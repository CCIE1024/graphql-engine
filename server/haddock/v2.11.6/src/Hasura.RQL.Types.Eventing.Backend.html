<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hasura.RQL.Types.Eventing.Backend</span><span>
</span><span id="line-2"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#BackendEventTrigger"><span class="hs-identifier">BackendEventTrigger</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-4"></span><span class="hs-keyword">where</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Control</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadBaseControl</span></span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set.NonEmpty</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time.Clock</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Time</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html"><span class="hs-identifier">Hasura.Backends.MSSQL.DDL.EventTrigger</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MSSQL</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html"><span class="hs-identifier">Hasura.Backends.Postgres.DDL.EventTrigger</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PG</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Base.Error.html"><span class="hs-identifier">Hasura.Base.Error</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Prelude.html"><span class="hs-identifier">Hasura.Prelude</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html"><span class="hs-identifier">Hasura.RQL.Types.Backend</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Column.html"><span class="hs-identifier">Hasura.RQL.Types.Column</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnInfo"><span class="hs-identifier">ColumnInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html"><span class="hs-identifier">Hasura.RQL.Types.Common</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html"><span class="hs-identifier">Hasura.RQL.Types.EventTrigger</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.html"><span class="hs-identifier">Hasura.RQL.Types.Eventing</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Source.html"><span class="hs-identifier">Hasura.RQL.Types.Source</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Table.html"><span class="hs-identifier">Hasura.RQL.Types.Table</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Table.html#PrimaryKey"><span class="hs-identifier">PrimaryKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.SQL.Backend.html"><span class="hs-identifier">Hasura.SQL.Backend</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Types.html"><span class="hs-identifier">Hasura.Server.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Types.html#HasServerConfigCtx"><span class="hs-identifier">HasServerConfigCtx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.Types.html#MaintenanceMode"><span class="hs-identifier">MaintenanceMode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.Types.html#ServerConfigCtx"><span class="hs-identifier">ServerConfigCtx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Session.html"><span class="hs-identifier">Hasura.Session</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Session.html#UserInfo"><span class="hs-identifier">UserInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Tracing.html"><span class="hs-identifier">Hasura.Tracing</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Tracing</span></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-comment">-- | The @BackendEventTrigger@ type class contains functions which interacts</span><span>
</span><span id="line-27"></span><span class="hs-comment">--   with the source database to perform event trigger related operations like</span><span>
</span><span id="line-28"></span><span class="hs-comment">--   fetching pending events from the database or inserting a new invocation log</span><span>
</span><span id="line-29"></span><span class="hs-comment">--   after processing an event.</span><span>
</span><span id="line-30"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="BackendEventTrigger"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#BackendEventTrigger"><span class="hs-identifier hs-var">BackendEventTrigger</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621689345990"><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.SQL.Backend.html#BackendType"><span class="hs-identifier hs-type">BackendType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-comment">-- | insertManualEvent inserts the specified event in the event log table,</span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-comment">--   note that this method should also set the trace context and session</span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-comment">--   variables in the source database context (if available).</span><span>
</span><span id="line-34"></span><span>  </span><span id="local-6989586621689346033"><span id="insertManualEvent"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#insertManualEvent"><span class="hs-identifier hs-type">insertManualEvent</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621689346033"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689346033"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#TableName"><span class="hs-identifier hs-type">TableName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#TriggerName"><span class="hs-identifier hs-type">TriggerName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="Hasura.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="Hasura.Tracing.html#TraceContext"><span class="hs-identifier hs-type">Tracing.TraceContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="#local-6989586621689346033"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.html#EventId"><span class="hs-identifier hs-type">EventId</span></a></span></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-comment">-- | @fetchUndeliveredEvents@ fetches the undelivered events from the source</span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-comment">--   and locks those events for processing. The locking is done so that when</span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-comment">--   there are multiple instances of graphql-engine connected to the same</span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-comment">--   source they don't end up processing the same events concurrently.</span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-comment">--   Also, it's crucial that the SQL query used to fetch events in this</span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-comment">--   function uses something like Postgres's `FOR UPDATE SKIP LOCKED`</span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-comment">--   mechanism so that it skips past the events which are locked by the</span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-comment">--   database and pick newer undelivered events to achieve maximum throughput.</span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-comment">--   The locking mechanism for event triggers is timestamp based i.e. when an</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-comment">--   event is fetched from the database, the `locked` column will contain the</span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-comment">--   timestamp of when it was fetched from the database. Undelivered events</span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-comment">--   will have `NULL` value as their `locked` column value.</span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-comment">--   The idea behind having a timestamp based locking mechanism is that if the</span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-comment">--   graphql-engine is shutdown abruptly with events being fetched by the</span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-comment">--   events processor, it will be locked and after the shutdown it will remain</span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-comment">--   locked. Now with a timestamp based lock, when the graphql-engine is</span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-comment">--   started again it will also fetch events which have a `locked` value of</span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-comment">--   older than 30 mins along with the undelivered events. So, this way no</span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-comment">--   events remain in a `locked` state.</span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-comment">--   When fetching the events from the event_log table we also include the</span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-comment">--   list of the triggers that exist in the metadata at that point of time,</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-comment">--   because we have seen in some cases there are events that do not belong to</span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-comment">--   any of the event triggers present in the metadata and those are fetched</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-comment">--   only to be failed saying the said event trigger doesn't exist. So, to</span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-comment">--   avoid this (atleast, as much as possible) we get only the events of the</span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-comment">--   event triggers we have in the metadata.</span><span>
</span><span id="line-74"></span><span>  </span><span id="local-6989586621689346022"><span id="fetchUndeliveredEvents"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#fetchUndeliveredEvents"><span class="hs-identifier hs-type">fetchUndeliveredEvents</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621689346022"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689346022"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#SourceName"><span class="hs-identifier hs-type">SourceName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-comment">-- | List of trigger names which exist in the metadata</span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#TriggerName"><span class="hs-identifier hs-type">TriggerName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><a href="Hasura.Server.Types.html#MaintenanceMode"><span class="hs-identifier hs-type">MaintenanceMode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#FetchBatchSize"><span class="hs-identifier hs-type">FetchBatchSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><a href="#local-6989586621689346022"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-comment">-- | Ad-hoc function to set a retry for an undelivered event</span><span>
</span><span id="line-85"></span><span>  </span><span id="local-6989586621689346017"><span id="setRetry"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#setRetry"><span class="hs-identifier hs-type">setRetry</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621689346017"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689346017"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Time.UTCTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><a href="Hasura.Server.Types.html#MaintenanceMode"><span class="hs-identifier hs-type">MaintenanceMode</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Source.html#MaintenanceModeVersion"><span class="hs-identifier hs-type">MaintenanceModeVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><a href="#local-6989586621689346017"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-comment">-- | @getMaintenanceModeVersion@ gets the source catalog version from the</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-comment">--   source</span><span>
</span><span id="line-95"></span><span>  </span><span id="local-6989586621689346014"><span id="getMaintenanceModeVersion"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#getMaintenanceModeVersion"><span class="hs-identifier hs-type">getMaintenanceModeVersion</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621689346014"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689346014"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><a href="#local-6989586621689346014"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Source.html#MaintenanceModeVersion"><span class="hs-identifier hs-type">MaintenanceModeVersion</span></a></span></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-comment">-- | @recordSuccess@ records a successful event invocation, it does a couple</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-comment">--   of things,</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-comment">--   1. Insert the invocation in the invocation logs table</span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-comment">--   2. Mark the event as 'delivered' in the event_log table</span><span>
</span><span id="line-105"></span><span>  </span><span id="local-6989586621689346013"><span id="recordSuccess"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#recordSuccess"><span class="hs-identifier hs-type">recordSuccess</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621689346013"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.html#Invocation"><span class="hs-identifier hs-type">Invocation</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.Eventing.html#EventType"><span class="hs-identifier hs-type">EventType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><a href="Hasura.Server.Types.html#MaintenanceMode"><span class="hs-identifier hs-type">MaintenanceMode</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Source.html#MaintenanceModeVersion"><span class="hs-identifier hs-type">MaintenanceModeVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-111"></span><span>    </span><span class="annot"><a href="#local-6989586621689346013"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-comment">-- | @recordError@ records an erronous event invocation, it does a couple of</span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-comment">--   things,</span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-comment">--   1. Insert the invocation in the invocation logs table</span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-comment">--   2. Depending on the value of `ProcessEventError`, it will either,</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-comment">--        - Set a retry for the given event</span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-comment">--        - Mark the event as 'error'</span><span>
</span><span id="line-120"></span><span>  </span><span id="local-6989586621689346010"><span id="recordError"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#recordError"><span class="hs-identifier hs-type">recordError</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621689346010"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-122"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.html#Invocation"><span class="hs-identifier hs-type">Invocation</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.Eventing.html#EventType"><span class="hs-identifier hs-type">EventType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#ProcessEventError"><span class="hs-identifier hs-type">ProcessEventError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><a href="Hasura.Server.Types.html#MaintenanceMode"><span class="hs-identifier hs-type">MaintenanceMode</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Source.html#MaintenanceModeVersion"><span class="hs-identifier hs-type">MaintenanceModeVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><a href="#local-6989586621689346010"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-comment">-- | @recordError'@ records an erronous event invocation, it does a couple of</span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-comment">--   things,</span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-comment">--   1. If present, insert the invocation in the invocation logs table</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-comment">--   2. Depending on the value of `ProcessEventError`, it will either,</span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-comment">--        - Set a retry for the given event</span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-comment">--        - Mark the event as 'error'</span><span>
</span><span id="line-136"></span><span>  </span><span id="local-6989586621689346008"><span id="recordError%27"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#recordError%27"><span class="hs-identifier hs-type">recordError'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621689346008"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Eventing.html#Invocation"><span class="hs-identifier hs-type">Invocation</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.Eventing.html#EventType"><span class="hs-identifier hs-type">EventType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#ProcessEventError"><span class="hs-identifier hs-type">ProcessEventError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><a href="Hasura.Server.Types.html#MaintenanceMode"><span class="hs-identifier hs-type">MaintenanceMode</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Source.html#MaintenanceModeVersion"><span class="hs-identifier hs-type">MaintenanceModeVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><a href="#local-6989586621689346008"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-comment">-- | @dropTriggerAndArchiveEvents@ drops the database trigger and</span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-comment">--   marks all the events related to the event trigger as archived.</span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-comment">--   See Note [Cleanup for dropped triggers]</span><span>
</span><span id="line-148"></span><span>  </span><span id="local-6989586621689346007"><span id="dropTriggerAndArchiveEvents"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#dropTriggerAndArchiveEvents"><span class="hs-identifier hs-type">dropTriggerAndArchiveEvents</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621689346007"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689346007"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-150"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#TriggerName"><span class="hs-identifier hs-type">TriggerName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#TableName"><span class="hs-identifier hs-type">TableName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><a href="#local-6989586621689346007"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-comment">-- | @dropDanglingSQLTriggger@ is used to delete the extraneous SQL triggers</span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-comment">--   created by an event trigger. The extraneous SQL triggers can be created</span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-comment">--   when an event trigger's definition is replaced to a new definition. For</span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-comment">--   example, an event trigger `authors_all` had an INSERT and UPDATE trigger</span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-comment">--   defined earlier and after it has UPDATE and DELETE triggers. So, in this</span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-comment">--   case, we need to drop the trigger created by us earlier for the INSERT</span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-comment">--   trigger.</span><span>
</span><span id="line-162"></span><span>  </span><span id="local-6989586621689346006"><span id="dropDanglingSQLTrigger"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#dropDanglingSQLTrigger"><span class="hs-identifier hs-type">dropDanglingSQLTrigger</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621689346006"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689346006"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-164"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-165"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#TriggerName"><span class="hs-identifier hs-type">TriggerName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-166"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#TableName"><span class="hs-identifier hs-type">TableName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">HashSet</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#Ops"><span class="hs-identifier hs-type">Ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><a href="#local-6989586621689346006"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span>  </span><span id="local-6989586621689346003"><span id="redeliverEvent"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#redeliverEvent"><span class="hs-identifier hs-type">redeliverEvent</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621689346003"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689346003"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.html#EventId"><span class="hs-identifier hs-type">EventId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><a href="#local-6989586621689346003"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-comment">-- | @unlockEventsInSource@ unlocks the cached locked events which were</span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-comment">--   captured when a graceful shutdown is initiated, so that when the</span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-comment">--   graphql-engine restarts these events can be fetched to process them</span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-comment">--   immediately.</span><span>
</span><span id="line-180"></span><span>  </span><span id="local-6989586621689346002"><span id="unlockEventsInSource"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#unlockEventsInSource"><span class="hs-identifier hs-type">unlockEventsInSource</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621689346002"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">NE.NESet</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.html#EventId"><span class="hs-identifier hs-type">EventId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-184"></span><span>    </span><span class="annot"><a href="#local-6989586621689346002"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-comment">-- | @createMissingSQLTriggers@ checks in the source whether all the triggers</span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-comment">--   exist according to the event trigger's specification. If any SQL trigger doesn't</span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-comment">--   exist then it will create it.</span><span>
</span><span id="line-189"></span><span>  </span><span id="local-6989586621689346000"><span id="createMissingSQLTriggers"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#createMissingSQLTriggers"><span class="hs-identifier hs-type">createMissingSQLTriggers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621689346000"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689346000"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadBaseControl</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621689346000"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.Types.html#HasServerConfigCtx"><span class="hs-identifier hs-type">HasServerConfigCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689346000"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#TableName"><span class="hs-identifier hs-type">TableName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnInfo"><span class="hs-identifier hs-type">ColumnInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Table.html#PrimaryKey"><span class="hs-identifier hs-type">PrimaryKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnInfo"><span class="hs-identifier hs-type">ColumnInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#TriggerName"><span class="hs-identifier hs-type">TriggerName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#TriggerOpsDef"><span class="hs-identifier hs-type">TriggerOpsDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><a href="#local-6989586621689346000"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span>  </span><span id="local-6989586621689345994"><span id="createTableEventTrigger"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#createTableEventTrigger"><span class="hs-identifier hs-type">createTableEventTrigger</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadBaseControl</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621689345994"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621689345994"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345994"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><a href="Hasura.Server.Types.html#ServerConfigCtx"><span class="hs-identifier hs-type">ServerConfigCtx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#TableName"><span class="hs-identifier hs-type">TableName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnInfo"><span class="hs-identifier hs-type">ColumnInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#TriggerName"><span class="hs-identifier hs-type">TriggerName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#TriggerOpsDef"><span class="hs-identifier hs-type">TriggerOpsDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-comment">-- TODO: Naveen: Find a better way to pass these extra, backend specific</span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-comment">-- parameters instead of adding a bunch of Maybes to the type class</span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-comment">-- functions.</span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-comment">-- Update event trigger on MS-SQL are only supported on tables with primary</span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-comment">-- keys. Hence the PrimaryKey argument below.</span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Table.html#PrimaryKey"><span class="hs-identifier hs-type">PrimaryKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnInfo"><span class="hs-identifier hs-type">ColumnInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689345990"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-213"></span><span>    </span><span class="annot"><a href="#local-6989586621689345994"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- TODO: move those instances to 'Backend/*/Instances/Eventing' and create a</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- corresponding 'Instances.hs' file in this directory to import them, similarly</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- to how we import instances for other backend classes. This would</span><span>
</span><span id="line-219"></span><span class="hs-comment">-- significantly reduce the number of files in the core engine that end up</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- depending / importing backend-specific files.</span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#BackendEventTrigger"><span class="hs-identifier hs-type">BackendEventTrigger</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-223"></span><span>  </span><span id="local-6989586621689345822"><span class="annot"><span class="annottext">insertManualEvent :: SourceConfig ('Postgres 'Vanilla)
-&gt; TableName ('Postgres 'Vanilla)
-&gt; TriggerName
-&gt; Value
-&gt; UserInfo
-&gt; TraceContext
-&gt; m EventId
</span><a href="#local-6989586621689345822"><span class="hs-identifier hs-var hs-var hs-var hs-var">insertManualEvent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Vanilla)
-&gt; TableName ('Postgres 'Vanilla)
-&gt; TriggerName
-&gt; Value
-&gt; UserInfo
-&gt; TraceContext
-&gt; m EventId
forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres pgKind)
-&gt; TableName ('Postgres pgKind)
-&gt; TriggerName
-&gt; Value
-&gt; UserInfo
-&gt; TraceContext
-&gt; m EventId
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#insertManualEvent"><span class="hs-identifier hs-var">PG.insertManualEvent</span></a></span><span>
</span><span id="line-224"></span><span>  </span><span id="local-6989586621689345820"><span class="annot"><span class="annottext">fetchUndeliveredEvents :: SourceConfig ('Postgres 'Vanilla)
-&gt; SourceName
-&gt; [TriggerName]
-&gt; MaintenanceMode ()
-&gt; FetchBatchSize
-&gt; m [Event ('Postgres 'Vanilla)]
</span><a href="#local-6989586621689345820"><span class="hs-identifier hs-var hs-var hs-var hs-var">fetchUndeliveredEvents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Vanilla)
-&gt; SourceName
-&gt; [TriggerName]
-&gt; MaintenanceMode ()
-&gt; FetchBatchSize
-&gt; m [Event ('Postgres 'Vanilla)]
forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres pgKind)
-&gt; SourceName
-&gt; [TriggerName]
-&gt; MaintenanceMode ()
-&gt; FetchBatchSize
-&gt; m [Event ('Postgres pgKind)]
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#fetchUndeliveredEvents"><span class="hs-identifier hs-var">PG.fetchUndeliveredEvents</span></a></span><span>
</span><span id="line-225"></span><span>  </span><span id="local-6989586621689345818"><span class="annot"><span class="annottext">setRetry :: SourceConfig ('Postgres 'Vanilla)
-&gt; Event ('Postgres 'Vanilla)
-&gt; UTCTime
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m ()
</span><a href="#local-6989586621689345818"><span class="hs-identifier hs-var hs-var hs-var hs-var">setRetry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Vanilla)
-&gt; Event ('Postgres 'Vanilla)
-&gt; UTCTime
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m ()
forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres pgKind)
-&gt; Event ('Postgres pgKind)
-&gt; UTCTime
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m ()
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#setRetry"><span class="hs-identifier hs-var">PG.setRetry</span></a></span><span>
</span><span id="line-226"></span><span>  </span><span id="local-6989586621689345816"><span class="annot"><span class="annottext">getMaintenanceModeVersion :: SourceConfig ('Postgres 'Vanilla) -&gt; m MaintenanceModeVersion
</span><a href="#local-6989586621689345816"><span class="hs-identifier hs-var hs-var hs-var hs-var">getMaintenanceModeVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Vanilla) -&gt; m MaintenanceModeVersion
forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres pgKind) -&gt; m MaintenanceModeVersion
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#getMaintenanceModeVersion"><span class="hs-identifier hs-var">PG.getMaintenanceModeVersion</span></a></span><span>
</span><span id="line-227"></span><span>  </span><span id="local-6989586621689345814"><span class="annot"><span class="annottext">recordSuccess :: SourceConfig ('Postgres 'Vanilla)
-&gt; Event ('Postgres 'Vanilla)
-&gt; Invocation 'EventType
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621689345814"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordSuccess</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Vanilla)
-&gt; Event ('Postgres 'Vanilla)
-&gt; Invocation 'EventType
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
forall (m :: * -&gt; *) (pgKind :: PostgresKind).
MonadIO m =&gt;
SourceConfig ('Postgres pgKind)
-&gt; Event ('Postgres pgKind)
-&gt; Invocation 'EventType
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#recordSuccess"><span class="hs-identifier hs-var">PG.recordSuccess</span></a></span><span>
</span><span id="line-228"></span><span>  </span><span id="local-6989586621689345812"><span class="annot"><span class="annottext">recordError :: SourceConfig ('Postgres 'Vanilla)
-&gt; Event ('Postgres 'Vanilla)
-&gt; Invocation 'EventType
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621689345812"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Vanilla)
-&gt; Event ('Postgres 'Vanilla)
-&gt; Invocation 'EventType
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
forall (m :: * -&gt; *) (pgKind :: PostgresKind).
MonadIO m =&gt;
SourceConfig ('Postgres pgKind)
-&gt; Event ('Postgres pgKind)
-&gt; Invocation 'EventType
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#recordError"><span class="hs-identifier hs-var">PG.recordError</span></a></span><span>
</span><span id="line-229"></span><span>  </span><span id="local-6989586621689345810"><span class="annot"><span class="annottext">recordError' :: SourceConfig ('Postgres 'Vanilla)
-&gt; Event ('Postgres 'Vanilla)
-&gt; Maybe (Invocation 'EventType)
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621689345810"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Vanilla)
-&gt; Event ('Postgres 'Vanilla)
-&gt; Maybe (Invocation 'EventType)
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
forall (m :: * -&gt; *) (pgKind :: PostgresKind).
MonadIO m =&gt;
SourceConfig ('Postgres pgKind)
-&gt; Event ('Postgres pgKind)
-&gt; Maybe (Invocation 'EventType)
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#recordError%27"><span class="hs-identifier hs-var">PG.recordError'</span></a></span><span>
</span><span id="line-230"></span><span>  </span><span id="local-6989586621689345808"><span class="annot"><span class="annottext">dropTriggerAndArchiveEvents :: SourceConfig ('Postgres 'Vanilla)
-&gt; TriggerName -&gt; TableName ('Postgres 'Vanilla) -&gt; m ()
</span><a href="#local-6989586621689345808"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropTriggerAndArchiveEvents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Vanilla)
-&gt; TriggerName -&gt; TableName ('Postgres 'Vanilla) -&gt; m ()
forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres pgKind)
-&gt; TriggerName -&gt; QualifiedTable -&gt; m ()
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#dropTriggerAndArchiveEvents"><span class="hs-identifier hs-var">PG.dropTriggerAndArchiveEvents</span></a></span><span>
</span><span id="line-231"></span><span>  </span><span id="local-6989586621689345806"><span class="annot"><span class="annottext">dropDanglingSQLTrigger :: SourceConfig ('Postgres 'Vanilla)
-&gt; TriggerName
-&gt; TableName ('Postgres 'Vanilla)
-&gt; HashSet Ops
-&gt; m ()
</span><a href="#local-6989586621689345806"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropDanglingSQLTrigger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Vanilla)
-&gt; TriggerName
-&gt; TableName ('Postgres 'Vanilla)
-&gt; HashSet Ops
-&gt; m ()
forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres pgKind)
-&gt; TriggerName -&gt; QualifiedTable -&gt; HashSet Ops -&gt; m ()
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#dropDanglingSQLTrigger"><span class="hs-identifier hs-var">PG.dropDanglingSQLTrigger</span></a></span><span>
</span><span id="line-232"></span><span>  </span><span id="local-6989586621689345804"><span class="annot"><span class="annottext">redeliverEvent :: SourceConfig ('Postgres 'Vanilla) -&gt; EventId -&gt; m ()
</span><a href="#local-6989586621689345804"><span class="hs-identifier hs-var hs-var hs-var hs-var">redeliverEvent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Vanilla) -&gt; EventId -&gt; m ()
forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres pgKind) -&gt; EventId -&gt; m ()
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#redeliverEvent"><span class="hs-identifier hs-var">PG.redeliverEvent</span></a></span><span>
</span><span id="line-233"></span><span>  </span><span id="local-6989586621689345802"><span class="annot"><span class="annottext">unlockEventsInSource :: SourceConfig ('Postgres 'Vanilla)
-&gt; NESet EventId -&gt; m (Either QErr Int)
</span><a href="#local-6989586621689345802"><span class="hs-identifier hs-var hs-var hs-var hs-var">unlockEventsInSource</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Vanilla)
-&gt; NESet EventId -&gt; m (Either QErr Int)
forall (m :: * -&gt; *) (pgKind :: PostgresKind).
MonadIO m =&gt;
SourceConfig ('Postgres pgKind)
-&gt; NESet EventId -&gt; m (Either QErr Int)
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#unlockEventsInSource"><span class="hs-identifier hs-var">PG.unlockEventsInSource</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span id="local-6989586621689345800"><span class="annot"><span class="annottext">createTableEventTrigger :: ServerConfigCtx
-&gt; SourceConfig ('Postgres 'Vanilla)
-&gt; TableName ('Postgres 'Vanilla)
-&gt; [ColumnInfo ('Postgres 'Vanilla)]
-&gt; TriggerName
-&gt; TriggerOpsDef ('Postgres 'Vanilla)
-&gt; Maybe
     (PrimaryKey ('Postgres 'Vanilla) (ColumnInfo ('Postgres 'Vanilla)))
-&gt; m (Either QErr ())
</span><a href="#local-6989586621689345800"><span class="hs-identifier hs-var hs-var hs-var hs-var">createTableEventTrigger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ServerConfigCtx
-&gt; SourceConfig ('Postgres 'Vanilla)
-&gt; TableName ('Postgres 'Vanilla)
-&gt; [ColumnInfo ('Postgres 'Vanilla)]
-&gt; TriggerName
-&gt; TriggerOpsDef ('Postgres 'Vanilla)
-&gt; Maybe
     (PrimaryKey ('Postgres 'Vanilla) (ColumnInfo ('Postgres 'Vanilla)))
-&gt; m (Either QErr ())
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(Backend ('Postgres pgKind), MonadIO m, MonadBaseControl IO m) =&gt;
ServerConfigCtx
-&gt; PGSourceConfig
-&gt; QualifiedTable
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; TriggerName
-&gt; TriggerOpsDef ('Postgres pgKind)
-&gt; Maybe
     (PrimaryKey ('Postgres pgKind) (ColumnInfo ('Postgres pgKind)))
-&gt; m (Either QErr ())
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#createTableEventTrigger"><span class="hs-identifier hs-var">PG.createTableEventTrigger</span></a></span><span>
</span><span id="line-235"></span><span>  </span><span id="local-6989586621689345798"><span class="annot"><span class="annottext">createMissingSQLTriggers :: SourceConfig ('Postgres 'Vanilla)
-&gt; TableName ('Postgres 'Vanilla)
-&gt; ([ColumnInfo ('Postgres 'Vanilla)],
    Maybe
      (PrimaryKey
         ('Postgres 'Vanilla) (ColumnInfo ('Postgres 'Vanilla))))
-&gt; TriggerName
-&gt; TriggerOpsDef ('Postgres 'Vanilla)
-&gt; m ()
</span><a href="#local-6989586621689345798"><span class="hs-identifier hs-var hs-var hs-var hs-var">createMissingSQLTriggers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Vanilla)
-&gt; TableName ('Postgres 'Vanilla)
-&gt; ([ColumnInfo ('Postgres 'Vanilla)],
    Maybe
      (PrimaryKey
         ('Postgres 'Vanilla) (ColumnInfo ('Postgres 'Vanilla))))
-&gt; TriggerName
-&gt; TriggerOpsDef ('Postgres 'Vanilla)
-&gt; m ()
forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadIO m, MonadError QErr m, MonadBaseControl IO m,
 HasServerConfigCtx m, Backend ('Postgres pgKind)) =&gt;
PGSourceConfig
-&gt; TableName ('Postgres pgKind)
-&gt; ([ColumnInfo ('Postgres pgKind)],
    Maybe
      (PrimaryKey ('Postgres pgKind) (ColumnInfo ('Postgres pgKind))))
-&gt; TriggerName
-&gt; TriggerOpsDef ('Postgres pgKind)
-&gt; m ()
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#createMissingSQLTriggers"><span class="hs-identifier hs-var">PG.createMissingSQLTriggers</span></a></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#BackendEventTrigger"><span class="hs-identifier hs-type">BackendEventTrigger</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Citus"><span class="hs-identifier hs-type">Citus</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-238"></span><span>  </span><span id="local-6989586621689345782"><span class="annot"><span class="annottext">insertManualEvent :: SourceConfig ('Postgres 'Citus)
-&gt; TableName ('Postgres 'Citus)
-&gt; TriggerName
-&gt; Value
-&gt; UserInfo
-&gt; TraceContext
-&gt; m EventId
</span><a href="#local-6989586621689345782"><span class="hs-identifier hs-var hs-var hs-var hs-var">insertManualEvent</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TraceContext
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m EventId
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m EventId) -&gt; Text -&gt; m EventId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-239"></span><span>  </span><span id="local-6989586621689345779"><span class="annot"><span class="annottext">fetchUndeliveredEvents :: SourceConfig ('Postgres 'Citus)
-&gt; SourceName
-&gt; [TriggerName]
-&gt; MaintenanceMode ()
-&gt; FetchBatchSize
-&gt; m [Event ('Postgres 'Citus)]
</span><a href="#local-6989586621689345779"><span class="hs-identifier hs-var hs-var hs-var hs-var">fetchUndeliveredEvents</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[TriggerName]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode ()
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FetchBatchSize
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m [Event ('Postgres 'Citus)]
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-240"></span><span>  </span><span id="local-6989586621689345778"><span class="annot"><span class="annottext">setRetry :: SourceConfig ('Postgres 'Citus)
-&gt; Event ('Postgres 'Citus)
-&gt; UTCTime
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m ()
</span><a href="#local-6989586621689345778"><span class="hs-identifier hs-var hs-var hs-var hs-var">setRetry</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-241"></span><span>  </span><span id="local-6989586621689345777"><span class="annot"><span class="annottext">recordSuccess :: SourceConfig ('Postgres 'Citus)
-&gt; Event ('Postgres 'Citus)
-&gt; Invocation 'EventType
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621689345777"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordSuccess</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Invocation 'EventType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT QErr m () -&gt; m (Either QErr ())
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT QErr m () -&gt; m (Either QErr ()))
-&gt; ExceptT QErr m () -&gt; m (Either QErr ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; ExceptT QErr m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-242"></span><span>  </span><span id="local-6989586621689345775"><span class="annot"><span class="annottext">getMaintenanceModeVersion :: SourceConfig ('Postgres 'Citus) -&gt; m MaintenanceModeVersion
</span><a href="#local-6989586621689345775"><span class="hs-identifier hs-var hs-var hs-var hs-var">getMaintenanceModeVersion</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m MaintenanceModeVersion
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-243"></span><span>  </span><span id="local-6989586621689345774"><span class="annot"><span class="annottext">recordError :: SourceConfig ('Postgres 'Citus)
-&gt; Event ('Postgres 'Citus)
-&gt; Invocation 'EventType
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621689345774"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Invocation 'EventType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ProcessEventError
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT QErr m () -&gt; m (Either QErr ())
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT QErr m () -&gt; m (Either QErr ()))
-&gt; ExceptT QErr m () -&gt; m (Either QErr ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; ExceptT QErr m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-244"></span><span>  </span><span id="local-6989586621689345773"><span class="annot"><span class="annottext">recordError' :: SourceConfig ('Postgres 'Citus)
-&gt; Event ('Postgres 'Citus)
-&gt; Maybe (Invocation 'EventType)
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621689345773"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError'</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Invocation 'EventType)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ProcessEventError
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT QErr m () -&gt; m (Either QErr ())
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT QErr m () -&gt; m (Either QErr ()))
-&gt; ExceptT QErr m () -&gt; m (Either QErr ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; ExceptT QErr m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-245"></span><span>  </span><span id="local-6989586621689345772"><span class="annot"><span class="annottext">dropTriggerAndArchiveEvents :: SourceConfig ('Postgres 'Citus)
-&gt; TriggerName -&gt; TableName ('Postgres 'Citus) -&gt; m ()
</span><a href="#local-6989586621689345772"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropTriggerAndArchiveEvents</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-246"></span><span>  </span><span id="local-6989586621689345771"><span class="annot"><span class="annottext">dropDanglingSQLTrigger :: SourceConfig ('Postgres 'Citus)
-&gt; TriggerName
-&gt; TableName ('Postgres 'Citus)
-&gt; HashSet Ops
-&gt; m ()
</span><a href="#local-6989586621689345771"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropDanglingSQLTrigger</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HashSet Ops
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-247"></span><span>  </span><span id="local-6989586621689345770"><span class="annot"><span class="annottext">redeliverEvent :: SourceConfig ('Postgres 'Citus) -&gt; EventId -&gt; m ()
</span><a href="#local-6989586621689345770"><span class="hs-identifier hs-var hs-var hs-var hs-var">redeliverEvent</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">EventId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-248"></span><span>  </span><span id="local-6989586621689345769"><span class="annot"><span class="annottext">unlockEventsInSource :: SourceConfig ('Postgres 'Citus)
-&gt; NESet EventId -&gt; m (Either QErr Int)
</span><a href="#local-6989586621689345769"><span class="hs-identifier hs-var hs-var hs-var hs-var">unlockEventsInSource</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NESet EventId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT QErr m Int -&gt; m (Either QErr Int)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT QErr m Int -&gt; m (Either QErr Int))
-&gt; ExceptT QErr m Int -&gt; m (Either QErr Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; ExceptT QErr m Int
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-249"></span><span>  </span><span id="local-6989586621689345768"><span class="annot"><span class="annottext">createTableEventTrigger :: ServerConfigCtx
-&gt; SourceConfig ('Postgres 'Citus)
-&gt; TableName ('Postgres 'Citus)
-&gt; [ColumnInfo ('Postgres 'Citus)]
-&gt; TriggerName
-&gt; TriggerOpsDef ('Postgres 'Citus)
-&gt; Maybe
     (PrimaryKey ('Postgres 'Citus) (ColumnInfo ('Postgres 'Citus)))
-&gt; m (Either QErr ())
</span><a href="#local-6989586621689345768"><span class="hs-identifier hs-var hs-var hs-var hs-var">createTableEventTrigger</span></a></span></span><span> </span><span class="annot"><span class="annottext">ServerConfigCtx
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[ColumnInfo ('Postgres 'Citus)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerOpsDef ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe
  (PrimaryKey ('Postgres 'Citus) (ColumnInfo ('Postgres 'Citus)))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT QErr m () -&gt; m (Either QErr ())
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT QErr m () -&gt; m (Either QErr ()))
-&gt; ExceptT QErr m () -&gt; m (Either QErr ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; ExceptT QErr m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-250"></span><span>  </span><span id="local-6989586621689345767"><span class="annot"><span class="annottext">createMissingSQLTriggers :: SourceConfig ('Postgres 'Citus)
-&gt; TableName ('Postgres 'Citus)
-&gt; ([ColumnInfo ('Postgres 'Citus)],
    Maybe
      (PrimaryKey ('Postgres 'Citus) (ColumnInfo ('Postgres 'Citus))))
-&gt; TriggerName
-&gt; TriggerOpsDef ('Postgres 'Citus)
-&gt; m ()
</span><a href="#local-6989586621689345767"><span class="hs-identifier hs-var hs-var hs-var hs-var">createMissingSQLTriggers</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">([ColumnInfo ('Postgres 'Citus)],
 Maybe
   (PrimaryKey ('Postgres 'Citus) (ColumnInfo ('Postgres 'Citus))))
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerOpsDef ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m ()) -&gt; Text -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#BackendEventTrigger"><span class="hs-identifier hs-type">BackendEventTrigger</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#MSSQL"><span class="hs-identifier hs-type">MSSQL</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-253"></span><span>  </span><span id="local-6989586621689345752"><span class="annot"><span class="annottext">insertManualEvent :: SourceConfig 'MSSQL
-&gt; TableName 'MSSQL
-&gt; TriggerName
-&gt; Value
-&gt; UserInfo
-&gt; TraceContext
-&gt; m EventId
</span><a href="#local-6989586621689345752"><span class="hs-identifier hs-var hs-var hs-var hs-var">insertManualEvent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MSSQL
-&gt; TableName 'MSSQL
-&gt; TriggerName
-&gt; Value
-&gt; UserInfo
-&gt; TraceContext
-&gt; m EventId
forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
MSSQLSourceConfig
-&gt; TableName
-&gt; TriggerName
-&gt; Value
-&gt; UserInfo
-&gt; TraceContext
-&gt; m EventId
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#insertManualEvent"><span class="hs-identifier hs-var">MSSQL.insertManualEvent</span></a></span><span>
</span><span id="line-254"></span><span>  </span><span id="local-6989586621689345750"><span class="annot"><span class="annottext">fetchUndeliveredEvents :: SourceConfig 'MSSQL
-&gt; SourceName
-&gt; [TriggerName]
-&gt; MaintenanceMode ()
-&gt; FetchBatchSize
-&gt; m [Event 'MSSQL]
</span><a href="#local-6989586621689345750"><span class="hs-identifier hs-var hs-var hs-var hs-var">fetchUndeliveredEvents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MSSQL
-&gt; SourceName
-&gt; [TriggerName]
-&gt; MaintenanceMode ()
-&gt; FetchBatchSize
-&gt; m [Event 'MSSQL]
forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
MSSQLSourceConfig
-&gt; SourceName
-&gt; [TriggerName]
-&gt; MaintenanceMode ()
-&gt; FetchBatchSize
-&gt; m [Event 'MSSQL]
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#fetchUndeliveredEvents"><span class="hs-identifier hs-var">MSSQL.fetchUndeliveredEvents</span></a></span><span>
</span><span id="line-255"></span><span>  </span><span id="local-6989586621689345748"><span class="annot"><span class="annottext">setRetry :: SourceConfig 'MSSQL
-&gt; Event 'MSSQL
-&gt; UTCTime
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m ()
</span><a href="#local-6989586621689345748"><span class="hs-identifier hs-var hs-var hs-var hs-var">setRetry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MSSQL
-&gt; Event 'MSSQL
-&gt; UTCTime
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m ()
forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
MSSQLSourceConfig
-&gt; Event 'MSSQL
-&gt; UTCTime
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m ()
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#setRetry"><span class="hs-identifier hs-var">MSSQL.setRetry</span></a></span><span>
</span><span id="line-256"></span><span>  </span><span id="local-6989586621689345746"><span class="annot"><span class="annottext">recordSuccess :: SourceConfig 'MSSQL
-&gt; Event 'MSSQL
-&gt; Invocation 'EventType
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621689345746"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordSuccess</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MSSQL
-&gt; Event 'MSSQL
-&gt; Invocation 'EventType
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
forall (m :: * -&gt; *).
MonadIO m =&gt;
MSSQLSourceConfig
-&gt; Event 'MSSQL
-&gt; Invocation 'EventType
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#recordSuccess"><span class="hs-identifier hs-var">MSSQL.recordSuccess</span></a></span><span>
</span><span id="line-257"></span><span>  </span><span id="local-6989586621689345744"><span class="annot"><span class="annottext">getMaintenanceModeVersion :: SourceConfig 'MSSQL -&gt; m MaintenanceModeVersion
</span><a href="#local-6989586621689345744"><span class="hs-identifier hs-var hs-var hs-var hs-var">getMaintenanceModeVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MSSQL -&gt; m MaintenanceModeVersion
forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
MSSQLSourceConfig -&gt; m MaintenanceModeVersion
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#getMaintenanceModeVersion"><span class="hs-identifier hs-var">MSSQL.getMaintenanceModeVersion</span></a></span><span>
</span><span id="line-258"></span><span>  </span><span id="local-6989586621689345742"><span class="annot"><span class="annottext">recordError :: SourceConfig 'MSSQL
-&gt; Event 'MSSQL
-&gt; Invocation 'EventType
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621689345742"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MSSQL
-&gt; Event 'MSSQL
-&gt; Invocation 'EventType
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
forall (m :: * -&gt; *).
MonadIO m =&gt;
MSSQLSourceConfig
-&gt; Event 'MSSQL
-&gt; Invocation 'EventType
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#recordError"><span class="hs-identifier hs-var">MSSQL.recordError</span></a></span><span>
</span><span id="line-259"></span><span>  </span><span id="local-6989586621689345740"><span class="annot"><span class="annottext">recordError' :: SourceConfig 'MSSQL
-&gt; Event 'MSSQL
-&gt; Maybe (Invocation 'EventType)
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621689345740"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MSSQL
-&gt; Event 'MSSQL
-&gt; Maybe (Invocation 'EventType)
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
forall (m :: * -&gt; *).
MonadIO m =&gt;
MSSQLSourceConfig
-&gt; Event 'MSSQL
-&gt; Maybe (Invocation 'EventType)
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#recordError%27"><span class="hs-identifier hs-var">MSSQL.recordError'</span></a></span><span>
</span><span id="line-260"></span><span>  </span><span id="local-6989586621689345738"><span class="annot"><span class="annottext">dropTriggerAndArchiveEvents :: SourceConfig 'MSSQL -&gt; TriggerName -&gt; TableName 'MSSQL -&gt; m ()
</span><a href="#local-6989586621689345738"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropTriggerAndArchiveEvents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MSSQL -&gt; TriggerName -&gt; TableName 'MSSQL -&gt; m ()
forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
MSSQLSourceConfig -&gt; TriggerName -&gt; TableName -&gt; m ()
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#dropTriggerAndArchiveEvents"><span class="hs-identifier hs-var">MSSQL.dropTriggerAndArchiveEvents</span></a></span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621689345736"><span class="annot"><span class="annottext">redeliverEvent :: SourceConfig 'MSSQL -&gt; EventId -&gt; m ()
</span><a href="#local-6989586621689345736"><span class="hs-identifier hs-var hs-var hs-var hs-var">redeliverEvent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MSSQL -&gt; EventId -&gt; m ()
forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
MSSQLSourceConfig -&gt; EventId -&gt; m ()
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#redeliverEvent"><span class="hs-identifier hs-var">MSSQL.redeliverEvent</span></a></span><span>
</span><span id="line-262"></span><span>  </span><span id="local-6989586621689345734"><span class="annot"><span class="annottext">unlockEventsInSource :: SourceConfig 'MSSQL -&gt; NESet EventId -&gt; m (Either QErr Int)
</span><a href="#local-6989586621689345734"><span class="hs-identifier hs-var hs-var hs-var hs-var">unlockEventsInSource</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MSSQL -&gt; NESet EventId -&gt; m (Either QErr Int)
forall (m :: * -&gt; *).
MonadIO m =&gt;
MSSQLSourceConfig -&gt; NESet EventId -&gt; m (Either QErr Int)
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#unlockEventsInSource"><span class="hs-identifier hs-var">MSSQL.unlockEventsInSource</span></a></span><span>
</span><span id="line-263"></span><span>  </span><span id="local-6989586621689345732"><span class="annot"><span class="annottext">dropDanglingSQLTrigger :: SourceConfig 'MSSQL
-&gt; TriggerName -&gt; TableName 'MSSQL -&gt; HashSet Ops -&gt; m ()
</span><a href="#local-6989586621689345732"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropDanglingSQLTrigger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MSSQL
-&gt; TriggerName -&gt; TableName 'MSSQL -&gt; HashSet Ops -&gt; m ()
forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
MSSQLSourceConfig
-&gt; TriggerName -&gt; TableName -&gt; HashSet Ops -&gt; m ()
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#dropDanglingSQLTrigger"><span class="hs-identifier hs-var">MSSQL.dropDanglingSQLTrigger</span></a></span><span>
</span><span id="line-264"></span><span>  </span><span id="local-6989586621689345730"><span class="annot"><span class="annottext">createTableEventTrigger :: ServerConfigCtx
-&gt; SourceConfig 'MSSQL
-&gt; TableName 'MSSQL
-&gt; [ColumnInfo 'MSSQL]
-&gt; TriggerName
-&gt; TriggerOpsDef 'MSSQL
-&gt; Maybe (PrimaryKey 'MSSQL (ColumnInfo 'MSSQL))
-&gt; m (Either QErr ())
</span><a href="#local-6989586621689345730"><span class="hs-identifier hs-var hs-var hs-var hs-var">createTableEventTrigger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ServerConfigCtx
-&gt; SourceConfig 'MSSQL
-&gt; TableName 'MSSQL
-&gt; [ColumnInfo 'MSSQL]
-&gt; TriggerName
-&gt; TriggerOpsDef 'MSSQL
-&gt; Maybe (PrimaryKey 'MSSQL (ColumnInfo 'MSSQL))
-&gt; m (Either QErr ())
forall (m :: * -&gt; *).
MonadIO m =&gt;
ServerConfigCtx
-&gt; MSSQLSourceConfig
-&gt; TableName
-&gt; [ColumnInfo 'MSSQL]
-&gt; TriggerName
-&gt; TriggerOpsDef 'MSSQL
-&gt; Maybe (PrimaryKey 'MSSQL (ColumnInfo 'MSSQL))
-&gt; m (Either QErr ())
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#createTableEventTrigger"><span class="hs-identifier hs-var">MSSQL.createTableEventTrigger</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span id="local-6989586621689345728"><span class="annot"><span class="annottext">createMissingSQLTriggers :: SourceConfig 'MSSQL
-&gt; TableName 'MSSQL
-&gt; ([ColumnInfo 'MSSQL],
    Maybe (PrimaryKey 'MSSQL (ColumnInfo 'MSSQL)))
-&gt; TriggerName
-&gt; TriggerOpsDef 'MSSQL
-&gt; m ()
</span><a href="#local-6989586621689345728"><span class="hs-identifier hs-var hs-var hs-var hs-var">createMissingSQLTriggers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MSSQL
-&gt; TableName 'MSSQL
-&gt; ([ColumnInfo 'MSSQL],
    Maybe (PrimaryKey 'MSSQL (ColumnInfo 'MSSQL)))
-&gt; TriggerName
-&gt; TriggerOpsDef 'MSSQL
-&gt; m ()
forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m, MonadBaseControl IO m) =&gt;
MSSQLSourceConfig
-&gt; TableName
-&gt; ([ColumnInfo 'MSSQL],
    Maybe (PrimaryKey 'MSSQL (ColumnInfo 'MSSQL)))
-&gt; TriggerName
-&gt; TriggerOpsDef 'MSSQL
-&gt; m ()
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#createMissingSQLTriggers"><span class="hs-identifier hs-var">MSSQL.createMissingSQLTriggers</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#BackendEventTrigger"><span class="hs-identifier hs-type">BackendEventTrigger</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#BigQuery"><span class="hs-identifier hs-type">BigQuery</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-268"></span><span>  </span><span id="local-6989586621689345712"><span class="annot"><span class="annottext">insertManualEvent :: SourceConfig 'BigQuery
-&gt; TableName 'BigQuery
-&gt; TriggerName
-&gt; Value
-&gt; UserInfo
-&gt; TraceContext
-&gt; m EventId
</span><a href="#local-6989586621689345712"><span class="hs-identifier hs-var hs-var hs-var hs-var">insertManualEvent</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TraceContext
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m EventId
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m EventId) -&gt; Text -&gt; m EventId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-269"></span><span>  </span><span id="local-6989586621689345711"><span class="annot"><span class="annottext">fetchUndeliveredEvents :: SourceConfig 'BigQuery
-&gt; SourceName
-&gt; [TriggerName]
-&gt; MaintenanceMode ()
-&gt; FetchBatchSize
-&gt; m [Event 'BigQuery]
</span><a href="#local-6989586621689345711"><span class="hs-identifier hs-var hs-var hs-var hs-var">fetchUndeliveredEvents</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[TriggerName]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode ()
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FetchBatchSize
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m [Event 'BigQuery]
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-270"></span><span>  </span><span id="local-6989586621689345710"><span class="annot"><span class="annottext">setRetry :: SourceConfig 'BigQuery
-&gt; Event 'BigQuery
-&gt; UTCTime
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m ()
</span><a href="#local-6989586621689345710"><span class="hs-identifier hs-var hs-var hs-var hs-var">setRetry</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-271"></span><span>  </span><span id="local-6989586621689345709"><span class="annot"><span class="annottext">recordSuccess :: SourceConfig 'BigQuery
-&gt; Event 'BigQuery
-&gt; Invocation 'EventType
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621689345709"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordSuccess</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Invocation 'EventType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT QErr m () -&gt; m (Either QErr ())
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT QErr m () -&gt; m (Either QErr ()))
-&gt; ExceptT QErr m () -&gt; m (Either QErr ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; ExceptT QErr m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-272"></span><span>  </span><span id="local-6989586621689345708"><span class="annot"><span class="annottext">getMaintenanceModeVersion :: SourceConfig 'BigQuery -&gt; m MaintenanceModeVersion
</span><a href="#local-6989586621689345708"><span class="hs-identifier hs-var hs-var hs-var hs-var">getMaintenanceModeVersion</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m MaintenanceModeVersion
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-273"></span><span>  </span><span id="local-6989586621689345707"><span class="annot"><span class="annottext">recordError :: SourceConfig 'BigQuery
-&gt; Event 'BigQuery
-&gt; Invocation 'EventType
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621689345707"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Invocation 'EventType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ProcessEventError
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT QErr m () -&gt; m (Either QErr ())
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT QErr m () -&gt; m (Either QErr ()))
-&gt; ExceptT QErr m () -&gt; m (Either QErr ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; ExceptT QErr m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-274"></span><span>  </span><span id="local-6989586621689345706"><span class="annot"><span class="annottext">recordError' :: SourceConfig 'BigQuery
-&gt; Event 'BigQuery
-&gt; Maybe (Invocation 'EventType)
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621689345706"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError'</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Invocation 'EventType)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ProcessEventError
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT QErr m () -&gt; m (Either QErr ())
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT QErr m () -&gt; m (Either QErr ()))
-&gt; ExceptT QErr m () -&gt; m (Either QErr ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; ExceptT QErr m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-275"></span><span>  </span><span id="local-6989586621689345705"><span class="annot"><span class="annottext">dropTriggerAndArchiveEvents :: SourceConfig 'BigQuery
-&gt; TriggerName -&gt; TableName 'BigQuery -&gt; m ()
</span><a href="#local-6989586621689345705"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropTriggerAndArchiveEvents</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-276"></span><span>  </span><span id="local-6989586621689345704"><span class="annot"><span class="annottext">dropDanglingSQLTrigger :: SourceConfig 'BigQuery
-&gt; TriggerName -&gt; TableName 'BigQuery -&gt; HashSet Ops -&gt; m ()
</span><a href="#local-6989586621689345704"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropDanglingSQLTrigger</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HashSet Ops
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-277"></span><span>  </span><span id="local-6989586621689345703"><span class="annot"><span class="annottext">redeliverEvent :: SourceConfig 'BigQuery -&gt; EventId -&gt; m ()
</span><a href="#local-6989586621689345703"><span class="hs-identifier hs-var hs-var hs-var hs-var">redeliverEvent</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">EventId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-278"></span><span>  </span><span id="local-6989586621689345702"><span class="annot"><span class="annottext">unlockEventsInSource :: SourceConfig 'BigQuery -&gt; NESet EventId -&gt; m (Either QErr Int)
</span><a href="#local-6989586621689345702"><span class="hs-identifier hs-var hs-var hs-var hs-var">unlockEventsInSource</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NESet EventId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT QErr m Int -&gt; m (Either QErr Int)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT QErr m Int -&gt; m (Either QErr Int))
-&gt; ExceptT QErr m Int -&gt; m (Either QErr Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; ExceptT QErr m Int
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-279"></span><span>  </span><span id="local-6989586621689345701"><span class="annot"><span class="annottext">createTableEventTrigger :: ServerConfigCtx
-&gt; SourceConfig 'BigQuery
-&gt; TableName 'BigQuery
-&gt; [ColumnInfo 'BigQuery]
-&gt; TriggerName
-&gt; TriggerOpsDef 'BigQuery
-&gt; Maybe (PrimaryKey 'BigQuery (ColumnInfo 'BigQuery))
-&gt; m (Either QErr ())
</span><a href="#local-6989586621689345701"><span class="hs-identifier hs-var hs-var hs-var hs-var">createTableEventTrigger</span></a></span></span><span> </span><span class="annot"><span class="annottext">ServerConfigCtx
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[ColumnInfo 'BigQuery]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerOpsDef 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (PrimaryKey 'BigQuery (ColumnInfo 'BigQuery))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT QErr m () -&gt; m (Either QErr ())
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT QErr m () -&gt; m (Either QErr ()))
-&gt; ExceptT QErr m () -&gt; m (Either QErr ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; ExceptT QErr m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-280"></span><span>  </span><span id="local-6989586621689345700"><span class="annot"><span class="annottext">createMissingSQLTriggers :: SourceConfig 'BigQuery
-&gt; TableName 'BigQuery
-&gt; ([ColumnInfo 'BigQuery],
    Maybe (PrimaryKey 'BigQuery (ColumnInfo 'BigQuery)))
-&gt; TriggerName
-&gt; TriggerOpsDef 'BigQuery
-&gt; m ()
</span><a href="#local-6989586621689345700"><span class="hs-identifier hs-var hs-var hs-var hs-var">createMissingSQLTriggers</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">([ColumnInfo 'BigQuery],
 Maybe (PrimaryKey 'BigQuery (ColumnInfo 'BigQuery)))
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerOpsDef 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m ()) -&gt; Text -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#BackendEventTrigger"><span class="hs-identifier hs-type">BackendEventTrigger</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#MySQL"><span class="hs-identifier hs-type">MySQL</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-283"></span><span>  </span><span id="local-6989586621689345685"><span class="annot"><span class="annottext">insertManualEvent :: SourceConfig 'MySQL
-&gt; TableName 'MySQL
-&gt; TriggerName
-&gt; Value
-&gt; UserInfo
-&gt; TraceContext
-&gt; m EventId
</span><a href="#local-6989586621689345685"><span class="hs-identifier hs-var hs-var hs-var hs-var">insertManualEvent</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TraceContext
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m EventId
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m EventId) -&gt; Text -&gt; m EventId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-284"></span><span>  </span><span id="local-6989586621689345684"><span class="annot"><span class="annottext">fetchUndeliveredEvents :: SourceConfig 'MySQL
-&gt; SourceName
-&gt; [TriggerName]
-&gt; MaintenanceMode ()
-&gt; FetchBatchSize
-&gt; m [Event 'MySQL]
</span><a href="#local-6989586621689345684"><span class="hs-identifier hs-var hs-var hs-var hs-var">fetchUndeliveredEvents</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[TriggerName]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode ()
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FetchBatchSize
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m [Event 'MySQL]
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-285"></span><span>  </span><span id="local-6989586621689345683"><span class="annot"><span class="annottext">setRetry :: SourceConfig 'MySQL
-&gt; Event 'MySQL
-&gt; UTCTime
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m ()
</span><a href="#local-6989586621689345683"><span class="hs-identifier hs-var hs-var hs-var hs-var">setRetry</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-286"></span><span>  </span><span id="local-6989586621689345682"><span class="annot"><span class="annottext">recordSuccess :: SourceConfig 'MySQL
-&gt; Event 'MySQL
-&gt; Invocation 'EventType
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621689345682"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordSuccess</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Invocation 'EventType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT QErr m () -&gt; m (Either QErr ())
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT QErr m () -&gt; m (Either QErr ()))
-&gt; ExceptT QErr m () -&gt; m (Either QErr ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; ExceptT QErr m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-287"></span><span>  </span><span id="local-6989586621689345681"><span class="annot"><span class="annottext">getMaintenanceModeVersion :: SourceConfig 'MySQL -&gt; m MaintenanceModeVersion
</span><a href="#local-6989586621689345681"><span class="hs-identifier hs-var hs-var hs-var hs-var">getMaintenanceModeVersion</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m MaintenanceModeVersion
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-288"></span><span>  </span><span id="local-6989586621689345680"><span class="annot"><span class="annottext">recordError :: SourceConfig 'MySQL
-&gt; Event 'MySQL
-&gt; Invocation 'EventType
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621689345680"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Invocation 'EventType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ProcessEventError
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT QErr m () -&gt; m (Either QErr ())
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT QErr m () -&gt; m (Either QErr ()))
-&gt; ExceptT QErr m () -&gt; m (Either QErr ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; ExceptT QErr m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-289"></span><span>  </span><span id="local-6989586621689345679"><span class="annot"><span class="annottext">recordError' :: SourceConfig 'MySQL
-&gt; Event 'MySQL
-&gt; Maybe (Invocation 'EventType)
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621689345679"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError'</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Invocation 'EventType)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ProcessEventError
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT QErr m () -&gt; m (Either QErr ())
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT QErr m () -&gt; m (Either QErr ()))
-&gt; ExceptT QErr m () -&gt; m (Either QErr ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; ExceptT QErr m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-290"></span><span>  </span><span id="local-6989586621689345678"><span class="annot"><span class="annottext">dropTriggerAndArchiveEvents :: SourceConfig 'MySQL -&gt; TriggerName -&gt; TableName 'MySQL -&gt; m ()
</span><a href="#local-6989586621689345678"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropTriggerAndArchiveEvents</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-291"></span><span>  </span><span id="local-6989586621689345677"><span class="annot"><span class="annottext">dropDanglingSQLTrigger :: SourceConfig 'MySQL
-&gt; TriggerName -&gt; TableName 'MySQL -&gt; HashSet Ops -&gt; m ()
</span><a href="#local-6989586621689345677"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropDanglingSQLTrigger</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HashSet Ops
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-292"></span><span>  </span><span id="local-6989586621689345676"><span class="annot"><span class="annottext">redeliverEvent :: SourceConfig 'MySQL -&gt; EventId -&gt; m ()
</span><a href="#local-6989586621689345676"><span class="hs-identifier hs-var hs-var hs-var hs-var">redeliverEvent</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">EventId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-293"></span><span>  </span><span id="local-6989586621689345675"><span class="annot"><span class="annottext">unlockEventsInSource :: SourceConfig 'MySQL -&gt; NESet EventId -&gt; m (Either QErr Int)
</span><a href="#local-6989586621689345675"><span class="hs-identifier hs-var hs-var hs-var hs-var">unlockEventsInSource</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NESet EventId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT QErr m Int -&gt; m (Either QErr Int)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT QErr m Int -&gt; m (Either QErr Int))
-&gt; ExceptT QErr m Int -&gt; m (Either QErr Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; ExceptT QErr m Int
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-294"></span><span>  </span><span id="local-6989586621689345674"><span class="annot"><span class="annottext">createTableEventTrigger :: ServerConfigCtx
-&gt; SourceConfig 'MySQL
-&gt; TableName 'MySQL
-&gt; [ColumnInfo 'MySQL]
-&gt; TriggerName
-&gt; TriggerOpsDef 'MySQL
-&gt; Maybe (PrimaryKey 'MySQL (ColumnInfo 'MySQL))
-&gt; m (Either QErr ())
</span><a href="#local-6989586621689345674"><span class="hs-identifier hs-var hs-var hs-var hs-var">createTableEventTrigger</span></a></span></span><span> </span><span class="annot"><span class="annottext">ServerConfigCtx
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[ColumnInfo 'MySQL]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerOpsDef 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (PrimaryKey 'MySQL (ColumnInfo 'MySQL))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT QErr m () -&gt; m (Either QErr ())
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT QErr m () -&gt; m (Either QErr ()))
-&gt; ExceptT QErr m () -&gt; m (Either QErr ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; ExceptT QErr m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-295"></span><span>  </span><span id="local-6989586621689345673"><span class="annot"><span class="annottext">createMissingSQLTriggers :: SourceConfig 'MySQL
-&gt; TableName 'MySQL
-&gt; ([ColumnInfo 'MySQL],
    Maybe (PrimaryKey 'MySQL (ColumnInfo 'MySQL)))
-&gt; TriggerName
-&gt; TriggerOpsDef 'MySQL
-&gt; m ()
</span><a href="#local-6989586621689345673"><span class="hs-identifier hs-var hs-var hs-var hs-var">createMissingSQLTriggers</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">([ColumnInfo 'MySQL],
 Maybe (PrimaryKey 'MySQL (ColumnInfo 'MySQL)))
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerOpsDef 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m ()) -&gt; Text -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-comment">-- TODO(jkachmar): See if there isn't a way to define the function that</span><span>
</span><span id="line-300"></span><span class="hs-comment">-- implement these methods in the 'Hasura.Experimental.Adapters' module</span><span>
</span><span id="line-301"></span><span class="hs-comment">-- hierarchy just to keep everything as tidy as possible for that section of</span><span>
</span><span id="line-302"></span><span class="hs-comment">-- code.</span><span>
</span><span id="line-303"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#BackendEventTrigger"><span class="hs-identifier hs-type">BackendEventTrigger</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#DataConnector"><span class="hs-identifier hs-type">DataConnector</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-304"></span><span>  </span><span id="local-6989586621689345658"><span class="annot"><span class="annottext">insertManualEvent :: SourceConfig 'DataConnector
-&gt; TableName 'DataConnector
-&gt; TriggerName
-&gt; Value
-&gt; UserInfo
-&gt; TraceContext
-&gt; m EventId
</span><a href="#local-6989586621689345658"><span class="hs-identifier hs-var hs-var hs-var hs-var">insertManualEvent</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TraceContext
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m EventId
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for the Data Connector backend.&quot;</span></span><span>
</span><span id="line-306"></span><span>  </span><span id="local-6989586621689345657"><span class="annot"><span class="annottext">fetchUndeliveredEvents :: SourceConfig 'DataConnector
-&gt; SourceName
-&gt; [TriggerName]
-&gt; MaintenanceMode ()
-&gt; FetchBatchSize
-&gt; m [Event 'DataConnector]
</span><a href="#local-6989586621689345657"><span class="hs-identifier hs-var hs-var hs-var hs-var">fetchUndeliveredEvents</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[TriggerName]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode ()
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FetchBatchSize
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-307"></span><span>    </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m [Event 'DataConnector]
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for the Data Connector backend.&quot;</span></span><span>
</span><span id="line-308"></span><span>  </span><span id="local-6989586621689345656"><span class="annot"><span class="annottext">setRetry :: SourceConfig 'DataConnector
-&gt; Event 'DataConnector
-&gt; UTCTime
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m ()
</span><a href="#local-6989586621689345656"><span class="hs-identifier hs-var hs-var hs-var hs-var">setRetry</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-309"></span><span>    </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for the Data Connector backend.&quot;</span></span><span>
</span><span id="line-310"></span><span>  </span><span id="local-6989586621689345655"><span class="annot"><span class="annottext">recordSuccess :: SourceConfig 'DataConnector
-&gt; Event 'DataConnector
-&gt; Invocation 'EventType
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621689345655"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordSuccess</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Invocation 'EventType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><span class="annottext">ExceptT QErr m () -&gt; m (Either QErr ())
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT QErr m () -&gt; m (Either QErr ()))
-&gt; ExceptT QErr m () -&gt; m (Either QErr ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; ExceptT QErr m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for the Data Connector backend.&quot;</span></span><span>
</span><span id="line-312"></span><span>  </span><span id="local-6989586621689345654"><span class="annot"><span class="annottext">getMaintenanceModeVersion :: SourceConfig 'DataConnector -&gt; m MaintenanceModeVersion
</span><a href="#local-6989586621689345654"><span class="hs-identifier hs-var hs-var hs-var hs-var">getMaintenanceModeVersion</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-313"></span><span>    </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m MaintenanceModeVersion
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for the Data Connector backend.&quot;</span></span><span>
</span><span id="line-314"></span><span>  </span><span id="local-6989586621689345653"><span class="annot"><span class="annottext">recordError :: SourceConfig 'DataConnector
-&gt; Event 'DataConnector
-&gt; Invocation 'EventType
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621689345653"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Invocation 'EventType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ProcessEventError
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-315"></span><span>    </span><span class="annot"><span class="annottext">ExceptT QErr m () -&gt; m (Either QErr ())
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT QErr m () -&gt; m (Either QErr ()))
-&gt; ExceptT QErr m () -&gt; m (Either QErr ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; ExceptT QErr m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for the Data Connector backend.&quot;</span></span><span>
</span><span id="line-316"></span><span>  </span><span id="local-6989586621689345652"><span class="annot"><span class="annottext">recordError' :: SourceConfig 'DataConnector
-&gt; Event 'DataConnector
-&gt; Maybe (Invocation 'EventType)
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621689345652"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError'</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Invocation 'EventType)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ProcessEventError
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-317"></span><span>    </span><span class="annot"><span class="annottext">ExceptT QErr m () -&gt; m (Either QErr ())
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT QErr m () -&gt; m (Either QErr ()))
-&gt; ExceptT QErr m () -&gt; m (Either QErr ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; ExceptT QErr m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for the Data Connector backend.&quot;</span></span><span>
</span><span id="line-318"></span><span>  </span><span id="local-6989586621689345651"><span class="annot"><span class="annottext">dropTriggerAndArchiveEvents :: SourceConfig 'DataConnector
-&gt; TriggerName -&gt; TableName 'DataConnector -&gt; m ()
</span><a href="#local-6989586621689345651"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropTriggerAndArchiveEvents</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-319"></span><span>    </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for the Data Connector backend.&quot;</span></span><span>
</span><span id="line-320"></span><span>  </span><span id="local-6989586621689345650"><span class="annot"><span class="annottext">dropDanglingSQLTrigger :: SourceConfig 'DataConnector
-&gt; TriggerName -&gt; TableName 'DataConnector -&gt; HashSet Ops -&gt; m ()
</span><a href="#local-6989586621689345650"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropDanglingSQLTrigger</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HashSet Ops
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-321"></span><span>    </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for the Data Connector backend&quot;</span></span><span>
</span><span id="line-322"></span><span>  </span><span id="local-6989586621689345649"><span class="annot"><span class="annottext">redeliverEvent :: SourceConfig 'DataConnector -&gt; EventId -&gt; m ()
</span><a href="#local-6989586621689345649"><span class="hs-identifier hs-var hs-var hs-var hs-var">redeliverEvent</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">EventId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-323"></span><span>    </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for the Data Connector backend.&quot;</span></span><span>
</span><span id="line-324"></span><span>  </span><span id="local-6989586621689345648"><span class="annot"><span class="annottext">unlockEventsInSource :: SourceConfig 'DataConnector -&gt; NESet EventId -&gt; m (Either QErr Int)
</span><a href="#local-6989586621689345648"><span class="hs-identifier hs-var hs-var hs-var hs-var">unlockEventsInSource</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NESet EventId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-325"></span><span>    </span><span class="annot"><span class="annottext">ExceptT QErr m Int -&gt; m (Either QErr Int)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT QErr m Int -&gt; m (Either QErr Int))
-&gt; ExceptT QErr m Int -&gt; m (Either QErr Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; ExceptT QErr m Int
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for the Data Connector backend.&quot;</span></span><span>
</span><span id="line-326"></span><span>  </span><span id="local-6989586621689345647"><span class="annot"><span class="annottext">createTableEventTrigger :: ServerConfigCtx
-&gt; SourceConfig 'DataConnector
-&gt; TableName 'DataConnector
-&gt; [ColumnInfo 'DataConnector]
-&gt; TriggerName
-&gt; TriggerOpsDef 'DataConnector
-&gt; Maybe (PrimaryKey 'DataConnector (ColumnInfo 'DataConnector))
-&gt; m (Either QErr ())
</span><a href="#local-6989586621689345647"><span class="hs-identifier hs-var hs-var hs-var hs-var">createTableEventTrigger</span></a></span></span><span> </span><span class="annot"><span class="annottext">ServerConfigCtx
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[ColumnInfo 'DataConnector]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerOpsDef 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (PrimaryKey 'DataConnector (ColumnInfo 'DataConnector))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-327"></span><span>    </span><span class="annot"><span class="annottext">ExceptT QErr m () -&gt; m (Either QErr ())
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT QErr m () -&gt; m (Either QErr ()))
-&gt; ExceptT QErr m () -&gt; m (Either QErr ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; ExceptT QErr m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for the Data Connector backend.&quot;</span></span><span>
</span><span id="line-328"></span><span>  </span><span id="local-6989586621689345646"><span class="annot"><span class="annottext">createMissingSQLTriggers :: SourceConfig 'DataConnector
-&gt; TableName 'DataConnector
-&gt; ([ColumnInfo 'DataConnector],
    Maybe (PrimaryKey 'DataConnector (ColumnInfo 'DataConnector)))
-&gt; TriggerName
-&gt; TriggerOpsDef 'DataConnector
-&gt; m ()
</span><a href="#local-6989586621689345646"><span class="hs-identifier hs-var hs-var hs-var hs-var">createMissingSQLTriggers</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">([ColumnInfo 'DataConnector],
 Maybe (PrimaryKey 'DataConnector (ColumnInfo 'DataConnector)))
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerOpsDef 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m ()) -&gt; Text -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Data Connector backend.&quot;</span></span><span>
</span><span id="line-329"></span></pre></body></html>