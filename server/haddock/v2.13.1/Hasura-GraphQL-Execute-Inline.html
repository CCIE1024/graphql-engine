<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Hasura.GraphQL.Execute.Inline</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">graphql-engine-1.0.0: GraphQL API over Postgres</span><ul class="links" id="page-menu"><li><a href="src/Hasura.GraphQL.Execute.Inline.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Hasura.GraphQL.Execute.Inline</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module implements <em>fragment inlining</em>, which converts all fragment
 spreads in a GraphQL query to inline fragments. For example, given a query like</p><pre>query {
  users {
    id
    ...userFields
  }
}

fragment userFields on User {
  name
  favoriteColor
}</pre><p>the fragment inliner will convert it to this:</p><pre>query {
  users {
    id
    ... on User {
      name
      favoriteColor
    }
  }
}</pre><p>This is a straightforward and mechanical transformation, but it simplifies
 further processing, since we catch unbound fragments and recursive fragment
 definitions early in the pipeline, so parsing does not have to worry about it.
 In that sense, fragment inlining is similar to the variable resolution pass
 performed by <a href="Hasura-GraphQL-Execute-Resolve.html">Hasura.GraphQL.Execute.Resolve</a>, but for fragment definitions
 rather than variables.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:InlineEnv">InlineEnv</a> = <a href="#v:InlineEnv">InlineEnv</a> {<ul class="subs"><li><a href="#v:_ieFragmentDefinitions">_ieFragmentDefinitions</a> :: HashMap Name FragmentDefinition</li><li><a href="#v:_ieFragmentStack">_ieFragmentStack</a> :: [Name]</li></ul>}</li><li class="src short"><span class="keyword">newtype</span> <a href="#t:InlineState">InlineState</a> = <a href="#v:InlineState">InlineState</a> {<ul class="subs"><li><a href="#v:_isFragmentCache">_isFragmentCache</a> :: HashMap Name (InlineFragment NoFragments Name)</li></ul>}</li><li class="src short"><a href="#v:ieFragmentStack">ieFragmentStack</a> :: Lens' <a href="Hasura-GraphQL-Execute-Inline.html#t:InlineEnv" title="Hasura.GraphQL.Execute.Inline">InlineEnv</a> [Name]</li><li class="src short"><a href="#v:isFragmentCache">isFragmentCache</a> :: Iso' <a href="Hasura-GraphQL-Execute-Inline.html#t:InlineState" title="Hasura.GraphQL.Execute.Inline">InlineState</a> (HashMap Name (InlineFragment NoFragments Name))</li><li class="src short"><span class="keyword">type</span> <a href="#t:MonadInline">MonadInline</a> m = (<a href="file:///root/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/Control-Monad-Error-Class.html#t:MonadError" title="Control.Monad.Error.Class">MonadError</a> <a href="Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> m, <a href="file:///root/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/Control-Monad-Reader-Class.html#t:MonadReader" title="Control.Monad.Reader.Class">MonadReader</a> <a href="Hasura-GraphQL-Execute-Inline.html#t:InlineEnv" title="Hasura.GraphQL.Execute.Inline">InlineEnv</a> m, <a href="file:///root/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/Control-Monad-State-Class.html#t:MonadState" title="Control.Monad.State.Class">MonadState</a> <a href="Hasura-GraphQL-Execute-Inline.html#t:InlineState" title="Hasura.GraphQL.Execute.Inline">InlineState</a> m)</li><li class="src short"><span class="keyword">type</span> <a href="#t:InlineMT">InlineMT</a> m a = <a href="file:///root/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/Control-Monad-Error-Class.html#t:MonadError" title="Control.Monad.Error.Class">MonadError</a> <a href="Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> m =&gt; <a href="file:///root/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/Control-Monad-State-Strict.html#t:StateT" title="Control.Monad.State.Strict">StateT</a> <a href="Hasura-GraphQL-Execute-Inline.html#t:InlineState" title="Hasura.GraphQL.Execute.Inline">InlineState</a> (<a href="file:///root/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/Control-Monad-Reader.html#t:ReaderT" title="Control.Monad.Reader">ReaderT</a> <a href="Hasura-GraphQL-Execute-Inline.html#t:InlineEnv" title="Hasura.GraphQL.Execute.Inline">InlineEnv</a> m) a</li><li class="src short"><span class="keyword">type</span> <a href="#t:InlineM">InlineM</a> a = <a href="Hasura-GraphQL-Execute-Inline.html#t:InlineMT" title="Hasura.GraphQL.Execute.Inline">InlineMT</a> (<a href="file:///root/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/Control-Monad-Except.html#t:Except" title="Control.Monad.Except">Except</a> <a href="Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a>) a</li><li class="src short"><a href="#v:runInlineMT">runInlineMT</a> :: <span class="keyword">forall</span> m a. <a href="file:///root/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/Control-Monad-Error-Class.html#t:MonadError" title="Control.Monad.Error.Class">MonadError</a> <a href="Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> m =&gt; HashMap Name FragmentDefinition -&gt; <a href="Hasura-GraphQL-Execute-Inline.html#t:InlineMT" title="Hasura.GraphQL.Execute.Inline">InlineMT</a> m a -&gt; m a</li><li class="src short"><a href="#v:runInlineM">runInlineM</a> :: <span class="keyword">forall</span> a. HashMap Name FragmentDefinition -&gt; <a href="Hasura-GraphQL-Execute-Inline.html#t:InlineM" title="Hasura.GraphQL.Execute.Inline">InlineM</a> a -&gt; <a href="file:///root/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> a</li><li class="src short"><a href="#v:inlineSelectionSet">inlineSelectionSet</a> :: (<a href="file:///root/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/Control-Monad-Error-Class.html#t:MonadError" title="Control.Monad.Error.Class">MonadError</a> <a href="Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> m, <a href="file:///root/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/Data-Foldable.html#t:Foldable" title="Data.Foldable">Foldable</a> t) =&gt; t FragmentDefinition -&gt; SelectionSet FragmentSpread Name -&gt; m (SelectionSet NoFragments Name)</li><li class="src short"><a href="#v:inlineSelection">inlineSelection</a> :: <a href="Hasura-GraphQL-Execute-Inline.html#t:MonadInline" title="Hasura.GraphQL.Execute.Inline">MonadInline</a> m =&gt; Selection FragmentSpread Name -&gt; m (Selection NoFragments Name)</li><li class="src short"><a href="#v:inlineField">inlineField</a> :: <a href="Hasura-GraphQL-Execute-Inline.html#t:MonadInline" title="Hasura.GraphQL.Execute.Inline">MonadInline</a> m =&gt; Field FragmentSpread Name -&gt; m (Field NoFragments Name)</li><li class="src short"><a href="#v:inlineFragmentSpread">inlineFragmentSpread</a> :: <a href="Hasura-GraphQL-Execute-Inline.html#t:MonadInline" title="Hasura.GraphQL.Execute.Inline">MonadInline</a> m =&gt; FragmentSpread Name -&gt; m (InlineFragment NoFragments Name)</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:InlineEnv" class="def">InlineEnv</a> <a href="src/Hasura.GraphQL.Execute.Inline.html#InlineEnv" class="link">Source</a> <a href="#t:InlineEnv" class="selflink">#</a></p><div class="doc"><p>Internal bookkeeping used during inlining.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:InlineEnv" class="def">InlineEnv</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:_ieFragmentDefinitions" class="def">_ieFragmentDefinitions</a> :: HashMap Name FragmentDefinition</dfn><div class="doc"><p>All known fragment definitions.</p></div></li><li><dfn class="src"><a id="v:_ieFragmentStack" class="def">_ieFragmentStack</a> :: [Name]</dfn><div class="doc"><p>Fragments we&#8217;re currently inlining higher up in the call stack, used to
 detect fragment cycles.</p></div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:InlineState" class="def">InlineState</a> <a href="src/Hasura.GraphQL.Execute.Inline.html#InlineState" class="link">Source</a> <a href="#t:InlineState" class="selflink">#</a></p><div class="doc"><p>Internal bookkeeping used during inlining.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:InlineState" class="def">InlineState</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:_isFragmentCache" class="def">_isFragmentCache</a> :: HashMap Name (InlineFragment NoFragments Name)</dfn><div class="doc"><p>A cache of fragment definitions we&#8217;ve already inlined, so we don&#8217;t need
 to inline them again.</p></div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><a id="v:ieFragmentStack" class="def">ieFragmentStack</a> :: Lens' <a href="Hasura-GraphQL-Execute-Inline.html#t:InlineEnv" title="Hasura.GraphQL.Execute.Inline">InlineEnv</a> [Name] <a href="src/Hasura.GraphQL.Execute.Inline.html#ieFragmentStack" class="link">Source</a> <a href="#v:ieFragmentStack" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:isFragmentCache" class="def">isFragmentCache</a> :: Iso' <a href="Hasura-GraphQL-Execute-Inline.html#t:InlineState" title="Hasura.GraphQL.Execute.Inline">InlineState</a> (HashMap Name (InlineFragment NoFragments Name)) <a href="src/Hasura.GraphQL.Execute.Inline.html#isFragmentCache" class="link">Source</a> <a href="#v:isFragmentCache" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:MonadInline" class="def">MonadInline</a> m = (<a href="file:///root/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/Control-Monad-Error-Class.html#t:MonadError" title="Control.Monad.Error.Class">MonadError</a> <a href="Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> m, <a href="file:///root/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/Control-Monad-Reader-Class.html#t:MonadReader" title="Control.Monad.Reader.Class">MonadReader</a> <a href="Hasura-GraphQL-Execute-Inline.html#t:InlineEnv" title="Hasura.GraphQL.Execute.Inline">InlineEnv</a> m, <a href="file:///root/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/Control-Monad-State-Class.html#t:MonadState" title="Control.Monad.State.Class">MonadState</a> <a href="Hasura-GraphQL-Execute-Inline.html#t:InlineState" title="Hasura.GraphQL.Execute.Inline">InlineState</a> m) <a href="src/Hasura.GraphQL.Execute.Inline.html#MonadInline" class="link">Source</a> <a href="#t:MonadInline" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:InlineMT" class="def">InlineMT</a> m a = <a href="file:///root/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/Control-Monad-Error-Class.html#t:MonadError" title="Control.Monad.Error.Class">MonadError</a> <a href="Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> m =&gt; <a href="file:///root/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/Control-Monad-State-Strict.html#t:StateT" title="Control.Monad.State.Strict">StateT</a> <a href="Hasura-GraphQL-Execute-Inline.html#t:InlineState" title="Hasura.GraphQL.Execute.Inline">InlineState</a> (<a href="file:///root/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/Control-Monad-Reader.html#t:ReaderT" title="Control.Monad.Reader">ReaderT</a> <a href="Hasura-GraphQL-Execute-Inline.html#t:InlineEnv" title="Hasura.GraphQL.Execute.Inline">InlineEnv</a> m) a <a href="src/Hasura.GraphQL.Execute.Inline.html#InlineMT" class="link">Source</a> <a href="#t:InlineMT" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:InlineM" class="def">InlineM</a> a = <a href="Hasura-GraphQL-Execute-Inline.html#t:InlineMT" title="Hasura.GraphQL.Execute.Inline">InlineMT</a> (<a href="file:///root/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/Control-Monad-Except.html#t:Except" title="Control.Monad.Except">Except</a> <a href="Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a>) a <a href="src/Hasura.GraphQL.Execute.Inline.html#InlineM" class="link">Source</a> <a href="#t:InlineM" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:runInlineMT" class="def">runInlineMT</a> :: <span class="keyword">forall</span> m a. <a href="file:///root/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/Control-Monad-Error-Class.html#t:MonadError" title="Control.Monad.Error.Class">MonadError</a> <a href="Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> m =&gt; HashMap Name FragmentDefinition -&gt; <a href="Hasura-GraphQL-Execute-Inline.html#t:InlineMT" title="Hasura.GraphQL.Execute.Inline">InlineMT</a> m a -&gt; m a <a href="src/Hasura.GraphQL.Execute.Inline.html#runInlineMT" class="link">Source</a> <a href="#v:runInlineMT" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:runInlineM" class="def">runInlineM</a> :: <span class="keyword">forall</span> a. HashMap Name FragmentDefinition -&gt; <a href="Hasura-GraphQL-Execute-Inline.html#t:InlineM" title="Hasura.GraphQL.Execute.Inline">InlineM</a> a -&gt; <a href="file:///root/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> a <a href="src/Hasura.GraphQL.Execute.Inline.html#runInlineM" class="link">Source</a> <a href="#v:runInlineM" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:inlineSelectionSet" class="def">inlineSelectionSet</a> :: (<a href="file:///root/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/Control-Monad-Error-Class.html#t:MonadError" title="Control.Monad.Error.Class">MonadError</a> <a href="Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> m, <a href="file:///root/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/Data-Foldable.html#t:Foldable" title="Data.Foldable">Foldable</a> t) =&gt; t FragmentDefinition -&gt; SelectionSet FragmentSpread Name -&gt; m (SelectionSet NoFragments Name) <a href="src/Hasura.GraphQL.Execute.Inline.html#inlineSelectionSet" class="link">Source</a> <a href="#v:inlineSelectionSet" class="selflink">#</a></p><div class="doc"><p>Inlines all fragment spreads in a <code>SelectionSet</code>; see the module
 documentation for <a href="Hasura-GraphQL-Execute-Inline.html">Hasura.GraphQL.Execute.Inline</a> for details.</p></div></div><div class="top"><p class="src"><a id="v:inlineSelection" class="def">inlineSelection</a> :: <a href="Hasura-GraphQL-Execute-Inline.html#t:MonadInline" title="Hasura.GraphQL.Execute.Inline">MonadInline</a> m =&gt; Selection FragmentSpread Name -&gt; m (Selection NoFragments Name) <a href="src/Hasura.GraphQL.Execute.Inline.html#inlineSelection" class="link">Source</a> <a href="#v:inlineSelection" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:inlineField" class="def">inlineField</a> :: <a href="Hasura-GraphQL-Execute-Inline.html#t:MonadInline" title="Hasura.GraphQL.Execute.Inline">MonadInline</a> m =&gt; Field FragmentSpread Name -&gt; m (Field NoFragments Name) <a href="src/Hasura.GraphQL.Execute.Inline.html#inlineField" class="link">Source</a> <a href="#v:inlineField" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:inlineFragmentSpread" class="def">inlineFragmentSpread</a> :: <a href="Hasura-GraphQL-Execute-Inline.html#t:MonadInline" title="Hasura.GraphQL.Execute.Inline">MonadInline</a> m =&gt; FragmentSpread Name -&gt; m (InlineFragment NoFragments Name) <a href="src/Hasura.GraphQL.Execute.Inline.html#inlineFragmentSpread" class="link">Source</a> <a href="#v:inlineFragmentSpread" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.2</p></div></body></html>