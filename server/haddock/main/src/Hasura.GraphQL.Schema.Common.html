<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="local-6989586621690735503"><span id="local-6989586621690735504"></span></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hasura.GraphQL.Schema.Common</span><span>
</span><span id="line-4"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaContext"><span class="hs-identifier">SchemaContext</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-5"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaKind"><span class="hs-identifier">SchemaKind</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#RemoteRelationshipParserBuilder"><span class="hs-identifier">RemoteRelationshipParserBuilder</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#NodeInterfaceParserBuilder"><span class="hs-identifier">NodeInterfaceParserBuilder</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#MonadBuildSchemaBase"><span class="hs-identifier">MonadBuildSchemaBase</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#retrieve"><span class="hs-identifier">retrieve</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaT"><span class="hs-identifier">SchemaT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#MonadBuildSourceSchema"><span class="hs-identifier">MonadBuildSourceSchema</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#MonadBuildRemoteSchema"><span class="hs-identifier">MonadBuildRemoteSchema</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#MonadBuildActionSchema"><span class="hs-identifier">MonadBuildActionSchema</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#runSourceSchema"><span class="hs-identifier">runSourceSchema</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#runRemoteSchema"><span class="hs-identifier">runRemoteSchema</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#runActionSchema"><span class="hs-identifier">runActionSchema</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#ignoreRemoteRelationship"><span class="hs-identifier">ignoreRemoteRelationship</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#isHasuraSchema"><span class="hs-identifier">isHasuraSchema</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#AggSelectExp"><span class="hs-identifier">AggSelectExp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#AnnotatedField"><span class="hs-identifier">AnnotatedField</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#AnnotatedFields"><span class="hs-identifier">AnnotatedFields</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#ConnectionFields"><span class="hs-identifier">ConnectionFields</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#ConnectionSelectExp"><span class="hs-identifier">ConnectionSelectExp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#AnnotatedActionField"><span class="hs-identifier">AnnotatedActionField</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#AnnotatedActionFields"><span class="hs-identifier">AnnotatedActionFields</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#EdgeFields"><span class="hs-identifier">EdgeFields</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#Scenario"><span class="hs-identifier">Scenario</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SelectArgs"><span class="hs-identifier">SelectArgs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SelectStreamArgs"><span class="hs-identifier">SelectStreamArgs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SelectExp"><span class="hs-identifier">SelectExp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#StreamSelectExp"><span class="hs-identifier">StreamSelectExp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#TablePerms"><span class="hs-identifier">TablePerms</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#getTableRoles"><span class="hs-identifier">getTableRoles</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#askTableInfo"><span class="hs-identifier">askTableInfo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#comparisonAggOperators"><span class="hs-identifier">comparisonAggOperators</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#mapField"><span class="hs-identifier">mapField</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#mkDescriptionWith"><span class="hs-identifier">mkDescriptionWith</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#numericAggOperators"><span class="hs-identifier">numericAggOperators</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#optionalFieldParser"><span class="hs-identifier">optionalFieldParser</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#parsedSelectionsToFields"><span class="hs-identifier">parsedSelectionsToFields</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#partialSQLExpToUnpreparedValue"><span class="hs-identifier">partialSQLExpToUnpreparedValue</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#requiredFieldParser"><span class="hs-identifier">requiredFieldParser</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#takeValidFunctions"><span class="hs-identifier">takeValidFunctions</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#takeValidTables"><span class="hs-identifier">takeValidTables</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#textToName"><span class="hs-identifier">textToName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#textToGQLIdentifier"><span class="hs-identifier">textToGQLIdentifier</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#RemoteSchemaParser"><span class="hs-identifier">RemoteSchemaParser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#mkEnumTypeName"><span class="hs-identifier">mkEnumTypeName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#addEnumSuffix"><span class="hs-identifier">addEnumSuffix</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#peelWithOrigin"><span class="hs-identifier">peelWithOrigin</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#getIntrospectionResult"><span class="hs-identifier">getIntrospectionResult</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">where</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">isRight</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Has</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict.InsOrd</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">OMap</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">uncons</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Text.Casing.html"><span class="hs-identifier">Data.Text.Casing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.Casing.html#GQLNameIdentifier"><span class="hs-identifier">GQLNameIdentifier</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Text.Casing.html"><span class="hs-identifier">Data.Text.Casing</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Text.Extended.html"><span class="hs-identifier">Data.Text.Extended</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html"><span class="hs-identifier">Hasura.Backends.Postgres.SQL.Types</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Postgres</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Base.Error.html"><span class="hs-identifier">Hasura.Base.Error</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Namespace.html"><span class="hs-identifier">Hasura.GraphQL.Namespace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Namespace.html#NamespacedField"><span class="hs-identifier">NamespacedField</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-schema-parsers-1.0.0/opt/doc/html/hasura-schema-parsers/src"><span class="hs-identifier">Hasura.GraphQL.Parser.Internal.TypeChecking</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Node.html"><span class="hs-identifier">Hasura.GraphQL.Schema.Node</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Options.html"><span class="hs-identifier">Hasura.GraphQL.Schema.Options</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Schema.Options.html#SchemaOptions"><span class="hs-identifier">SchemaOptions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Options.html"><span class="hs-identifier">Hasura.GraphQL.Schema.Options</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Options</span></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Parser.html"><span class="hs-identifier">Hasura.GraphQL.Schema.Parser</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Typename.html"><span class="hs-identifier">Hasura.GraphQL.Schema.Typename</span></a></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Name.html"><span class="hs-identifier">Hasura.Name</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Name</span></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier">Hasura.Prelude</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.html"><span class="hs-identifier">Hasura.RQL.IR</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IR</span></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.BoolExp.html"><span class="hs-identifier">Hasura.RQL.IR.BoolExp</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html"><span class="hs-identifier">Hasura.RQL.Types.Backend</span></a></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html"><span class="hs-identifier">Hasura.RQL.Types.Common</span></a></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Function.html"><span class="hs-identifier">Hasura.RQL.Types.Function</span></a></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Remote.html"><span class="hs-identifier">Hasura.RQL.Types.Relationships.Remote</span></a></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html"><span class="hs-identifier">Hasura.RQL.Types.SchemaCache</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#askTableInfo"><span class="hs-identifier">askTableInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Source.html"><span class="hs-identifier">Hasura.RQL.Types.Source</span></a></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SourceCustomization.html"><span class="hs-identifier">Hasura.RQL.Types.SourceCustomization</span></a></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RemoteSchema.SchemaCache.Types.html"><span class="hs-identifier">Hasura.RemoteSchema.SchemaCache.Types</span></a></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.SQL.AnyBackend.html"><span class="hs-identifier">Hasura.SQL.AnyBackend</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">AB</span></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Session.html"><span class="hs-identifier">Hasura.Session</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Session.html#RoleName"><span class="hs-identifier">RoleName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Session.html#adminRoleName"><span class="hs-identifier">adminRoleName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src"><span class="hs-identifier">Language.GraphQL.Draft.Syntax</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">G</span></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | Aggregation of contextual information required to build the schema.</span><span>
</span><span id="line-92"></span><span class="hs-keyword">data</span><span> </span><span id="SchemaContext"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaContext"><span class="hs-identifier hs-var">SchemaContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SchemaContext"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaContext"><span class="hs-identifier hs-var">SchemaContext</span></a></span></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | the kind of schema being built</span><span>
</span><span id="line-94"></span><span>    </span><span id="scSchemaKind"><span class="annot"><span class="annottext">SchemaContext -&gt; SchemaKind
</span><a href="Hasura.GraphQL.Schema.Common.html#scSchemaKind"><span class="hs-identifier hs-var hs-var">scSchemaKind</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaKind"><span class="hs-identifier hs-type">SchemaKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-comment">-- | how to process remote relationships</span><span>
</span><span id="line-96"></span><span>    </span><span id="scRemoteRelationshipParserBuilder"><span class="annot"><span class="annottext">SchemaContext -&gt; RemoteRelationshipParserBuilder
</span><a href="Hasura.GraphQL.Schema.Common.html#scRemoteRelationshipParserBuilder"><span class="hs-identifier hs-var hs-var">scRemoteRelationshipParserBuilder</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#RemoteRelationshipParserBuilder"><span class="hs-identifier hs-type">RemoteRelationshipParserBuilder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-comment">-- | the role for which the schema is being built</span><span>
</span><span id="line-98"></span><span>    </span><span id="scRole"><span class="annot"><span class="annottext">SchemaContext -&gt; RoleName
</span><a href="Hasura.GraphQL.Schema.Common.html#scRole"><span class="hs-identifier hs-var hs-var">scRole</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Session.html#RoleName"><span class="hs-identifier hs-type">RoleName</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-comment">-- | The kind of schema we're building, and its associated options.</span><span>
</span><span id="line-102"></span><span class="hs-keyword">data</span><span> </span><span id="SchemaKind"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaKind"><span class="hs-identifier hs-var">SchemaKind</span></a></span></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="HasuraSchema"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#HasuraSchema"><span class="hs-identifier hs-var">HasuraSchema</span></a></span></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RelaySchema"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#RelaySchema"><span class="hs-identifier hs-var">RelaySchema</span></a></span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#NodeInterfaceParserBuilder"><span class="hs-identifier hs-type">NodeInterfaceParserBuilder</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#isHasuraSchema"><span class="hs-identifier hs-type">isHasuraSchema</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaKind"><span class="hs-identifier hs-type">SchemaKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-107"></span><span id="isHasuraSchema"><span class="annot"><span class="annottext">isHasuraSchema :: SchemaKind -&gt; Bool
</span><a href="Hasura.GraphQL.Schema.Common.html#isHasuraSchema"><span class="hs-identifier hs-var hs-var">isHasuraSchema</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><span class="annottext">SchemaKind
</span><a href="Hasura.GraphQL.Schema.Common.html#HasuraSchema"><span class="hs-identifier hs-var">HasuraSchema</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#RelaySchema"><span class="hs-identifier hs-type">RelaySchema</span></a></span><span> </span><span class="annot"><span class="annottext">NodeInterfaceParserBuilder
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-comment">-- | The set of common constraints required to build the schema.</span><span>
</span><span id="line-112"></span><span class="hs-keyword">type</span><span> </span><span id="MonadBuildSchemaBase"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#MonadBuildSchemaBase"><span class="hs-identifier hs-var">MonadBuildSchemaBase</span></a></span></span><span> </span><span id="local-6989586621690735406"><span class="annot"><a href="#local-6989586621690735406"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621690735405"><span class="annot"><a href="#local-6989586621690735405"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735406"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><a href="Control.Monad.Memoize.html#MonadMemoize"><span class="hs-identifier hs-type">P.MonadMemoize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735406"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-schema-parsers-1.0.0/opt/doc/html/hasura-schema-parsers/src"><span class="hs-identifier hs-type">P.MonadParse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735405"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-comment">-- | How a remote relationship field should be processed when building a</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- schema. Injecting this function from the top level avoids having to know how</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- to do top-level dispatch from deep within the schema code.</span><span>
</span><span id="line-121"></span><span class="hs-comment">--</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- Note: the inner function type uses an existential qualifier: it is expected</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- that the given function will work for _any_ monad @m@ that has the relevant</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- constraints. This prevents us from passing a function that is specfic to the</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- monad in which the schema construction will run, but avoids having to</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- propagate type annotations to each call site.</span><span>
</span><span id="line-127"></span><span class="hs-keyword">newtype</span><span> </span><span id="RemoteRelationshipParserBuilder"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#RemoteRelationshipParserBuilder"><span class="hs-identifier hs-var">RemoteRelationshipParserBuilder</span></a></span></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="RemoteRelationshipParserBuilder"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#RemoteRelationshipParserBuilder"><span class="hs-identifier hs-var">RemoteRelationshipParserBuilder</span></a></span></span><span>
</span><span id="line-129"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621690735903"><span class="annot"><a href="#local-6989586621690735903"><span class="hs-identifier hs-type">lhsJoinField</span></a></span></span><span> </span><span id="local-6989586621690735901"><span class="annot"><a href="#local-6989586621690735901"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621690735905"><span class="annot"><a href="#local-6989586621690735905"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621690735906"><span class="annot"><a href="#local-6989586621690735906"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-130"></span><span>        </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#MonadBuildSchemaBase"><span class="hs-identifier hs-type">MonadBuildSchemaBase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735906"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735905"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-131"></span><span>        </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Remote.html#RemoteFieldInfo"><span class="hs-identifier hs-type">RemoteFieldInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735903"><span class="hs-identifier hs-type">lhsJoinField</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-132"></span><span>        </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaT"><span class="hs-identifier hs-type">SchemaT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735901"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735906"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.GraphQL.Schema.Parser.html#FieldParser"><span class="hs-identifier hs-type">P.FieldParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735905"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">IR.RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-comment">-- | A 'RemoteRelationshipParserBuilder' that ignores the field altogether, that can</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- be used in tests or to build a source or remote schema in isolation.</span><span>
</span><span id="line-137"></span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#ignoreRemoteRelationship"><span class="hs-identifier hs-type">ignoreRemoteRelationship</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#RemoteRelationshipParserBuilder"><span class="hs-identifier hs-type">RemoteRelationshipParserBuilder</span></a></span><span>
</span><span id="line-138"></span><span id="ignoreRemoteRelationship"><span class="annot"><span class="annottext">ignoreRemoteRelationship :: RemoteRelationshipParserBuilder
</span><a href="Hasura.GraphQL.Schema.Common.html#ignoreRemoteRelationship"><span class="hs-identifier hs-var hs-var">ignoreRemoteRelationship</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall lhsJoinField r (n :: * -&gt; *) (m :: * -&gt; *).
 MonadBuildSchemaBase m n =&gt;
 RemoteFieldInfo lhsJoinField
 -&gt; SchemaT
      r
      m
      (Maybe [FieldParser n (RemoteRelationshipField UnpreparedValue)]))
-&gt; RemoteRelationshipParserBuilder
</span><a href="Hasura.GraphQL.Schema.Common.html#RemoteRelationshipParserBuilder"><span class="hs-identifier hs-var">RemoteRelationshipParserBuilder</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">-- | How to build the 'Relay' node.</span><span>
</span><span id="line-141"></span><span class="hs-comment">--</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- Similarly to what we do for remote relationships, we pass in the context the</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- builder function required to build the 'Node' interface, in order to avoid</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- the cross-sources cycles it creates otherwise.</span><span>
</span><span id="line-145"></span><span class="hs-keyword">newtype</span><span> </span><span id="NodeInterfaceParserBuilder"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#NodeInterfaceParserBuilder"><span class="hs-identifier hs-var">NodeInterfaceParserBuilder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NodeInterfaceParserBuilder"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#NodeInterfaceParserBuilder"><span class="hs-identifier hs-var">NodeInterfaceParserBuilder</span></a></span></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="runNodeBuilder"><span class="annot"><span class="annottext">NodeInterfaceParserBuilder
-&gt; forall (m :: * -&gt; *) (n :: * -&gt; *).
   MonadBuildSchemaBase m n =&gt;
   SchemaContext -&gt; SchemaOptions -&gt; m (Parser 'Output n NodeMap)
</span><a href="Hasura.GraphQL.Schema.Common.html#runNodeBuilder"><span class="hs-identifier hs-var hs-var">runNodeBuilder</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-147"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621690735875"><span class="annot"><a href="#local-6989586621690735875"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621690735874"><span class="annot"><a href="#local-6989586621690735874"><span class="hs-identifier hs-type">n</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-148"></span><span>        </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#MonadBuildSchemaBase"><span class="hs-identifier hs-type">MonadBuildSchemaBase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735875"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735874"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-149"></span><span>        </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaContext"><span class="hs-identifier hs-type">SchemaContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-150"></span><span>        </span><span class="annot"><a href="Hasura.GraphQL.Schema.Options.html#SchemaOptions"><span class="hs-identifier hs-type">SchemaOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-151"></span><span>        </span><span class="annot"><a href="#local-6989586621690735875"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Schema.Parser.html#Parser"><span class="hs-identifier hs-type">P.Parser</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-schema-parsers-1.0.0/opt/doc/html/hasura-schema-parsers/src"><span class="hs-identifier hs-type">P.Output</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735874"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Node.html#NodeMap"><span class="hs-identifier hs-type">NodeMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-comment">-- TODO: move this to Prelude?</span><span>
</span><span id="line-156"></span><span id="local-6989586621690735862"><span id="local-6989586621690735864"><span id="local-6989586621690735866"><span id="local-6989586621690735867"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#retrieve"><span class="hs-identifier hs-type">retrieve</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735867"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735866"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Has</span></span><span> </span><span class="annot"><a href="#local-6989586621690735864"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735867"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621690735864"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690735862"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-159"></span><span>  </span><span class="annot"><a href="#local-6989586621690735866"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735862"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span><span>
</span><span id="line-160"></span><span id="retrieve"><span class="annot"><span class="annottext">retrieve :: forall r (m :: * -&gt; *) a b.
(MonadReader r m, Has a r) =&gt;
(a -&gt; b) -&gt; m b
</span><a href="Hasura.GraphQL.Schema.Common.html#retrieve"><span class="hs-identifier hs-var hs-var">retrieve</span></a></span></span><span> </span><span id="local-6989586621690735385"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621690735385"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621690735385"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a t. Has a t =&gt; t -&gt; a
</span><span class="hs-identifier hs-var">getter</span></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">{- Note [SchemaT and stacking]

The schema is explicitly built in `SchemaT`, rather than in an arbitrary monad
`m` that happens to have the desired properties (`MonadReader`, `MonadMemoize`,
`MonadError`, and so on). The main reason why we do this is that we want to
avoid a specific performance issue that arises out of two specific constraints:

  - we want to build each part of the schema (such as sources and remote
    schemas) with its own dedicated minimal reader context (i.e. not using a
    shared reader context that is the union of all the information required);
  - we want to be able to process remote-relationships, which means &quot;altering&quot;
    the reader context when jumping from one &quot;part&quot; of the schema to another.

What that means, in practice, is that we have to call `runReaderT` (or an
equivalent) every time we build a part of the schema (at the root level or as
part of a remote relationship) so that the part we build has access to its
context. When processing a remote relationship, the calling code is *already* in
a monad stack that contains a `ReaderT`, since we were processing a given part
of the schema. If we directly call `runReaderT` to process the RHS of the remote
relationship, we implicitly make it so that the monad stack of the LHS is the
base underneath the `ReaderT` of the RHS; in other terms, we stack another
reader on top of the existing monad stack.

As the schema is built in a &quot;depth-first&quot; way, in a complicated schema with a
lot of remote relationships we would end up with several readers stacked upon
one another. A manually run benchmark showed that this could significantly
impact performance in complicated schemas. We do now have a benchmark set to
replicate this specific case (see the &quot;deep_schema&quot; benchmark set for more
information).

To prevent this stacking, we need to be able to &quot;bring back&quot; the result of the
`runReaderT` back into the calling monad, rather than defaulting to having the
calling monad be the base of the reader. The simplest way of doing this is to
enforce that we are always building the schema in a monad stack that has the
reader on top of some arbitrary *shared* base. This gives us the guarantee that
the LHS of any remote relationship, the calling context for `runReaderT`, is
itself a `ReaderT` on top og that known shared base, meaning that after a call
to `runReaderT` on another part of the schema, we can always go back to the
calling monad with a simple `lift`, as demonstrated in
'remoteRelationshipField'.
-}</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-comment">-- | The monad in which the schema is built.</span><span>
</span><span id="line-207"></span><span class="hs-comment">--</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- The implementation of 'SchemaT' is intended to be opaque: running a</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- computation in 'SchemaT' is intended to be done via calls to</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- 'runSourceSchema' and 'runRemoteSchema', which also enforce what the @r@</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- parameter should be in each case.</span><span>
</span><span id="line-212"></span><span class="hs-comment">--</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- The reason why we want to enforce that the schema is built in a reader on top</span><span>
</span><span id="line-214"></span><span class="hs-comment">-- of an arbitrary base monad is for performance: see Note [SchemaT and</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- stacking] for more information.</span><span>
</span><span id="line-216"></span><span class="hs-comment">--</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- In the future, we might monomorphize this further to make `MemoizeT` explicit.</span><span>
</span><span id="line-218"></span><span class="hs-keyword">newtype</span><span> </span><span id="SchemaT"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaT"><span class="hs-identifier hs-var">SchemaT</span></a></span></span><span> </span><span id="local-6989586621690735880"><span class="annot"><a href="#local-6989586621690735880"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621690735881"><span class="annot"><a href="#local-6989586621690735881"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621690735849"><span class="annot"><a href="#local-6989586621690735849"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SchemaT"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaT"><span class="hs-identifier hs-var">SchemaT</span></a></span></span><span> </span><span class="hs-special">{</span><span id="runSchemaT"><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. SchemaT r m a -&gt; ReaderT r m a
</span><a href="Hasura.GraphQL.Schema.Common.html#runSchemaT"><span class="hs-identifier hs-var hs-var">runSchemaT</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">ReaderT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735880"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735881"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735849"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621690735372"><span id="local-6989586621690735377"><span class="annot"><span class="annottext">forall a b. a -&gt; SchemaT r m b -&gt; SchemaT r m a
forall a b. (a -&gt; b) -&gt; SchemaT r m a -&gt; SchemaT r m b
forall r (m :: * -&gt; *) a b.
Functor m =&gt;
a -&gt; SchemaT r m b -&gt; SchemaT r m a
forall r (m :: * -&gt; *) a b.
Functor m =&gt;
(a -&gt; b) -&gt; SchemaT r m a -&gt; SchemaT r m b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: forall a b. a -&gt; SchemaT r m b -&gt; SchemaT r m a
$c&lt;$ :: forall r (m :: * -&gt; *) a b.
Functor m =&gt;
a -&gt; SchemaT r m b -&gt; SchemaT r m a
fmap :: forall a b. (a -&gt; b) -&gt; SchemaT r m a -&gt; SchemaT r m b
$cfmap :: forall r (m :: * -&gt; *) a b.
Functor m =&gt;
(a -&gt; b) -&gt; SchemaT r m a -&gt; SchemaT r m b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690735345"><span id="local-6989586621690735349"><span id="local-6989586621690735353"><span id="local-6989586621690735357"><span id="local-6989586621690735362"><span class="annot"><span class="annottext">forall a. a -&gt; SchemaT r m a
forall a b. SchemaT r m a -&gt; SchemaT r m b -&gt; SchemaT r m a
forall a b. SchemaT r m a -&gt; SchemaT r m b -&gt; SchemaT r m b
forall a b. SchemaT r m (a -&gt; b) -&gt; SchemaT r m a -&gt; SchemaT r m b
forall a b c.
(a -&gt; b -&gt; c) -&gt; SchemaT r m a -&gt; SchemaT r m b -&gt; SchemaT r m c
forall {r} {m :: * -&gt; *}. Applicative m =&gt; Functor (SchemaT r m)
forall r (m :: * -&gt; *) a. Applicative m =&gt; a -&gt; SchemaT r m a
forall r (m :: * -&gt; *) a b.
Applicative m =&gt;
SchemaT r m a -&gt; SchemaT r m b -&gt; SchemaT r m a
forall r (m :: * -&gt; *) a b.
Applicative m =&gt;
SchemaT r m a -&gt; SchemaT r m b -&gt; SchemaT r m b
forall r (m :: * -&gt; *) a b.
Applicative m =&gt;
SchemaT r m (a -&gt; b) -&gt; SchemaT r m a -&gt; SchemaT r m b
forall r (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; b -&gt; c) -&gt; SchemaT r m a -&gt; SchemaT r m b -&gt; SchemaT r m c
forall (f :: * -&gt; *).
Functor f
-&gt; (forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
&lt;* :: forall a b. SchemaT r m a -&gt; SchemaT r m b -&gt; SchemaT r m a
$c&lt;* :: forall r (m :: * -&gt; *) a b.
Applicative m =&gt;
SchemaT r m a -&gt; SchemaT r m b -&gt; SchemaT r m a
*&gt; :: forall a b. SchemaT r m a -&gt; SchemaT r m b -&gt; SchemaT r m b
$c*&gt; :: forall r (m :: * -&gt; *) a b.
Applicative m =&gt;
SchemaT r m a -&gt; SchemaT r m b -&gt; SchemaT r m b
liftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; SchemaT r m a -&gt; SchemaT r m b -&gt; SchemaT r m c
$cliftA2 :: forall r (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; b -&gt; c) -&gt; SchemaT r m a -&gt; SchemaT r m b -&gt; SchemaT r m c
&lt;*&gt; :: forall a b. SchemaT r m (a -&gt; b) -&gt; SchemaT r m a -&gt; SchemaT r m b
$c&lt;*&gt; :: forall r (m :: * -&gt; *) a b.
Applicative m =&gt;
SchemaT r m (a -&gt; b) -&gt; SchemaT r m a -&gt; SchemaT r m b
pure :: forall a. a -&gt; SchemaT r m a
$cpure :: forall r (m :: * -&gt; *) a. Applicative m =&gt; a -&gt; SchemaT r m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></a></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690735326"><span id="local-6989586621690735330"><span id="local-6989586621690735335"><span class="annot"><span class="annottext">forall a. a -&gt; SchemaT r m a
forall a b. SchemaT r m a -&gt; SchemaT r m b -&gt; SchemaT r m b
forall a b. SchemaT r m a -&gt; (a -&gt; SchemaT r m b) -&gt; SchemaT r m b
forall {r} {m :: * -&gt; *}. Monad m =&gt; Applicative (SchemaT r m)
forall r (m :: * -&gt; *) a. Monad m =&gt; a -&gt; SchemaT r m a
forall r (m :: * -&gt; *) a b.
Monad m =&gt;
SchemaT r m a -&gt; SchemaT r m b -&gt; SchemaT r m b
forall r (m :: * -&gt; *) a b.
Monad m =&gt;
SchemaT r m a -&gt; (a -&gt; SchemaT r m b) -&gt; SchemaT r m b
forall (m :: * -&gt; *).
Applicative m
-&gt; (forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
return :: forall a. a -&gt; SchemaT r m a
$creturn :: forall r (m :: * -&gt; *) a. Monad m =&gt; a -&gt; SchemaT r m a
&gt;&gt; :: forall a b. SchemaT r m a -&gt; SchemaT r m b -&gt; SchemaT r m b
$c&gt;&gt; :: forall r (m :: * -&gt; *) a b.
Monad m =&gt;
SchemaT r m a -&gt; SchemaT r m b -&gt; SchemaT r m b
&gt;&gt;= :: forall a b. SchemaT r m a -&gt; (a -&gt; SchemaT r m b) -&gt; SchemaT r m b
$c&gt;&gt;= :: forall r (m :: * -&gt; *) a b.
Monad m =&gt;
SchemaT r m a -&gt; (a -&gt; SchemaT r m b) -&gt; SchemaT r m b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690735308"><span id="local-6989586621690735312"><span id="local-6989586621690735317"><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735880"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690735292"><span class="annot"><span class="annottext">forall a p.
(Ord a, Typeable a, Typeable p) =&gt;
Name -&gt; a -&gt; SchemaT r m p -&gt; SchemaT r m p
forall {r} {m :: * -&gt; *}. MonadMemoize m =&gt; Monad (SchemaT r m)
forall r (m :: * -&gt; *) a p.
(MonadMemoize m, Ord a, Typeable a, Typeable p) =&gt;
Name -&gt; a -&gt; SchemaT r m p -&gt; SchemaT r m p
forall (m :: * -&gt; *).
Monad m
-&gt; (forall a p.
    (Ord a, Typeable a, Typeable p) =&gt;
    Name -&gt; a -&gt; m p -&gt; m p)
-&gt; MonadMemoize m
memoizeOn :: forall a p.
(Ord a, Typeable a, Typeable p) =&gt;
Name -&gt; a -&gt; SchemaT r m p -&gt; SchemaT r m p
$cmemoizeOn :: forall r (m :: * -&gt; *) a p.
(MonadMemoize m, Ord a, Typeable a, Typeable p) =&gt;
Name -&gt; a -&gt; SchemaT r m p -&gt; SchemaT r m p
</span><a href="Control.Monad.Memoize.html#C%3AMonadMemoize"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">P.MonadMemoize</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690735276"><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; SchemaT r m a
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; SchemaT r m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *).
(forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; t m a) -&gt; MonadTrans t
lift :: forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; SchemaT r m a
$clift :: forall r (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; SchemaT r m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">MonadTrans</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690735258"><span id="local-6989586621690735263"><span id="local-6989586621690735753"><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735753"><span class="hs-identifier hs-type">e</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-keyword">type</span><span> </span><span id="MonadBuildSourceSchema"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#MonadBuildSourceSchema"><span class="hs-identifier hs-var">MonadBuildSourceSchema</span></a></span></span><span> </span><span id="local-6989586621690735253"><span class="annot"><a href="#local-6989586621690735253"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621690735252"><span class="annot"><a href="#local-6989586621690735252"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621690735251"><span class="annot"><a href="#local-6989586621690735251"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621690735250"><span class="annot"><a href="#local-6989586621690735250"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#MonadBuildSchemaBase"><span class="hs-identifier hs-type">MonadBuildSchemaBase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735251"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735250"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Has</span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaContext"><span class="hs-identifier hs-type">SchemaContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735252"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-224"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Has</span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Options.html#SchemaOptions"><span class="hs-identifier hs-type">SchemaOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735252"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-225"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Has</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Source.html#SourceInfo"><span class="hs-identifier hs-type">SourceInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735253"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621690735252"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">-- | Runs a schema-building computation with all the context required to build a source.</span><span>
</span><span id="line-229"></span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#runSourceSchema"><span class="hs-identifier hs-type">runSourceSchema</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621690735752"><span class="annot"><a href="#local-6989586621690735752"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621690735750"><span class="annot"><a href="#local-6989586621690735750"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621690735749"><span class="annot"><a href="#local-6989586621690735749"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaContext"><span class="hs-identifier hs-type">SchemaContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-232"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Schema.Options.html#SchemaOptions"><span class="hs-identifier hs-type">SchemaOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Source.html#SourceInfo"><span class="hs-identifier hs-type">SourceInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735752"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-234"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaT"><span class="hs-identifier hs-type">SchemaT</span></a></span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaContext"><span class="hs-identifier hs-type">SchemaContext</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-236"></span><span>      </span><span class="annot"><a href="Hasura.GraphQL.Schema.Options.html#SchemaOptions"><span class="hs-identifier hs-type">SchemaOptions</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-237"></span><span>      </span><span class="annot"><a href="Hasura.RQL.Types.Source.html#SourceInfo"><span class="hs-identifier hs-type">SourceInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735752"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>    </span><span class="annot"><a href="#local-6989586621690735750"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-240"></span><span>    </span><span class="annot"><a href="#local-6989586621690735749"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-241"></span><span>  </span><span class="annot"><a href="#local-6989586621690735750"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735749"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-242"></span><span id="runSourceSchema"><span class="annot"><span class="annottext">runSourceSchema :: forall (b :: BackendType) (m :: * -&gt; *) a.
SchemaContext
-&gt; SchemaOptions
-&gt; SourceInfo b
-&gt; SchemaT (SchemaContext, SchemaOptions, SourceInfo b) m a
-&gt; m a
</span><a href="Hasura.GraphQL.Schema.Common.html#runSourceSchema"><span class="hs-identifier hs-var hs-var">runSourceSchema</span></a></span></span><span> </span><span id="local-6989586621690735249"><span class="annot"><span class="annottext">SchemaContext
</span><a href="#local-6989586621690735249"><span class="hs-identifier hs-var">context</span></a></span></span><span> </span><span id="local-6989586621690735248"><span class="annot"><span class="annottext">SchemaOptions
</span><a href="#local-6989586621690735248"><span class="hs-identifier hs-var">options</span></a></span></span><span> </span><span id="local-6989586621690735247"><span class="annot"><span class="annottext">SourceInfo b
</span><a href="#local-6989586621690735247"><span class="hs-identifier hs-var">sourceInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaT"><span class="hs-identifier hs-type">SchemaT</span></a></span><span> </span><span id="local-6989586621690735246"><span class="annot"><span class="annottext">ReaderT (SchemaContext, SchemaOptions, SourceInfo b) m a
</span><a href="#local-6989586621690735246"><span class="hs-identifier hs-var">action</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runReaderT</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT (SchemaContext, SchemaOptions, SourceInfo b) m a
</span><a href="#local-6989586621690735246"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SchemaContext
</span><a href="#local-6989586621690735249"><span class="hs-identifier hs-var">context</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SchemaOptions
</span><a href="#local-6989586621690735248"><span class="hs-identifier hs-var">options</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SourceInfo b
</span><a href="#local-6989586621690735247"><span class="hs-identifier hs-var">sourceInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-keyword">type</span><span> </span><span id="MonadBuildRemoteSchema"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#MonadBuildRemoteSchema"><span class="hs-identifier hs-var">MonadBuildRemoteSchema</span></a></span></span><span> </span><span id="local-6989586621690735244"><span class="annot"><a href="#local-6989586621690735244"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621690735243"><span class="annot"><a href="#local-6989586621690735243"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621690735242"><span class="annot"><a href="#local-6989586621690735242"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#MonadBuildSchemaBase"><span class="hs-identifier hs-type">MonadBuildSchemaBase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735243"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735242"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Has</span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaContext"><span class="hs-identifier hs-type">SchemaContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735244"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-247"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Has</span></span><span> </span><span class="annot"><a href="Hasura.RemoteSchema.SchemaCache.Types.html#CustomizeRemoteFieldName"><span class="hs-identifier hs-type">CustomizeRemoteFieldName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735244"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-248"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Has</span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Typename.html#MkTypename"><span class="hs-identifier hs-type">MkTypename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735244"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-comment">-- | Runs a schema-building computation with all the context required to build a remote schema.</span><span>
</span><span id="line-252"></span><span id="local-6989586621690735739"><span id="local-6989586621690735740"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#runRemoteSchema"><span class="hs-identifier hs-type">runRemoteSchema</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-253"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaContext"><span class="hs-identifier hs-type">SchemaContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-254"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaT"><span class="hs-identifier hs-type">SchemaT</span></a></span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaContext"><span class="hs-identifier hs-type">SchemaContext</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-256"></span><span>      </span><span class="annot"><a href="Hasura.GraphQL.Schema.Typename.html#MkTypename"><span class="hs-identifier hs-type">MkTypename</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-257"></span><span>      </span><span class="annot"><a href="Hasura.RemoteSchema.SchemaCache.Types.html#CustomizeRemoteFieldName"><span class="hs-identifier hs-type">CustomizeRemoteFieldName</span></a></span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><a href="#local-6989586621690735740"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><a href="#local-6989586621690735739"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-261"></span><span>  </span><span class="annot"><a href="#local-6989586621690735740"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735739"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-262"></span><span id="runRemoteSchema"><span class="annot"><span class="annottext">runRemoteSchema :: forall (m :: * -&gt; *) a.
SchemaContext
-&gt; SchemaT
     (SchemaContext, MkTypename, CustomizeRemoteFieldName) m a
-&gt; m a
</span><a href="Hasura.GraphQL.Schema.Common.html#runRemoteSchema"><span class="hs-identifier hs-var hs-var">runRemoteSchema</span></a></span></span><span> </span><span id="local-6989586621690735237"><span class="annot"><span class="annottext">SchemaContext
</span><a href="#local-6989586621690735237"><span class="hs-identifier hs-var">context</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaT"><span class="hs-identifier hs-type">SchemaT</span></a></span><span> </span><span id="local-6989586621690735236"><span class="annot"><span class="annottext">ReaderT (SchemaContext, MkTypename, CustomizeRemoteFieldName) m a
</span><a href="#local-6989586621690735236"><span class="hs-identifier hs-var">action</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runReaderT</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT (SchemaContext, MkTypename, CustomizeRemoteFieldName) m a
</span><a href="#local-6989586621690735236"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SchemaContext
</span><a href="#local-6989586621690735237"><span class="hs-identifier hs-var">context</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-keyword">type</span><span> </span><span id="MonadBuildActionSchema"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#MonadBuildActionSchema"><span class="hs-identifier hs-var">MonadBuildActionSchema</span></a></span></span><span> </span><span id="local-6989586621690735235"><span class="annot"><a href="#local-6989586621690735235"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621690735234"><span class="annot"><a href="#local-6989586621690735234"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621690735233"><span class="annot"><a href="#local-6989586621690735233"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#MonadBuildSchemaBase"><span class="hs-identifier hs-type">MonadBuildSchemaBase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735234"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735233"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-266"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Has</span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaContext"><span class="hs-identifier hs-type">SchemaContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735235"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-267"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Has</span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Options.html#SchemaOptions"><span class="hs-identifier hs-type">SchemaOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735235"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="hs-comment">-- | Runs a schema-building computation with all the context required to build actions.</span><span>
</span><span id="line-271"></span><span id="local-6989586621690735734"><span id="local-6989586621690735735"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#runActionSchema"><span class="hs-identifier hs-type">runActionSchema</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-272"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaContext"><span class="hs-identifier hs-type">SchemaContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-273"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Schema.Options.html#SchemaOptions"><span class="hs-identifier hs-type">SchemaOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-274"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaT"><span class="hs-identifier hs-type">SchemaT</span></a></span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaContext"><span class="hs-identifier hs-type">SchemaContext</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-276"></span><span>      </span><span class="annot"><a href="Hasura.GraphQL.Schema.Options.html#SchemaOptions"><span class="hs-identifier hs-type">SchemaOptions</span></a></span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>    </span><span class="annot"><a href="#local-6989586621690735735"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-279"></span><span>    </span><span class="annot"><a href="#local-6989586621690735734"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-280"></span><span>  </span><span class="annot"><a href="#local-6989586621690735735"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735734"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-281"></span><span id="runActionSchema"><span class="annot"><span class="annottext">runActionSchema :: forall (m :: * -&gt; *) a.
SchemaContext
-&gt; SchemaOptions
-&gt; SchemaT (SchemaContext, SchemaOptions) m a
-&gt; m a
</span><a href="Hasura.GraphQL.Schema.Common.html#runActionSchema"><span class="hs-identifier hs-var hs-var">runActionSchema</span></a></span></span><span> </span><span id="local-6989586621690735232"><span class="annot"><span class="annottext">SchemaContext
</span><a href="#local-6989586621690735232"><span class="hs-identifier hs-var">context</span></a></span></span><span> </span><span id="local-6989586621690735231"><span class="annot"><span class="annottext">SchemaOptions
</span><a href="#local-6989586621690735231"><span class="hs-identifier hs-var">options</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaT"><span class="hs-identifier hs-type">SchemaT</span></a></span><span> </span><span id="local-6989586621690735230"><span class="annot"><span class="annottext">ReaderT (SchemaContext, SchemaOptions) m a
</span><a href="#local-6989586621690735230"><span class="hs-identifier hs-var">action</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runReaderT</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT (SchemaContext, SchemaOptions) m a
</span><a href="#local-6989586621690735230"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SchemaContext
</span><a href="#local-6989586621690735232"><span class="hs-identifier hs-var">context</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SchemaOptions
</span><a href="#local-6989586621690735231"><span class="hs-identifier hs-var">options</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-keyword">type</span><span> </span><span id="SelectExp"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SelectExp"><span class="hs-identifier hs-var">SelectExp</span></a></span></span><span> </span><span id="local-6989586621690735229"><span class="annot"><a href="#local-6989586621690735229"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnSimpleSelectG"><span class="hs-identifier hs-type">IR.AnnSimpleSelectG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735229"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">IR.RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735229"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="hs-keyword">type</span><span> </span><span id="StreamSelectExp"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#StreamSelectExp"><span class="hs-identifier hs-var">StreamSelectExp</span></a></span></span><span> </span><span id="local-6989586621690735227"><span class="annot"><a href="#local-6989586621690735227"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnSimpleStreamSelectG"><span class="hs-identifier hs-type">IR.AnnSimpleStreamSelectG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735227"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">IR.RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735227"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="hs-keyword">type</span><span> </span><span id="AggSelectExp"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#AggSelectExp"><span class="hs-identifier hs-var">AggSelectExp</span></a></span></span><span> </span><span id="local-6989586621690735225"><span class="annot"><a href="#local-6989586621690735225"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnAggregateSelectG"><span class="hs-identifier hs-type">IR.AnnAggregateSelectG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735225"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">IR.RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735225"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="hs-keyword">type</span><span> </span><span id="ConnectionSelectExp"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#ConnectionSelectExp"><span class="hs-identifier hs-var">ConnectionSelectExp</span></a></span></span><span> </span><span id="local-6989586621690735223"><span class="annot"><a href="#local-6989586621690735223"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ConnectionSelect"><span class="hs-identifier hs-type">IR.ConnectionSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735223"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">IR.RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735223"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-keyword">type</span><span> </span><span id="SelectArgs"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SelectArgs"><span class="hs-identifier hs-var">SelectArgs</span></a></span></span><span> </span><span id="local-6989586621690735221"><span class="annot"><a href="#local-6989586621690735221"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#SelectArgsG"><span class="hs-identifier hs-type">IR.SelectArgsG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735221"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735221"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-keyword">type</span><span> </span><span id="SelectStreamArgs"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SelectStreamArgs"><span class="hs-identifier hs-var">SelectStreamArgs</span></a></span></span><span> </span><span id="local-6989586621690735219"><span class="annot"><a href="#local-6989586621690735219"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#SelectStreamArgsG"><span class="hs-identifier hs-type">IR.SelectStreamArgsG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735219"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735219"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="hs-keyword">type</span><span> </span><span id="TablePerms"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#TablePerms"><span class="hs-identifier hs-var">TablePerms</span></a></span></span><span> </span><span id="local-6989586621690735217"><span class="annot"><a href="#local-6989586621690735217"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#TablePermG"><span class="hs-identifier hs-type">IR.TablePermG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735217"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735217"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-keyword">type</span><span> </span><span id="AnnotatedFields"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#AnnotatedFields"><span class="hs-identifier hs-var">AnnotatedFields</span></a></span></span><span> </span><span id="local-6989586621690735215"><span class="annot"><a href="#local-6989586621690735215"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnFieldsG"><span class="hs-identifier hs-type">IR.AnnFieldsG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735215"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">IR.RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735215"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="hs-keyword">type</span><span> </span><span id="AnnotatedField"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#AnnotatedField"><span class="hs-identifier hs-var">AnnotatedField</span></a></span></span><span> </span><span id="local-6989586621690735213"><span class="annot"><a href="#local-6989586621690735213"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnFieldG"><span class="hs-identifier hs-type">IR.AnnFieldG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735213"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">IR.RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735213"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="hs-keyword">type</span><span> </span><span id="ConnectionFields"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#ConnectionFields"><span class="hs-identifier hs-var">ConnectionFields</span></a></span></span><span> </span><span id="local-6989586621690735211"><span class="annot"><a href="#local-6989586621690735211"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ConnectionFields"><span class="hs-identifier hs-type">IR.ConnectionFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735211"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">IR.RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735211"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="hs-keyword">type</span><span> </span><span id="EdgeFields"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#EdgeFields"><span class="hs-identifier hs-var">EdgeFields</span></a></span></span><span> </span><span id="local-6989586621690735209"><span class="annot"><a href="#local-6989586621690735209"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#EdgeFields"><span class="hs-identifier hs-type">IR.EdgeFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735209"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">IR.RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735209"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="hs-keyword">type</span><span> </span><span id="AnnotatedActionFields"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#AnnotatedActionFields"><span class="hs-identifier hs-var">AnnotatedActionFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Action.html#ActionFieldsG"><span class="hs-identifier hs-type">IR.ActionFieldsG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">IR.RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span class="hs-keyword">type</span><span> </span><span id="AnnotatedActionField"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#AnnotatedActionField"><span class="hs-identifier hs-var">AnnotatedActionField</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Action.html#ActionFieldG"><span class="hs-identifier hs-type">IR.ActionFieldG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">IR.RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="hs-keyword">data</span><span> </span><span id="RemoteSchemaParser"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#RemoteSchemaParser"><span class="hs-identifier hs-var">RemoteSchemaParser</span></a></span></span><span> </span><span id="local-6989586621690735731"><span class="annot"><a href="#local-6989586621690735731"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RemoteSchemaParser"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#RemoteSchemaParser"><span class="hs-identifier hs-var">RemoteSchemaParser</span></a></span></span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="piQuery"><span class="annot"><span class="annottext">forall (n :: * -&gt; *).
RemoteSchemaParser n
-&gt; [FieldParser
      n
      (NamespacedField
         (RemoteSchemaRootField
            (RemoteRelationshipField UnpreparedValue) RemoteSchemaVariable))]
</span><a href="Hasura.GraphQL.Schema.Common.html#piQuery"><span class="hs-identifier hs-var hs-var">piQuery</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.GraphQL.Schema.Parser.html#FieldParser"><span class="hs-identifier hs-type">P.FieldParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735731"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Namespace.html#NamespacedField"><span class="hs-identifier hs-type">NamespacedField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.RemoteSchema.html#RemoteSchemaRootField"><span class="hs-identifier hs-type">IR.RemoteSchemaRootField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">IR.RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.RemoteSchema.SchemaCache.Types.html#RemoteSchemaVariable"><span class="hs-identifier hs-type">RemoteSchemaVariable</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-315"></span><span>    </span><span id="piMutation"><span class="annot"><span class="annottext">forall (n :: * -&gt; *).
RemoteSchemaParser n
-&gt; Maybe
     [FieldParser
        n
        (NamespacedField
           (RemoteSchemaRootField
              (RemoteRelationshipField UnpreparedValue) RemoteSchemaVariable))]
</span><a href="Hasura.GraphQL.Schema.Common.html#piMutation"><span class="hs-identifier hs-var hs-var">piMutation</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.GraphQL.Schema.Parser.html#FieldParser"><span class="hs-identifier hs-type">P.FieldParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735731"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Namespace.html#NamespacedField"><span class="hs-identifier hs-type">NamespacedField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.RemoteSchema.html#RemoteSchemaRootField"><span class="hs-identifier hs-type">IR.RemoteSchemaRootField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">IR.RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.RemoteSchema.SchemaCache.Types.html#RemoteSchemaVariable"><span class="hs-identifier hs-type">RemoteSchemaVariable</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-316"></span><span>    </span><span id="piSubscription"><span class="annot"><span class="annottext">forall (n :: * -&gt; *).
RemoteSchemaParser n
-&gt; Maybe
     [FieldParser
        n
        (NamespacedField
           (RemoteSchemaRootField
              (RemoteRelationshipField UnpreparedValue) RemoteSchemaVariable))]
</span><a href="Hasura.GraphQL.Schema.Common.html#piSubscription"><span class="hs-identifier hs-var hs-var">piSubscription</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.GraphQL.Schema.Parser.html#FieldParser"><span class="hs-identifier hs-type">P.FieldParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735731"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Namespace.html#NamespacedField"><span class="hs-identifier hs-type">NamespacedField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.RemoteSchema.html#RemoteSchemaRootField"><span class="hs-identifier hs-type">IR.RemoteSchemaRootField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">IR.RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.RemoteSchema.SchemaCache.Types.html#RemoteSchemaVariable"><span class="hs-identifier hs-type">RemoteSchemaVariable</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#getTableRoles"><span class="hs-identifier hs-type">getTableRoles</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Source.html#BackendSourceInfo"><span class="hs-identifier hs-type">BackendSourceInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.Session.html#RoleName"><span class="hs-identifier hs-type">RoleName</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-320"></span><span id="getTableRoles"><span class="annot"><span class="annottext">getTableRoles :: BackendSourceInfo -&gt; [RoleName]
</span><a href="Hasura.GraphQL.Schema.Common.html#getTableRoles"><span class="hs-identifier hs-var hs-var">getTableRoles</span></a></span></span><span> </span><span id="local-6989586621690735201"><span class="annot"><span class="annottext">BackendSourceInfo
</span><a href="#local-6989586621690735201"><span class="hs-identifier hs-var">bsi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (c :: BackendType -&gt; Constraint) (i :: BackendType -&gt; *) r.
AllBackendsSatisfy c =&gt;
AnyBackend i -&gt; (forall (b :: BackendType). c b =&gt; i b -&gt; r) -&gt; r
</span><a href="Hasura.SQL.AnyBackend.html#dispatchAnyBackend"><span class="hs-identifier hs-var">AB.dispatchAnyBackend</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><span class="annottext">BackendSourceInfo
</span><a href="#local-6989586621690735201"><span class="hs-identifier hs-var">bsi</span></a></span><span> </span><span class="annot"><span class="annottext">forall {b :: BackendType}. SourceInfo b -&gt; [RoleName]
</span><a href="#local-6989586621690735199"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-321"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-322"></span><span>    </span><span id="local-6989586621690735199"><span class="annot"><span class="annottext">go :: SourceInfo b -&gt; [RoleName]
</span><a href="#local-6989586621690735199"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621690735195"><span class="annot"><span class="annottext">SourceInfo b
</span><a href="#local-6989586621690735195"><span class="hs-identifier hs-var">si</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k v. HashMap k v -&gt; [k]
</span><span class="hs-identifier hs-var">Map.keys</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType). TableInfo b -&gt; RolePermInfoMap b
</span><a href="Hasura.RQL.Types.Table.html#_tiRolePermInfoMap"><span class="hs-identifier hs-var">_tiRolePermInfoMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall k v. HashMap k v -&gt; [v]
</span><span class="hs-identifier hs-var">Map.elems</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType). SourceInfo b -&gt; TableCache b
</span><a href="Hasura.RQL.Types.Source.html#_siTables"><span class="hs-identifier hs-var">_siTables</span></a></span><span> </span><span class="annot"><span class="annottext">SourceInfo b
</span><a href="#local-6989586621690735195"><span class="hs-identifier hs-var">si</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="hs-comment">-- | Looks up table information for the given table name. This function</span><span>
</span><span id="line-325"></span><span class="hs-comment">-- should never fail, since the schema cache construction process is</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- supposed to ensure all dependencies are resolved.</span><span>
</span><span id="line-327"></span><span class="hs-comment">-- TODO: deduplicate this with `CacheRM`.</span><span>
</span><span id="line-328"></span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#askTableInfo"><span class="hs-identifier hs-type">askTableInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621690735702"><span class="annot"><a href="#local-6989586621690735702"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621690735700"><span class="annot"><a href="#local-6989586621690735700"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621690735701"><span class="annot"><a href="#local-6989586621690735701"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735702"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735701"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735700"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735701"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Has</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Source.html#SourceInfo"><span class="hs-identifier hs-type">SourceInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735702"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621690735700"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-331"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#TableName"><span class="hs-identifier hs-type">TableName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735702"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-332"></span><span>  </span><span class="annot"><a href="#local-6989586621690735701"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Table.html#TableInfo"><span class="hs-identifier hs-type">TableInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735702"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span id="askTableInfo"><span class="annot"><span class="annottext">askTableInfo :: forall (b :: BackendType) r (m :: * -&gt; *).
(Backend b, MonadError QErr m, MonadReader r m,
 Has (SourceInfo b) r) =&gt;
TableName b -&gt; m (TableInfo b)
</span><a href="Hasura.GraphQL.Schema.Common.html#askTableInfo"><span class="hs-identifier hs-var hs-var">askTableInfo</span></a></span></span><span> </span><span id="local-6989586621690735161"><span class="annot"><span class="annottext">TableName b
</span><a href="#local-6989586621690735161"><span class="hs-identifier hs-var">tableName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-334"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Source.html#SourceInfo"><span class="hs-identifier hs-type">SourceInfo</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621690735153"><span id="local-6989586621690735154"><span id="local-6989586621690735155"><span id="local-6989586621690735156"><span id="local-6989586621690735157"><span id="local-6989586621690735158"><span id="local-6989586621690735159"><span class="annot"><span class="annottext">NativeQueries b
Maybe QueryTagsConfig
TableCache b
FunctionCache b
SourceName
SourceConfig b
ResolvedSourceCustomization
_siCustomization :: forall (b :: BackendType).
SourceInfo b -&gt; ResolvedSourceCustomization
_siQueryTagsConfig :: forall (b :: BackendType). SourceInfo b -&gt; Maybe QueryTagsConfig
_siConfiguration :: forall (b :: BackendType). SourceInfo b -&gt; SourceConfig b
_siNativeQueries :: forall (b :: BackendType). SourceInfo b -&gt; NativeQueries b
_siFunctions :: forall (b :: BackendType). SourceInfo b -&gt; FunctionCache b
_siName :: forall (b :: BackendType). SourceInfo b -&gt; SourceName
_siCustomization :: ResolvedSourceCustomization
_siQueryTagsConfig :: Maybe QueryTagsConfig
_siConfiguration :: SourceConfig b
_siNativeQueries :: NativeQueries b
_siFunctions :: FunctionCache b
_siTables :: TableCache b
_siName :: SourceName
_siTables :: forall (b :: BackendType). SourceInfo b -&gt; TableCache b
</span><a href="Hasura.RQL.Types.Source.html#_siCustomization"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">forall a t. Has a t =&gt; t -&gt; a
</span><span class="hs-identifier hs-var">getter</span></span><span>
</span><span id="line-335"></span><span>  </span><span class="annot"><span class="annottext">forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">TableName b
</span><a href="#local-6989586621690735161"><span class="hs-identifier hs-var">tableName</span></a></span><span> </span><span class="annot"><span class="annottext">TableCache b
</span><a href="#local-6989586621690735158"><span class="hs-identifier hs-var">_siTables</span></a></span><span>
</span><span id="line-336"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Applicative m =&gt; Maybe a -&gt; m a -&gt; m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-operator hs-var">`onNothing`</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw500"><span class="hs-identifier hs-var">throw500</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;askTableInfo: no info for table &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. ToTxt t =&gt; t -&gt; Text
</span><a href="Data.Text.Extended.html#dquote"><span class="hs-identifier hs-var">dquote</span></a></span><span> </span><span class="annot"><span class="annottext">TableName b
</span><a href="#local-6989586621690735161"><span class="hs-identifier hs-var">tableName</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; in source &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. ToTxt t =&gt; t -&gt; Text
</span><a href="Data.Text.Extended.html#dquote"><span class="hs-identifier hs-var">dquote</span></a></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><a href="#local-6989586621690735159"><span class="hs-identifier hs-var">_siName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span class="hs-comment">-- | Whether the request is sent with `x-hasura-use-backend-only-permissions` set to `true`.</span><span>
</span><span id="line-339"></span><span class="hs-keyword">data</span><span> </span><span id="Scenario"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#Scenario"><span class="hs-identifier hs-var">Scenario</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Backend"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#Backend"><span class="hs-identifier hs-var">Backend</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Frontend"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#Frontend"><span class="hs-identifier hs-var">Frontend</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621690735099"><span id="local-6989586621690735101"><span id="local-6989586621690735105"><span id="local-6989586621690735109"><span id="local-6989586621690735111"><span id="local-6989586621690735125"><span id="local-6989586621690735131"><span id="local-6989586621690735139"><span class="annot"><span class="annottext">Int -&gt; Scenario
Scenario -&gt; Int
Scenario -&gt; [Scenario]
Scenario -&gt; Scenario
Scenario -&gt; Scenario -&gt; [Scenario]
Scenario -&gt; Scenario -&gt; Scenario -&gt; [Scenario]
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: Scenario -&gt; Scenario -&gt; Scenario -&gt; [Scenario]
$cenumFromThenTo :: Scenario -&gt; Scenario -&gt; Scenario -&gt; [Scenario]
enumFromTo :: Scenario -&gt; Scenario -&gt; [Scenario]
$cenumFromTo :: Scenario -&gt; Scenario -&gt; [Scenario]
enumFromThen :: Scenario -&gt; Scenario -&gt; [Scenario]
$cenumFromThen :: Scenario -&gt; Scenario -&gt; [Scenario]
enumFrom :: Scenario -&gt; [Scenario]
$cenumFrom :: Scenario -&gt; [Scenario]
fromEnum :: Scenario -&gt; Int
$cfromEnum :: Scenario -&gt; Int
toEnum :: Int -&gt; Scenario
$ctoEnum :: Int -&gt; Scenario
pred :: Scenario -&gt; Scenario
$cpred :: Scenario -&gt; Scenario
succ :: Scenario -&gt; Scenario
$csucc :: Scenario -&gt; Scenario
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></a></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690735092"><span id="local-6989586621690735094"><span id="local-6989586621690735096"><span class="annot"><span class="annottext">Int -&gt; Scenario -&gt; ShowS
[Scenario] -&gt; ShowS
Scenario -&gt; [Char]
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Scenario] -&gt; ShowS
$cshowList :: [Scenario] -&gt; ShowS
show :: Scenario -&gt; [Char]
$cshow :: Scenario -&gt; [Char]
showsPrec :: Int -&gt; Scenario -&gt; ShowS
$cshowsPrec :: Int -&gt; Scenario -&gt; ShowS
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690735087"><span id="local-6989586621690735089"><span class="annot"><span class="annottext">Scenario -&gt; Scenario -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Scenario -&gt; Scenario -&gt; Bool
$c/= :: Scenario -&gt; Scenario -&gt; Bool
== :: Scenario -&gt; Scenario -&gt; Bool
$c== :: Scenario -&gt; Scenario -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span id="local-6989586621690735663"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#textToName"><span class="hs-identifier hs-type">textToName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735663"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690735663"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src"><span class="hs-identifier hs-type">G.Name</span></a></span></span><span>
</span><span id="line-342"></span><span id="textToName"><span class="annot"><span class="annottext">textToName :: forall (m :: * -&gt; *). MonadError QErr m =&gt; Text -&gt; m Name
</span><a href="Hasura.GraphQL.Schema.Common.html#textToName"><span class="hs-identifier hs-var hs-var">textToName</span></a></span></span><span> </span><span id="local-6989586621690735073"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690735073"><span class="hs-identifier hs-var">textName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-343"></span><span>  </span><span class="annot"><span class="annottext">Text -&gt; Maybe Name
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src"><span class="hs-identifier hs-var">G.mkName</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690735073"><span class="hs-identifier hs-var">textName</span></a></span><span>
</span><span id="line-344"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Applicative m =&gt; Maybe a -&gt; m a -&gt; m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-operator hs-var">`onNothing`</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span>
</span><span id="line-345"></span><span>      </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#ValidationFailed"><span class="hs-identifier hs-var">ValidationFailed</span></a></span><span>
</span><span id="line-346"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;cannot include &quot;</span></span><span>
</span><span id="line-347"></span><span>          </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690735073"><span class="hs-identifier hs-var">textName</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; in the GraphQL schema because &quot;</span></span><span>
</span><span id="line-348"></span><span>          </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; it is not a valid GraphQL identifier&quot;</span></span><span>
</span><span id="line-349"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span id="local-6989586621690735656"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#textToGQLIdentifier"><span class="hs-identifier hs-type">textToGQLIdentifier</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735656"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690735656"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Data.Text.Casing.html#GQLNameIdentifier"><span class="hs-identifier hs-type">GQLNameIdentifier</span></a></span></span><span>
</span><span id="line-352"></span><span id="textToGQLIdentifier"><span class="annot"><span class="annottext">textToGQLIdentifier :: forall (m :: * -&gt; *).
MonadError QErr m =&gt;
Text -&gt; m GQLNameIdentifier
</span><a href="Hasura.GraphQL.Schema.Common.html#textToGQLIdentifier"><span class="hs-identifier hs-var hs-var">textToGQLIdentifier</span></a></span></span><span> </span><span id="local-6989586621690735048"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690735048"><span class="hs-identifier hs-var">textName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-353"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690735047"><span class="annot"><span class="annottext">gqlIdents :: Maybe GQLNameIdentifier
</span><a href="#local-6989586621690735047"><span class="hs-identifier hs-var hs-var">gqlIdents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-354"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621690735046"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690735046"><span class="hs-identifier hs-var">pref</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690735045"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621690735045"><span class="hs-identifier hs-var">suffs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe (a, [a])
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">uncons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [Text]
</span><a href="Data.Text.Casing.html#fromSnake"><span class="hs-identifier hs-var">C.fromSnake</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690735048"><span class="hs-identifier hs-var">textName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>        </span><span id="local-6989586621690735043"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621690735043"><span class="hs-identifier hs-var">prefName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Name
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src"><span class="hs-identifier hs-var">G.mkName</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690735046"><span class="hs-identifier hs-var">pref</span></a></span><span>
</span><span id="line-356"></span><span>        </span><span id="local-6989586621690735042"><span class="annot"><span class="annottext">[NameSuffix]
</span><a href="#local-6989586621690735042"><span class="hs-identifier hs-var">suffNames</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe NameSuffix
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src"><span class="hs-identifier hs-var">G.mkNameSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621690735045"><span class="hs-identifier hs-var">suffs</span></a></span><span>
</span><span id="line-357"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Name, [NameSuffix]) -&gt; GQLNameIdentifier
</span><a href="Data.Text.Casing.html#fromAutogeneratedTuple"><span class="hs-identifier hs-var">C.fromAutogeneratedTuple</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621690735043"><span class="hs-identifier hs-var">prefName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[NameSuffix]
</span><a href="#local-6989586621690735042"><span class="hs-identifier hs-var">suffNames</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>  </span><span class="annot"><span class="annottext">Maybe GQLNameIdentifier
</span><a href="#local-6989586621690735047"><span class="hs-identifier hs-var">gqlIdents</span></a></span><span>
</span><span id="line-359"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Applicative m =&gt; Maybe a -&gt; m a -&gt; m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-operator hs-var">`onNothing`</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span>
</span><span id="line-360"></span><span>      </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#ValidationFailed"><span class="hs-identifier hs-var">ValidationFailed</span></a></span><span>
</span><span id="line-361"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;cannot include &quot;</span></span><span>
</span><span id="line-362"></span><span>          </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690735048"><span class="hs-identifier hs-var">textName</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; in the GraphQL schema because &quot;</span></span><span>
</span><span id="line-363"></span><span>          </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; it is not a valid GraphQL identifier&quot;</span></span><span>
</span><span id="line-364"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span id="local-6989586621690735647"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#partialSQLExpToUnpreparedValue"><span class="hs-identifier hs-type">partialSQLExpToUnpreparedValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.BoolExp.html#PartialSQLExp"><span class="hs-identifier hs-type">PartialSQLExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735647"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735647"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-367"></span><span id="partialSQLExpToUnpreparedValue"><span class="annot"><span class="annottext">partialSQLExpToUnpreparedValue :: forall (b :: BackendType). PartialSQLExp b -&gt; UnpreparedValue b
</span><a href="Hasura.GraphQL.Schema.Common.html#partialSQLExpToUnpreparedValue"><span class="hs-identifier hs-var hs-var">partialSQLExpToUnpreparedValue</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.BoolExp.html#PSESessVar"><span class="hs-identifier hs-type">PSESessVar</span></a></span><span> </span><span id="local-6989586621690735037"><span class="annot"><span class="annottext">SessionVarType b
</span><a href="#local-6989586621690735037"><span class="hs-identifier hs-var">pftype</span></a></span></span><span> </span><span id="local-6989586621690735036"><span class="annot"><span class="annottext">SessionVariable
</span><a href="#local-6989586621690735036"><span class="hs-identifier hs-var">var</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType).
SessionVarType b -&gt; SessionVariable -&gt; UnpreparedValue b
</span><a href="Hasura.RQL.IR.Value.html#UVSessionVar"><span class="hs-identifier hs-var">IR.UVSessionVar</span></a></span><span> </span><span class="annot"><span class="annottext">SessionVarType b
</span><a href="#local-6989586621690735037"><span class="hs-identifier hs-var">pftype</span></a></span><span> </span><span class="annot"><span class="annottext">SessionVariable
</span><a href="#local-6989586621690735036"><span class="hs-identifier hs-var">var</span></a></span><span>
</span><span id="line-368"></span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#partialSQLExpToUnpreparedValue"><span class="hs-identifier hs-var">partialSQLExpToUnpreparedValue</span></a></span><span> </span><span class="annot"><span class="annottext">PartialSQLExp b
</span><a href="Hasura.RQL.IR.BoolExp.html#PSESession"><span class="hs-identifier hs-var">PSESession</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType). UnpreparedValue b
</span><a href="Hasura.RQL.IR.Value.html#UVSession"><span class="hs-identifier hs-var">IR.UVSession</span></a></span><span>
</span><span id="line-369"></span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#partialSQLExpToUnpreparedValue"><span class="hs-identifier hs-var">partialSQLExpToUnpreparedValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.BoolExp.html#PSESQLExp"><span class="hs-identifier hs-type">PSESQLExp</span></a></span><span> </span><span id="local-6989586621690735031"><span class="annot"><span class="annottext">SQLExpression b
</span><a href="#local-6989586621690735031"><span class="hs-identifier hs-var">sqlExp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType). SQLExpression b -&gt; UnpreparedValue b
</span><a href="Hasura.RQL.IR.Value.html#UVLiteral"><span class="hs-identifier hs-var">IR.UVLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">SQLExpression b
</span><a href="#local-6989586621690735031"><span class="hs-identifier hs-var">sqlExp</span></a></span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span id="local-6989586621690735637"><span id="local-6989586621690735639"><span id="local-6989586621690735640"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#mapField"><span class="hs-identifier hs-type">mapField</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-372"></span><span>  </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735640"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-373"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Schema.Parser.html#InputFieldsParser"><span class="hs-identifier hs-type">P.InputFieldsParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735640"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735639"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-374"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621690735639"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690735637"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-375"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Schema.Parser.html#InputFieldsParser"><span class="hs-identifier hs-type">P.InputFieldsParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735640"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735637"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-376"></span><span id="mapField"><span class="annot"><span class="annottext">mapField :: forall (m :: * -&gt; *) a b.
Functor m =&gt;
InputFieldsParser m (Maybe a)
-&gt; (a -&gt; b) -&gt; InputFieldsParser m (Maybe b)
</span><a href="Hasura.GraphQL.Schema.Common.html#mapField"><span class="hs-identifier hs-var hs-var">mapField</span></a></span></span><span> </span><span id="local-6989586621690735024"><span class="annot"><span class="annottext">InputFieldsParser m (Maybe a)
</span><a href="#local-6989586621690735024"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621690735023"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621690735023"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621690735023"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InputFieldsParser m (Maybe a)
</span><a href="#local-6989586621690735024"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span id="local-6989586621690735629"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#parsedSelectionsToFields"><span class="hs-identifier hs-type">parsedSelectionsToFields</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-379"></span><span>  </span><span class="hs-comment">-- | how to handle @__typename@ fields</span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690735629"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-381"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">OMap.InsOrdHashMap</span></span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src"><span class="hs-identifier hs-type">G.Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-schema-parsers-1.0.0/opt/doc/html/hasura-schema-parsers/src"><span class="hs-identifier hs-type">P.ParsedSelection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735629"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-382"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#Fields"><span class="hs-identifier hs-type">Fields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735629"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-383"></span><span id="parsedSelectionsToFields"><span class="annot"><span class="annottext">parsedSelectionsToFields :: forall a.
(Text -&gt; a) -&gt; InsOrdHashMap Name (ParsedSelection a) -&gt; Fields a
</span><a href="Hasura.GraphQL.Schema.Common.html#parsedSelectionsToFields"><span class="hs-identifier hs-var hs-var">parsedSelectionsToFields</span></a></span></span><span> </span><span id="local-6989586621690735018"><span class="annot"><span class="annottext">Text -&gt; a
</span><a href="#local-6989586621690735018"><span class="hs-identifier hs-var">mkTypenameFromText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-384"></span><span>  </span><span class="annot"><span class="annottext">forall k v. InsOrdHashMap k v -&gt; [(k, v)]
</span><span class="hs-identifier hs-var">OMap.toList</span></span><span>
</span><span id="line-385"></span><span>    </span><span class="annot"><span class="annottext">forall {k} (cat :: k -&gt; k -&gt; *) (a :: k) (b :: k) (c :: k).
Category cat =&gt;
cat a b -&gt; cat b c -&gt; cat a c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; FieldName
</span><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-var">FieldName</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src"><span class="hs-identifier hs-var">G.unName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) b c b' c'.
Arrow a =&gt;
a b c -&gt; a b' c' -&gt; a (b, b') (c, c')
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">***</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. (Name -&gt; a) -&gt; ParsedSelection a -&gt; a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-schema-parsers-1.0.0/opt/doc/html/hasura-schema-parsers/src"><span class="hs-identifier hs-var">P.handleTypename</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; a
</span><a href="#local-6989586621690735018"><span class="hs-identifier hs-var">mkTypenameFromText</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src"><span class="hs-identifier hs-var">G.unName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#numericAggOperators"><span class="hs-identifier hs-type">numericAggOperators</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src"><span class="hs-identifier hs-type">G.Name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-388"></span><span id="numericAggOperators"><span class="annot"><span class="annottext">numericAggOperators :: [Name]
</span><a href="Hasura.GraphQL.Schema.Common.html#numericAggOperators"><span class="hs-identifier hs-var hs-var">numericAggOperators</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-389"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Hasura.Name.html#_sum"><span class="hs-identifier hs-var">Name._sum</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-390"></span><span>    </span><span class="annot"><span class="annottext">Name
</span><a href="Hasura.Name.html#_avg"><span class="hs-identifier hs-var">Name._avg</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-391"></span><span>    </span><span class="annot"><span class="annottext">Name
</span><a href="Hasura.Name.html#_stddev"><span class="hs-identifier hs-var">Name._stddev</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-392"></span><span>    </span><span class="annot"><span class="annottext">Name
</span><a href="Hasura.Name.html#_stddev_samp"><span class="hs-identifier hs-var">Name._stddev_samp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-393"></span><span>    </span><span class="annot"><span class="annottext">Name
</span><a href="Hasura.Name.html#_stddev_pop"><span class="hs-identifier hs-var">Name._stddev_pop</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-394"></span><span>    </span><span class="annot"><span class="annottext">Name
</span><a href="Hasura.Name.html#_variance"><span class="hs-identifier hs-var">Name._variance</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-395"></span><span>    </span><span class="annot"><span class="annottext">Name
</span><a href="Hasura.Name.html#_var_samp"><span class="hs-identifier hs-var">Name._var_samp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-396"></span><span>    </span><span class="annot"><span class="annottext">Name
</span><a href="Hasura.Name.html#_var_pop"><span class="hs-identifier hs-var">Name._var_pop</span></a></span><span>
</span><span id="line-397"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#comparisonAggOperators"><span class="hs-identifier hs-type">comparisonAggOperators</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src"><span class="hs-identifier hs-type">G.Name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-400"></span><span id="comparisonAggOperators"><span class="annot"><span class="annottext">comparisonAggOperators :: [Name]
</span><a href="Hasura.GraphQL.Schema.Common.html#comparisonAggOperators"><span class="hs-identifier hs-var hs-var">comparisonAggOperators</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src"><span class="hs-identifier hs-type">G.litName</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;max&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src"><span class="hs-identifier hs-type">G.litName</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;min&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#mkDescriptionWith"><span class="hs-identifier hs-type">mkDescriptionWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#PGDescription"><span class="hs-identifier hs-type">Postgres.PGDescription</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src"><span class="hs-identifier hs-type">G.Description</span></a></span><span>
</span><span id="line-403"></span><span id="mkDescriptionWith"><span class="annot"><span class="annottext">mkDescriptionWith :: Maybe PGDescription -&gt; Text -&gt; Description
</span><a href="Hasura.GraphQL.Schema.Common.html#mkDescriptionWith"><span class="hs-identifier hs-var hs-var">mkDescriptionWith</span></a></span></span><span> </span><span id="local-6989586621690735000"><span class="annot"><span class="annottext">Maybe PGDescription
</span><a href="#local-6989586621690735000"><span class="hs-identifier hs-var">descM</span></a></span></span><span> </span><span id="local-6989586621690734999"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690734999"><span class="hs-identifier hs-var">defaultTxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Description
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src"><span class="hs-identifier hs-var">G.Description</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe PGDescription
</span><a href="#local-6989586621690735000"><span class="hs-identifier hs-var">descM</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-404"></span><span>  </span><span class="annot"><span class="annottext">Maybe PGDescription
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690734999"><span class="hs-identifier hs-var">defaultTxt</span></a></span><span>
</span><span id="line-405"></span><span>  </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#PGDescription"><span class="hs-identifier hs-type">Postgres.PGDescription</span></a></span><span> </span><span id="local-6989586621690734996"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690734996"><span class="hs-identifier hs-var">descTxt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.unlines</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690734996"><span class="hs-identifier hs-var">descTxt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690734999"><span class="hs-identifier hs-var">defaultTxt</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span class="hs-comment">-- TODO why do we do these validations at this point? What does it mean to track</span><span>
</span><span id="line-408"></span><span class="hs-comment">--      a function but not add it to the schema...?</span><span>
</span><span id="line-409"></span><span class="hs-comment">--      Auke:</span><span>
</span><span id="line-410"></span><span class="hs-comment">--        I believe the intention is simply to allow the console to do postgres data management</span><span>
</span><span id="line-411"></span><span class="hs-comment">--      Karthikeyan: Yes, this is correct. We allowed this pre PDV but somehow</span><span>
</span><span id="line-412"></span><span class="hs-comment">--        got removed in PDV. OTOH, I&#8217;m not sure how prevalent this feature</span><span>
</span><span id="line-413"></span><span class="hs-comment">--        actually is</span><span>
</span><span id="line-414"></span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#takeValidTables"><span class="hs-identifier hs-type">takeValidTables</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621690735604"><span class="annot"><a href="#local-6989586621690735604"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735604"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Table.html#TableCache"><span class="hs-identifier hs-type">TableCache</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735604"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Table.html#TableCache"><span class="hs-identifier hs-type">TableCache</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735604"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-415"></span><span id="takeValidTables"><span class="annot"><span class="annottext">takeValidTables :: forall (b :: BackendType).
Backend b =&gt;
TableCache b -&gt; TableCache b
</span><a href="Hasura.GraphQL.Schema.Common.html#takeValidTables"><span class="hs-identifier hs-var hs-var">takeValidTables</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k v. (k -&gt; v -&gt; Bool) -&gt; HashMap k v -&gt; HashMap k v
</span><span class="hs-identifier hs-var">Map.filterWithKey</span></span><span> </span><span class="annot"><span class="annottext">TableName b -&gt; TableInfo b -&gt; Bool
</span><a href="#local-6989586621690734991"><span class="hs-identifier hs-var">graphQLTableFilter</span></a></span><span>
</span><span id="line-416"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-417"></span><span>    </span><span id="local-6989586621690734991"><span class="annot"><span class="annottext">graphQLTableFilter :: TableName b -&gt; TableInfo b -&gt; Bool
</span><a href="#local-6989586621690734991"><span class="hs-identifier hs-var hs-var">graphQLTableFilter</span></a></span></span><span> </span><span id="local-6989586621690734990"><span class="annot"><span class="annottext">TableName b
</span><a href="#local-6989586621690734990"><span class="hs-identifier hs-var">tableName</span></a></span></span><span> </span><span id="local-6989586621690734989"><span class="annot"><span class="annottext">TableInfo b
</span><a href="#local-6989586621690734989"><span class="hs-identifier hs-var">tableInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-418"></span><span>      </span><span class="hs-comment">-- either the table name should be GraphQL compliant</span><span>
</span><span id="line-419"></span><span>      </span><span class="hs-comment">-- or it should have a GraphQL custom name set with it</span><span>
</span><span id="line-420"></span><span>      </span><span class="annot"><span class="annottext">forall a b. Either a b -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">isRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType).
Backend b =&gt;
TableName b -&gt; Either QErr Name
</span><a href="Hasura.RQL.Types.Backend.html#tableGraphQLName"><span class="hs-identifier hs-var">tableGraphQLName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621690735604"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="annottext">TableName b
</span><a href="#local-6989586621690734990"><span class="hs-identifier hs-var">tableName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">isJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType). TableConfig b -&gt; Maybe Name
</span><a href="Hasura.RQL.Types.Table.html#_tcCustomName"><span class="hs-identifier hs-var">_tcCustomName</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) field primaryKeyColumn.
TableCoreInfoG b field primaryKeyColumn -&gt; TableConfig b
</span><a href="Hasura.RQL.Types.Table.html#_tciCustomConfig"><span class="hs-identifier hs-var">_tciCustomConfig</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType). TableInfo b -&gt; TableCoreInfo b
</span><a href="Hasura.RQL.Types.Table.html#_tiCoreInfo"><span class="hs-identifier hs-var">_tiCoreInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TableInfo b
</span><a href="#local-6989586621690734989"><span class="hs-identifier hs-var">tableInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span class="hs-comment">-- TODO and what about graphql-compliant function names here too?</span><span>
</span><span id="line-424"></span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#takeValidFunctions"><span class="hs-identifier hs-type">takeValidFunctions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621690735589"><span class="annot"><a href="#local-6989586621690735589"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Function.html#FunctionCache"><span class="hs-identifier hs-type">FunctionCache</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735589"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Function.html#FunctionCache"><span class="hs-identifier hs-type">FunctionCache</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735589"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-425"></span><span id="takeValidFunctions"><span class="annot"><span class="annottext">takeValidFunctions :: forall (b :: BackendType). FunctionCache b -&gt; FunctionCache b
</span><a href="Hasura.GraphQL.Schema.Common.html#takeValidFunctions"><span class="hs-identifier hs-var hs-var">takeValidFunctions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v k. (v -&gt; Bool) -&gt; HashMap k v -&gt; HashMap k v
</span><span class="hs-identifier hs-var">Map.filter</span></span><span> </span><span class="annot"><span class="annottext">forall {b :: BackendType}. FunctionInfo b -&gt; Bool
</span><a href="#local-6989586621690734981"><span class="hs-identifier hs-var">functionFilter</span></a></span><span>
</span><span id="line-426"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-427"></span><span>    </span><span id="local-6989586621690734981"><span class="annot"><span class="annottext">functionFilter :: FunctionInfo b -&gt; Bool
</span><a href="#local-6989586621690734981"><span class="hs-identifier hs-var hs-var">functionFilter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SystemDefined -&gt; Bool
</span><a href="Hasura.RQL.Types.Common.html#isSystemDefined"><span class="hs-identifier hs-var">isSystemDefined</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType). FunctionInfo b -&gt; SystemDefined
</span><a href="Hasura.RQL.Types.Function.html#_fiSystemDefined"><span class="hs-identifier hs-var">_fiSystemDefined</span></a></span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span class="hs-comment">-- root field builder helpers</span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span id="local-6989586621690735579"><span id="local-6989586621690735580"><span id="local-6989586621690735581"><span id="local-6989586621690735582"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#requiredFieldParser"><span class="hs-identifier hs-type">requiredFieldParser</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-432"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735582"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735581"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-433"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621690735580"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690735579"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-434"></span><span>  </span><span class="annot"><a href="#local-6989586621690735581"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Schema.Parser.html#FieldParser"><span class="hs-identifier hs-type">P.FieldParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735582"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735580"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-435"></span><span>  </span><span class="annot"><a href="#local-6989586621690735581"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Schema.Parser.html#FieldParser"><span class="hs-identifier hs-type">P.FieldParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735582"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735579"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-436"></span><span id="requiredFieldParser"><span class="annot"><span class="annottext">requiredFieldParser :: forall (n :: * -&gt; *) (m :: * -&gt; *) a b.
(Functor n, Functor m) =&gt;
(a -&gt; b) -&gt; m (FieldParser n a) -&gt; m (Maybe (FieldParser n b))
</span><a href="Hasura.GraphQL.Schema.Common.html#requiredFieldParser"><span class="hs-identifier hs-var hs-var">requiredFieldParser</span></a></span></span><span> </span><span id="local-6989586621690734972"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621690734972"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621690734972"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-437"></span><span>
</span><span id="line-438"></span><span id="local-6989586621690735568"><span id="local-6989586621690735569"><span id="local-6989586621690735570"><span id="local-6989586621690735571"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#optionalFieldParser"><span class="hs-identifier hs-type">optionalFieldParser</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-439"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735571"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735570"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-440"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621690735569"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690735568"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-441"></span><span>  </span><span class="annot"><a href="#local-6989586621690735570"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Schema.Parser.html#FieldParser"><span class="hs-identifier hs-type">P.FieldParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735571"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735569"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-442"></span><span>  </span><span class="annot"><a href="#local-6989586621690735570"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Schema.Parser.html#FieldParser"><span class="hs-identifier hs-type">P.FieldParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735571"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735568"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-443"></span><span id="optionalFieldParser"><span class="annot"><span class="annottext">optionalFieldParser :: forall (n :: * -&gt; *) (m :: * -&gt; *) a b.
(Functor n, Functor m) =&gt;
(a -&gt; b)
-&gt; m (Maybe (FieldParser n a)) -&gt; m (Maybe (FieldParser n b))
</span><a href="Hasura.GraphQL.Schema.Common.html#optionalFieldParser"><span class="hs-identifier hs-var hs-var">optionalFieldParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span class="hs-comment">-- | Builds the type name for referenced enum tables.</span><span>
</span><span id="line-446"></span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#mkEnumTypeName"><span class="hs-identifier hs-type">mkEnumTypeName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621690735563"><span class="annot"><a href="#local-6989586621690735563"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621690735561"><span class="annot"><a href="#local-6989586621690735561"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621690735562"><span class="annot"><a href="#local-6989586621690735562"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735563"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735562"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Has</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Source.html#SourceInfo"><span class="hs-identifier hs-type">SourceInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735563"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621690735561"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#TableName"><span class="hs-identifier hs-type">TableName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735563"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src"><span class="hs-identifier hs-type">G.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaT"><span class="hs-identifier hs-type">SchemaT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735561"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735562"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src"><span class="hs-identifier hs-type">G.Name</span></a></span><span>
</span><span id="line-447"></span><span id="mkEnumTypeName"><span class="annot"><span class="annottext">mkEnumTypeName :: forall (b :: BackendType) r (m :: * -&gt; *).
(Backend b, MonadError QErr m, Has (SourceInfo b) r) =&gt;
TableName b -&gt; Maybe Name -&gt; SchemaT r m Name
</span><a href="Hasura.GraphQL.Schema.Common.html#mkEnumTypeName"><span class="hs-identifier hs-var hs-var">mkEnumTypeName</span></a></span></span><span> </span><span id="local-6989586621690734953"><span class="annot"><span class="annottext">TableName b
</span><a href="#local-6989586621690734953"><span class="hs-identifier hs-var">enumTableName</span></a></span></span><span> </span><span id="local-6989586621690734952"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621690734952"><span class="hs-identifier hs-var">enumTableCustomName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-448"></span><span>  </span><span id="local-6989586621690734951"><span class="annot"><span class="annottext">ResolvedSourceCustomization
</span><a href="#local-6989586621690734951"><span class="hs-identifier hs-var">customization</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a b.
(MonadReader r m, Has a r) =&gt;
(a -&gt; b) -&gt; m b
</span><a href="Hasura.GraphQL.Schema.Common.html#retrieve"><span class="hs-identifier hs-var">retrieve</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType).
SourceInfo b -&gt; ResolvedSourceCustomization
</span><a href="Hasura.RQL.Types.Source.html#_siCustomization"><span class="hs-identifier hs-var">_siCustomization</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621690735563"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-449"></span><span>  </span><span id="local-6989586621690734950"><span class="annot"><span class="annottext">GQLNameIdentifier
</span><a href="#local-6989586621690734950"><span class="hs-identifier hs-var">enumTableGQLName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType).
Backend b =&gt;
TableName b -&gt; Either QErr GQLNameIdentifier
</span><a href="Hasura.RQL.Types.Backend.html#getTableIdentifier"><span class="hs-identifier hs-var">getTableIdentifier</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621690735563"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="annottext">TableName b
</span><a href="#local-6989586621690734953"><span class="hs-identifier hs-var">enumTableName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e a.
Applicative m =&gt;
Either e a -&gt; (e -&gt; m a) -&gt; m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-operator hs-var">`onLeft`</span></a></span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">throwError</span></a></span><span>
</span><span id="line-450"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedSourceCustomization
-&gt; GQLNameIdentifier -&gt; Maybe Name -&gt; Name
</span><a href="Hasura.GraphQL.Schema.Common.html#addEnumSuffix"><span class="hs-identifier hs-var">addEnumSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedSourceCustomization
</span><a href="#local-6989586621690734951"><span class="hs-identifier hs-var">customization</span></a></span><span> </span><span class="annot"><span class="annottext">GQLNameIdentifier
</span><a href="#local-6989586621690734950"><span class="hs-identifier hs-var">enumTableGQLName</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621690734952"><span class="hs-identifier hs-var">enumTableCustomName</span></a></span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#addEnumSuffix"><span class="hs-identifier hs-type">addEnumSuffix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SourceCustomization.html#ResolvedSourceCustomization"><span class="hs-identifier hs-type">ResolvedSourceCustomization</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Text.Casing.html#GQLNameIdentifier"><span class="hs-identifier hs-type">GQLNameIdentifier</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src"><span class="hs-identifier hs-type">G.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src"><span class="hs-identifier hs-type">G.Name</span></a></span><span>
</span><span id="line-453"></span><span id="addEnumSuffix"><span class="annot"><span class="annottext">addEnumSuffix :: ResolvedSourceCustomization
-&gt; GQLNameIdentifier -&gt; Maybe Name -&gt; Name
</span><a href="Hasura.GraphQL.Schema.Common.html#addEnumSuffix"><span class="hs-identifier hs-var hs-var">addEnumSuffix</span></a></span></span><span> </span><span id="local-6989586621690734946"><span class="annot"><span class="annottext">ResolvedSourceCustomization
</span><a href="#local-6989586621690734946"><span class="hs-identifier hs-var">customization</span></a></span></span><span> </span><span id="local-6989586621690734945"><span class="annot"><span class="annottext">GQLNameIdentifier
</span><a href="#local-6989586621690734945"><span class="hs-identifier hs-var">enumTableGQLName</span></a></span></span><span> </span><span id="local-6989586621690734944"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621690734944"><span class="hs-identifier hs-var">enumTableCustomName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-454"></span><span>  </span><span class="annot"><span class="annottext">MkTypename -&gt; Name -&gt; Name
</span><a href="Hasura.GraphQL.Schema.Typename.html#runMkTypename"><span class="hs-identifier hs-var">runMkTypename</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedSourceCustomization -&gt; MkTypename
</span><a href="Hasura.RQL.Types.SourceCustomization.html#_rscTypeNames"><span class="hs-identifier hs-var">_rscTypeNames</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedSourceCustomization
</span><a href="#local-6989586621690734946"><span class="hs-identifier hs-var">customization</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-455"></span><span>    </span><span class="annot"><span class="annottext">NamingCase -&gt; GQLNameIdentifier -&gt; Name
</span><a href="Hasura.RQL.Types.SourceCustomization.html#applyTypeNameCaseIdentifier"><span class="hs-identifier hs-var">applyTypeNameCaseIdentifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedSourceCustomization -&gt; NamingCase
</span><a href="Hasura.RQL.Types.SourceCustomization.html#_rscNamingConvention"><span class="hs-identifier hs-var">_rscNamingConvention</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedSourceCustomization
</span><a href="#local-6989586621690734946"><span class="hs-identifier hs-var">customization</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-456"></span><span>      </span><span class="annot"><span class="annottext">GQLNameIdentifier -&gt; Maybe Name -&gt; GQLNameIdentifier
</span><a href="Hasura.RQL.Types.SourceCustomization.html#mkEnumTableTypeName"><span class="hs-identifier hs-var">mkEnumTableTypeName</span></a></span><span> </span><span class="annot"><span class="annottext">GQLNameIdentifier
</span><a href="#local-6989586621690734945"><span class="hs-identifier hs-var">enumTableGQLName</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621690734944"><span class="hs-identifier hs-var">enumTableCustomName</span></a></span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span class="hs-comment">-- TODO: figure out what the purpose of this method is.</span><span>
</span><span id="line-459"></span><span id="local-6989586621690735550"><span id="local-6989586621690735553"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#peelWithOrigin"><span class="hs-identifier hs-type">peelWithOrigin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-schema-parsers-1.0.0/opt/doc/html/hasura-schema-parsers/src"><span class="hs-identifier hs-type">P.MonadParse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735553"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Parser.html#Parser"><span class="hs-identifier hs-type">P.Parser</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-schema-parsers-1.0.0/opt/doc/html/hasura-schema-parsers/src"><span class="hs-identifier hs-type">P.Both</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735553"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735550"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Parser.html#Parser"><span class="hs-identifier hs-type">P.Parser</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-schema-parsers-1.0.0/opt/doc/html/hasura-schema-parsers/src"><span class="hs-identifier hs-type">P.Both</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735553"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Value.html#ValueWithOrigin"><span class="hs-identifier hs-type">IR.ValueWithOrigin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735550"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-460"></span><span id="peelWithOrigin"><span class="annot"><span class="annottext">peelWithOrigin :: forall (m :: * -&gt; *) a.
MonadParse m =&gt;
Parser 'Both m a -&gt; Parser 'Both m (ValueWithOrigin a)
</span><a href="Hasura.GraphQL.Schema.Common.html#peelWithOrigin"><span class="hs-identifier hs-var hs-var">peelWithOrigin</span></a></span></span><span> </span><span id="local-6989586621690734927"><span class="annot"><span class="annottext">Parser 'Both m a
</span><a href="#local-6989586621690734927"><span class="hs-identifier hs-var">parser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-461"></span><span>  </span><span class="annot"><span class="annottext">Parser 'Both m a
</span><a href="#local-6989586621690734927"><span class="hs-identifier hs-var">parser</span></a></span><span>
</span><span id="line-462"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">pParser :: ParserInput 'Both -&gt; m (ValueWithOrigin a)
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-schema-parsers-1.0.0/opt/doc/html/hasura-schema-parsers/src"><span class="hs-identifier hs-var">P.pParser</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-463"></span><span>        </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-schema-parsers-1.0.0/opt/doc/html/hasura-schema-parsers/src"><span class="hs-identifier hs-type">P.GraphQLValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src"><span class="hs-identifier hs-type">G.VVariable</span></a></span><span> </span><span id="local-6989586621690734923"><span class="annot"><span class="annottext">var :: Variable
</span><a href="#local-6989586621690734923"><span class="hs-identifier hs-var">var</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-schema-parsers-1.0.0/opt/doc/html/hasura-schema-parsers/src"><span class="hs-identifier hs-type">P.Variable</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621690734921"><span class="annot"><span class="annottext">VariableInfo
vInfo :: Variable -&gt; VariableInfo
vInfo :: VariableInfo
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-schema-parsers-1.0.0/opt/doc/html/hasura-schema-parsers/src"><span class="hs-identifier hs-var hs-var">vInfo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690734919"><span class="annot"><span class="annottext">InputValue Void
vValue :: Variable -&gt; InputValue Void
vValue :: InputValue Void
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-schema-parsers-1.0.0/opt/doc/html/hasura-schema-parsers/src"><span class="hs-identifier hs-var hs-var">vValue</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-464"></span><span>          </span><span class="hs-comment">-- Check types c.f. 5.8.5 of the June 2018 GraphQL spec</span><span>
</span><span id="line-465"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadParse m =&gt;
Bool -&gt; GType -&gt; Variable -&gt; m ()
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-schema-parsers-1.0.0/opt/doc/html/hasura-schema-parsers/src"><span class="hs-identifier hs-var">P.typeCheck</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall origin (k :: Kind). Type origin k -&gt; GType
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-schema-parsers-1.0.0/opt/doc/html/hasura-schema-parsers/src"><span class="hs-identifier hs-var">P.toGraphQLType</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall origin (k :: Kind) (m :: * -&gt; *) a.
Parser origin k m a -&gt; Type origin k
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-schema-parsers-1.0.0/opt/doc/html/hasura-schema-parsers/src"><span class="hs-identifier hs-var">P.pType</span></a></span><span> </span><span class="annot"><span class="annottext">Parser 'Both m a
</span><a href="#local-6989586621690734927"><span class="hs-identifier hs-var">parser</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621690734923"><span class="hs-identifier hs-var">var</span></a></span><span>
</span><span id="line-466"></span><span>          </span><span class="annot"><span class="annottext">forall a. VariableInfo -&gt; a -&gt; ValueWithOrigin a
</span><a href="Hasura.RQL.IR.Value.html#ValueWithOrigin"><span class="hs-identifier hs-var">IR.ValueWithOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">VariableInfo
</span><a href="#local-6989586621690734921"><span class="hs-identifier hs-var">vInfo</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall origin (k :: Kind) (m :: * -&gt; *) a.
Parser origin k m a -&gt; ParserInput k -&gt; m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-schema-parsers-1.0.0/opt/doc/html/hasura-schema-parsers/src"><span class="hs-identifier hs-var">P.pParser</span></a></span><span> </span><span class="annot"><span class="annottext">Parser 'Both m a
</span><a href="#local-6989586621690734927"><span class="hs-identifier hs-var">parser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Void -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">absurd</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">InputValue Void
</span><a href="#local-6989586621690734919"><span class="hs-identifier hs-var">vValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span>        </span><span id="local-6989586621690734911"><span class="annot"><span class="annottext">ParserInput 'Both
</span><a href="#local-6989586621690734911"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; ValueWithOrigin a
</span><a href="Hasura.RQL.IR.Value.html#ValueNoOrigin"><span class="hs-identifier hs-var">IR.ValueNoOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall origin (k :: Kind) (m :: * -&gt; *) a.
Parser origin k m a -&gt; ParserInput k -&gt; m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-schema-parsers-1.0.0/opt/doc/html/hasura-schema-parsers/src"><span class="hs-identifier hs-var">P.pParser</span></a></span><span> </span><span class="annot"><span class="annottext">Parser 'Both m a
</span><a href="#local-6989586621690734927"><span class="hs-identifier hs-var">parser</span></a></span><span> </span><span class="annot"><span class="annottext">ParserInput 'Both
</span><a href="#local-6989586621690734911"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-468"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span id="local-6989586621690735518"><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#getIntrospectionResult"><span class="hs-identifier hs-type">getIntrospectionResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Options.html#RemoteSchemaPermissions"><span class="hs-identifier hs-type">Options.RemoteSchemaPermissions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Session.html#RoleName"><span class="hs-identifier hs-type">RoleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RemoteSchema.SchemaCache.Types.html#RemoteSchemaCtxG"><span class="hs-identifier hs-type">RemoteSchemaCtxG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690735518"><span class="hs-identifier hs-type">remoteFieldInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Hasura.RemoteSchema.SchemaCache.Types.html#IntrospectionResult"><span class="hs-identifier hs-type">IntrospectionResult</span></a></span></span><span>
</span><span id="line-471"></span><span id="getIntrospectionResult"><span class="annot"><span class="annottext">getIntrospectionResult :: forall remoteFieldInfo.
RemoteSchemaPermissions
-&gt; RoleName
-&gt; RemoteSchemaCtxG remoteFieldInfo
-&gt; Maybe IntrospectionResult
</span><a href="Hasura.GraphQL.Schema.Common.html#getIntrospectionResult"><span class="hs-identifier hs-var hs-var">getIntrospectionResult</span></a></span></span><span> </span><span id="local-6989586621690734900"><span class="annot"><span class="annottext">RemoteSchemaPermissions
</span><a href="#local-6989586621690734900"><span class="hs-identifier hs-var">remoteSchemaPermsCtx</span></a></span></span><span> </span><span id="local-6989586621690734899"><span class="annot"><span class="annottext">RoleName
</span><a href="#local-6989586621690734899"><span class="hs-keyword hs-var">role</span></a></span></span><span> </span><span id="local-6989586621690734898"><span class="annot"><span class="annottext">RemoteSchemaCtxG remoteFieldInfo
</span><a href="#local-6989586621690734898"><span class="hs-identifier hs-var">remoteSchemaContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-keyword">if</span><span>
</span><span id="line-473"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- admin doesn't have a custom annotated introspection, defaulting to the original one</span><span>
</span><span id="line-474"></span><span>        </span><span class="annot"><span class="annottext">RoleName
</span><a href="#local-6989586621690734899"><span class="hs-keyword hs-var">role</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">RoleName
</span><a href="Hasura.Session.html#adminRoleName"><span class="hs-identifier hs-var">adminRoleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-475"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall remoteFieldInfo.
RemoteSchemaCtxG remoteFieldInfo -&gt; IntrospectionResult
</span><a href="Hasura.RemoteSchema.SchemaCache.Types.html#_rscIntroOriginal"><span class="hs-identifier hs-var">_rscIntroOriginal</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteSchemaCtxG remoteFieldInfo
</span><a href="#local-6989586621690734898"><span class="hs-identifier hs-var">remoteSchemaContext</span></a></span><span>
</span><span id="line-476"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- if permissions are disabled, the role map will be empty, defaulting to the original one</span><span>
</span><span id="line-477"></span><span>        </span><span class="annot"><span class="annottext">RemoteSchemaPermissions
</span><a href="#local-6989586621690734900"><span class="hs-identifier hs-var">remoteSchemaPermsCtx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteSchemaPermissions
</span><a href="Hasura.GraphQL.Schema.Options.html#DisableRemoteSchemaPermissions"><span class="hs-identifier hs-var">Options.DisableRemoteSchemaPermissions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-478"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall remoteFieldInfo.
RemoteSchemaCtxG remoteFieldInfo -&gt; IntrospectionResult
</span><a href="Hasura.RemoteSchema.SchemaCache.Types.html#_rscIntroOriginal"><span class="hs-identifier hs-var">_rscIntroOriginal</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteSchemaCtxG remoteFieldInfo
</span><a href="#local-6989586621690734898"><span class="hs-identifier hs-var">remoteSchemaContext</span></a></span><span>
</span><span id="line-479"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- otherwise, look the role up in the map; if we find nothing, then the role doesn't have access</span><span>
</span><span id="line-480"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-481"></span><span>          </span><span class="annot"><span class="annottext">forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">RoleName
</span><a href="#local-6989586621690734899"><span class="hs-keyword hs-var">role</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall remoteFieldInfo.
RemoteSchemaCtxG remoteFieldInfo
-&gt; HashMap RoleName IntrospectionResult
</span><a href="Hasura.RemoteSchema.SchemaCache.Types.html#_rscPermissions"><span class="hs-identifier hs-var">_rscPermissions</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteSchemaCtxG remoteFieldInfo
</span><a href="#local-6989586621690734898"><span class="hs-identifier hs-var">remoteSchemaContext</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span></pre></body></html>