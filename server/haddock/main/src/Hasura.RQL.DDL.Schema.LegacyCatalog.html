<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE QuasiQuotes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-comment">-- | Funtions related to @hdb_catalog@ schema prior to metadata separation (catalog version &lt; 43).</span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hasura.RQL.DDL.Schema.LegacyCatalog</span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#saveMetadataToHdbTables"><span class="hs-identifier">saveMetadataToHdbTables</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#fetchMetadataFromHdbTables"><span class="hs-identifier">fetchMetadataFromHdbTables</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#recreateSystemMetadata"><span class="hs-identifier">recreateSystemMetadata</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addCronTriggerForeignKeyConstraint"><span class="hs-identifier">addCronTriggerForeignKeyConstraint</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><span class="hs-comment">-- * export for testing</span></span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#parseLegacyRemoteRelationshipDefinition"><span class="hs-identifier">parseLegacyRemoteRelationshipDefinition</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">where</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(.=)</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.FileEmbed</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">makeRelativeToProject</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HM</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict.InsOrd</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">OMap</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Text.Extended.html"><span class="hs-identifier">Data.Text.Extended</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator">(&lt;&lt;&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Text.NonEmpty.html"><span class="hs-identifier">Data.Text.NonEmpty</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/time-1.11.1.1/src"><span class="hs-identifier">Data.Time.Clock</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier">Database.PG.Query</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PG</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.html"><span class="hs-identifier">Hasura.Backends.Postgres.Connection</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html"><span class="hs-identifier">Hasura.Backends.Postgres.SQL.Types</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Postgres</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Base.Error.html"><span class="hs-identifier">Hasura.Base.Error</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Eventing.ScheduledTrigger.html"><span class="hs-identifier">Hasura.Eventing.ScheduledTrigger</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier">Hasura.Prelude</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html"><span class="hs-identifier">Hasura.RQL.DDL.Action</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.ComputedField.html"><span class="hs-identifier">Hasura.RQL.DDL.ComputedField</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Permission.html"><span class="hs-identifier">Hasura.RQL.DDL.Permission</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.RemoteRelationship.html"><span class="hs-identifier">Hasura.RQL.DDL.RemoteRelationship</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Action.html"><span class="hs-identifier">Hasura.RQL.Types.Action</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Allowlist.html"><span class="hs-identifier">Hasura.RQL.Types.Allowlist</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html"><span class="hs-identifier">Hasura.RQL.Types.Backend</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html"><span class="hs-identifier">Hasura.RQL.Types.Common</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.CustomTypes.html"><span class="hs-identifier">Hasura.RQL.Types.CustomTypes</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html"><span class="hs-identifier">Hasura.RQL.Types.EventTrigger</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Function.html"><span class="hs-identifier">Hasura.RQL.Types.Function</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.html"><span class="hs-identifier">Hasura.RQL.Types.Metadata</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Permission.html"><span class="hs-identifier">Hasura.RQL.Types.Permission</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.QueryCollection.html"><span class="hs-identifier">Hasura.RQL.Types.QueryCollection</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html"><span class="hs-identifier">Hasura.RQL.Types.Relationships.Local</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Remote.html"><span class="hs-identifier">Hasura.RQL.Types.Relationships.Remote</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.ScheduledTrigger.html"><span class="hs-identifier">Hasura.RQL.Types.ScheduledTrigger</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html"><span class="hs-identifier">Hasura.RQL.Types.SchemaCache</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RemoteSchema.Metadata.html"><span class="hs-identifier">Hasura.RemoteSchema.Metadata</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.SQL.Backend.html"><span class="hs-identifier">Hasura.SQL.Backend</span></a></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span id="local-6989586621690602519"><span class="annot"><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#saveMetadataToHdbTables"><span class="hs-identifier hs-type">saveMetadataToHdbTables</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602519"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#SystemDefined"><span class="hs-identifier hs-type">SystemDefined</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602519"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.html#MetadataNoSources"><span class="hs-identifier hs-type">MetadataNoSources</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690602519"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-53"></span><span id="saveMetadataToHdbTables"><span class="annot"><span class="annottext">saveMetadataToHdbTables :: forall (m :: * -&gt; *).
(MonadTx m, MonadReader SystemDefined m) =&gt;
MetadataNoSources -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#saveMetadataToHdbTables"><span class="hs-identifier hs-var hs-var">saveMetadataToHdbTables</span></a></span></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.html#MetadataNoSources"><span class="hs-identifier hs-type">MetadataNoSources</span></a></span><span>
</span><span id="line-55"></span><span>      </span><span id="local-6989586621690601799"><span class="annot"><span class="annottext">Tables ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601799"><span class="hs-identifier hs-var">tables</span></a></span></span><span>
</span><span id="line-56"></span><span>      </span><span id="local-6989586621690601798"><span class="annot"><span class="annottext">Functions ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601798"><span class="hs-identifier hs-var">functions</span></a></span></span><span>
</span><span id="line-57"></span><span>      </span><span id="local-6989586621690601797"><span class="annot"><span class="annottext">RemoteSchemas
</span><a href="#local-6989586621690601797"><span class="hs-identifier hs-var">schemas</span></a></span></span><span>
</span><span id="line-58"></span><span>      </span><span id="local-6989586621690601796"><span class="annot"><span class="annottext">QueryCollections
</span><a href="#local-6989586621690601796"><span class="hs-identifier hs-var">collections</span></a></span></span><span>
</span><span id="line-59"></span><span>      </span><span id="local-6989586621690601795"><span class="annot"><span class="annottext">MetadataAllowlist
</span><a href="#local-6989586621690601795"><span class="hs-identifier hs-var">allowlist</span></a></span></span><span>
</span><span id="line-60"></span><span>      </span><span id="local-6989586621690601794"><span class="annot"><span class="annottext">CustomTypes
</span><a href="#local-6989586621690601794"><span class="hs-identifier hs-var">customTypes</span></a></span></span><span>
</span><span id="line-61"></span><span>      </span><span id="local-6989586621690601793"><span class="annot"><span class="annottext">Actions
</span><a href="#local-6989586621690601793"><span class="hs-identifier hs-var">actions</span></a></span></span><span>
</span><span id="line-62"></span><span>      </span><span id="local-6989586621690601792"><span class="annot"><span class="annottext">CronTriggers
</span><a href="#local-6989586621690601792"><span class="hs-identifier hs-var">cronTriggers</span></a></span></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;tables&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-65"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (t :: * -&gt; *) a b.
(QErrM m, Foldable t) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="Hasura.Base.Error.html#indexedForM_"><span class="hs-identifier hs-var">indexedForM_</span></a></span><span> </span><span class="annot"><span class="annottext">Tables ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601799"><span class="hs-identifier hs-var">tables</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><a href="Hasura.RQL.Types.Metadata.Common.html#TableMetadata"><span class="hs-identifier hs-type">TableMetadata</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621690601776"><span id="local-6989586621690601777"><span id="local-6989586621690601778"><span id="local-6989586621690601779"><span id="local-6989586621690601780"><span id="local-6989586621690601781"><span id="local-6989586621690601782"><span id="local-6989586621690601783"><span id="local-6989586621690601784"><span id="local-6989586621690601785"><span id="local-6989586621690601786"><span id="local-6989586621690601787"><span id="local-6989586621690601788"><span class="annot"><span class="annottext">Bool
Maybe ApolloFederationConfig
RemoteRelationships
Relationships (ObjRelDef ('Postgres 'Vanilla))
Relationships (ArrRelDef ('Postgres 'Vanilla))
Permissions (UpdPermDef ('Postgres 'Vanilla))
Permissions (DelPermDef ('Postgres 'Vanilla))
Permissions (SelPermDef ('Postgres 'Vanilla))
Permissions (InsPermDef ('Postgres 'Vanilla))
ComputedFields ('Postgres 'Vanilla)
EventTriggers ('Postgres 'Vanilla)
TableName ('Postgres 'Vanilla)
TableConfig ('Postgres 'Vanilla)
_tmApolloFederationConfig :: forall (b :: BackendType).
TableMetadata b -&gt; Maybe ApolloFederationConfig
_tmEventTriggers :: forall (b :: BackendType). TableMetadata b -&gt; EventTriggers b
_tmDeletePermissions :: forall (b :: BackendType).
TableMetadata b -&gt; Permissions (DelPermDef b)
_tmUpdatePermissions :: forall (b :: BackendType).
TableMetadata b -&gt; Permissions (UpdPermDef b)
_tmSelectPermissions :: forall (b :: BackendType).
TableMetadata b -&gt; Permissions (SelPermDef b)
_tmInsertPermissions :: forall (b :: BackendType).
TableMetadata b -&gt; Permissions (InsPermDef b)
_tmRemoteRelationships :: forall (b :: BackendType). TableMetadata b -&gt; RemoteRelationships
_tmComputedFields :: forall (b :: BackendType). TableMetadata b -&gt; ComputedFields b
_tmArrayRelationships :: forall (b :: BackendType).
TableMetadata b -&gt; Relationships (ArrRelDef b)
_tmObjectRelationships :: forall (b :: BackendType).
TableMetadata b -&gt; Relationships (ObjRelDef b)
_tmConfiguration :: forall (b :: BackendType). TableMetadata b -&gt; TableConfig b
_tmIsEnum :: forall (b :: BackendType). TableMetadata b -&gt; Bool
_tmTable :: forall (b :: BackendType). TableMetadata b -&gt; TableName b
_tmApolloFederationConfig :: Maybe ApolloFederationConfig
_tmEventTriggers :: EventTriggers ('Postgres 'Vanilla)
_tmDeletePermissions :: Permissions (DelPermDef ('Postgres 'Vanilla))
_tmUpdatePermissions :: Permissions (UpdPermDef ('Postgres 'Vanilla))
_tmSelectPermissions :: Permissions (SelPermDef ('Postgres 'Vanilla))
_tmInsertPermissions :: Permissions (InsPermDef ('Postgres 'Vanilla))
_tmRemoteRelationships :: RemoteRelationships
_tmComputedFields :: ComputedFields ('Postgres 'Vanilla)
_tmArrayRelationships :: Relationships (ArrRelDef ('Postgres 'Vanilla))
_tmObjectRelationships :: Relationships (ObjRelDef ('Postgres 'Vanilla))
_tmConfiguration :: TableConfig ('Postgres 'Vanilla)
_tmIsEnum :: Bool
_tmTable :: TableName ('Postgres 'Vanilla)
</span><a href="Hasura.RQL.Types.Metadata.Common.html#_tmApolloFederationConfig"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-66"></span><span>        </span><span class="hs-comment">-- Save table</span><span>
</span><span id="line-67"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadTx m, MonadReader SystemDefined m) =&gt;
QualifiedTable -&gt; Bool -&gt; TableConfig ('Postgres 'Vanilla) -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#saveTableToCatalog"><span class="hs-identifier hs-var">saveTableToCatalog</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601788"><span class="hs-identifier hs-var">_tmTable</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690601787"><span class="hs-identifier hs-var">_tmIsEnum</span></a></span><span> </span><span class="annot"><span class="annottext">TableConfig ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601786"><span class="hs-identifier hs-var">_tmConfiguration</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span>        </span><span class="hs-comment">-- Relationships</span><span>
</span><span id="line-70"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;object_relationships&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-71"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (t :: * -&gt; *) a b.
(QErrM m, Foldable t) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="Hasura.Base.Error.html#indexedForM_"><span class="hs-identifier hs-var">indexedForM_</span></a></span><span> </span><span class="annot"><span class="annottext">Relationships (ObjRelDef ('Postgres 'Vanilla))
</span><a href="#local-6989586621690601785"><span class="hs-identifier hs-var">_tmObjectRelationships</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621690601761"><span class="annot"><span class="annottext">ObjRelDef ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601761"><span class="hs-identifier hs-var">objRel</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-72"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadTx m, MonadReader SystemDefined m, ToJSON a) =&gt;
QualifiedTable -&gt; RelType -&gt; RelDef a -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#insertRelationshipToCatalog"><span class="hs-identifier hs-var">insertRelationshipToCatalog</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601788"><span class="hs-identifier hs-var">_tmTable</span></a></span><span> </span><span class="annot"><span class="annottext">RelType
</span><a href="Hasura.RQL.Types.Common.html#ObjRel"><span class="hs-identifier hs-var">ObjRel</span></a></span><span> </span><span class="annot"><span class="annottext">ObjRelDef ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601761"><span class="hs-identifier hs-var">objRel</span></a></span><span>
</span><span id="line-73"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;array_relationships&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-74"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (t :: * -&gt; *) a b.
(QErrM m, Foldable t) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="Hasura.Base.Error.html#indexedForM_"><span class="hs-identifier hs-var">indexedForM_</span></a></span><span> </span><span class="annot"><span class="annottext">Relationships (ArrRelDef ('Postgres 'Vanilla))
</span><a href="#local-6989586621690601784"><span class="hs-identifier hs-var">_tmArrayRelationships</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621690601758"><span class="annot"><span class="annottext">ArrRelDef ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601758"><span class="hs-identifier hs-var">arrRel</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-75"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadTx m, MonadReader SystemDefined m, ToJSON a) =&gt;
QualifiedTable -&gt; RelType -&gt; RelDef a -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#insertRelationshipToCatalog"><span class="hs-identifier hs-var">insertRelationshipToCatalog</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601788"><span class="hs-identifier hs-var">_tmTable</span></a></span><span> </span><span class="annot"><span class="annottext">RelType
</span><a href="Hasura.RQL.Types.Common.html#ArrRel"><span class="hs-identifier hs-var">ArrRel</span></a></span><span> </span><span class="annot"><span class="annottext">ArrRelDef ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601758"><span class="hs-identifier hs-var">arrRel</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span>        </span><span class="hs-comment">-- Computed Fields</span><span>
</span><span id="line-78"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;computed_fields&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-79"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (t :: * -&gt; *) a b.
(QErrM m, Foldable t) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="Hasura.Base.Error.html#indexedForM_"><span class="hs-identifier hs-var">indexedForM_</span></a></span><span> </span><span class="annot"><span class="annottext">ComputedFields ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601783"><span class="hs-identifier hs-var">_tmComputedFields</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-80"></span><span>            </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Metadata.Common.html#ComputedFieldMetadata"><span class="hs-identifier hs-type">ComputedFieldMetadata</span></a></span><span> </span><span id="local-6989586621690601755"><span class="annot"><span class="annottext">ComputedFieldName
</span><a href="#local-6989586621690601755"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621690601754"><span class="annot"><span class="annottext">ComputedFieldDefinition ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601754"><span class="hs-identifier hs-var">definition</span></a></span></span><span> </span><span id="local-6989586621690601753"><span class="annot"><span class="annottext">Comment
</span><a href="#local-6989586621690601753"><span class="hs-identifier hs-var">comment</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-81"></span><span>              </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadTx m =&gt;
AddComputedField ('Postgres 'Vanilla) -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addComputedFieldToCatalog"><span class="hs-identifier hs-var">addComputedFieldToCatalog</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-82"></span><span>                </span><span class="annot"><span class="annottext">forall (b :: BackendType).
SourceName
-&gt; TableName b
-&gt; ComputedFieldName
-&gt; ComputedFieldDefinition b
-&gt; Comment
-&gt; AddComputedField b
</span><a href="Hasura.RQL.DDL.ComputedField.html#AddComputedField"><span class="hs-identifier hs-var">AddComputedField</span></a></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><a href="Hasura.RQL.Types.Common.html#defaultSource"><span class="hs-identifier hs-var">defaultSource</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601788"><span class="hs-identifier hs-var">_tmTable</span></a></span><span> </span><span class="annot"><span class="annottext">ComputedFieldName
</span><a href="#local-6989586621690601755"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ComputedFieldDefinition ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601754"><span class="hs-identifier hs-var">definition</span></a></span><span> </span><span class="annot"><span class="annottext">Comment
</span><a href="#local-6989586621690601753"><span class="hs-identifier hs-var">comment</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span>        </span><span class="hs-comment">-- Remote Relationships</span><span>
</span><span id="line-85"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;remote_relationships&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-86"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (t :: * -&gt; *) a b.
(QErrM m, Foldable t) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="Hasura.Base.Error.html#indexedForM_"><span class="hs-identifier hs-var">indexedForM_</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteRelationships
</span><a href="#local-6989586621690601782"><span class="hs-identifier hs-var">_tmRemoteRelationships</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-87"></span><span>            </span><span class="hs-glyph">\</span><span class="annot"><a href="Hasura.RQL.Types.Common.html#RemoteRelationship"><span class="hs-identifier hs-type">RemoteRelationship</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621690601747"><span id="local-6989586621690601748"><span class="annot"><span class="annottext">RelName
RemoteRelationshipDefinition
_rrDefinition :: forall definition. RemoteRelationshipG definition -&gt; definition
_rrName :: forall definition. RemoteRelationshipG definition -&gt; RelName
_rrDefinition :: RemoteRelationshipDefinition
_rrName :: RelName
</span><a href="Hasura.RQL.Types.Common.html#_rrDefinition"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-88"></span><span>              </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadTx m =&gt;
CreateFromSourceRelationship ('Postgres 'Vanilla) -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addRemoteRelationshipToCatalog"><span class="hs-identifier hs-var">addRemoteRelationshipToCatalog</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-89"></span><span>                </span><span class="annot"><span class="annottext">forall (b :: BackendType).
SourceName
-&gt; TableName b
-&gt; RelName
-&gt; RemoteRelationshipDefinition
-&gt; CreateFromSourceRelationship b
</span><a href="Hasura.RQL.DDL.RemoteRelationship.html#CreateFromSourceRelationship"><span class="hs-identifier hs-var">CreateFromSourceRelationship</span></a></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><a href="Hasura.RQL.Types.Common.html#defaultSource"><span class="hs-identifier hs-var">defaultSource</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601788"><span class="hs-identifier hs-var">_tmTable</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690601748"><span class="hs-identifier hs-var">_rrName</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteRelationshipDefinition
</span><a href="#local-6989586621690601747"><span class="hs-identifier hs-var">_rrDefinition</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span>        </span><span class="hs-comment">-- Permissions</span><span>
</span><span id="line-92"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;insert_permissions&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {b :: BackendType} {t :: * -&gt; *}
       {a :: BackendType -&gt; *}.
(MonadReader SystemDefined m, MonadTx m, Backend b, Foldable t) =&gt;
QualifiedTable -&gt; t (PermDef b a) -&gt; m ()
</span><a href="#local-6989586621690601742"><span class="hs-identifier hs-var">processPerms</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601788"><span class="hs-identifier hs-var">_tmTable</span></a></span><span> </span><span class="annot"><span class="annottext">Permissions (InsPermDef ('Postgres 'Vanilla))
</span><a href="#local-6989586621690601781"><span class="hs-identifier hs-var">_tmInsertPermissions</span></a></span><span>
</span><span id="line-93"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;select_permissions&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {b :: BackendType} {t :: * -&gt; *}
       {a :: BackendType -&gt; *}.
(MonadReader SystemDefined m, MonadTx m, Backend b, Foldable t) =&gt;
QualifiedTable -&gt; t (PermDef b a) -&gt; m ()
</span><a href="#local-6989586621690601742"><span class="hs-identifier hs-var">processPerms</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601788"><span class="hs-identifier hs-var">_tmTable</span></a></span><span> </span><span class="annot"><span class="annottext">Permissions (SelPermDef ('Postgres 'Vanilla))
</span><a href="#local-6989586621690601780"><span class="hs-identifier hs-var">_tmSelectPermissions</span></a></span><span>
</span><span id="line-94"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;update_permissions&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {b :: BackendType} {t :: * -&gt; *}
       {a :: BackendType -&gt; *}.
(MonadReader SystemDefined m, MonadTx m, Backend b, Foldable t) =&gt;
QualifiedTable -&gt; t (PermDef b a) -&gt; m ()
</span><a href="#local-6989586621690601742"><span class="hs-identifier hs-var">processPerms</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601788"><span class="hs-identifier hs-var">_tmTable</span></a></span><span> </span><span class="annot"><span class="annottext">Permissions (UpdPermDef ('Postgres 'Vanilla))
</span><a href="#local-6989586621690601779"><span class="hs-identifier hs-var">_tmUpdatePermissions</span></a></span><span>
</span><span id="line-95"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;delete_permissions&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {b :: BackendType} {t :: * -&gt; *}
       {a :: BackendType -&gt; *}.
(MonadReader SystemDefined m, MonadTx m, Backend b, Foldable t) =&gt;
QualifiedTable -&gt; t (PermDef b a) -&gt; m ()
</span><a href="#local-6989586621690601742"><span class="hs-identifier hs-var">processPerms</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601788"><span class="hs-identifier hs-var">_tmTable</span></a></span><span> </span><span class="annot"><span class="annottext">Permissions (DelPermDef ('Postgres 'Vanilla))
</span><a href="#local-6989586621690601778"><span class="hs-identifier hs-var">_tmDeletePermissions</span></a></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span>        </span><span class="hs-comment">-- Event triggers</span><span>
</span><span id="line-98"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;event_triggers&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-99"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (t :: * -&gt; *) a b.
(QErrM m, Foldable t) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="Hasura.Base.Error.html#indexedForM_"><span class="hs-identifier hs-var">indexedForM_</span></a></span><span> </span><span class="annot"><span class="annottext">EventTriggers ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601777"><span class="hs-identifier hs-var">_tmEventTriggers</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-100"></span><span>            </span><span class="hs-glyph">\</span><span id="local-6989586621690601741"><span class="annot"><span class="annottext">EventTriggerConf ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601741"><span class="hs-identifier hs-var">etc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadTx m, Backend ('Postgres pgKind)) =&gt;
QualifiedTable -&gt; EventTriggerConf ('Postgres pgKind) -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addEventTriggerToCatalog"><span class="hs-identifier hs-var">addEventTriggerToCatalog</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601788"><span class="hs-identifier hs-var">_tmTable</span></a></span><span> </span><span class="annot"><span class="annottext">EventTriggerConf ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601741"><span class="hs-identifier hs-var">etc</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-comment">-- sql functions</span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;functions&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-104"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (t :: * -&gt; *) a b.
(QErrM m, Foldable t) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="Hasura.Base.Error.html#indexedForM_"><span class="hs-identifier hs-var">indexedForM_</span></a></span><span> </span><span class="annot"><span class="annottext">Functions ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601798"><span class="hs-identifier hs-var">functions</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-105"></span><span>        </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Metadata.Common.html#FunctionMetadata"><span class="hs-identifier hs-type">FunctionMetadata</span></a></span><span> </span><span id="local-6989586621690601738"><span class="annot"><span class="annottext">FunctionName ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601738"><span class="hs-identifier hs-var">function</span></a></span></span><span> </span><span id="local-6989586621690601737"><span class="annot"><span class="annottext">FunctionConfig
</span><a href="#local-6989586621690601737"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="annot"><span class="annottext">[FunctionPermissionInfo]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadTx m, MonadReader SystemDefined m) =&gt;
QualifiedFunction -&gt; FunctionConfig -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addFunctionToCatalog"><span class="hs-identifier hs-var">addFunctionToCatalog</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionName ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601738"><span class="hs-identifier hs-var">function</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionConfig
</span><a href="#local-6989586621690601737"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-comment">-- query collections</span><span>
</span><span id="line-108"></span><span>    </span><span id="local-6989586621690601735"><span class="annot"><span class="annottext">SystemDefined
</span><a href="#local-6989586621690601735"><span class="hs-identifier hs-var">systemDefined</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">ask</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;query_collections&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-110"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (t :: * -&gt; *) a b.
(QErrM m, Foldable t) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="Hasura.Base.Error.html#indexedForM_"><span class="hs-identifier hs-var">indexedForM_</span></a></span><span> </span><span class="annot"><span class="annottext">QueryCollections
</span><a href="#local-6989586621690601796"><span class="hs-identifier hs-var">collections</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-111"></span><span>        </span><span class="hs-glyph">\</span><span id="local-6989586621690601733"><span class="annot"><span class="annottext">CreateCollection
</span><a href="#local-6989586621690601733"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadTx m =&gt;
CreateCollection -&gt; SystemDefined -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addCollectionToCatalog"><span class="hs-identifier hs-var">addCollectionToCatalog</span></a></span><span> </span><span class="annot"><span class="annottext">CreateCollection
</span><a href="#local-6989586621690601733"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">SystemDefined
</span><a href="#local-6989586621690601735"><span class="hs-identifier hs-var">systemDefined</span></a></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-comment">-- allow list</span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;allowlist&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-115"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (t :: * -&gt; *) a b.
(QErrM m, Foldable t) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="Hasura.Base.Error.html#indexedForM_"><span class="hs-identifier hs-var">indexedForM_</span></a></span><span> </span><span class="annot"><span class="annottext">MetadataAllowlist
</span><a href="#local-6989586621690601795"><span class="hs-identifier hs-var">allowlist</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Allowlist.html#AllowlistEntry"><span class="hs-identifier hs-type">AllowlistEntry</span></a></span><span> </span><span id="local-6989586621690601729"><span class="annot"><span class="annottext">CollectionName
</span><a href="#local-6989586621690601729"><span class="hs-identifier hs-var">collectionName</span></a></span></span><span> </span><span id="local-6989586621690601728"><span class="annot"><span class="annottext">AllowlistScope
</span><a href="#local-6989586621690601728"><span class="hs-identifier hs-var">scope</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-116"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AllowlistScope
</span><a href="#local-6989586621690601728"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">AllowlistScope
</span><a href="Hasura.RQL.Types.Allowlist.html#AllowlistScopeGlobal"><span class="hs-identifier hs-var">AllowlistScopeGlobal</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-117"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-118"></span><span>            </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;cannot downgrade to v1 because the &quot;</span></span><span>
</span><span id="line-119"></span><span>              </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CollectionName
</span><a href="#local-6989586621690601729"><span class="hs-identifier hs-var">collectionName</span></a></span><span>
</span><span id="line-120"></span><span>                </span><span class="annot"><span class="annottext">forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; added to the allowlist is a role based allowlist&quot;</span></span><span>
</span><span id="line-121"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadTx m =&gt; CollectionName -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addCollectionToAllowlistCatalog"><span class="hs-identifier hs-var">addCollectionToAllowlistCatalog</span></a></span><span> </span><span class="annot"><span class="annottext">CollectionName
</span><a href="#local-6989586621690601729"><span class="hs-identifier hs-var">collectionName</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-comment">-- remote schemas</span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;remote_schemas&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-125"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (t :: * -&gt; *) a b.
(QErrM m, Foldable t) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="Hasura.Base.Error.html#indexedMapM_"><span class="hs-identifier hs-var">indexedMapM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteSchemaMetadata -&gt; TxE QErr ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addRemoteSchemaToCatalog"><span class="hs-identifier hs-var">addRemoteSchemaToCatalog</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RemoteSchemas
</span><a href="#local-6989586621690601797"><span class="hs-identifier hs-var">schemas</span></a></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-comment">-- custom types</span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;custom_types&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadTx m =&gt; CustomTypes -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#setCustomTypesInCatalog"><span class="hs-identifier hs-var">setCustomTypesInCatalog</span></a></span><span> </span><span class="annot"><span class="annottext">CustomTypes
</span><a href="#local-6989586621690601794"><span class="hs-identifier hs-var">customTypes</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-comment">-- cron triggers</span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;cron_triggers&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-132"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (t :: * -&gt; *) a b.
(QErrM m, Foldable t) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="Hasura.Base.Error.html#indexedForM_"><span class="hs-identifier hs-var">indexedForM_</span></a></span><span> </span><span class="annot"><span class="annottext">CronTriggers
</span><a href="#local-6989586621690601792"><span class="hs-identifier hs-var">cronTriggers</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621690601718"><span class="annot"><span class="annottext">CronTriggerMetadata
</span><a href="#local-6989586621690601718"><span class="hs-identifier hs-var">ct</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-133"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadTx m =&gt; CronTriggerMetadata -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addCronTriggerToCatalog"><span class="hs-identifier hs-var">addCronTriggerToCatalog</span></a></span><span> </span><span class="annot"><span class="annottext">CronTriggerMetadata
</span><a href="#local-6989586621690601718"><span class="hs-identifier hs-var">ct</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-comment">-- actions</span><span>
</span><span id="line-136"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;actions&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-137"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (t :: * -&gt; *) a b.
(QErrM m, Foldable t) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="Hasura.Base.Error.html#indexedForM_"><span class="hs-identifier hs-var">indexedForM_</span></a></span><span> </span><span class="annot"><span class="annottext">Actions
</span><a href="#local-6989586621690601793"><span class="hs-identifier hs-var">actions</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621690601716"><span class="annot"><span class="annottext">ActionMetadata
</span><a href="#local-6989586621690601716"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-138"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690601715"><span class="annot"><span class="annottext">createAction :: CreateAction
</span><a href="#local-6989586621690601715"><span class="hs-identifier hs-var hs-var">createAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-139"></span><span>              </span><span class="annot"><span class="annottext">ActionName -&gt; ActionDefinitionInput -&gt; Maybe Text -&gt; CreateAction
</span><a href="Hasura.RQL.DDL.Action.html#CreateAction"><span class="hs-identifier hs-var">CreateAction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActionMetadata -&gt; ActionName
</span><a href="Hasura.RQL.Types.Action.html#_amName"><span class="hs-identifier hs-var">_amName</span></a></span><span> </span><span class="annot"><span class="annottext">ActionMetadata
</span><a href="#local-6989586621690601716"><span class="hs-identifier hs-var">action</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActionMetadata -&gt; ActionDefinitionInput
</span><a href="Hasura.RQL.Types.Action.html#_amDefinition"><span class="hs-identifier hs-var">_amDefinition</span></a></span><span> </span><span class="annot"><span class="annottext">ActionMetadata
</span><a href="#local-6989586621690601716"><span class="hs-identifier hs-var">action</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActionMetadata -&gt; Maybe Text
</span><a href="Hasura.RQL.Types.Action.html#_amComment"><span class="hs-identifier hs-var">_amComment</span></a></span><span> </span><span class="annot"><span class="annottext">ActionMetadata
</span><a href="#local-6989586621690601716"><span class="hs-identifier hs-var">action</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadTx m =&gt; CreateAction -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addActionToCatalog"><span class="hs-identifier hs-var">addActionToCatalog</span></a></span><span> </span><span class="annot"><span class="annottext">CreateAction
</span><a href="#local-6989586621690601715"><span class="hs-identifier hs-var">createAction</span></a></span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;permissions&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-142"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (t :: * -&gt; *) a b.
(QErrM m, Foldable t) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="Hasura.Base.Error.html#indexedForM_"><span class="hs-identifier hs-var">indexedForM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActionMetadata -&gt; [ActionPermissionMetadata]
</span><a href="Hasura.RQL.Types.Action.html#_amPermissions"><span class="hs-identifier hs-var">_amPermissions</span></a></span><span> </span><span class="annot"><span class="annottext">ActionMetadata
</span><a href="#local-6989586621690601716"><span class="hs-identifier hs-var">action</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621690601708"><span class="annot"><span class="annottext">ActionPermissionMetadata
</span><a href="#local-6989586621690601708"><span class="hs-identifier hs-var">permission</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-143"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690601707"><span class="annot"><span class="annottext">createActionPermission :: CreateActionPermission
</span><a href="#local-6989586621690601707"><span class="hs-identifier hs-var hs-var">createActionPermission</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-144"></span><span>                  </span><span class="annot"><span class="annottext">ActionName
-&gt; RoleName -&gt; Maybe Value -&gt; Maybe Text -&gt; CreateActionPermission
</span><a href="Hasura.RQL.DDL.Action.html#CreateActionPermission"><span class="hs-identifier hs-var">CreateActionPermission</span></a></span><span>
</span><span id="line-145"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActionMetadata -&gt; ActionName
</span><a href="Hasura.RQL.Types.Action.html#_amName"><span class="hs-identifier hs-var">_amName</span></a></span><span> </span><span class="annot"><span class="annottext">ActionMetadata
</span><a href="#local-6989586621690601716"><span class="hs-identifier hs-var">action</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActionPermissionMetadata -&gt; RoleName
</span><a href="Hasura.RQL.Types.Action.html#_apmRole"><span class="hs-identifier hs-var">_apmRole</span></a></span><span> </span><span class="annot"><span class="annottext">ActionPermissionMetadata
</span><a href="#local-6989586621690601708"><span class="hs-identifier hs-var">permission</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>                    </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-148"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActionPermissionMetadata -&gt; Maybe Text
</span><a href="Hasura.RQL.Types.Action.html#_apmComment"><span class="hs-identifier hs-var">_apmComment</span></a></span><span> </span><span class="annot"><span class="annottext">ActionPermissionMetadata
</span><a href="#local-6989586621690601708"><span class="hs-identifier hs-var">permission</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadTx m =&gt; CreateActionPermission -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addActionPermissionToCatalog"><span class="hs-identifier hs-var">addActionPermissionToCatalog</span></a></span><span> </span><span class="annot"><span class="annottext">CreateActionPermission
</span><a href="#local-6989586621690601707"><span class="hs-identifier hs-var">createActionPermission</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-151"></span><span>      </span><span id="local-6989586621690601742"><span class="annot"><span class="annottext">processPerms :: QualifiedTable -&gt; t (PermDef b a) -&gt; m ()
</span><a href="#local-6989586621690601742"><span class="hs-identifier hs-var hs-var">processPerms</span></a></span></span><span> </span><span id="local-6989586621690601688"><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690601688"><span class="hs-identifier hs-var">tableName</span></a></span></span><span> </span><span id="local-6989586621690601687"><span class="annot"><span class="annottext">t (PermDef b a)
</span><a href="#local-6989586621690601687"><span class="hs-identifier hs-var">perms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (t :: * -&gt; *) a b.
(QErrM m, Foldable t) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="Hasura.Base.Error.html#indexedForM_"><span class="hs-identifier hs-var">indexedForM_</span></a></span><span> </span><span class="annot"><span class="annottext">t (PermDef b a)
</span><a href="#local-6989586621690601687"><span class="hs-identifier hs-var">perms</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621690601686"><span class="annot"><span class="annottext">PermDef b a
</span><a href="#local-6989586621690601686"><span class="hs-identifier hs-var">perm</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-152"></span><span>        </span><span id="local-6989586621690601685"><span class="annot"><span class="annottext">SystemDefined
</span><a href="#local-6989586621690601685"><span class="hs-identifier hs-var">systemDefined</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">ask</span></a></span><span>
</span><span id="line-153"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (b :: BackendType) (a :: BackendType -&gt; *).
(MonadTx m, Backend b) =&gt;
QualifiedTable -&gt; PermDef b a -&gt; SystemDefined -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addPermissionToCatalog"><span class="hs-identifier hs-var">addPermissionToCatalog</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690601688"><span class="hs-identifier hs-var">tableName</span></a></span><span> </span><span class="annot"><span class="annottext">PermDef b a
</span><a href="#local-6989586621690601686"><span class="hs-identifier hs-var">perm</span></a></span><span> </span><span class="annot"><span class="annottext">SystemDefined
</span><a href="#local-6989586621690601685"><span class="hs-identifier hs-var">systemDefined</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span id="local-6989586621690602427"><span class="annot"><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#saveTableToCatalog"><span class="hs-identifier hs-type">saveTableToCatalog</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602427"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#SystemDefined"><span class="hs-identifier hs-type">SystemDefined</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602427"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedTable"><span class="hs-identifier hs-type">QualifiedTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Table.html#TableConfig"><span class="hs-identifier hs-type">TableConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690602427"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-157"></span><span id="saveTableToCatalog"><span class="annot"><span class="annottext">saveTableToCatalog :: forall (m :: * -&gt; *).
(MonadTx m, MonadReader SystemDefined m) =&gt;
QualifiedTable -&gt; Bool -&gt; TableConfig ('Postgres 'Vanilla) -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#saveTableToCatalog"><span class="hs-identifier hs-var hs-var">saveTableToCatalog</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedObject"><span class="hs-identifier hs-type">QualifiedObject</span></a></span><span> </span><span id="local-6989586621690601654"><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690601654"><span class="hs-identifier hs-var">sn</span></a></span></span><span> </span><span id="local-6989586621690601653"><span class="annot"><span class="annottext">TableName
</span><a href="#local-6989586621690601653"><span class="hs-identifier hs-var">tn</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621690601652"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690601652"><span class="hs-identifier hs-var">isEnum</span></a></span></span><span> </span><span id="local-6989586621690601651"><span class="annot"><span class="annottext">TableConfig ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601651"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-158"></span><span>  </span><span id="local-6989586621690601650"><span class="annot"><span class="annottext">SystemDefined
</span><a href="#local-6989586621690601650"><span class="hs-identifier hs-var">systemDefined</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">ask</span></a></span><span>
</span><span id="line-159"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-160"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r e.
(MonadIO m, ToPrepArgs r) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; r -&gt; Bool -&gt; TxET e m ()
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.unitQE</span></a></span><span>
</span><span id="line-161"></span><span>      </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span>
</span><span id="line-162"></span><span>      </span><span class="annot"><span class="">[PG.sql|
    INSERT INTO &quot;hdb_catalog&quot;.&quot;hdb_table&quot;
      (table_schema, table_name, is_system_defined, is_enum, configuration)
    VALUES ($1, $2, $3, $4, $5)
  |]</span></span><span>
</span><span id="line-167"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690601654"><span class="hs-identifier hs-var">sn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TableName
</span><a href="#local-6989586621690601653"><span class="hs-identifier hs-var">tn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SystemDefined
</span><a href="#local-6989586621690601650"><span class="hs-identifier hs-var">systemDefined</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690601652"><span class="hs-identifier hs-var">isEnum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ViaJSON Value
</span><a href="#local-6989586621690601647"><span class="hs-identifier hs-var">configVal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>      </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-170"></span><span>    </span><span id="local-6989586621690601647"><span class="annot"><span class="annottext">configVal :: ViaJSON Value
</span><a href="#local-6989586621690601647"><span class="hs-identifier hs-var hs-var">configVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; ViaJSON a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.ViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">TableConfig ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601651"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span id="local-6989586621690602425"><span id="local-6989586621690602426"><span class="annot"><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#insertRelationshipToCatalog"><span class="hs-identifier hs-type">insertRelationshipToCatalog</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602426"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#SystemDefined"><span class="hs-identifier hs-type">SystemDefined</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602426"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621690602425"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-174"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedTable"><span class="hs-identifier hs-type">QualifiedTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-175"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#RelType"><span class="hs-identifier hs-type">RelType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-176"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#RelDef"><span class="hs-identifier hs-type">RelDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602425"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-177"></span><span>  </span><span class="annot"><a href="#local-6989586621690602426"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-178"></span><span id="insertRelationshipToCatalog"><span class="annot"><span class="annottext">insertRelationshipToCatalog :: forall (m :: * -&gt; *) a.
(MonadTx m, MonadReader SystemDefined m, ToJSON a) =&gt;
QualifiedTable -&gt; RelType -&gt; RelDef a -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#insertRelationshipToCatalog"><span class="hs-identifier hs-var hs-var">insertRelationshipToCatalog</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedObject"><span class="hs-identifier hs-type">QualifiedObject</span></a></span><span> </span><span id="local-6989586621690601628"><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690601628"><span class="hs-identifier hs-var">schema</span></a></span></span><span> </span><span id="local-6989586621690601627"><span class="annot"><span class="annottext">TableName
</span><a href="#local-6989586621690601627"><span class="hs-identifier hs-var">table</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621690601626"><span class="annot"><span class="annottext">RelType
</span><a href="#local-6989586621690601626"><span class="hs-identifier hs-var">relType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#RelDef"><span class="hs-identifier hs-type">RelDef</span></a></span><span> </span><span id="local-6989586621690601624"><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690601624"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621690601623"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690601623"><span class="hs-identifier hs-var">using</span></a></span></span><span> </span><span id="local-6989586621690601622"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690601622"><span class="hs-identifier hs-var">comment</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-179"></span><span>  </span><span id="local-6989586621690601621"><span class="annot"><span class="annottext">SystemDefined
</span><a href="#local-6989586621690601621"><span class="hs-identifier hs-var">systemDefined</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">ask</span></a></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690601620"><span class="annot"><span class="annottext">args :: (SchemaName, TableName, RelName, Text, ViaJSON a, Maybe Text,
 SystemDefined)
</span><a href="#local-6989586621690601620"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690601628"><span class="hs-identifier hs-var">schema</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TableName
</span><a href="#local-6989586621690601627"><span class="hs-identifier hs-var">table</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690601624"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RelType -&gt; Text
</span><a href="Hasura.RQL.Types.Common.html#relTypeToTxt"><span class="hs-identifier hs-var">relTypeToTxt</span></a></span><span> </span><span class="annot"><span class="annottext">RelType
</span><a href="#local-6989586621690601626"><span class="hs-identifier hs-var">relType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; ViaJSON a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.ViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690601623"><span class="hs-identifier hs-var">using</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690601622"><span class="hs-identifier hs-var">comment</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SystemDefined
</span><a href="#local-6989586621690601621"><span class="hs-identifier hs-var">systemDefined</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r e.
(MonadIO m, ToPrepArgs r) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; r -&gt; Bool -&gt; TxET e m ()
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.unitQE</span></a></span><span> </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621690601618"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">(SchemaName, TableName, RelName, Text, ViaJSON a, Maybe Text,
 SystemDefined)
</span><a href="#local-6989586621690601620"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621690601618"><span class="annot"><span class="annottext">query :: Query
</span><a href="#local-6989586621690601618"><span class="hs-identifier hs-var hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-184"></span><span>      </span><span class="annot"><span class="">[PG.sql|
      INSERT INTO
        hdb_catalog.hdb_relationship
        (table_schema, table_name, rel_name, rel_type, rel_def, comment, is_system_defined)
      VALUES ($1, $2, $3, $4, $5 :: jsonb, $6, $7) |]</span></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span id="local-6989586621690602400"><span id="local-6989586621690602401"><span class="annot"><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addEventTriggerToCatalog"><span class="hs-identifier hs-type">addEventTriggerToCatalog</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602401"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602400"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-192"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedTable"><span class="hs-identifier hs-type">QualifiedTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-193"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#EventTriggerConf"><span class="hs-identifier hs-type">EventTriggerConf</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602400"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-194"></span><span>  </span><span class="annot"><a href="#local-6989586621690602401"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-195"></span><span id="addEventTriggerToCatalog"><span class="annot"><span class="annottext">addEventTriggerToCatalog :: forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadTx m, Backend ('Postgres pgKind)) =&gt;
QualifiedTable -&gt; EventTriggerConf ('Postgres pgKind) -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addEventTriggerToCatalog"><span class="hs-identifier hs-var hs-var">addEventTriggerToCatalog</span></a></span></span><span> </span><span id="local-6989586621690601603"><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690601603"><span class="hs-identifier hs-var">qt</span></a></span></span><span> </span><span id="local-6989586621690601602"><span class="annot"><span class="annottext">EventTriggerConf ('Postgres pgKind)
</span><a href="#local-6989586621690601602"><span class="hs-identifier hs-var">etc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-196"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r e.
(MonadIO m, ToPrepArgs r) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; r -&gt; Bool -&gt; TxET e m ()
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.unitQE</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><span class="">[PG.sql|
           INSERT into hdb_catalog.event_triggers
                       (name, type, schema_name, table_name, configuration)
           VALUES ($1, 'table', $2, $3, $4)
         |]</span></span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TriggerName
</span><a href="#local-6989586621690601601"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690601600"><span class="hs-identifier hs-var">sn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TableName
</span><a href="#local-6989586621690601599"><span class="hs-identifier hs-var">tn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; ViaJSON a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.ViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">EventTriggerConf ('Postgres pgKind)
</span><a href="#local-6989586621690601602"><span class="hs-identifier hs-var">etc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedObject"><span class="hs-identifier hs-type">QualifiedObject</span></a></span><span> </span><span id="local-6989586621690601600"><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690601600"><span class="hs-identifier hs-var">sn</span></a></span></span><span> </span><span id="local-6989586621690601599"><span class="annot"><span class="annottext">TableName
</span><a href="#local-6989586621690601599"><span class="hs-identifier hs-var">tn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690601603"><span class="hs-identifier hs-var">qt</span></a></span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#EventTriggerConf"><span class="hs-identifier hs-type">EventTriggerConf</span></a></span><span> </span><span id="local-6989586621690601601"><span class="annot"><span class="annottext">TriggerName
</span><a href="#local-6989586621690601601"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">TriggerOpsDef ('Postgres pgKind)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe InputWebhook
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RetryConf
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe [HeaderConf]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe RequestTransform
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe MetadataResponseTransform
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe AutoTriggerLogCleanupConfig
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerOnReplication
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EventTriggerConf ('Postgres pgKind)
</span><a href="#local-6989586621690601602"><span class="hs-identifier hs-var">etc</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span id="local-6989586621690602419"><span class="annot"><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addComputedFieldToCatalog"><span class="hs-identifier hs-type">addComputedFieldToCatalog</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-210"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602419"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-211"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DDL.ComputedField.html#AddComputedField"><span class="hs-identifier hs-type">AddComputedField</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-212"></span><span>  </span><span class="annot"><a href="#local-6989586621690602419"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-213"></span><span id="addComputedFieldToCatalog"><span class="annot"><span class="annottext">addComputedFieldToCatalog :: forall (m :: * -&gt; *).
MonadTx m =&gt;
AddComputedField ('Postgres 'Vanilla) -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addComputedFieldToCatalog"><span class="hs-identifier hs-var hs-var">addComputedFieldToCatalog</span></a></span></span><span> </span><span id="local-6989586621690601583"><span class="annot"><span class="annottext">AddComputedField ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601583"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-214"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a r e.
(MonadIO m, FromRes a, ToPrepArgs r) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; r -&gt; Bool -&gt; TxET e m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.withQE</span></a></span><span>
</span><span id="line-216"></span><span>      </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span>
</span><span id="line-217"></span><span>      </span><span class="annot"><span class="">[PG.sql|
     INSERT INTO hdb_catalog.hdb_computed_field
       (table_schema, table_name, computed_field_name, definition, commentText)
     VALUES ($1, $2, $3, $4, $5)
    |]</span></span><span>
</span><span id="line-222"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690601581"><span class="hs-identifier hs-var">schemaName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TableName
</span><a href="#local-6989586621690601580"><span class="hs-identifier hs-var">tableName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ComputedFieldName
</span><a href="#local-6989586621690601579"><span class="hs-identifier hs-var">computedField</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; ViaJSON a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.ViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">ComputedFieldDefinition ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601578"><span class="hs-identifier hs-var">definition</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690601577"><span class="hs-identifier hs-var">commentText</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>      </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-225"></span><span>    </span><span id="local-6989586621690601577"><span class="annot"><span class="annottext">commentText :: Maybe Text
</span><a href="#local-6989586621690601577"><span class="hs-identifier hs-var hs-var">commentText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Comment -&gt; Maybe Text
</span><a href="Hasura.RQL.Types.Common.html#commentToMaybeText"><span class="hs-identifier hs-var">commentToMaybeText</span></a></span><span> </span><span class="annot"><span class="annottext">Comment
</span><a href="#local-6989586621690601575"><span class="hs-identifier hs-var">comment</span></a></span><span>
</span><span id="line-226"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedObject"><span class="hs-identifier hs-type">QualifiedObject</span></a></span><span> </span><span id="local-6989586621690601581"><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690601581"><span class="hs-identifier hs-var">schemaName</span></a></span></span><span> </span><span id="local-6989586621690601580"><span class="annot"><span class="annottext">TableName
</span><a href="#local-6989586621690601580"><span class="hs-identifier hs-var">tableName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601574"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.ComputedField.html#AddComputedField"><span class="hs-identifier hs-type">AddComputedField</span></a></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621690601574"><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601574"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span id="local-6989586621690601579"><span class="annot"><span class="annottext">ComputedFieldName
</span><a href="#local-6989586621690601579"><span class="hs-identifier hs-var">computedField</span></a></span></span><span> </span><span id="local-6989586621690601578"><span class="annot"><span class="annottext">ComputedFieldDefinition ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601578"><span class="hs-identifier hs-var">definition</span></a></span></span><span> </span><span id="local-6989586621690601575"><span class="annot"><span class="annottext">Comment
</span><a href="#local-6989586621690601575"><span class="hs-identifier hs-var">comment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddComputedField ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601583"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span id="local-6989586621690602410"><span class="annot"><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addRemoteRelationshipToCatalog"><span class="hs-identifier hs-type">addRemoteRelationshipToCatalog</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602410"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.RemoteRelationship.html#CreateFromSourceRelationship"><span class="hs-identifier hs-type">CreateFromSourceRelationship</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690602410"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-230"></span><span id="addRemoteRelationshipToCatalog"><span class="annot"><span class="annottext">addRemoteRelationshipToCatalog :: forall (m :: * -&gt; *).
MonadTx m =&gt;
CreateFromSourceRelationship ('Postgres 'Vanilla) -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addRemoteRelationshipToCatalog"><span class="hs-identifier hs-var hs-var">addRemoteRelationshipToCatalog</span></a></span></span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.RemoteRelationship.html#CreateFromSourceRelationship"><span class="hs-identifier hs-type">CreateFromSourceRelationship</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621690601559"><span id="local-6989586621690601560"><span id="local-6989586621690601561"><span id="local-6989586621690601562"><span class="annot"><span class="annottext">SourceName
RelName
TableName ('Postgres 'Vanilla)
RemoteRelationshipDefinition
_crrDefinition :: forall (b :: BackendType).
CreateFromSourceRelationship b -&gt; RemoteRelationshipDefinition
_crrName :: forall (b :: BackendType).
CreateFromSourceRelationship b -&gt; RelName
_crrTable :: forall (b :: BackendType).
CreateFromSourceRelationship b -&gt; TableName b
_crrSource :: forall (b :: BackendType).
CreateFromSourceRelationship b -&gt; SourceName
_crrDefinition :: RemoteRelationshipDefinition
_crrName :: RelName
_crrTable :: TableName ('Postgres 'Vanilla)
_crrSource :: SourceName
</span><a href="Hasura.RQL.DDL.RemoteRelationship.html#_crrDefinition"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-232"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r e.
(MonadIO m, ToPrepArgs r) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; r -&gt; Bool -&gt; TxET e m ()
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.unitQE</span></a></span><span>
</span><span id="line-233"></span><span>      </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span>
</span><span id="line-234"></span><span>      </span><span class="annot"><span class="">[PG.sql|
       INSERT INTO hdb_catalog.hdb_remote_relationship
       (remote_relationship_name, table_schema, table_name, definition)
       VALUES ($1, $2, $3, $4::jsonb)
  |]</span></span><span>
</span><span id="line-239"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690601560"><span class="hs-identifier hs-var">_crrName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690601554"><span class="hs-identifier hs-var">schemaName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TableName
</span><a href="#local-6989586621690601553"><span class="hs-identifier hs-var">tableName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; ViaJSON a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.ViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteRelationshipDefinition
</span><a href="#local-6989586621690601559"><span class="hs-identifier hs-var">_crrDefinition</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>      </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-242"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedObject"><span class="hs-identifier hs-type">QualifiedObject</span></a></span><span> </span><span id="local-6989586621690601554"><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690601554"><span class="hs-identifier hs-var">schemaName</span></a></span></span><span> </span><span id="local-6989586621690601553"><span class="annot"><span class="annottext">TableName
</span><a href="#local-6989586621690601553"><span class="hs-identifier hs-var">tableName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601561"><span class="hs-identifier hs-var">_crrTable</span></a></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span id="local-6989586621690602395"><span class="annot"><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addFunctionToCatalog"><span class="hs-identifier hs-type">addFunctionToCatalog</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602395"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#SystemDefined"><span class="hs-identifier hs-type">SystemDefined</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602395"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-246"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedFunction"><span class="hs-identifier hs-type">QualifiedFunction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-247"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Function.html#FunctionConfig"><span class="hs-identifier hs-type">FunctionConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-248"></span><span>  </span><span class="annot"><a href="#local-6989586621690602395"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-249"></span><span id="addFunctionToCatalog"><span class="annot"><span class="annottext">addFunctionToCatalog :: forall (m :: * -&gt; *).
(MonadTx m, MonadReader SystemDefined m) =&gt;
QualifiedFunction -&gt; FunctionConfig -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addFunctionToCatalog"><span class="hs-identifier hs-var hs-var">addFunctionToCatalog</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedObject"><span class="hs-identifier hs-type">QualifiedObject</span></a></span><span> </span><span id="local-6989586621690601536"><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690601536"><span class="hs-identifier hs-var">sn</span></a></span></span><span> </span><span id="local-6989586621690601535"><span class="annot"><span class="annottext">FunctionName
</span><a href="#local-6989586621690601535"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621690601534"><span class="annot"><span class="annottext">FunctionConfig
</span><a href="#local-6989586621690601534"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-250"></span><span>  </span><span id="local-6989586621690601533"><span class="annot"><span class="annottext">SystemDefined
</span><a href="#local-6989586621690601533"><span class="hs-identifier hs-var">systemDefined</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">ask</span></a></span><span>
</span><span id="line-251"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-252"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r e.
(MonadIO m, ToPrepArgs r) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; r -&gt; Bool -&gt; TxET e m ()
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.unitQE</span></a></span><span>
</span><span id="line-253"></span><span>      </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span>
</span><span id="line-254"></span><span>      </span><span class="annot"><span class="">[PG.sql|
         INSERT INTO &quot;hdb_catalog&quot;.&quot;hdb_function&quot;
           (function_schema, function_name, configuration, is_system_defined)
         VALUES ($1, $2, $3, $4)
                 |]</span></span><span>
</span><span id="line-259"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690601536"><span class="hs-identifier hs-var">sn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FunctionName
</span><a href="#local-6989586621690601535"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; ViaJSON a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.ViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionConfig
</span><a href="#local-6989586621690601534"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SystemDefined
</span><a href="#local-6989586621690601533"><span class="hs-identifier hs-var">systemDefined</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>      </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="annot"><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addRemoteSchemaToCatalog"><span class="hs-identifier hs-type">addRemoteSchemaToCatalog</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-263"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.Common.html#RemoteSchemaMetadata"><span class="hs-identifier hs-type">RemoteSchemaMetadata</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-264"></span><span>  </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.TxE</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span id="addRemoteSchemaToCatalog"><span class="annot"><span class="annottext">addRemoteSchemaToCatalog :: RemoteSchemaMetadata -&gt; TxE QErr ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addRemoteSchemaToCatalog"><span class="hs-identifier hs-var hs-var">addRemoteSchemaToCatalog</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RemoteSchema.Metadata.Core.html#RemoteSchemaMetadata"><span class="hs-identifier hs-type">RemoteSchemaMetadata</span></a></span><span> </span><span id="local-6989586621690601531"><span class="annot"><span class="annottext">RemoteSchemaName
</span><a href="#local-6989586621690601531"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621690601530"><span class="annot"><span class="annottext">RemoteSchemaDef
</span><a href="#local-6989586621690601530"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span id="local-6989586621690601529"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690601529"><span class="hs-identifier hs-var">comment</span></a></span></span><span> </span><span class="annot"><span class="annottext">[RemoteSchemaPermissionMetadata]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SchemaRemoteRelationships RemoteRelationshipDefinition
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-266"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r e.
(MonadIO m, ToPrepArgs r) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; r -&gt; Bool -&gt; TxET e m ()
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.unitQE</span></a></span><span>
</span><span id="line-267"></span><span>    </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span>
</span><span id="line-268"></span><span>    </span><span class="annot"><span class="">[PG.sql|
    INSERT into hdb_catalog.remote_schemas
      (name, definition, comment)
      VALUES ($1, $2, $3)
  |]</span></span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RemoteSchemaName
</span><a href="#local-6989586621690601531"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; ViaJSON a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.ViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">RemoteSchemaDef
</span><a href="#local-6989586621690601530"><span class="hs-identifier hs-var">def</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690601529"><span class="hs-identifier hs-var">comment</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>    </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span id="local-6989586621690602391"><span class="annot"><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addCollectionToCatalog"><span class="hs-identifier hs-type">addCollectionToCatalog</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-277"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602391"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.QueryCollection.html#CreateCollection"><span class="hs-identifier hs-type">CreateCollection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#SystemDefined"><span class="hs-identifier hs-type">SystemDefined</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690602391"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-278"></span><span id="addCollectionToCatalog"><span class="annot"><span class="annottext">addCollectionToCatalog :: forall (m :: * -&gt; *).
MonadTx m =&gt;
CreateCollection -&gt; SystemDefined -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addCollectionToCatalog"><span class="hs-identifier hs-var hs-var">addCollectionToCatalog</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.QueryCollection.html#CreateCollection"><span class="hs-identifier hs-type">CreateCollection</span></a></span><span> </span><span id="local-6989586621690601516"><span class="annot"><span class="annottext">CollectionName
</span><a href="#local-6989586621690601516"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621690601515"><span class="annot"><span class="annottext">CollectionDef
</span><a href="#local-6989586621690601515"><span class="hs-identifier hs-var">defn</span></a></span></span><span> </span><span id="local-6989586621690601514"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690601514"><span class="hs-identifier hs-var">mComment</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621690601513"><span class="annot"><span class="annottext">SystemDefined
</span><a href="#local-6989586621690601513"><span class="hs-identifier hs-var">systemDefined</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-279"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r e.
(MonadIO m, ToPrepArgs r) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; r -&gt; Bool -&gt; TxET e m ()
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.unitQE</span></a></span><span>
</span><span id="line-281"></span><span>      </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span>
</span><span id="line-282"></span><span>      </span><span class="annot"><span class="">[PG.sql|
    INSERT INTO hdb_catalog.hdb_query_collection
      (collection_name, collection_defn, comment, is_system_defined)
    VALUES ($1, $2, $3, $4)
  |]</span></span><span>
</span><span id="line-287"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CollectionName
</span><a href="#local-6989586621690601516"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; ViaJSON a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.ViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">CollectionDef
</span><a href="#local-6989586621690601515"><span class="hs-identifier hs-var">defn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690601514"><span class="hs-identifier hs-var">mComment</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SystemDefined
</span><a href="#local-6989586621690601513"><span class="hs-identifier hs-var">systemDefined</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>      </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span id="local-6989586621690602382"><span class="annot"><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addCollectionToAllowlistCatalog"><span class="hs-identifier hs-type">addCollectionToAllowlistCatalog</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602382"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.QueryCollection.html#CollectionName"><span class="hs-identifier hs-type">CollectionName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690602382"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-291"></span><span id="addCollectionToAllowlistCatalog"><span class="annot"><span class="annottext">addCollectionToAllowlistCatalog :: forall (m :: * -&gt; *). MonadTx m =&gt; CollectionName -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addCollectionToAllowlistCatalog"><span class="hs-identifier hs-var hs-var">addCollectionToAllowlistCatalog</span></a></span></span><span> </span><span id="local-6989586621690601505"><span class="annot"><span class="annottext">CollectionName
</span><a href="#local-6989586621690601505"><span class="hs-identifier hs-var">collName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-292"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-293"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r e.
(MonadIO m, ToPrepArgs r) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; r -&gt; Bool -&gt; TxET e m ()
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.unitQE</span></a></span><span>
</span><span id="line-294"></span><span>      </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span>
</span><span id="line-295"></span><span>      </span><span class="annot"><span class="">[PG.sql|
      INSERT INTO hdb_catalog.hdb_allowlist
                   (collection_name)
            VALUES ($1)
      |]</span></span><span>
</span><span id="line-300"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Identity a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Identity</span></a></span><span> </span><span class="annot"><span class="annottext">CollectionName
</span><a href="#local-6989586621690601505"><span class="hs-identifier hs-var">collName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>      </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span id="local-6989586621690602373"><span class="annot"><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#setCustomTypesInCatalog"><span class="hs-identifier hs-type">setCustomTypesInCatalog</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602373"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.CustomTypes.html#CustomTypes"><span class="hs-identifier hs-type">CustomTypes</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690602373"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-304"></span><span id="setCustomTypesInCatalog"><span class="annot"><span class="annottext">setCustomTypesInCatalog :: forall (m :: * -&gt; *). MonadTx m =&gt; CustomTypes -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#setCustomTypesInCatalog"><span class="hs-identifier hs-var hs-var">setCustomTypesInCatalog</span></a></span></span><span> </span><span id="local-6989586621690601491"><span class="annot"><span class="annottext">CustomTypes
</span><a href="#local-6989586621690601491"><span class="hs-identifier hs-var">customTypes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-305"></span><span>  </span><span class="annot"><span class="annottext">TxE QErr ()
</span><a href="#local-6989586621690601490"><span class="hs-identifier hs-var">clearCustomTypes</span></a></span><span>
</span><span id="line-306"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r e.
(MonadIO m, ToPrepArgs r) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; r -&gt; Bool -&gt; TxET e m ()
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.unitQE</span></a></span><span>
</span><span id="line-307"></span><span>    </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span>
</span><span id="line-308"></span><span>    </span><span class="annot"><span class="">[PG.sql|
    INSERT into hdb_catalog.hdb_custom_types
      (custom_types)
      VALUES ($1)
  |]</span></span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Identity a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Identity</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; ViaJSON a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.ViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">CustomTypes
</span><a href="#local-6989586621690601491"><span class="hs-identifier hs-var">customTypes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>    </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-316"></span><span>    </span><span id="local-6989586621690601490"><span class="annot"><span class="annottext">clearCustomTypes :: TxE QErr ()
</span><a href="#local-6989586621690601490"><span class="hs-identifier hs-var hs-var">clearCustomTypes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-317"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r e.
(MonadIO m, ToPrepArgs r) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; r -&gt; Bool -&gt; TxET e m ()
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.unitQE</span></a></span><span>
</span><span id="line-318"></span><span>        </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span>
</span><span id="line-319"></span><span>        </span><span class="annot"><span class="">[PG.sql|
        DELETE FROM hdb_catalog.hdb_custom_types
      |]</span></span><span>
</span><span id="line-322"></span><span>        </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span id="local-6989586621690602367"><span class="annot"><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addActionToCatalog"><span class="hs-identifier hs-type">addActionToCatalog</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602367"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#CreateAction"><span class="hs-identifier hs-type">CreateAction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690602367"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-326"></span><span id="addActionToCatalog"><span class="annot"><span class="annottext">addActionToCatalog :: forall (m :: * -&gt; *). MonadTx m =&gt; CreateAction -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addActionToCatalog"><span class="hs-identifier hs-var hs-var">addActionToCatalog</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#CreateAction"><span class="hs-identifier hs-type">CreateAction</span></a></span><span> </span><span id="local-6989586621690601471"><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621690601471"><span class="hs-identifier hs-var">actionName</span></a></span></span><span> </span><span id="local-6989586621690601470"><span class="annot"><span class="annottext">ActionDefinitionInput
</span><a href="#local-6989586621690601470"><span class="hs-identifier hs-var">actionDefinition</span></a></span></span><span> </span><span id="local-6989586621690601469"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690601469"><span class="hs-identifier hs-var">comment</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-327"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-328"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r e.
(MonadIO m, ToPrepArgs r) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; r -&gt; Bool -&gt; TxET e m ()
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.unitQE</span></a></span><span>
</span><span id="line-329"></span><span>      </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span>
</span><span id="line-330"></span><span>      </span><span class="annot"><span class="">[PG.sql|
    INSERT into hdb_catalog.hdb_action
      (action_name, action_defn, comment)
      VALUES ($1, $2, $3)
  |]</span></span><span>
</span><span id="line-335"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621690601471"><span class="hs-identifier hs-var">actionName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; ViaJSON a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.ViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">ActionDefinitionInput
</span><a href="#local-6989586621690601470"><span class="hs-identifier hs-var">actionDefinition</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690601469"><span class="hs-identifier hs-var">comment</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>      </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span id="local-6989586621690602363"><span class="annot"><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addActionPermissionToCatalog"><span class="hs-identifier hs-type">addActionPermissionToCatalog</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602363"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#CreateActionPermission"><span class="hs-identifier hs-type">CreateActionPermission</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690602363"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-339"></span><span id="addActionPermissionToCatalog"><span class="annot"><span class="annottext">addActionPermissionToCatalog :: forall (m :: * -&gt; *). MonadTx m =&gt; CreateActionPermission -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addActionPermissionToCatalog"><span class="hs-identifier hs-var hs-var">addActionPermissionToCatalog</span></a></span></span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#CreateActionPermission"><span class="hs-identifier hs-type">CreateActionPermission</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621690601457"><span id="local-6989586621690601458"><span id="local-6989586621690601459"><span id="local-6989586621690601460"><span class="annot"><span class="annottext">Maybe Value
Maybe Text
RoleName
ActionName
_capComment :: CreateActionPermission -&gt; Maybe Text
_capDefinition :: CreateActionPermission -&gt; Maybe Value
_capRole :: CreateActionPermission -&gt; RoleName
_capAction :: CreateActionPermission -&gt; ActionName
_capComment :: Maybe Text
_capDefinition :: Maybe Value
_capRole :: RoleName
_capAction :: ActionName
</span><a href="Hasura.RQL.DDL.Action.html#_capComment"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-340"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r e.
(MonadIO m, ToPrepArgs r) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; r -&gt; Bool -&gt; TxET e m ()
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.unitQE</span></a></span><span>
</span><span id="line-342"></span><span>      </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span>
</span><span id="line-343"></span><span>      </span><span class="annot"><span class="">[PG.sql|
    INSERT into hdb_catalog.hdb_action_permission
      (action_name, role_name, comment)
      VALUES ($1, $2, $3)
  |]</span></span><span>
</span><span id="line-348"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621690601460"><span class="hs-identifier hs-var">_capAction</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RoleName
</span><a href="#local-6989586621690601459"><span class="hs-identifier hs-var">_capRole</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690601457"><span class="hs-identifier hs-var">_capComment</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>      </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span id="local-6989586621690602360"><span id="local-6989586621690602361"><span id="local-6989586621690602362"><span class="annot"><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addPermissionToCatalog"><span class="hs-identifier hs-type">addPermissionToCatalog</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-352"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602362"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602361"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-353"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedTable"><span class="hs-identifier hs-type">QualifiedTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-354"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Permission.html#PermDef"><span class="hs-identifier hs-type">PermDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602361"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602360"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-355"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#SystemDefined"><span class="hs-identifier hs-type">SystemDefined</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-356"></span><span>  </span><span class="annot"><a href="#local-6989586621690602362"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-357"></span><span id="addPermissionToCatalog"><span class="annot"><span class="annottext">addPermissionToCatalog :: forall (m :: * -&gt; *) (b :: BackendType) (a :: BackendType -&gt; *).
(MonadTx m, Backend b) =&gt;
QualifiedTable -&gt; PermDef b a -&gt; SystemDefined -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addPermissionToCatalog"><span class="hs-identifier hs-var hs-var">addPermissionToCatalog</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedObject"><span class="hs-identifier hs-type">QualifiedObject</span></a></span><span> </span><span id="local-6989586621690601439"><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690601439"><span class="hs-identifier hs-var">sn</span></a></span></span><span> </span><span id="local-6989586621690601438"><span class="annot"><span class="annottext">TableName
</span><a href="#local-6989586621690601438"><span class="hs-identifier hs-var">tn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Permission.html#PermDef"><span class="hs-identifier hs-type">PermDef</span></a></span><span> </span><span id="local-6989586621690601436"><span class="annot"><span class="annottext">RoleName
</span><a href="#local-6989586621690601436"><span class="hs-identifier hs-var">rn</span></a></span></span><span> </span><span id="local-6989586621690601435"><span class="annot"><span class="annottext">PermDefPermission b a
</span><a href="#local-6989586621690601435"><span class="hs-identifier hs-var">qdef</span></a></span></span><span> </span><span id="local-6989586621690601434"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690601434"><span class="hs-identifier hs-var">mComment</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621690601433"><span class="annot"><span class="annottext">SystemDefined
</span><a href="#local-6989586621690601433"><span class="hs-identifier hs-var">systemDefined</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-358"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-359"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r e.
(MonadIO m, ToPrepArgs r) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; r -&gt; Bool -&gt; TxET e m ()
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.unitQE</span></a></span><span>
</span><span id="line-360"></span><span>      </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span>
</span><span id="line-361"></span><span>      </span><span class="annot"><span class="">[PG.sql|
           INSERT INTO
               hdb_catalog.hdb_permission
               (table_schema, table_name, role_name, perm_type, perm_def, comment, is_system_defined)
           VALUES ($1, $2, $3, $4, $5 :: jsonb, $6, $7)
                |]</span></span><span>
</span><span id="line-367"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690601439"><span class="hs-identifier hs-var">sn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TableName
</span><a href="#local-6989586621690601438"><span class="hs-identifier hs-var">tn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RoleName
</span><a href="#local-6989586621690601436"><span class="hs-identifier hs-var">rn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PermType -&gt; Text
</span><a href="Hasura.RQL.Types.Permission.html#permTypeToCode"><span class="hs-identifier hs-var">permTypeToCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType) (a :: BackendType -&gt; *).
PermDefPermission b a -&gt; PermType
</span><a href="Hasura.RQL.Types.Permission.html#reflectPermDefPermission"><span class="hs-identifier hs-var">reflectPermDefPermission</span></a></span><span> </span><span class="annot"><span class="annottext">PermDefPermission b a
</span><a href="#local-6989586621690601435"><span class="hs-identifier hs-var">qdef</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; ViaJSON a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.ViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">PermDefPermission b a
</span><a href="#local-6989586621690601435"><span class="hs-identifier hs-var">qdef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690601434"><span class="hs-identifier hs-var">mComment</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SystemDefined
</span><a href="#local-6989586621690601433"><span class="hs-identifier hs-var">systemDefined</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>      </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span id="local-6989586621690602371"><span class="annot"><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addCronTriggerToCatalog"><span class="hs-identifier hs-type">addCronTriggerToCatalog</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602371"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.ScheduledTrigger.html#CronTriggerMetadata"><span class="hs-identifier hs-type">CronTriggerMetadata</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690602371"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-371"></span><span id="addCronTriggerToCatalog"><span class="annot"><span class="annottext">addCronTriggerToCatalog :: forall (m :: * -&gt; *). MonadTx m =&gt; CronTriggerMetadata -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addCronTriggerToCatalog"><span class="hs-identifier hs-var hs-var">addCronTriggerToCatalog</span></a></span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.ScheduledTrigger.html#CronTriggerMetadata"><span class="hs-identifier hs-type">CronTriggerMetadata</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621690601392"><span id="local-6989586621690601393"><span id="local-6989586621690601394"><span id="local-6989586621690601395"><span id="local-6989586621690601396"><span id="local-6989586621690601397"><span id="local-6989586621690601398"><span id="local-6989586621690601399"><span id="local-6989586621690601400"><span id="local-6989586621690601401"><span class="annot"><span class="annottext">Bool
[HeaderConf]
Maybe Value
Maybe Text
Maybe MetadataResponseTransform
Maybe RequestTransform
CronSchedule
InputWebhook
TriggerName
STRetryConf
ctResponseTransform :: CronTriggerMetadata -&gt; Maybe MetadataResponseTransform
ctRequestTransform :: CronTriggerMetadata -&gt; Maybe RequestTransform
ctComment :: CronTriggerMetadata -&gt; Maybe Text
ctIncludeInMetadata :: CronTriggerMetadata -&gt; Bool
ctHeaders :: CronTriggerMetadata -&gt; [HeaderConf]
ctRetryConf :: CronTriggerMetadata -&gt; STRetryConf
ctPayload :: CronTriggerMetadata -&gt; Maybe Value
ctSchedule :: CronTriggerMetadata -&gt; CronSchedule
ctWebhook :: CronTriggerMetadata -&gt; InputWebhook
ctName :: CronTriggerMetadata -&gt; TriggerName
ctResponseTransform :: Maybe MetadataResponseTransform
ctRequestTransform :: Maybe RequestTransform
ctComment :: Maybe Text
ctIncludeInMetadata :: Bool
ctHeaders :: [HeaderConf]
ctRetryConf :: STRetryConf
ctPayload :: Maybe Value
ctSchedule :: CronSchedule
ctWebhook :: InputWebhook
ctName :: TriggerName
</span><a href="Hasura.RQL.Types.ScheduledTrigger.html#ctResponseTransform"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-372"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r e.
(MonadIO m, ToPrepArgs r) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; r -&gt; Bool -&gt; TxET e m ()
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.unitQE</span></a></span><span>
</span><span id="line-373"></span><span>    </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span>
</span><span id="line-374"></span><span>    </span><span class="annot"><span class="">[PG.sql|
      INSERT into hdb_catalog.hdb_cron_triggers
        (name, webhook_conf, cron_schedule, payload, retry_conf, header_conf, include_in_metadata, comment)
      VALUES ($1, $2, $3, $4, $5, $6, $7, $8)
    |]</span></span><span>
</span><span id="line-379"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><a href="#local-6989586621690601401"><span class="hs-identifier hs-var">ctName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-380"></span><span>      </span><span class="annot"><span class="annottext">forall a. a -&gt; ViaJSON a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.ViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">InputWebhook
</span><a href="#local-6989586621690601400"><span class="hs-identifier hs-var">ctWebhook</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-381"></span><span>      </span><span class="annot"><span class="annottext">CronSchedule
</span><a href="#local-6989586621690601399"><span class="hs-identifier hs-var">ctSchedule</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-382"></span><span>      </span><span class="annot"><span class="annottext">forall a. a -&gt; ViaJSON a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.ViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621690601398"><span class="hs-identifier hs-var">ctPayload</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-383"></span><span>      </span><span class="annot"><span class="annottext">forall a. a -&gt; ViaJSON a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.ViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">STRetryConf
</span><a href="#local-6989586621690601397"><span class="hs-identifier hs-var">ctRetryConf</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-384"></span><span>      </span><span class="annot"><span class="annottext">forall a. a -&gt; ViaJSON a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.ViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">[HeaderConf]
</span><a href="#local-6989586621690601396"><span class="hs-identifier hs-var">ctHeaders</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-385"></span><span>      </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690601395"><span class="hs-identifier hs-var">ctIncludeInMetadata</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-386"></span><span>      </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690601394"><span class="hs-identifier hs-var">ctComment</span></a></span><span>
</span><span id="line-387"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>    </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-389"></span><span>  </span><span id="local-6989586621690601380"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621690601380"><span class="hs-identifier hs-var">currentTime</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">IO UTCTime
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/time-1.11.1.1/src"><span class="hs-identifier hs-var">C.getCurrentTime</span></a></span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690601377"><span class="annot"><span class="annottext">scheduleTimes :: [UTCTime]
</span><a href="#local-6989586621690601377"><span class="hs-identifier hs-var hs-var">scheduleTimes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; Int -&gt; CronSchedule -&gt; [UTCTime]
</span><a href="Hasura.Eventing.Common.html#generateScheduleTimes"><span class="hs-identifier hs-var">generateScheduleTimes</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621690601380"><span class="hs-identifier hs-var">currentTime</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">CronSchedule
</span><a href="#local-6989586621690601399"><span class="hs-identifier hs-var">ctSchedule</span></a></span><span> </span><span class="hs-comment">-- generate next 100 events</span><span>
</span><span id="line-391"></span><span>  </span><span class="annot"><span class="annottext">[CronEventSeed] -&gt; TxE QErr ()
</span><a href="Hasura.Eventing.ScheduledTrigger.html#insertCronEventsTx"><span class="hs-identifier hs-var">insertCronEventsTx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TriggerName -&gt; UTCTime -&gt; CronEventSeed
</span><a href="Hasura.RQL.Types.ScheduledTrigger.html#CronEventSeed"><span class="hs-identifier hs-var">CronEventSeed</span></a></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><a href="#local-6989586621690601401"><span class="hs-identifier hs-var">ctName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[UTCTime]
</span><a href="#local-6989586621690601377"><span class="hs-identifier hs-var">scheduleTimes</span></a></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span id="local-6989586621690602256"><span class="annot"><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#parseLegacyRemoteRelationshipDefinition"><span class="hs-identifier hs-type">parseLegacyRemoteRelationshipDefinition</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-394"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602256"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-395"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-396"></span><span>  </span><span class="annot"><a href="#local-6989586621690602256"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Remote.html#RemoteRelationshipDefinition"><span class="hs-identifier hs-type">RemoteRelationshipDefinition</span></a></span></span><span>
</span><span id="line-397"></span><span id="parseLegacyRemoteRelationshipDefinition"><span class="annot"><span class="annottext">parseLegacyRemoteRelationshipDefinition :: forall (m :: * -&gt; *).
MonadError QErr m =&gt;
Value -&gt; m RemoteRelationshipDefinition
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#parseLegacyRemoteRelationshipDefinition"><span class="hs-identifier hs-var hs-var">parseLegacyRemoteRelationshipDefinition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-398"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) v a. QErrM m =&gt; (v -&gt; Parser a) -&gt; v -&gt; m a
</span><a href="Hasura.Base.Error.html#runAesonParser"><span class="hs-identifier hs-var">runAesonParser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RRParseMode -&gt; Value -&gt; Parser RemoteRelationshipDefinition
</span><a href="Hasura.RQL.Types.Relationships.Remote.html#parseRemoteRelationshipDefinition"><span class="hs-identifier hs-var">parseRemoteRelationshipDefinition</span></a></span><span> </span><span class="annot"><span class="annottext">RRParseMode
</span><a href="Hasura.RQL.Types.Relationships.Remote.html#RRPLegacy"><span class="hs-identifier hs-var">RRPLegacy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span id="local-6989586621690602249"><span class="annot"><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#fetchMetadataFromHdbTables"><span class="hs-identifier hs-type">fetchMetadataFromHdbTables</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602249"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690602249"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.html#MetadataNoSources"><span class="hs-identifier hs-type">MetadataNoSources</span></a></span></span><span>
</span><span id="line-401"></span><span id="fetchMetadataFromHdbTables"><span class="annot"><span class="annottext">fetchMetadataFromHdbTables :: forall (m :: * -&gt; *). MonadTx m =&gt; m MetadataNoSources
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#fetchMetadataFromHdbTables"><span class="hs-identifier hs-var hs-var">fetchMetadataFromHdbTables</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-402"></span><span>  </span><span id="local-6989586621690601182"><span class="annot"><span class="annottext">[(SchemaName, TableName, Bool,
  Maybe (ViaJSON (TableConfig ('Postgres 'Vanilla))))]
</span><a href="#local-6989586621690601182"><span class="hs-identifier hs-var">tables</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e e' a.
Functor m =&gt;
(e -&gt; e') -&gt; TxET e m a -&gt; TxET e' m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.catchE</span></a></span><span> </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span> </span><span class="annot"><span class="annottext">TxT
  IO
  [(SchemaName, TableName, Bool,
    Maybe (ViaJSON (TableConfig ('Postgres 'Vanilla))))]
</span><a href="#local-6989586621690601180"><span class="hs-identifier hs-var">fetchTables</span></a></span><span>
</span><span id="line-403"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690601179"><span class="annot"><span class="annottext">tableMetaMap :: InsOrdHashMap QualifiedTable (TableMetadata ('Postgres 'Vanilla))
</span><a href="#local-6989586621690601179"><span class="hs-identifier hs-var hs-var">tableMetaMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; InsOrdHashMap k v
</span><span class="hs-identifier hs-var">OMap.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">[(SchemaName, TableName, Bool,
  Maybe (ViaJSON (TableConfig ('Postgres 'Vanilla))))]
</span><a href="#local-6989586621690601182"><span class="hs-identifier hs-var">tables</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-404"></span><span>        </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621690601176"><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690601176"><span class="hs-identifier hs-var">schema</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690601175"><span class="annot"><span class="annottext">TableName
</span><a href="#local-6989586621690601175"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690601174"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690601174"><span class="hs-identifier hs-var">isEnum</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690601173"><span class="annot"><span class="annottext">Maybe (ViaJSON (TableConfig ('Postgres 'Vanilla)))
</span><a href="#local-6989586621690601173"><span class="hs-identifier hs-var">maybeConfig</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-405"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690601172"><span class="annot"><span class="annottext">qualifiedName :: QualifiedTable
</span><a href="#local-6989586621690601172"><span class="hs-identifier hs-var hs-var">qualifiedName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. SchemaName -&gt; a -&gt; QualifiedObject a
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedObject"><span class="hs-identifier hs-var">QualifiedObject</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690601176"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="annot"><span class="annottext">TableName
</span><a href="#local-6989586621690601175"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-406"></span><span>              </span><span id="local-6989586621690601171"><span class="annot"><span class="annottext">configuration :: TableConfig ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601171"><span class="hs-identifier hs-var hs-var">configuration</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType). TableConfig b
</span><a href="Hasura.RQL.Types.Table.html#emptyTableConfig"><span class="hs-identifier hs-var">emptyTableConfig</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. ViaJSON a -&gt; a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.getViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ViaJSON (TableConfig ('Postgres 'Vanilla)))
</span><a href="#local-6989586621690601173"><span class="hs-identifier hs-var">maybeConfig</span></a></span><span>
</span><span id="line-407"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690601172"><span class="hs-identifier hs-var">qualifiedName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType).
TableName b -&gt; Bool -&gt; TableConfig b -&gt; TableMetadata b
</span><a href="Hasura.RQL.Types.Metadata.Common.html#mkTableMeta"><span class="hs-identifier hs-var">mkTableMeta</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690601172"><span class="hs-identifier hs-var">qualifiedName</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690601174"><span class="hs-identifier hs-var">isEnum</span></a></span><span> </span><span class="annot"><span class="annottext">TableConfig ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601171"><span class="hs-identifier hs-var">configuration</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span>  </span><span class="hs-comment">-- Fetch all the relationships</span><span>
</span><span id="line-410"></span><span>  </span><span id="local-6989586621690601166"><span class="annot"><span class="annottext">[(SchemaName, TableName, RelName, RelType, ViaJSON Value,
  Maybe Text)]
</span><a href="#local-6989586621690601166"><span class="hs-identifier hs-var">relationships</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e e' a.
Functor m =&gt;
(e -&gt; e') -&gt; TxET e m a -&gt; TxET e' m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.catchE</span></a></span><span> </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span> </span><span class="annot"><span class="annottext">TxT
  IO
  [(SchemaName, TableName, RelName, RelType, ViaJSON Value,
    Maybe Text)]
</span><a href="#local-6989586621690601165"><span class="hs-identifier hs-var">fetchRelationships</span></a></span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span>  </span><span id="local-6989586621690601164"><span class="annot"><span class="annottext">[(QualifiedTable, ObjRelDef ('Postgres 'Vanilla))]
</span><a href="#local-6989586621690601164"><span class="hs-identifier hs-var">objRelDefs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {a} {d} {a}.
(MonadError QErr m, FromJSON a, Eq d) =&gt;
d
-&gt; [(SchemaName, a, RelName, d, ViaJSON Value, Maybe Text)]
-&gt; m [(QualifiedObject a, RelDef a)]
</span><a href="#local-6989586621690601163"><span class="hs-identifier hs-var">mkRelDefs</span></a></span><span> </span><span class="annot"><span class="annottext">RelType
</span><a href="Hasura.RQL.Types.Common.html#ObjRel"><span class="hs-identifier hs-var">ObjRel</span></a></span><span> </span><span class="annot"><span class="annottext">[(SchemaName, TableName, RelName, RelType, ViaJSON Value,
  Maybe Text)]
</span><a href="#local-6989586621690601166"><span class="hs-identifier hs-var">relationships</span></a></span><span>
</span><span id="line-413"></span><span>  </span><span id="local-6989586621690601162"><span class="annot"><span class="annottext">[(QualifiedTable, ArrRelDef ('Postgres 'Vanilla))]
</span><a href="#local-6989586621690601162"><span class="hs-identifier hs-var">arrRelDefs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {a} {d} {a}.
(MonadError QErr m, FromJSON a, Eq d) =&gt;
d
-&gt; [(SchemaName, a, RelName, d, ViaJSON Value, Maybe Text)]
-&gt; m [(QualifiedObject a, RelDef a)]
</span><a href="#local-6989586621690601163"><span class="hs-identifier hs-var">mkRelDefs</span></a></span><span> </span><span class="annot"><span class="annottext">RelType
</span><a href="Hasura.RQL.Types.Common.html#ArrRel"><span class="hs-identifier hs-var">ArrRel</span></a></span><span> </span><span class="annot"><span class="annottext">[(SchemaName, TableName, RelName, RelType, ViaJSON Value,
  Maybe Text)]
</span><a href="#local-6989586621690601166"><span class="hs-identifier hs-var">relationships</span></a></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span>  </span><span class="hs-comment">-- Fetch all the permissions</span><span>
</span><span id="line-416"></span><span>  </span><span id="local-6989586621690601161"><span class="annot"><span class="annottext">[(SchemaName, TableName, RoleName, PermType, ViaJSON Value,
  Maybe Text)]
</span><a href="#local-6989586621690601161"><span class="hs-identifier hs-var">permissions</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e e' a.
Functor m =&gt;
(e -&gt; e') -&gt; TxET e m a -&gt; TxET e' m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.catchE</span></a></span><span> </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span> </span><span class="annot"><span class="annottext">TxT
  IO
  [(SchemaName, TableName, RoleName, PermType, ViaJSON Value,
    Maybe Text)]
</span><a href="#local-6989586621690601160"><span class="hs-identifier hs-var">fetchPermissions</span></a></span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span>  </span><span class="hs-comment">-- Parse all the permissions</span><span>
</span><span id="line-419"></span><span>  </span><span id="local-6989586621690601159"><span class="annot"><span class="annottext">[(QualifiedTable, InsPermDef ('Postgres 'Vanilla))]
</span><a href="#local-6989586621690601159"><span class="hs-identifier hs-var">insPermDefs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {b :: BackendType} {perm :: BackendType -&gt; *}
       {d} {a}.
(MonadError QErr m, FromJSON (PermDefPermission b perm), Eq d) =&gt;
d
-&gt; [(SchemaName, a, RoleName, d, ViaJSON Value, Maybe Text)]
-&gt; m [(QualifiedObject a, PermDef b perm)]
</span><a href="#local-6989586621690601158"><span class="hs-identifier hs-var">mkPermDefs</span></a></span><span> </span><span class="annot"><span class="annottext">PermType
</span><a href="Hasura.RQL.Types.Permission.html#PTInsert"><span class="hs-identifier hs-var">PTInsert</span></a></span><span> </span><span class="annot"><span class="annottext">[(SchemaName, TableName, RoleName, PermType, ViaJSON Value,
  Maybe Text)]
</span><a href="#local-6989586621690601161"><span class="hs-identifier hs-var">permissions</span></a></span><span>
</span><span id="line-420"></span><span>  </span><span id="local-6989586621690601156"><span class="annot"><span class="annottext">[(QualifiedTable, SelPermDef ('Postgres 'Vanilla))]
</span><a href="#local-6989586621690601156"><span class="hs-identifier hs-var">selPermDefs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {b :: BackendType} {perm :: BackendType -&gt; *}
       {d} {a}.
(MonadError QErr m, FromJSON (PermDefPermission b perm), Eq d) =&gt;
d
-&gt; [(SchemaName, a, RoleName, d, ViaJSON Value, Maybe Text)]
-&gt; m [(QualifiedObject a, PermDef b perm)]
</span><a href="#local-6989586621690601158"><span class="hs-identifier hs-var">mkPermDefs</span></a></span><span> </span><span class="annot"><span class="annottext">PermType
</span><a href="Hasura.RQL.Types.Permission.html#PTSelect"><span class="hs-identifier hs-var">PTSelect</span></a></span><span> </span><span class="annot"><span class="annottext">[(SchemaName, TableName, RoleName, PermType, ViaJSON Value,
  Maybe Text)]
</span><a href="#local-6989586621690601161"><span class="hs-identifier hs-var">permissions</span></a></span><span>
</span><span id="line-421"></span><span>  </span><span id="local-6989586621690601154"><span class="annot"><span class="annottext">[(QualifiedTable, UpdPermDef ('Postgres 'Vanilla))]
</span><a href="#local-6989586621690601154"><span class="hs-identifier hs-var">updPermDefs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {b :: BackendType} {perm :: BackendType -&gt; *}
       {d} {a}.
(MonadError QErr m, FromJSON (PermDefPermission b perm), Eq d) =&gt;
d
-&gt; [(SchemaName, a, RoleName, d, ViaJSON Value, Maybe Text)]
-&gt; m [(QualifiedObject a, PermDef b perm)]
</span><a href="#local-6989586621690601158"><span class="hs-identifier hs-var">mkPermDefs</span></a></span><span> </span><span class="annot"><span class="annottext">PermType
</span><a href="Hasura.RQL.Types.Permission.html#PTUpdate"><span class="hs-identifier hs-var">PTUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">[(SchemaName, TableName, RoleName, PermType, ViaJSON Value,
  Maybe Text)]
</span><a href="#local-6989586621690601161"><span class="hs-identifier hs-var">permissions</span></a></span><span>
</span><span id="line-422"></span><span>  </span><span id="local-6989586621690601152"><span class="annot"><span class="annottext">[(QualifiedTable, DelPermDef ('Postgres 'Vanilla))]
</span><a href="#local-6989586621690601152"><span class="hs-identifier hs-var">delPermDefs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {b :: BackendType} {perm :: BackendType -&gt; *}
       {d} {a}.
(MonadError QErr m, FromJSON (PermDefPermission b perm), Eq d) =&gt;
d
-&gt; [(SchemaName, a, RoleName, d, ViaJSON Value, Maybe Text)]
-&gt; m [(QualifiedObject a, PermDef b perm)]
</span><a href="#local-6989586621690601158"><span class="hs-identifier hs-var">mkPermDefs</span></a></span><span> </span><span class="annot"><span class="annottext">PermType
</span><a href="Hasura.RQL.Types.Permission.html#PTDelete"><span class="hs-identifier hs-var">PTDelete</span></a></span><span> </span><span class="annot"><span class="annottext">[(SchemaName, TableName, RoleName, PermType, ViaJSON Value,
  Maybe Text)]
</span><a href="#local-6989586621690601161"><span class="hs-identifier hs-var">permissions</span></a></span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span>  </span><span class="hs-comment">-- Fetch all event triggers</span><span>
</span><span id="line-425"></span><span>  </span><span id="local-6989586621690601150"><span class="annot"><span class="annottext">[(SchemaName, TableName, ViaJSON Value)]
</span><a href="#local-6989586621690601150"><span class="hs-identifier hs-var">eventTriggers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#SchemaName"><span class="hs-identifier hs-type">SchemaName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#TableName"><span class="hs-identifier hs-type">Postgres.TableName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.ViaJSON</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e e' a.
Functor m =&gt;
(e -&gt; e') -&gt; TxET e m a -&gt; TxET e' m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.catchE</span></a></span><span> </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span> </span><span class="annot"><span class="annottext">TxT IO [(SchemaName, TableName, ViaJSON Value)]
</span><a href="#local-6989586621690601149"><span class="hs-identifier hs-var">fetchEventTriggers</span></a></span><span>
</span><span id="line-426"></span><span>  </span><span id="local-6989586621690601148"><span class="annot"><span class="annottext">[(QualifiedTable, EventTriggerConf ('Postgres 'Vanilla))]
</span><a href="#local-6989586621690601148"><span class="hs-identifier hs-var">triggerMetaDefs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {a}.
[(SchemaName, a, ViaJSON Value)]
-&gt; TxET
     QErr
     IO
     [(QualifiedObject a, EventTriggerConf ('Postgres 'Vanilla))]
</span><a href="#local-6989586621690601147"><span class="hs-identifier hs-var">mkTriggerMetaDefs</span></a></span><span> </span><span class="annot"><span class="annottext">[(SchemaName, TableName, ViaJSON Value)]
</span><a href="#local-6989586621690601150"><span class="hs-identifier hs-var">eventTriggers</span></a></span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span>  </span><span class="hs-comment">-- Fetch all computed fields</span><span>
</span><span id="line-429"></span><span>  </span><span id="local-6989586621690601146"><span class="annot"><span class="annottext">[(QualifiedTable, ComputedFieldMetadata ('Postgres 'Vanilla))]
</span><a href="#local-6989586621690601146"><span class="hs-identifier hs-var">computedFields</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxET
  QErr
  IO
  [(QualifiedTable, ComputedFieldMetadata ('Postgres 'Vanilla))]
</span><a href="#local-6989586621690601145"><span class="hs-identifier hs-var">fetchComputedFields</span></a></span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span>  </span><span class="hs-comment">-- Fetch all remote relationships</span><span>
</span><span id="line-432"></span><span>  </span><span id="local-6989586621690601144"><span class="annot"><span class="annottext">[(QualifiedTable, RelName, Value)]
</span><a href="#local-6989586621690601144"><span class="hs-identifier hs-var">remoteRelationshipsRaw</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e e' a.
Functor m =&gt;
(e -&gt; e') -&gt; TxET e m a -&gt; TxET e' m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.catchE</span></a></span><span> </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span> </span><span class="annot"><span class="annottext">TxET PGTxErr IO [(QualifiedTable, RelName, Value)]
</span><a href="#local-6989586621690601143"><span class="hs-identifier hs-var">fetchRemoteRelationships</span></a></span><span>
</span><span id="line-433"></span><span>  </span><span id="local-6989586621690601142"><span class="annot"><span class="annottext">[(QualifiedTable, RemoteRelationship)]
</span><a href="#local-6989586621690601142"><span class="hs-identifier hs-var">remoteRelationships</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">for</span></a></span><span> </span><span class="annot"><span class="annottext">[(QualifiedTable, RelName, Value)]
</span><a href="#local-6989586621690601144"><span class="hs-identifier hs-var">remoteRelationshipsRaw</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621690601140"><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690601140"><span class="hs-identifier hs-var">table</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690601139"><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690601139"><span class="hs-identifier hs-var">relationshipName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690601138"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621690601138"><span class="hs-identifier hs-var">definitionValue</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-434"></span><span>    </span><span id="local-6989586621690601137"><span class="annot"><span class="annottext">RemoteRelationshipDefinition
</span><a href="#local-6989586621690601137"><span class="hs-identifier hs-var">definition</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadError QErr m =&gt;
Value -&gt; m RemoteRelationshipDefinition
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#parseLegacyRemoteRelationshipDefinition"><span class="hs-identifier hs-var">parseLegacyRemoteRelationshipDefinition</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621690601138"><span class="hs-identifier hs-var">definitionValue</span></a></span><span>
</span><span id="line-435"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690601140"><span class="hs-identifier hs-var">table</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall definition.
RelName -&gt; definition -&gt; RemoteRelationshipG definition
</span><a href="Hasura.RQL.Types.Common.html#RemoteRelationship"><span class="hs-identifier hs-var">RemoteRelationship</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690601139"><span class="hs-identifier hs-var">relationshipName</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteRelationshipDefinition
</span><a href="#local-6989586621690601137"><span class="hs-identifier hs-var">definition</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690601136"><span class="annot"><span class="annottext">InsOrdHashMap QualifiedTable (TableMetadata ('Postgres 'Vanilla))
</span><a href="#local-6989586621690601136"><span class="hs-identifier hs-var">fullTableMetaMap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall s a. State s a -&gt; s -&gt; (a, s)
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runState</span></a></span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap QualifiedTable (TableMetadata ('Postgres 'Vanilla))
</span><a href="#local-6989586621690601179"><span class="hs-identifier hs-var">tableMetaMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-438"></span><span>        </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {a} {t :: * -&gt; *} {k} {v}.
(MonadState a m, Foldable t, At a, Hashable k) =&gt;
((InsOrdHashMap k v -&gt; Identity (InsOrdHashMap k v))
 -&gt; IxValue a -&gt; Identity (IxValue a))
-&gt; (v -&gt; k) -&gt; t (Index a, v) -&gt; m ()
</span><a href="#local-6989586621690601134"><span class="hs-identifier hs-var">modMetaMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType).
Lens' (TableMetadata b) (Relationships (ObjRelDef b))
</span><a href="Hasura.RQL.Types.Metadata.Common.html#tmObjectRelationships"><span class="hs-identifier hs-var">tmObjectRelationships</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. RelDef a -&gt; RelName
</span><a href="Hasura.RQL.Types.Relationships.Local.html#_rdName"><span class="hs-identifier hs-var">_rdName</span></a></span><span> </span><span class="annot"><span class="annottext">[(QualifiedTable, ObjRelDef ('Postgres 'Vanilla))]
</span><a href="#local-6989586621690601164"><span class="hs-identifier hs-var">objRelDefs</span></a></span><span>
</span><span id="line-439"></span><span>        </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {a} {t :: * -&gt; *} {k} {v}.
(MonadState a m, Foldable t, At a, Hashable k) =&gt;
((InsOrdHashMap k v -&gt; Identity (InsOrdHashMap k v))
 -&gt; IxValue a -&gt; Identity (IxValue a))
-&gt; (v -&gt; k) -&gt; t (Index a, v) -&gt; m ()
</span><a href="#local-6989586621690601134"><span class="hs-identifier hs-var">modMetaMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType).
Lens' (TableMetadata b) (Relationships (ArrRelDef b))
</span><a href="Hasura.RQL.Types.Metadata.Common.html#tmArrayRelationships"><span class="hs-identifier hs-var">tmArrayRelationships</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. RelDef a -&gt; RelName
</span><a href="Hasura.RQL.Types.Relationships.Local.html#_rdName"><span class="hs-identifier hs-var">_rdName</span></a></span><span> </span><span class="annot"><span class="annottext">[(QualifiedTable, ArrRelDef ('Postgres 'Vanilla))]
</span><a href="#local-6989586621690601162"><span class="hs-identifier hs-var">arrRelDefs</span></a></span><span>
</span><span id="line-440"></span><span>        </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {a} {t :: * -&gt; *} {k} {v}.
(MonadState a m, Foldable t, At a, Hashable k) =&gt;
((InsOrdHashMap k v -&gt; Identity (InsOrdHashMap k v))
 -&gt; IxValue a -&gt; Identity (IxValue a))
-&gt; (v -&gt; k) -&gt; t (Index a, v) -&gt; m ()
</span><a href="#local-6989586621690601134"><span class="hs-identifier hs-var">modMetaMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType).
Lens' (TableMetadata b) (Permissions (InsPermDef b))
</span><a href="Hasura.RQL.Types.Metadata.Common.html#tmInsertPermissions"><span class="hs-identifier hs-var">tmInsertPermissions</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) (perm :: BackendType -&gt; *).
PermDef b perm -&gt; RoleName
</span><a href="Hasura.RQL.Types.Permission.html#_pdRole"><span class="hs-identifier hs-var">_pdRole</span></a></span><span> </span><span class="annot"><span class="annottext">[(QualifiedTable, InsPermDef ('Postgres 'Vanilla))]
</span><a href="#local-6989586621690601159"><span class="hs-identifier hs-var">insPermDefs</span></a></span><span>
</span><span id="line-441"></span><span>        </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {a} {t :: * -&gt; *} {k} {v}.
(MonadState a m, Foldable t, At a, Hashable k) =&gt;
((InsOrdHashMap k v -&gt; Identity (InsOrdHashMap k v))
 -&gt; IxValue a -&gt; Identity (IxValue a))
-&gt; (v -&gt; k) -&gt; t (Index a, v) -&gt; m ()
</span><a href="#local-6989586621690601134"><span class="hs-identifier hs-var">modMetaMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType).
Lens' (TableMetadata b) (Permissions (SelPermDef b))
</span><a href="Hasura.RQL.Types.Metadata.Common.html#tmSelectPermissions"><span class="hs-identifier hs-var">tmSelectPermissions</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) (perm :: BackendType -&gt; *).
PermDef b perm -&gt; RoleName
</span><a href="Hasura.RQL.Types.Permission.html#_pdRole"><span class="hs-identifier hs-var">_pdRole</span></a></span><span> </span><span class="annot"><span class="annottext">[(QualifiedTable, SelPermDef ('Postgres 'Vanilla))]
</span><a href="#local-6989586621690601156"><span class="hs-identifier hs-var">selPermDefs</span></a></span><span>
</span><span id="line-442"></span><span>        </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {a} {t :: * -&gt; *} {k} {v}.
(MonadState a m, Foldable t, At a, Hashable k) =&gt;
((InsOrdHashMap k v -&gt; Identity (InsOrdHashMap k v))
 -&gt; IxValue a -&gt; Identity (IxValue a))
-&gt; (v -&gt; k) -&gt; t (Index a, v) -&gt; m ()
</span><a href="#local-6989586621690601134"><span class="hs-identifier hs-var">modMetaMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType).
Lens' (TableMetadata b) (Permissions (UpdPermDef b))
</span><a href="Hasura.RQL.Types.Metadata.Common.html#tmUpdatePermissions"><span class="hs-identifier hs-var">tmUpdatePermissions</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) (perm :: BackendType -&gt; *).
PermDef b perm -&gt; RoleName
</span><a href="Hasura.RQL.Types.Permission.html#_pdRole"><span class="hs-identifier hs-var">_pdRole</span></a></span><span> </span><span class="annot"><span class="annottext">[(QualifiedTable, UpdPermDef ('Postgres 'Vanilla))]
</span><a href="#local-6989586621690601154"><span class="hs-identifier hs-var">updPermDefs</span></a></span><span>
</span><span id="line-443"></span><span>        </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {a} {t :: * -&gt; *} {k} {v}.
(MonadState a m, Foldable t, At a, Hashable k) =&gt;
((InsOrdHashMap k v -&gt; Identity (InsOrdHashMap k v))
 -&gt; IxValue a -&gt; Identity (IxValue a))
-&gt; (v -&gt; k) -&gt; t (Index a, v) -&gt; m ()
</span><a href="#local-6989586621690601134"><span class="hs-identifier hs-var">modMetaMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType).
Lens' (TableMetadata b) (Permissions (DelPermDef b))
</span><a href="Hasura.RQL.Types.Metadata.Common.html#tmDeletePermissions"><span class="hs-identifier hs-var">tmDeletePermissions</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) (perm :: BackendType -&gt; *).
PermDef b perm -&gt; RoleName
</span><a href="Hasura.RQL.Types.Permission.html#_pdRole"><span class="hs-identifier hs-var">_pdRole</span></a></span><span> </span><span class="annot"><span class="annottext">[(QualifiedTable, DelPermDef ('Postgres 'Vanilla))]
</span><a href="#local-6989586621690601152"><span class="hs-identifier hs-var">delPermDefs</span></a></span><span>
</span><span id="line-444"></span><span>        </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {a} {t :: * -&gt; *} {k} {v}.
(MonadState a m, Foldable t, At a, Hashable k) =&gt;
((InsOrdHashMap k v -&gt; Identity (InsOrdHashMap k v))
 -&gt; IxValue a -&gt; Identity (IxValue a))
-&gt; (v -&gt; k) -&gt; t (Index a, v) -&gt; m ()
</span><a href="#local-6989586621690601134"><span class="hs-identifier hs-var">modMetaMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType).
Lens' (TableMetadata b) (EventTriggers b)
</span><a href="Hasura.RQL.Types.Metadata.Common.html#tmEventTriggers"><span class="hs-identifier hs-var">tmEventTriggers</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType). EventTriggerConf b -&gt; TriggerName
</span><a href="Hasura.RQL.Types.EventTrigger.html#etcName"><span class="hs-identifier hs-var">etcName</span></a></span><span> </span><span class="annot"><span class="annottext">[(QualifiedTable, EventTriggerConf ('Postgres 'Vanilla))]
</span><a href="#local-6989586621690601148"><span class="hs-identifier hs-var">triggerMetaDefs</span></a></span><span>
</span><span id="line-445"></span><span>        </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {a} {t :: * -&gt; *} {k} {v}.
(MonadState a m, Foldable t, At a, Hashable k) =&gt;
((InsOrdHashMap k v -&gt; Identity (InsOrdHashMap k v))
 -&gt; IxValue a -&gt; Identity (IxValue a))
-&gt; (v -&gt; k) -&gt; t (Index a, v) -&gt; m ()
</span><a href="#local-6989586621690601134"><span class="hs-identifier hs-var">modMetaMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType).
Lens' (TableMetadata b) (ComputedFields b)
</span><a href="Hasura.RQL.Types.Metadata.Common.html#tmComputedFields"><span class="hs-identifier hs-var">tmComputedFields</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType).
ComputedFieldMetadata b -&gt; ComputedFieldName
</span><a href="Hasura.RQL.Types.Metadata.Common.html#_cfmName"><span class="hs-identifier hs-var">_cfmName</span></a></span><span> </span><span class="annot"><span class="annottext">[(QualifiedTable, ComputedFieldMetadata ('Postgres 'Vanilla))]
</span><a href="#local-6989586621690601146"><span class="hs-identifier hs-var">computedFields</span></a></span><span>
</span><span id="line-446"></span><span>        </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {a} {t :: * -&gt; *} {k} {v}.
(MonadState a m, Foldable t, At a, Hashable k) =&gt;
((InsOrdHashMap k v -&gt; Identity (InsOrdHashMap k v))
 -&gt; IxValue a -&gt; Identity (IxValue a))
-&gt; (v -&gt; k) -&gt; t (Index a, v) -&gt; m ()
</span><a href="#local-6989586621690601134"><span class="hs-identifier hs-var">modMetaMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType).
Lens' (TableMetadata b) RemoteRelationships
</span><a href="Hasura.RQL.Types.Metadata.Common.html#tmRemoteRelationships"><span class="hs-identifier hs-var">tmRemoteRelationships</span></a></span><span> </span><span class="annot"><span class="annottext">forall definition. RemoteRelationshipG definition -&gt; RelName
</span><a href="Hasura.RQL.Types.Common.html#_rrName"><span class="hs-identifier hs-var">_rrName</span></a></span><span> </span><span class="annot"><span class="annottext">[(QualifiedTable, RemoteRelationship)]
</span><a href="#local-6989586621690601142"><span class="hs-identifier hs-var">remoteRelationships</span></a></span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span>  </span><span id="local-6989586621690601120"><span class="annot"><span class="annottext">Functions ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601120"><span class="hs-identifier hs-var">functions</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e e' a.
Functor m =&gt;
(e -&gt; e') -&gt; TxET e m a -&gt; TxET e' m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.catchE</span></a></span><span> </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span> </span><span class="annot"><span class="annottext">TxET PGTxErr IO (Functions ('Postgres 'Vanilla))
</span><a href="#local-6989586621690601119"><span class="hs-identifier hs-var">fetchFunctions</span></a></span><span>
</span><span id="line-449"></span><span>  </span><span id="local-6989586621690601118"><span class="annot"><span class="annottext">RemoteSchemas
</span><a href="#local-6989586621690601118"><span class="hs-identifier hs-var">remoteSchemas</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall k a.
(Eq k, Hashable k) =&gt;
(a -&gt; k) -&gt; [a] -&gt; InsOrdHashMap k a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier hs-var">oMapFromL</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. RemoteSchemaMetadataG r -&gt; RemoteSchemaName
</span><a href="Hasura.RemoteSchema.Metadata.Core.html#_rsmName"><span class="hs-identifier hs-var">_rsmName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall {r}. TxET QErr IO [RemoteSchemaMetadataG r]
</span><a href="#local-6989586621690601115"><span class="hs-identifier hs-var">fetchRemoteSchemas</span></a></span><span>
</span><span id="line-450"></span><span>  </span><span id="local-6989586621690601114"><span class="annot"><span class="annottext">QueryCollections
</span><a href="#local-6989586621690601114"><span class="hs-identifier hs-var">collections</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall k a.
(Eq k, Hashable k) =&gt;
(a -&gt; k) -&gt; [a] -&gt; InsOrdHashMap k a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier hs-var">oMapFromL</span></a></span><span> </span><span class="annot"><span class="annottext">CreateCollection -&gt; CollectionName
</span><a href="Hasura.RQL.Types.QueryCollection.html#_ccName"><span class="hs-identifier hs-var">_ccName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxET QErr IO [CreateCollection]
</span><a href="#local-6989586621690601112"><span class="hs-identifier hs-var">fetchCollections</span></a></span><span>
</span><span id="line-451"></span><span>  </span><span id="local-6989586621690601111"><span class="annot"><span class="annottext">MetadataAllowlist
</span><a href="#local-6989586621690601111"><span class="hs-identifier hs-var">allowlist</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall k a.
(Eq k, Hashable k) =&gt;
(a -&gt; k) -&gt; [a] -&gt; InsOrdHashMap k a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier hs-var">oMapFromL</span></a></span><span> </span><span class="annot"><span class="annottext">AllowlistEntry -&gt; CollectionName
</span><a href="Hasura.RQL.Types.Allowlist.html#aeCollection"><span class="hs-identifier hs-var">aeCollection</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxET QErr IO [AllowlistEntry]
</span><a href="#local-6989586621690601109"><span class="hs-identifier hs-var">fetchAllowlist</span></a></span><span>
</span><span id="line-452"></span><span>  </span><span id="local-6989586621690601108"><span class="annot"><span class="annottext">CustomTypes
</span><a href="#local-6989586621690601108"><span class="hs-identifier hs-var">customTypes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxE QErr CustomTypes
</span><a href="#local-6989586621690601107"><span class="hs-identifier hs-var">fetchCustomTypes</span></a></span><span>
</span><span id="line-453"></span><span>  </span><span id="local-6989586621690601106"><span class="annot"><span class="annottext">Actions
</span><a href="#local-6989586621690601106"><span class="hs-identifier hs-var">actions</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall k a.
(Eq k, Hashable k) =&gt;
(a -&gt; k) -&gt; [a] -&gt; InsOrdHashMap k a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier hs-var">oMapFromL</span></a></span><span> </span><span class="annot"><span class="annottext">ActionMetadata -&gt; ActionName
</span><a href="Hasura.RQL.Types.Action.html#_amName"><span class="hs-identifier hs-var">_amName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxET QErr IO [ActionMetadata]
</span><a href="#local-6989586621690601105"><span class="hs-identifier hs-var">fetchActions</span></a></span><span>
</span><span id="line-454"></span><span>  </span><span id="local-6989586621690601104"><span class="annot"><span class="annottext">CronTriggers
</span><a href="#local-6989586621690601104"><span class="hs-identifier hs-var">cronTriggers</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxET QErr IO CronTriggers
</span><a href="#local-6989586621690601103"><span class="hs-identifier hs-var">fetchCronTriggers</span></a></span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-457"></span><span>    </span><span class="annot"><span class="annottext">Tables ('Postgres 'Vanilla)
-&gt; Functions ('Postgres 'Vanilla)
-&gt; RemoteSchemas
-&gt; QueryCollections
-&gt; MetadataAllowlist
-&gt; CustomTypes
-&gt; Actions
-&gt; CronTriggers
-&gt; MetadataNoSources
</span><a href="Hasura.RQL.Types.Metadata.html#MetadataNoSources"><span class="hs-identifier hs-var">MetadataNoSources</span></a></span><span>
</span><span id="line-458"></span><span>      </span><span class="annot"><span class="annottext">InsOrdHashMap QualifiedTable (TableMetadata ('Postgres 'Vanilla))
</span><a href="#local-6989586621690601136"><span class="hs-identifier hs-var">fullTableMetaMap</span></a></span><span>
</span><span id="line-459"></span><span>      </span><span class="annot"><span class="annottext">Functions ('Postgres 'Vanilla)
</span><a href="#local-6989586621690601120"><span class="hs-identifier hs-var">functions</span></a></span><span>
</span><span id="line-460"></span><span>      </span><span class="annot"><span class="annottext">RemoteSchemas
</span><a href="#local-6989586621690601118"><span class="hs-identifier hs-var">remoteSchemas</span></a></span><span>
</span><span id="line-461"></span><span>      </span><span class="annot"><span class="annottext">QueryCollections
</span><a href="#local-6989586621690601114"><span class="hs-identifier hs-var">collections</span></a></span><span>
</span><span id="line-462"></span><span>      </span><span class="annot"><span class="annottext">MetadataAllowlist
</span><a href="#local-6989586621690601111"><span class="hs-identifier hs-var">allowlist</span></a></span><span>
</span><span id="line-463"></span><span>      </span><span class="annot"><span class="annottext">CustomTypes
</span><a href="#local-6989586621690601108"><span class="hs-identifier hs-var">customTypes</span></a></span><span>
</span><span id="line-464"></span><span>      </span><span class="annot"><span class="annottext">Actions
</span><a href="#local-6989586621690601106"><span class="hs-identifier hs-var">actions</span></a></span><span>
</span><span id="line-465"></span><span>      </span><span class="annot"><span class="annottext">CronTriggers
</span><a href="#local-6989586621690601104"><span class="hs-identifier hs-var">cronTriggers</span></a></span><span>
</span><span id="line-466"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-467"></span><span>    </span><span id="local-6989586621690601134"><span class="annot"><span class="annottext">modMetaMap :: ((InsOrdHashMap k v -&gt; Identity (InsOrdHashMap k v))
 -&gt; IxValue a -&gt; Identity (IxValue a))
-&gt; (v -&gt; k) -&gt; t (Index a, v) -&gt; m ()
</span><a href="#local-6989586621690601134"><span class="hs-identifier hs-var hs-var">modMetaMap</span></a></span></span><span> </span><span id="local-6989586621690601082"><span class="annot"><span class="annottext">(InsOrdHashMap k v -&gt; Identity (InsOrdHashMap k v))
-&gt; IxValue a -&gt; Identity (IxValue a)
</span><a href="#local-6989586621690601082"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621690601081"><span class="annot"><span class="annottext">v -&gt; k
</span><a href="#local-6989586621690601081"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621690601080"><span class="annot"><span class="annottext">t (Index a, v)
</span><a href="#local-6989586621690601080"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-468"></span><span>      </span><span id="local-6989586621690601079"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690601079"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-469"></span><span>      </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621690601075"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690601075"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621690601074"><span class="annot"><span class="annottext">Index a
</span><a href="#local-6989586621690601074"><span class="hs-identifier hs-var">qt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690601073"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621690601073"><span class="hs-identifier hs-var">dfn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690601075"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">forall m. At m =&gt; Index m -&gt; Lens' m (Maybe (IxValue m))
</span><span class="hs-identifier hs-var">at</span></span><span> </span><span class="annot"><span class="annottext">Index a
</span><a href="#local-6989586621690601074"><span class="hs-identifier hs-var">qt</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. Prism (Maybe a) (Maybe b) a b
</span><span class="hs-identifier hs-var">_Just</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(InsOrdHashMap k v -&gt; Identity (InsOrdHashMap k v))
-&gt; IxValue a -&gt; Identity (IxValue a)
</span><a href="#local-6989586621690601082"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">forall k v.
(Eq k, Hashable k) =&gt;
k -&gt; v -&gt; InsOrdHashMap k v -&gt; InsOrdHashMap k v
</span><span class="hs-identifier hs-var">OMap.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; k
</span><a href="#local-6989586621690601081"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621690601073"><span class="hs-identifier hs-var">dfn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621690601073"><span class="hs-identifier hs-var">dfn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690601079"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">t (Index a, v)
</span><a href="#local-6989586621690601080"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span>    </span><span id="local-6989586621690601158"><span class="annot"><span class="annottext">mkPermDefs :: d
-&gt; [(SchemaName, a, RoleName, d, ViaJSON Value, Maybe Text)]
-&gt; m [(QualifiedObject a, PermDef b perm)]
</span><a href="#local-6989586621690601158"><span class="hs-identifier hs-var hs-var">mkPermDefs</span></a></span></span><span> </span><span id="local-6989586621690601053"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621690601053"><span class="hs-identifier hs-var">pt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {b :: BackendType} {perm :: BackendType -&gt; *}
       {a} {d}.
(FromJSON (PermDefPermission b perm), MonadError QErr m) =&gt;
(SchemaName, a, RoleName, d, ViaJSON Value, Maybe Text)
-&gt; m (QualifiedObject a, PermDef b perm)
</span><a href="#local-6989586621690601051"><span class="hs-identifier hs-var">permRowToDef</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621690601050"><span class="annot"><span class="annottext">(SchemaName, a, RoleName, d, ViaJSON Value, Maybe Text)
</span><a href="#local-6989586621690601050"><span class="hs-identifier hs-var">pr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(SchemaName, a, RoleName, d, ViaJSON Value, Maybe Text)
</span><a href="#local-6989586621690601050"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="annot"><span class="annottext">forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">forall s t a b. Field4 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_4</span></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621690601053"><span class="hs-identifier hs-var">pt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span>    </span><span id="local-6989586621690601051"><span class="annot"><span class="annottext">permRowToDef :: (SchemaName, a, RoleName, d, ViaJSON Value, Maybe Text)
-&gt; m (QualifiedObject a, PermDef b perm)
</span><a href="#local-6989586621690601051"><span class="hs-identifier hs-var hs-var">permRowToDef</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621690601040"><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690601040"><span class="hs-identifier hs-var">sn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690601039"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690601039"><span class="hs-identifier hs-var">tn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690601038"><span class="annot"><span class="annottext">RoleName
</span><a href="#local-6989586621690601038"><span class="hs-identifier hs-var">rn</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">d
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.ViaJSON</span></a></span><span> </span><span id="local-6989586621690601037"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621690601037"><span class="hs-identifier hs-var">pDef</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690601036"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690601036"><span class="hs-identifier hs-var">mComment</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-474"></span><span>      </span><span id="local-6989586621690601035"><span class="annot"><span class="annottext">PermDefPermission b perm
</span><a href="#local-6989586621690601035"><span class="hs-identifier hs-var">perm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *). (FromJSON a, QErrM m) =&gt; Value -&gt; m a
</span><a href="Hasura.Base.Error.html#decodeValue"><span class="hs-identifier hs-var">decodeValue</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621690601037"><span class="hs-identifier hs-var">pDef</span></a></span><span>
</span><span id="line-475"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SchemaName -&gt; a -&gt; QualifiedObject a
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedObject"><span class="hs-identifier hs-var">QualifiedObject</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690601040"><span class="hs-identifier hs-var">sn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690601039"><span class="hs-identifier hs-var">tn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) (perm :: BackendType -&gt; *).
RoleName
-&gt; PermDefPermission b perm -&gt; Maybe Text -&gt; PermDef b perm
</span><a href="Hasura.RQL.Types.Permission.html#PermDef"><span class="hs-identifier hs-var">PermDef</span></a></span><span> </span><span class="annot"><span class="annottext">RoleName
</span><a href="#local-6989586621690601038"><span class="hs-identifier hs-var">rn</span></a></span><span> </span><span class="annot"><span class="annottext">PermDefPermission b perm
</span><a href="#local-6989586621690601035"><span class="hs-identifier hs-var">perm</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690601036"><span class="hs-identifier hs-var">mComment</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span>    </span><span id="local-6989586621690601163"><span class="annot"><span class="annottext">mkRelDefs :: d
-&gt; [(SchemaName, a, RelName, d, ViaJSON Value, Maybe Text)]
-&gt; m [(QualifiedObject a, RelDef a)]
</span><a href="#local-6989586621690601163"><span class="hs-identifier hs-var hs-var">mkRelDefs</span></a></span></span><span> </span><span id="local-6989586621690601022"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621690601022"><span class="hs-identifier hs-var">rt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {a} {a} {d}.
(FromJSON a, MonadError QErr m) =&gt;
(SchemaName, a, RelName, d, ViaJSON Value, Maybe Text)
-&gt; m (QualifiedObject a, RelDef a)
</span><a href="#local-6989586621690601021"><span class="hs-identifier hs-var">relRowToDef</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621690601020"><span class="annot"><span class="annottext">(SchemaName, a, RelName, d, ViaJSON Value, Maybe Text)
</span><a href="#local-6989586621690601020"><span class="hs-identifier hs-var">rr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(SchemaName, a, RelName, d, ViaJSON Value, Maybe Text)
</span><a href="#local-6989586621690601020"><span class="hs-identifier hs-var">rr</span></a></span><span> </span><span class="annot"><span class="annottext">forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">forall s t a b. Field4 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_4</span></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621690601022"><span class="hs-identifier hs-var">rt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span>    </span><span id="local-6989586621690601021"><span class="annot"><span class="annottext">relRowToDef :: (SchemaName, a, RelName, d, ViaJSON Value, Maybe Text)
-&gt; m (QualifiedObject a, RelDef a)
</span><a href="#local-6989586621690601021"><span class="hs-identifier hs-var hs-var">relRowToDef</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621690601012"><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690601012"><span class="hs-identifier hs-var">sn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690601011"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690601011"><span class="hs-identifier hs-var">tn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690601010"><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690601010"><span class="hs-identifier hs-var">rn</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">d
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.ViaJSON</span></a></span><span> </span><span id="local-6989586621690601009"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621690601009"><span class="hs-identifier hs-var">rDef</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690601008"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690601008"><span class="hs-identifier hs-var">mComment</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-480"></span><span>      </span><span id="local-6989586621690601007"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690601007"><span class="hs-identifier hs-var">using</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *). (FromJSON a, QErrM m) =&gt; Value -&gt; m a
</span><a href="Hasura.Base.Error.html#decodeValue"><span class="hs-identifier hs-var">decodeValue</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621690601009"><span class="hs-identifier hs-var">rDef</span></a></span><span>
</span><span id="line-481"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SchemaName -&gt; a -&gt; QualifiedObject a
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedObject"><span class="hs-identifier hs-var">QualifiedObject</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690601012"><span class="hs-identifier hs-var">sn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690601011"><span class="hs-identifier hs-var">tn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. RelName -&gt; a -&gt; Maybe Text -&gt; RelDef a
</span><a href="Hasura.RQL.Types.Relationships.Local.html#RelDef"><span class="hs-identifier hs-var">RelDef</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690601010"><span class="hs-identifier hs-var">rn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690601007"><span class="hs-identifier hs-var">using</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690601008"><span class="hs-identifier hs-var">mComment</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span>    </span><span id="local-6989586621690601147"><span class="annot"><span class="annottext">mkTriggerMetaDefs :: [(SchemaName, a, ViaJSON Value)]
-&gt; TxET
     QErr
     IO
     [(QualifiedObject a, EventTriggerConf ('Postgres 'Vanilla))]
</span><a href="#local-6989586621690601147"><span class="hs-identifier hs-var hs-var">mkTriggerMetaDefs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {pgKind :: PostgresKind} {a}.
(HasTag ('Postgres pgKind), Typeable pgKind,
 PostgresBackend pgKind,
 HasCodec (BackendSourceKind ('Postgres pgKind)), MonadError QErr m,
 FromJSON (BackendSourceKind ('Postgres pgKind))) =&gt;
(SchemaName, a, ViaJSON Value)
-&gt; m (QualifiedObject a, EventTriggerConf ('Postgres pgKind))
</span><a href="#local-6989586621690600998"><span class="hs-identifier hs-var">trigRowToDef</span></a></span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span>    </span><span id="local-6989586621690600998"><span class="annot"><span class="annottext">trigRowToDef :: (SchemaName, a, ViaJSON Value)
-&gt; m (QualifiedObject a, EventTriggerConf ('Postgres pgKind))
</span><a href="#local-6989586621690600998"><span class="hs-identifier hs-var hs-var">trigRowToDef</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621690600977"><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690600977"><span class="hs-identifier hs-var">sn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690600976"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690600976"><span class="hs-identifier hs-var">tn</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.ViaJSON</span></a></span><span> </span><span id="local-6989586621690600975"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621690600975"><span class="hs-identifier hs-var">configuration</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-486"></span><span>      </span><span id="local-6989586621690600974"><span id="local-6989586621690600973"><span class="annot"><span class="annottext">EventTriggerConf ('Postgres pgKind)
</span><a href="#local-6989586621690600973"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#EventTriggerConf"><span class="hs-identifier hs-type">EventTriggerConf</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690600974"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *). (FromJSON a, QErrM m) =&gt; Value -&gt; m a
</span><a href="Hasura.Base.Error.html#decodeValue"><span class="hs-identifier hs-var">decodeValue</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621690600975"><span class="hs-identifier hs-var">configuration</span></a></span><span>
</span><span id="line-487"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SchemaName -&gt; a -&gt; QualifiedObject a
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedObject"><span class="hs-identifier hs-var">QualifiedObject</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690600977"><span class="hs-identifier hs-var">sn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690600976"><span class="hs-identifier hs-var">tn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EventTriggerConf ('Postgres pgKind)
</span><a href="#local-6989586621690600973"><span class="hs-identifier hs-var">conf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>
</span><span id="line-489"></span><span>    </span><span id="local-6989586621690601180"><span class="annot"><span class="annottext">fetchTables :: TxT
  IO
  [(SchemaName, TableName, Bool,
    Maybe (ViaJSON (TableConfig ('Postgres 'Vanilla))))]
</span><a href="#local-6989586621690601180"><span class="hs-identifier hs-var hs-var">fetchTables</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-490"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a r.
(MonadIO m, FromRes a, ToPrepArgs r) =&gt;
Query -&gt; r -&gt; Bool -&gt; TxT m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.withQ</span></a></span><span>
</span><span id="line-491"></span><span>        </span><span class="annot"><span class="">[PG.sql|
                SELECT table_schema, table_name, is_enum, configuration::json
                FROM hdb_catalog.hdb_table
                 WHERE is_system_defined = 'false'
                ORDER BY table_schema ASC, table_name ASC
                    |]</span></span><span>
</span><span id="line-497"></span><span>        </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-498"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span>    </span><span id="local-6989586621690601165"><span class="annot"><span class="annottext">fetchRelationships :: TxT
  IO
  [(SchemaName, TableName, RelName, RelType, ViaJSON Value,
    Maybe Text)]
</span><a href="#local-6989586621690601165"><span class="hs-identifier hs-var hs-var">fetchRelationships</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-501"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a r.
(MonadIO m, FromRes a, ToPrepArgs r) =&gt;
Query -&gt; r -&gt; Bool -&gt; TxT m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.withQ</span></a></span><span>
</span><span id="line-502"></span><span>        </span><span class="annot"><span class="">[PG.sql|
                SELECT table_schema, table_name, rel_name, rel_type, rel_def::json, comment
                  FROM hdb_catalog.hdb_relationship
                 WHERE is_system_defined = 'false'
                ORDER BY table_schema ASC, table_name ASC, rel_name ASC
                    |]</span></span><span>
</span><span id="line-508"></span><span>        </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-510"></span><span>
</span><span id="line-511"></span><span>    </span><span id="local-6989586621690601160"><span class="annot"><span class="annottext">fetchPermissions :: TxT
  IO
  [(SchemaName, TableName, RoleName, PermType, ViaJSON Value,
    Maybe Text)]
</span><a href="#local-6989586621690601160"><span class="hs-identifier hs-var hs-var">fetchPermissions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-512"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a r.
(MonadIO m, FromRes a, ToPrepArgs r) =&gt;
Query -&gt; r -&gt; Bool -&gt; TxT m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.withQ</span></a></span><span>
</span><span id="line-513"></span><span>        </span><span class="annot"><span class="">[PG.sql|
                SELECT table_schema, table_name, role_name, perm_type, perm_def::json, comment
                  FROM hdb_catalog.hdb_permission
                 WHERE is_system_defined = 'false'
                ORDER BY table_schema ASC, table_name ASC, role_name ASC, perm_type ASC
                    |]</span></span><span>
</span><span id="line-519"></span><span>        </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-520"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span>    </span><span id="local-6989586621690601149"><span class="annot"><span class="annottext">fetchEventTriggers :: TxT IO [(SchemaName, TableName, ViaJSON Value)]
</span><a href="#local-6989586621690601149"><span class="hs-identifier hs-var hs-var">fetchEventTriggers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-523"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a r.
(MonadIO m, FromRes a, ToPrepArgs r) =&gt;
Query -&gt; r -&gt; Bool -&gt; TxT m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.withQ</span></a></span><span>
</span><span id="line-524"></span><span>        </span><span class="annot"><span class="">[PG.sql|
              SELECT e.schema_name, e.table_name, e.configuration::json
               FROM hdb_catalog.event_triggers e
              ORDER BY e.schema_name ASC, e.table_name ASC, e.name ASC
              |]</span></span><span>
</span><span id="line-529"></span><span>        </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-531"></span><span>
</span><span id="line-532"></span><span>    </span><span id="local-6989586621690601119"><span class="annot"><span class="annottext">fetchFunctions :: TxET PGTxErr IO (Functions ('Postgres 'Vanilla))
</span><a href="#local-6989586621690601119"><span class="hs-identifier hs-var hs-var">fetchFunctions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-533"></span><span>      </span><span id="local-6989586621690600888"><span class="annot"><span class="annottext">[(SchemaName, FunctionName, ViaJSON FunctionConfig)]
</span><a href="#local-6989586621690600888"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-534"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a r.
(MonadIO m, FromRes a, ToPrepArgs r) =&gt;
Query -&gt; r -&gt; Bool -&gt; TxT m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.withQ</span></a></span><span>
</span><span id="line-535"></span><span>          </span><span class="annot"><span class="">[PG.sql|
                SELECT function_schema, function_name, configuration::json
                FROM hdb_catalog.hdb_function
                WHERE is_system_defined = 'false'
                ORDER BY function_schema ASC, function_name ASC
                    |]</span></span><span>
</span><span id="line-541"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-542"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-543"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-544"></span><span>        </span><span class="annot"><span class="annottext">forall k a.
(Eq k, Hashable k) =&gt;
(a -&gt; k) -&gt; [a] -&gt; InsOrdHashMap k a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier hs-var">oMapFromL</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType). FunctionMetadata b -&gt; FunctionName b
</span><a href="Hasura.RQL.Types.Metadata.Common.html#_fmFunction"><span class="hs-identifier hs-var">_fmFunction</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-545"></span><span>          </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">[(SchemaName, FunctionName, ViaJSON FunctionConfig)]
</span><a href="#local-6989586621690600888"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621690600886"><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690600886"><span class="hs-identifier hs-var">sn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690600885"><span class="annot"><span class="annottext">FunctionName
</span><a href="#local-6989586621690600885"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.ViaJSON</span></a></span><span> </span><span id="local-6989586621690600884"><span class="annot"><span class="annottext">FunctionConfig
</span><a href="#local-6989586621690600884"><span class="hs-identifier hs-var">config</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-546"></span><span>            </span><span class="hs-comment">-- function permissions were only introduced post 43rd</span><span>
</span><span id="line-547"></span><span>            </span><span class="hs-comment">-- migration, so it's impossible we get any permissions</span><span>
</span><span id="line-548"></span><span>            </span><span class="hs-comment">-- here</span><span>
</span><span id="line-549"></span><span>            </span><span class="annot"><span class="annottext">forall (b :: BackendType).
FunctionName b
-&gt; FunctionConfig
-&gt; [FunctionPermissionInfo]
-&gt; Maybe Text
-&gt; FunctionMetadata b
</span><a href="Hasura.RQL.Types.Metadata.Common.html#FunctionMetadata"><span class="hs-identifier hs-var">FunctionMetadata</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SchemaName -&gt; a -&gt; QualifiedObject a
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedObject"><span class="hs-identifier hs-var">QualifiedObject</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690600886"><span class="hs-identifier hs-var">sn</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionName
</span><a href="#local-6989586621690600885"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FunctionConfig
</span><a href="#local-6989586621690600884"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span>    </span><span id="local-6989586621690601115"><span class="annot"><span class="annottext">fetchRemoteSchemas :: TxET QErr IO [RemoteSchemaMetadataG r]
</span><a href="#local-6989586621690601115"><span class="hs-identifier hs-var hs-var">fetchRemoteSchemas</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-552"></span><span>      </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall {r}.
(RemoteSchemaName, ViaJSON RemoteSchemaDef, Maybe Text)
-&gt; RemoteSchemaMetadataG r
</span><a href="#local-6989586621690600869"><span class="hs-identifier hs-var">fromRow</span></a></span><span>
</span><span id="line-553"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a r e.
(MonadIO m, FromRes a, ToPrepArgs r) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; r -&gt; Bool -&gt; TxET e m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.withQE</span></a></span><span>
</span><span id="line-554"></span><span>          </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span>
</span><span id="line-555"></span><span>          </span><span class="annot"><span class="">[PG.sql|
         SELECT name, definition, comment
           FROM hdb_catalog.remote_schemas
         ORDER BY name ASC
         |]</span></span><span>
</span><span id="line-560"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-561"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-562"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-563"></span><span>        </span><span id="local-6989586621690600869"><span class="annot"><span class="annottext">fromRow :: (RemoteSchemaName, ViaJSON RemoteSchemaDef, Maybe Text)
-&gt; RemoteSchemaMetadataG r
</span><a href="#local-6989586621690600869"><span class="hs-identifier hs-var hs-var">fromRow</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621690600860"><span class="annot"><span class="annottext">RemoteSchemaName
</span><a href="#local-6989586621690600860"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.ViaJSON</span></a></span><span> </span><span id="local-6989586621690600859"><span class="annot"><span class="annottext">RemoteSchemaDef
</span><a href="#local-6989586621690600859"><span class="hs-identifier hs-var">def</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690600858"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690600858"><span class="hs-identifier hs-var">comment</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-564"></span><span>          </span><span class="annot"><span class="annottext">forall r.
RemoteSchemaName
-&gt; RemoteSchemaDef
-&gt; Maybe Text
-&gt; [RemoteSchemaPermissionMetadata]
-&gt; SchemaRemoteRelationships r
-&gt; RemoteSchemaMetadataG r
</span><a href="Hasura.RemoteSchema.Metadata.Core.html#RemoteSchemaMetadata"><span class="hs-identifier hs-var">RemoteSchemaMetadata</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteSchemaName
</span><a href="#local-6989586621690600860"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteSchemaDef
</span><a href="#local-6989586621690600859"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690600858"><span class="hs-identifier hs-var">comment</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-565"></span><span>
</span><span id="line-566"></span><span>    </span><span id="local-6989586621690601112"><span class="annot"><span class="annottext">fetchCollections :: TxET QErr IO [CreateCollection]
</span><a href="#local-6989586621690601112"><span class="hs-identifier hs-var hs-var">fetchCollections</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-567"></span><span>      </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(CollectionName, ViaJSON CollectionDef, Maybe Text)
-&gt; CreateCollection
</span><a href="#local-6989586621690600843"><span class="hs-identifier hs-var">fromRow</span></a></span><span>
</span><span id="line-568"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a r e.
(MonadIO m, FromRes a, ToPrepArgs r) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; r -&gt; Bool -&gt; TxET e m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.withQE</span></a></span><span>
</span><span id="line-569"></span><span>          </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span>
</span><span id="line-570"></span><span>          </span><span class="annot"><span class="">[PG.sql|
               SELECT collection_name, collection_defn::json, comment
                 FROM hdb_catalog.hdb_query_collection
                 WHERE is_system_defined = 'false'
               ORDER BY collection_name ASC
              |]</span></span><span>
</span><span id="line-576"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-578"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-579"></span><span>        </span><span id="local-6989586621690600843"><span class="annot"><span class="annottext">fromRow :: (CollectionName, ViaJSON CollectionDef, Maybe Text)
-&gt; CreateCollection
</span><a href="#local-6989586621690600843"><span class="hs-identifier hs-var hs-var">fromRow</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621690600842"><span class="annot"><span class="annottext">CollectionName
</span><a href="#local-6989586621690600842"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.ViaJSON</span></a></span><span> </span><span id="local-6989586621690600841"><span class="annot"><span class="annottext">CollectionDef
</span><a href="#local-6989586621690600841"><span class="hs-identifier hs-var">defn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690600840"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690600840"><span class="hs-identifier hs-var">mComment</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-580"></span><span>          </span><span class="annot"><span class="annottext">CollectionName -&gt; CollectionDef -&gt; Maybe Text -&gt; CreateCollection
</span><a href="Hasura.RQL.Types.QueryCollection.html#CreateCollection"><span class="hs-identifier hs-var">CreateCollection</span></a></span><span> </span><span class="annot"><span class="annottext">CollectionName
</span><a href="#local-6989586621690600842"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">CollectionDef
</span><a href="#local-6989586621690600841"><span class="hs-identifier hs-var">defn</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690600840"><span class="hs-identifier hs-var">mComment</span></a></span><span>
</span><span id="line-581"></span><span>
</span><span id="line-582"></span><span>    </span><span id="local-6989586621690601109"><span class="annot"><span class="annottext">fetchAllowlist :: TxET QErr IO [AllowlistEntry]
</span><a href="#local-6989586621690601109"><span class="hs-identifier hs-var hs-var">fetchAllowlist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-583"></span><span>      </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Identity CollectionName -&gt; AllowlistEntry
</span><a href="#local-6989586621690600831"><span class="hs-identifier hs-var">fromRow</span></a></span><span>
</span><span id="line-584"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a r e.
(MonadIO m, FromRes a, ToPrepArgs r) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; r -&gt; Bool -&gt; TxET e m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.withQE</span></a></span><span>
</span><span id="line-585"></span><span>          </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span>
</span><span id="line-586"></span><span>          </span><span class="annot"><span class="">[PG.sql|
          SELECT collection_name
            FROM hdb_catalog.hdb_allowlist
          ORDER BY collection_name ASC
         |]</span></span><span>
</span><span id="line-591"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-592"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-593"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-594"></span><span>        </span><span id="local-6989586621690600831"><span class="annot"><span class="annottext">fromRow :: Identity CollectionName -&gt; AllowlistEntry
</span><a href="#local-6989586621690600831"><span class="hs-identifier hs-var hs-var">fromRow</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Identity</span></a></span><span> </span><span id="local-6989586621690600830"><span class="annot"><span class="annottext">CollectionName
</span><a href="#local-6989586621690600830"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CollectionName -&gt; AllowlistScope -&gt; AllowlistEntry
</span><a href="Hasura.RQL.Types.Allowlist.html#AllowlistEntry"><span class="hs-identifier hs-var">AllowlistEntry</span></a></span><span> </span><span class="annot"><span class="annottext">CollectionName
</span><a href="#local-6989586621690600830"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">AllowlistScope
</span><a href="Hasura.RQL.Types.Allowlist.html#AllowlistScopeGlobal"><span class="hs-identifier hs-var">AllowlistScopeGlobal</span></a></span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span>    </span><span id="local-6989586621690601145"><span class="annot"><span class="annottext">fetchComputedFields :: TxET
  QErr
  IO
  [(QualifiedTable, ComputedFieldMetadata ('Postgres 'Vanilla))]
</span><a href="#local-6989586621690601145"><span class="hs-identifier hs-var hs-var">fetchComputedFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-597"></span><span>      </span><span id="local-6989586621690600810"><span class="annot"><span class="annottext">[(SchemaName, TableName, ComputedFieldName,
  ViaJSON (ComputedFieldDefinition ('Postgres 'Vanilla)),
  Maybe Text)]
</span><a href="#local-6989586621690600810"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-598"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a r e.
(MonadIO m, FromRes a, ToPrepArgs r) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; r -&gt; Bool -&gt; TxET e m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.withQE</span></a></span><span>
</span><span id="line-599"></span><span>          </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span>
</span><span id="line-600"></span><span>          </span><span class="annot"><span class="">[PG.sql|
              SELECT table_schema, table_name, computed_field_name,
                     definition::json, comment
                FROM hdb_catalog.hdb_computed_field
             |]</span></span><span>
</span><span id="line-605"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-606"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-607"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-608"></span><span>        </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">[(SchemaName, TableName, ComputedFieldName,
  ViaJSON (ComputedFieldDefinition ('Postgres 'Vanilla)),
  Maybe Text)]
</span><a href="#local-6989586621690600810"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621690600809"><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690600809"><span class="hs-identifier hs-var">schema</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690600808"><span class="annot"><span class="annottext">TableName
</span><a href="#local-6989586621690600808"><span class="hs-identifier hs-var">table</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690600807"><span class="annot"><span class="annottext">ComputedFieldName
</span><a href="#local-6989586621690600807"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.ViaJSON</span></a></span><span> </span><span id="local-6989586621690600806"><span class="annot"><span class="annottext">ComputedFieldDefinition ('Postgres 'Vanilla)
</span><a href="#local-6989586621690600806"><span class="hs-identifier hs-var">definition</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690600805"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690600805"><span class="hs-identifier hs-var">comment</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-609"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">forall a. SchemaName -&gt; a -&gt; QualifiedObject a
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedObject"><span class="hs-identifier hs-var">QualifiedObject</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690600809"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="annot"><span class="annottext">TableName
</span><a href="#local-6989586621690600808"><span class="hs-identifier hs-var">table</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-610"></span><span>            </span><span class="annot"><span class="annottext">forall (b :: BackendType).
ComputedFieldName
-&gt; ComputedFieldDefinition b -&gt; Comment -&gt; ComputedFieldMetadata b
</span><a href="Hasura.RQL.Types.Metadata.Common.html#ComputedFieldMetadata"><span class="hs-identifier hs-var">ComputedFieldMetadata</span></a></span><span> </span><span class="annot"><span class="annottext">ComputedFieldName
</span><a href="#local-6989586621690600807"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ComputedFieldDefinition ('Postgres 'Vanilla)
</span><a href="#local-6989586621690600806"><span class="hs-identifier hs-var">definition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text -&gt; Comment
</span><a href="Hasura.RQL.Types.Common.html#commentFromMaybeText"><span class="hs-identifier hs-var">commentFromMaybeText</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690600805"><span class="hs-identifier hs-var">comment</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span>
</span><span id="line-613"></span><span>    </span><span id="local-6989586621690601103"><span class="annot"><span class="annottext">fetchCronTriggers :: TxET QErr IO CronTriggers
</span><a href="#local-6989586621690601103"><span class="hs-identifier hs-var hs-var">fetchCronTriggers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-614"></span><span>      </span><span class="annot"><span class="annottext">forall k a.
(Eq k, Hashable k) =&gt;
(a -&gt; k) -&gt; [a] -&gt; InsOrdHashMap k a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier hs-var">oMapFromL</span></a></span><span> </span><span class="annot"><span class="annottext">CronTriggerMetadata -&gt; TriggerName
</span><a href="Hasura.RQL.Types.ScheduledTrigger.html#ctName"><span class="hs-identifier hs-var">ctName</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(TriggerName, ViaJSON InputWebhook, CronSchedule,
 Maybe (ViaJSON Value), ViaJSON STRetryConf, ViaJSON [HeaderConf],
 Bool, Maybe Text)
-&gt; CronTriggerMetadata
</span><a href="#local-6989586621690600771"><span class="hs-identifier hs-var">uncurryCronTrigger</span></a></span><span>
</span><span id="line-615"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a r e.
(MonadIO m, FromRes a, ToPrepArgs r) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; r -&gt; Bool -&gt; TxET e m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.withQE</span></a></span><span>
</span><span id="line-616"></span><span>          </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span>
</span><span id="line-617"></span><span>          </span><span class="annot"><span class="">[PG.sql|
       SELECT ct.name, ct.webhook_conf, ct.cron_schedule, ct.payload,
             ct.retry_conf, ct.header_conf, ct.include_in_metadata, ct.comment
        FROM hdb_catalog.hdb_cron_triggers ct
        WHERE include_in_metadata
      |]</span></span><span>
</span><span id="line-623"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-624"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-625"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-626"></span><span>        </span><span id="local-6989586621690600771"><span class="annot"><span class="annottext">uncurryCronTrigger :: (TriggerName, ViaJSON InputWebhook, CronSchedule,
 Maybe (ViaJSON Value), ViaJSON STRetryConf, ViaJSON [HeaderConf],
 Bool, Maybe Text)
-&gt; CronTriggerMetadata
</span><a href="#local-6989586621690600771"><span class="hs-identifier hs-var hs-var">uncurryCronTrigger</span></a></span></span><span>
</span><span id="line-627"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621690600769"><span class="annot"><span class="annottext">TriggerName
</span><a href="#local-6989586621690600769"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690600768"><span class="annot"><span class="annottext">ViaJSON InputWebhook
</span><a href="#local-6989586621690600768"><span class="hs-identifier hs-var">webhook</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690600767"><span class="annot"><span class="annottext">CronSchedule
</span><a href="#local-6989586621690600767"><span class="hs-identifier hs-var">schedule</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690600766"><span class="annot"><span class="annottext">Maybe (ViaJSON Value)
</span><a href="#local-6989586621690600766"><span class="hs-identifier hs-var">payload</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690600765"><span class="annot"><span class="annottext">ViaJSON STRetryConf
</span><a href="#local-6989586621690600765"><span class="hs-identifier hs-var">retryConfig</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690600764"><span class="annot"><span class="annottext">ViaJSON [HeaderConf]
</span><a href="#local-6989586621690600764"><span class="hs-identifier hs-var">headerConfig</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690600763"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690600763"><span class="hs-identifier hs-var">includeMetadata</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690600762"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690600762"><span class="hs-identifier hs-var">comment</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-628"></span><span>            </span><span class="annot"><a href="Hasura.RQL.Types.ScheduledTrigger.html#CronTriggerMetadata"><span class="hs-identifier hs-type">CronTriggerMetadata</span></a></span><span>
</span><span id="line-629"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ctName :: TriggerName
</span><a href="Hasura.RQL.Types.ScheduledTrigger.html#ctName"><span class="hs-identifier hs-var">ctName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><a href="#local-6989586621690600769"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-630"></span><span>                </span><span class="annot"><span class="annottext">ctWebhook :: InputWebhook
</span><a href="Hasura.RQL.Types.ScheduledTrigger.html#ctWebhook"><span class="hs-identifier hs-var">ctWebhook</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ViaJSON a -&gt; a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.getViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">ViaJSON InputWebhook
</span><a href="#local-6989586621690600768"><span class="hs-identifier hs-var">webhook</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-631"></span><span>                </span><span class="annot"><span class="annottext">ctSchedule :: CronSchedule
</span><a href="Hasura.RQL.Types.ScheduledTrigger.html#ctSchedule"><span class="hs-identifier hs-var">ctSchedule</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CronSchedule
</span><a href="#local-6989586621690600767"><span class="hs-identifier hs-var">schedule</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-632"></span><span>                </span><span class="annot"><span class="annottext">ctPayload :: Maybe Value
</span><a href="Hasura.RQL.Types.ScheduledTrigger.html#ctPayload"><span class="hs-identifier hs-var">ctPayload</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ViaJSON a -&gt; a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.getViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ViaJSON Value)
</span><a href="#local-6989586621690600766"><span class="hs-identifier hs-var">payload</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-633"></span><span>                </span><span class="annot"><span class="annottext">ctRetryConf :: STRetryConf
</span><a href="Hasura.RQL.Types.ScheduledTrigger.html#ctRetryConf"><span class="hs-identifier hs-var">ctRetryConf</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ViaJSON a -&gt; a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.getViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">ViaJSON STRetryConf
</span><a href="#local-6989586621690600765"><span class="hs-identifier hs-var">retryConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-634"></span><span>                </span><span class="annot"><span class="annottext">ctHeaders :: [HeaderConf]
</span><a href="Hasura.RQL.Types.ScheduledTrigger.html#ctHeaders"><span class="hs-identifier hs-var">ctHeaders</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ViaJSON a -&gt; a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.getViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">ViaJSON [HeaderConf]
</span><a href="#local-6989586621690600764"><span class="hs-identifier hs-var">headerConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-635"></span><span>                </span><span class="annot"><span class="annottext">ctIncludeInMetadata :: Bool
</span><a href="Hasura.RQL.Types.ScheduledTrigger.html#ctIncludeInMetadata"><span class="hs-identifier hs-var">ctIncludeInMetadata</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690600763"><span class="hs-identifier hs-var">includeMetadata</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-636"></span><span>                </span><span class="annot"><span class="annottext">ctComment :: Maybe Text
</span><a href="Hasura.RQL.Types.ScheduledTrigger.html#ctComment"><span class="hs-identifier hs-var">ctComment</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690600762"><span class="hs-identifier hs-var">comment</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-637"></span><span>                </span><span class="annot"><span class="annottext">ctRequestTransform :: Maybe RequestTransform
</span><a href="Hasura.RQL.Types.ScheduledTrigger.html#ctRequestTransform"><span class="hs-identifier hs-var">ctRequestTransform</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-638"></span><span>                </span><span class="annot"><span class="annottext">ctResponseTransform :: Maybe MetadataResponseTransform
</span><a href="Hasura.RQL.Types.ScheduledTrigger.html#ctResponseTransform"><span class="hs-identifier hs-var">ctResponseTransform</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-639"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span>    </span><span class="annot"><a href="#local-6989586621690601107"><span class="hs-identifier hs-type">fetchCustomTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.TxE</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.CustomTypes.html#CustomTypes"><span class="hs-identifier hs-type">CustomTypes</span></a></span><span>
</span><span id="line-642"></span><span>    </span><span id="local-6989586621690601107"><span class="annot"><span class="annottext">fetchCustomTypes :: TxE QErr CustomTypes
</span><a href="#local-6989586621690601107"><span class="hs-identifier hs-var hs-var">fetchCustomTypes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-643"></span><span>      </span><span class="annot"><span class="annottext">forall a. ViaJSON a -&gt; a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.getViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Identity a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">runIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. SingleRow a -&gt; a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.getRow</span></a></span><span>
</span><span id="line-644"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a e.
(MonadIO m, FromRes a) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; [PrepArg] -&gt; Bool -&gt; TxET e m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.rawQE</span></a></span><span>
</span><span id="line-645"></span><span>          </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span>
</span><span id="line-646"></span><span>          </span><span class="annot"><span class="">[PG.sql|
         select coalesce((select custom_types::json from hdb_catalog.hdb_custom_types), '{}'::json)
         |]</span></span><span>
</span><span id="line-649"></span><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-650"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-651"></span><span>
</span><span id="line-652"></span><span>    </span><span id="local-6989586621690601105"><span class="annot"><span class="annottext">fetchActions :: TxET QErr IO [ActionMetadata]
</span><a href="#local-6989586621690601105"><span class="hs-identifier hs-var hs-var">fetchActions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-653"></span><span>      </span><span class="annot"><span class="annottext">forall a. ViaJSON a -&gt; a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.getViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Identity a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">runIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. SingleRow a -&gt; a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.getRow</span></a></span><span>
</span><span id="line-654"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a e.
(MonadIO m, FromRes a) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; [PrepArg] -&gt; Bool -&gt; TxET e m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.rawQE</span></a></span><span>
</span><span id="line-655"></span><span>          </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span>
</span><span id="line-656"></span><span>          </span><span class="annot"><span class="">[PG.sql|
        select
          coalesce(
            json_agg(
              json_build_object(
                'name', a.action_name,
                'definition', a.action_defn,
                'comment', a.comment,
                'permissions', ap.permissions
              ) order by a.action_name asc
            ),
            '[]'
          )
        from
          hdb_catalog.hdb_action as a
          left outer join lateral (
            select
              coalesce(
                json_agg(
                  json_build_object(
                    'role', ap.role_name,
                    'comment', ap.comment
                  ) order by ap.role_name asc
                ),
                '[]'
              ) as permissions
            from
              hdb_catalog.hdb_action_permission ap
            where
              ap.action_name = a.action_name
          ) ap on true;
                            |]</span></span><span>
</span><span id="line-688"></span><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-689"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-690"></span><span>
</span><span id="line-691"></span><span>    </span><span id="local-6989586621690601143"><span class="annot"><span class="annottext">fetchRemoteRelationships :: TxET PGTxErr IO [(QualifiedTable, RelName, Value)]
</span><a href="#local-6989586621690601143"><span class="hs-identifier hs-var hs-var">fetchRemoteRelationships</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-692"></span><span>      </span><span id="local-6989586621690600735"><span class="annot"><span class="annottext">[(SchemaName, TableName, RelName, ViaJSON Value)]
</span><a href="#local-6989586621690600735"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-693"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a r.
(MonadIO m, FromRes a, ToPrepArgs r) =&gt;
Query -&gt; r -&gt; Bool -&gt; TxT m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.withQ</span></a></span><span>
</span><span id="line-694"></span><span>          </span><span class="annot"><span class="">[PG.sql|
                SELECT table_schema, table_name,
                       remote_relationship_name, definition::json
                FROM hdb_catalog.hdb_remote_relationship
             |]</span></span><span>
</span><span id="line-699"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-700"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-701"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-702"></span><span>        </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">[(SchemaName, TableName, RelName, ViaJSON Value)]
</span><a href="#local-6989586621690600735"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621690600734"><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690600734"><span class="hs-identifier hs-var">schema</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690600733"><span class="annot"><span class="annottext">TableName
</span><a href="#local-6989586621690600733"><span class="hs-identifier hs-var">table</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690600732"><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690600732"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.ViaJSON</span></a></span><span> </span><span id="local-6989586621690600731"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621690600731"><span class="hs-identifier hs-var">definition</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-703"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">forall a. SchemaName -&gt; a -&gt; QualifiedObject a
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedObject"><span class="hs-identifier hs-var">QualifiedObject</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690600734"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="annot"><span class="annottext">TableName
</span><a href="#local-6989586621690600733"><span class="hs-identifier hs-var">table</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-704"></span><span>            </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690600732"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-705"></span><span>            </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621690600731"><span class="hs-identifier hs-var">definition</span></a></span><span>
</span><span id="line-706"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-707"></span><span>
</span><span id="line-708"></span><span id="local-6989586621690602034"><span class="annot"><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addCronTriggerForeignKeyConstraint"><span class="hs-identifier hs-type">addCronTriggerForeignKeyConstraint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690602034"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690602034"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-709"></span><span id="addCronTriggerForeignKeyConstraint"><span class="annot"><span class="annottext">addCronTriggerForeignKeyConstraint :: forall (m :: * -&gt; *). MonadTx m =&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#addCronTriggerForeignKeyConstraint"><span class="hs-identifier hs-var hs-var">addCronTriggerForeignKeyConstraint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-710"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-711"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r e.
(MonadIO m, ToPrepArgs r) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; r -&gt; Bool -&gt; TxET e m ()
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.unitQE</span></a></span><span>
</span><span id="line-712"></span><span>      </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span>
</span><span id="line-713"></span><span>      </span><span class="annot"><span class="">[PG.sql|
      ALTER TABLE hdb_catalog.hdb_cron_events ADD CONSTRAINT
     hdb_cron_events_trigger_name_fkey FOREIGN KEY (trigger_name)
     REFERENCES hdb_catalog.hdb_cron_triggers(name)
     ON UPDATE CASCADE ON DELETE CASCADE;
     |]</span></span><span>
</span><span id="line-719"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-720"></span><span>      </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-721"></span><span>
</span><span id="line-722"></span><span class="hs-comment">-- | Drops and recreates all &#8220;system-defined&#8221; metadata, aka metadata for tables and views in the</span><span>
</span><span id="line-723"></span><span class="hs-comment">-- @information_schema@ and @hdb_catalog@ schemas. These tables and views are tracked to expose them</span><span>
</span><span id="line-724"></span><span class="hs-comment">-- to the console, which allows us to reuse the same functionality we use to implement user-defined</span><span>
</span><span id="line-725"></span><span class="hs-comment">-- APIs to expose the catalog.</span><span>
</span><span id="line-726"></span><span class="hs-comment">--</span><span>
</span><span id="line-727"></span><span class="hs-comment">-- This process has a long and storied history.</span><span>
</span><span id="line-728"></span><span class="hs-comment">--</span><span>
</span><span id="line-729"></span><span class="hs-comment">-- In the past, we reused the same machinery we use for CLI migrations to define our own internal</span><span>
</span><span id="line-730"></span><span class="hs-comment">-- metadata migrations. This caused trouble, however, as we&#8217;d have to run those migrations in</span><span>
</span><span id="line-731"></span><span class="hs-comment">-- lockstep with our SQL migrations to ensure the two didn&#8217;t get out of sync. This in turn caused</span><span>
</span><span id="line-732"></span><span class="hs-comment">-- trouble because those migrations would hit code paths inside @graphql-engine@ to add or remove</span><span>
</span><span id="line-733"></span><span class="hs-comment">-- things from the @pg_catalog@ tables, and /that/ in turn would fail because we hadn&#8217;t finished</span><span>
</span><span id="line-734"></span><span class="hs-comment">-- running the SQL migrations, so we were running a new version of the code against an old version</span><span>
</span><span id="line-735"></span><span class="hs-comment">-- of the schema! That caused #2826.</span><span>
</span><span id="line-736"></span><span class="hs-comment">--</span><span>
</span><span id="line-737"></span><span class="hs-comment">-- To fix that, #2379 switched to the approach of just dropping and recreating all system metadata</span><span>
</span><span id="line-738"></span><span class="hs-comment">-- every time we run any SQL migrations. But /that/ in turn caused trouble due to the way we were</span><span>
</span><span id="line-739"></span><span class="hs-comment">-- constantly rebuilding the schema cache (#3354), causing us to switch to incremental schema cache</span><span>
</span><span id="line-740"></span><span class="hs-comment">-- construction (#3394). However, although that mostly resolved the problem, we still weren&#8217;t</span><span>
</span><span id="line-741"></span><span class="hs-comment">-- totally out of the woods, as the incremental construction was still too slow on slow Postgres</span><span>
</span><span id="line-742"></span><span class="hs-comment">-- instances (#3654).</span><span>
</span><span id="line-743"></span><span class="hs-comment">--</span><span>
</span><span id="line-744"></span><span class="hs-comment">-- To sidestep the whole issue, as of #3686 we now just create all the system metadata in code here,</span><span>
</span><span id="line-745"></span><span class="hs-comment">-- and we only rebuild the schema cache once, at the very end. This is a little unsatisfying, since</span><span>
</span><span id="line-746"></span><span class="hs-comment">-- it means our internal migrations are &#8220;blessed&#8221; compared to user-defined CLI migrations. If we</span><span>
</span><span id="line-747"></span><span class="hs-comment">-- improve CLI migrations further in the future, maybe we can switch back to using that approach,</span><span>
</span><span id="line-748"></span><span class="hs-comment">-- instead.</span><span>
</span><span id="line-749"></span><span id="local-6989586621690600725"><span class="annot"><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#recreateSystemMetadata"><span class="hs-identifier hs-type">recreateSystemMetadata</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690600725"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690600725"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-750"></span><span id="recreateSystemMetadata"><span class="annot"><span class="annottext">recreateSystemMetadata :: forall (m :: * -&gt; *). MonadTx m =&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#recreateSystemMetadata"><span class="hs-identifier hs-var hs-var">recreateSystemMetadata</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-751"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a e.
(MonadIO m, FromRes a) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; TxET e m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.multiQE</span></a></span><span> </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">defaultTxErrorHandler</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="hs-identifier">makeRelativeToProject</span><span> </span><span class="hs-string">&quot;src-rsr/clear_system_metadata.sql&quot;</span><span> </span><span class="hs-operator">&gt;&gt;=</span><span> </span><span class="hs-identifier">PG.sqlFromFile</span><span class="hs-special">)</span><span>
</span><span id="line-752"></span><span>  </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runReaderT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; SystemDefined
</span><a href="Hasura.RQL.Types.Common.html#SystemDefined"><span class="hs-identifier hs-var">SystemDefined</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">for_</span></a></span><span> </span><span class="annot"><span class="annottext">[(QualifiedTable,
  [Either
     (ObjRelDef ('Postgres 'Vanilla))
     (ArrRelDef ('Postgres 'Vanilla))])]
</span><a href="#local-6989586621690600500"><span class="hs-identifier hs-var">systemMetadata</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621690600499"><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690600499"><span class="hs-identifier hs-var">tableName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690600498"><span class="annot"><span class="annottext">[Either
   (ObjRelDef ('Postgres 'Vanilla)) (ArrRelDef ('Postgres 'Vanilla))]
</span><a href="#local-6989586621690600498"><span class="hs-identifier hs-var">tableRels</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-753"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadTx m, MonadReader SystemDefined m) =&gt;
QualifiedTable -&gt; Bool -&gt; TableConfig ('Postgres 'Vanilla) -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#saveTableToCatalog"><span class="hs-identifier hs-var">saveTableToCatalog</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690600499"><span class="hs-identifier hs-var">tableName</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType). TableConfig b
</span><a href="Hasura.RQL.Types.Table.html#emptyTableConfig"><span class="hs-identifier hs-var">emptyTableConfig</span></a></span><span>
</span><span id="line-754"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">for_</span></a></span><span> </span><span class="annot"><span class="annottext">[Either
   (ObjRelDef ('Postgres 'Vanilla)) (ArrRelDef ('Postgres 'Vanilla))]
</span><a href="#local-6989586621690600498"><span class="hs-identifier hs-var">tableRels</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-755"></span><span>      </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621690600497"><span class="annot"><span class="annottext">ObjRelDef ('Postgres 'Vanilla)
</span><a href="#local-6989586621690600497"><span class="hs-identifier hs-var">relDef</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadTx m, MonadReader SystemDefined m, ToJSON a) =&gt;
QualifiedTable -&gt; RelType -&gt; RelDef a -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#insertRelationshipToCatalog"><span class="hs-identifier hs-var">insertRelationshipToCatalog</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690600499"><span class="hs-identifier hs-var">tableName</span></a></span><span> </span><span class="annot"><span class="annottext">RelType
</span><a href="Hasura.RQL.Types.Common.html#ObjRel"><span class="hs-identifier hs-var">ObjRel</span></a></span><span> </span><span class="annot"><span class="annottext">ObjRelDef ('Postgres 'Vanilla)
</span><a href="#local-6989586621690600497"><span class="hs-identifier hs-var">relDef</span></a></span><span>
</span><span id="line-756"></span><span>      </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621690600496"><span class="annot"><span class="annottext">ArrRelDef ('Postgres 'Vanilla)
</span><a href="#local-6989586621690600496"><span class="hs-identifier hs-var">relDef</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadTx m, MonadReader SystemDefined m, ToJSON a) =&gt;
QualifiedTable -&gt; RelType -&gt; RelDef a -&gt; m ()
</span><a href="Hasura.RQL.DDL.Schema.LegacyCatalog.html#insertRelationshipToCatalog"><span class="hs-identifier hs-var">insertRelationshipToCatalog</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690600499"><span class="hs-identifier hs-var">tableName</span></a></span><span> </span><span class="annot"><span class="annottext">RelType
</span><a href="Hasura.RQL.Types.Common.html#ArrRel"><span class="hs-identifier hs-var">ArrRel</span></a></span><span> </span><span class="annot"><span class="annottext">ArrRelDef ('Postgres 'Vanilla)
</span><a href="#local-6989586621690600496"><span class="hs-identifier hs-var">relDef</span></a></span><span>
</span><span id="line-757"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-758"></span><span>    </span><span class="annot"><a href="#local-6989586621690600500"><span class="hs-identifier hs-type">systemMetadata</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedTable"><span class="hs-identifier hs-type">QualifiedTable</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#ObjRelDef"><span class="hs-identifier hs-type">ObjRelDef</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#ArrRelDef"><span class="hs-identifier hs-type">ArrRelDef</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-759"></span><span>    </span><span id="local-6989586621690600500"><span class="annot"><span class="annottext">systemMetadata :: [(QualifiedTable,
  [Either
     (ObjRelDef ('Postgres 'Vanilla))
     (ArrRelDef ('Postgres 'Vanilla))])]
</span><a href="#local-6989586621690600500"><span class="hs-identifier hs-var hs-var">systemMetadata</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-760"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;information_schema&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;tables&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-761"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;information_schema&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;schemata&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-762"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;information_schema&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;views&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-763"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;information_schema&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;columns&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-764"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-765"></span><span>          </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span>
</span><span id="line-766"></span><span>          </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_table&quot;</span></span><span>
</span><span id="line-767"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall {a} {b}. NonEmptyText -&gt; a -&gt; Either (RelDef a) b
</span><a href="#local-6989586621690600494"><span class="hs-identifier hs-var">objectRel</span></a></span><span> </span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.NonEmpty.html#nonEmptyText"><span class="hs-identifier hs-type">nonEmptyText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;detail&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-768"></span><span>              </span><span class="annot"><span class="annottext">forall {b :: BackendType} {a} {a}.
(TableName b ~ QualifiedObject a, Hashable (Column b)) =&gt;
SchemaName -&gt; a -&gt; [(Column b, Column b)] -&gt; RelUsing b a
</span><a href="#local-6989586621690600491"><span class="hs-identifier hs-var">manualConfig</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;information_schema&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;tables&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(PGCol, PGCol)]
</span><a href="#local-6989586621690600490"><span class="hs-identifier hs-var">tableNameMapping</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-769"></span><span>            </span><span class="annot"><span class="annottext">forall {a} {b}. NonEmptyText -&gt; a -&gt; Either (RelDef a) b
</span><a href="#local-6989586621690600494"><span class="hs-identifier hs-var">objectRel</span></a></span><span> </span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.NonEmpty.html#nonEmptyText"><span class="hs-identifier hs-type">nonEmptyText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;primary_key&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-770"></span><span>              </span><span class="annot"><span class="annottext">forall {b :: BackendType} {a} {a}.
(TableName b ~ QualifiedObject a, Hashable (Column b)) =&gt;
SchemaName -&gt; a -&gt; [(Column b, Column b)] -&gt; RelUsing b a
</span><a href="#local-6989586621690600491"><span class="hs-identifier hs-var">manualConfig</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_primary_key&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(PGCol, PGCol)]
</span><a href="#local-6989586621690600490"><span class="hs-identifier hs-var">tableNameMapping</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-771"></span><span>            </span><span class="annot"><span class="annottext">forall {a} {a}. NonEmptyText -&gt; a -&gt; Either a (RelDef a)
</span><a href="#local-6989586621690600489"><span class="hs-identifier hs-var">arrayRel</span></a></span><span> </span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.NonEmpty.html#nonEmptyText"><span class="hs-identifier hs-type">nonEmptyText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;columns&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-772"></span><span>              </span><span class="annot"><span class="annottext">forall {b :: BackendType} {a} {a}.
(TableName b ~ QualifiedObject a, Hashable (Column b)) =&gt;
SchemaName -&gt; a -&gt; [(Column b, Column b)] -&gt; RelUsing b a
</span><a href="#local-6989586621690600491"><span class="hs-identifier hs-var">manualConfig</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;information_schema&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;columns&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(PGCol, PGCol)]
</span><a href="#local-6989586621690600490"><span class="hs-identifier hs-var">tableNameMapping</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-773"></span><span>            </span><span class="annot"><span class="annottext">forall {a} {a}. NonEmptyText -&gt; a -&gt; Either a (RelDef a)
</span><a href="#local-6989586621690600489"><span class="hs-identifier hs-var">arrayRel</span></a></span><span> </span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.NonEmpty.html#nonEmptyText"><span class="hs-identifier hs-type">nonEmptyText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;foreign_key_constraints&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-774"></span><span>              </span><span class="annot"><span class="annottext">forall {b :: BackendType} {a} {a}.
(TableName b ~ QualifiedObject a, Hashable (Column b)) =&gt;
SchemaName -&gt; a -&gt; [(Column b, Column b)] -&gt; RelUsing b a
</span><a href="#local-6989586621690600491"><span class="hs-identifier hs-var">manualConfig</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_foreign_key_constraint&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(PGCol, PGCol)]
</span><a href="#local-6989586621690600490"><span class="hs-identifier hs-var">tableNameMapping</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-775"></span><span>            </span><span class="annot"><span class="annottext">forall {a} {a}. NonEmptyText -&gt; a -&gt; Either a (RelDef a)
</span><a href="#local-6989586621690600489"><span class="hs-identifier hs-var">arrayRel</span></a></span><span> </span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.NonEmpty.html#nonEmptyText"><span class="hs-identifier hs-type">nonEmptyText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;relationships&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-776"></span><span>              </span><span class="annot"><span class="annottext">forall {b :: BackendType} {a} {a}.
(TableName b ~ QualifiedObject a, Hashable (Column b)) =&gt;
SchemaName -&gt; a -&gt; [(Column b, Column b)] -&gt; RelUsing b a
</span><a href="#local-6989586621690600491"><span class="hs-identifier hs-var">manualConfig</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_relationship&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(PGCol, PGCol)]
</span><a href="#local-6989586621690600490"><span class="hs-identifier hs-var">tableNameMapping</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-777"></span><span>            </span><span class="annot"><span class="annottext">forall {a} {a}. NonEmptyText -&gt; a -&gt; Either a (RelDef a)
</span><a href="#local-6989586621690600489"><span class="hs-identifier hs-var">arrayRel</span></a></span><span> </span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.NonEmpty.html#nonEmptyText"><span class="hs-identifier hs-type">nonEmptyText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;permissions&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-778"></span><span>              </span><span class="annot"><span class="annottext">forall {b :: BackendType} {a} {a}.
(TableName b ~ QualifiedObject a, Hashable (Column b)) =&gt;
SchemaName -&gt; a -&gt; [(Column b, Column b)] -&gt; RelUsing b a
</span><a href="#local-6989586621690600491"><span class="hs-identifier hs-var">manualConfig</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_permission_agg&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(PGCol, PGCol)]
</span><a href="#local-6989586621690600490"><span class="hs-identifier hs-var">tableNameMapping</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-779"></span><span>            </span><span class="annot"><span class="annottext">forall {a} {a}. NonEmptyText -&gt; a -&gt; Either a (RelDef a)
</span><a href="#local-6989586621690600489"><span class="hs-identifier hs-var">arrayRel</span></a></span><span> </span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.NonEmpty.html#nonEmptyText"><span class="hs-identifier hs-type">nonEmptyText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;computed_fields&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-780"></span><span>              </span><span class="annot"><span class="annottext">forall {b :: BackendType} {a} {a}.
(TableName b ~ QualifiedObject a, Hashable (Column b)) =&gt;
SchemaName -&gt; a -&gt; [(Column b, Column b)] -&gt; RelUsing b a
</span><a href="#local-6989586621690600491"><span class="hs-identifier hs-var">manualConfig</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_computed_field&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(PGCol, PGCol)]
</span><a href="#local-6989586621690600490"><span class="hs-identifier hs-var">tableNameMapping</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-781"></span><span>            </span><span class="annot"><span class="annottext">forall {a} {a}. NonEmptyText -&gt; a -&gt; Either a (RelDef a)
</span><a href="#local-6989586621690600489"><span class="hs-identifier hs-var">arrayRel</span></a></span><span> </span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.NonEmpty.html#nonEmptyText"><span class="hs-identifier hs-type">nonEmptyText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;check_constraints&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-782"></span><span>              </span><span class="annot"><span class="annottext">forall {b :: BackendType} {a} {a}.
(TableName b ~ QualifiedObject a, Hashable (Column b)) =&gt;
SchemaName -&gt; a -&gt; [(Column b, Column b)] -&gt; RelUsing b a
</span><a href="#local-6989586621690600491"><span class="hs-identifier hs-var">manualConfig</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_check_constraint&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(PGCol, PGCol)]
</span><a href="#local-6989586621690600490"><span class="hs-identifier hs-var">tableNameMapping</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-783"></span><span>            </span><span class="annot"><span class="annottext">forall {a} {a}. NonEmptyText -&gt; a -&gt; Either a (RelDef a)
</span><a href="#local-6989586621690600489"><span class="hs-identifier hs-var">arrayRel</span></a></span><span> </span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.NonEmpty.html#nonEmptyText"><span class="hs-identifier hs-type">nonEmptyText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;unique_constraints&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-784"></span><span>              </span><span class="annot"><span class="annottext">forall {b :: BackendType} {a} {a}.
(TableName b ~ QualifiedObject a, Hashable (Column b)) =&gt;
SchemaName -&gt; a -&gt; [(Column b, Column b)] -&gt; RelUsing b a
</span><a href="#local-6989586621690600491"><span class="hs-identifier hs-var">manualConfig</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_unique_constraint&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(PGCol, PGCol)]
</span><a href="#local-6989586621690600490"><span class="hs-identifier hs-var">tableNameMapping</span></a></span><span>
</span><span id="line-785"></span><span>          </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-786"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_primary_key&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-787"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_foreign_key_constraint&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-788"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_relationship&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-789"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_permission_agg&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-790"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_computed_field&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-791"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_check_constraint&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-792"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_unique_constraint&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-793"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_remote_relationship&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-794"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-795"></span><span>          </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span>
</span><span id="line-796"></span><span>          </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;event_triggers&quot;</span></span><span>
</span><span id="line-797"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall {a} {a}. NonEmptyText -&gt; a -&gt; Either a (RelDef a)
</span><a href="#local-6989586621690600489"><span class="hs-identifier hs-var">arrayRel</span></a></span><span> </span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.NonEmpty.html#nonEmptyText"><span class="hs-identifier hs-type">nonEmptyText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;events&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-798"></span><span>              </span><span class="annot"><span class="annottext">forall {b :: BackendType} {a} {a}.
(TableName b ~ QualifiedObject a, Hashable (Column b)) =&gt;
SchemaName -&gt; a -&gt; [(Column b, Column b)] -&gt; RelUsing b a
</span><a href="#local-6989586621690600491"><span class="hs-identifier hs-var">manualConfig</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;event_log&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;name&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;trigger_name&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-799"></span><span>          </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-800"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-801"></span><span>          </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span>
</span><span id="line-802"></span><span>          </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;event_log&quot;</span></span><span>
</span><span id="line-803"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall {a} {b}. NonEmptyText -&gt; a -&gt; Either (RelDef a) b
</span><a href="#local-6989586621690600494"><span class="hs-identifier hs-var">objectRel</span></a></span><span> </span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.NonEmpty.html#nonEmptyText"><span class="hs-identifier hs-type">nonEmptyText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;trigger&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-804"></span><span>              </span><span class="annot"><span class="annottext">forall {b :: BackendType} {a} {a}.
(TableName b ~ QualifiedObject a, Hashable (Column b)) =&gt;
SchemaName -&gt; a -&gt; [(Column b, Column b)] -&gt; RelUsing b a
</span><a href="#local-6989586621690600491"><span class="hs-identifier hs-var">manualConfig</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;event_triggers&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;trigger_name&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;name&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-805"></span><span>            </span><span class="annot"><span class="annottext">forall {a} {a}. NonEmptyText -&gt; a -&gt; Either a (RelDef a)
</span><a href="#local-6989586621690600489"><span class="hs-identifier hs-var">arrayRel</span></a></span><span> </span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.NonEmpty.html#nonEmptyText"><span class="hs-identifier hs-type">nonEmptyText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;logs&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-806"></span><span>              </span><span class="annot"><span class="annottext">forall (b :: BackendType) a. a -&gt; RelUsing b a
</span><a href="Hasura.RQL.Types.Relationships.Local.html#RUFKeyOn"><span class="hs-identifier hs-var">RUFKeyOn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-807"></span><span>                </span><span class="annot"><span class="annottext">forall (b :: BackendType).
TableName b -&gt; NonEmpty (Column b) -&gt; ArrRelUsingFKeyOn b
</span><a href="Hasura.RQL.Types.Relationships.Local.html#ArrRelUsingFKeyOn"><span class="hs-identifier hs-var">ArrRelUsingFKeyOn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SchemaName -&gt; a -&gt; QualifiedObject a
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedObject"><span class="hs-identifier hs-var">QualifiedObject</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;event_invocation_logs&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;event_id&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-808"></span><span>          </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-809"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-810"></span><span>          </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span>
</span><span id="line-811"></span><span>          </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;event_invocation_logs&quot;</span></span><span>
</span><span id="line-812"></span><span>          </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall {a} {b}. NonEmptyText -&gt; a -&gt; Either (RelDef a) b
</span><a href="#local-6989586621690600494"><span class="hs-identifier hs-var">objectRel</span></a></span><span> </span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.NonEmpty.html#nonEmptyText"><span class="hs-identifier hs-type">nonEmptyText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;event&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) a. a -&gt; RelUsing b a
</span><a href="Hasura.RQL.Types.Relationships.Local.html#RUFKeyOn"><span class="hs-identifier hs-var">RUFKeyOn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType).
NonEmpty (Column b) -&gt; ObjRelUsingChoice b
</span><a href="Hasura.RQL.Types.Relationships.Local.html#SameTable"><span class="hs-identifier hs-var">SameTable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;event_id&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-813"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_function&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-814"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-815"></span><span>          </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span>
</span><span id="line-816"></span><span>          </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_function_agg&quot;</span></span><span>
</span><span id="line-817"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall {a} {b}. NonEmptyText -&gt; a -&gt; Either (RelDef a) b
</span><a href="#local-6989586621690600494"><span class="hs-identifier hs-var">objectRel</span></a></span><span> </span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.NonEmpty.html#nonEmptyText"><span class="hs-identifier hs-type">nonEmptyText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;return_table_info&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-818"></span><span>              </span><span class="annot"><span class="annottext">forall {b :: BackendType} {a} {a}.
(TableName b ~ QualifiedObject a, Hashable (Column b)) =&gt;
SchemaName -&gt; a -&gt; [(Column b, Column b)] -&gt; RelUsing b a
</span><a href="#local-6989586621690600491"><span class="hs-identifier hs-var">manualConfig</span></a></span><span>
</span><span id="line-819"></span><span>                </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span>
</span><span id="line-820"></span><span>                </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_table&quot;</span></span><span>
</span><span id="line-821"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;return_type_schema&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;table_schema&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-822"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;return_type_name&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;table_name&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-823"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-824"></span><span>          </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-825"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;remote_schemas&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-826"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_version&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-827"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_query_collection&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-828"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_allowlist&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-829"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_custom_types&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-830"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_action_permission&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-831"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-832"></span><span>          </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span>
</span><span id="line-833"></span><span>          </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_action&quot;</span></span><span>
</span><span id="line-834"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall {a} {a}. NonEmptyText -&gt; a -&gt; Either a (RelDef a)
</span><a href="#local-6989586621690600489"><span class="hs-identifier hs-var">arrayRel</span></a></span><span> </span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.NonEmpty.html#nonEmptyText"><span class="hs-identifier hs-type">nonEmptyText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;permissions&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-835"></span><span>              </span><span class="annot"><span class="annottext">forall {b :: BackendType} {a} {a}.
(TableName b ~ QualifiedObject a, Hashable (Column b)) =&gt;
SchemaName -&gt; a -&gt; [(Column b, Column b)] -&gt; RelUsing b a
</span><a href="#local-6989586621690600491"><span class="hs-identifier hs-var">manualConfig</span></a></span><span>
</span><span id="line-836"></span><span>                </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span>
</span><span id="line-837"></span><span>                </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_action_permission&quot;</span></span><span>
</span><span id="line-838"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;action_name&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;action_name&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-839"></span><span>          </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-840"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_action_log&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-841"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-842"></span><span>          </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span>
</span><span id="line-843"></span><span>          </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_role&quot;</span></span><span>
</span><span id="line-844"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall {a} {a}. NonEmptyText -&gt; a -&gt; Either a (RelDef a)
</span><a href="#local-6989586621690600489"><span class="hs-identifier hs-var">arrayRel</span></a></span><span> </span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.NonEmpty.html#nonEmptyText"><span class="hs-identifier hs-type">nonEmptyText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;action_permissions&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-845"></span><span>              </span><span class="annot"><span class="annottext">forall {b :: BackendType} {a} {a}.
(TableName b ~ QualifiedObject a, Hashable (Column b)) =&gt;
SchemaName -&gt; a -&gt; [(Column b, Column b)] -&gt; RelUsing b a
</span><a href="#local-6989586621690600491"><span class="hs-identifier hs-var">manualConfig</span></a></span><span>
</span><span id="line-846"></span><span>                </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span>
</span><span id="line-847"></span><span>                </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_action_permission&quot;</span></span><span>
</span><span id="line-848"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;role_name&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;role_name&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-849"></span><span>            </span><span class="annot"><span class="annottext">forall {a} {a}. NonEmptyText -&gt; a -&gt; Either a (RelDef a)
</span><a href="#local-6989586621690600489"><span class="hs-identifier hs-var">arrayRel</span></a></span><span> </span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.NonEmpty.html#nonEmptyText"><span class="hs-identifier hs-type">nonEmptyText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;permissions&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-850"></span><span>              </span><span class="annot"><span class="annottext">forall {b :: BackendType} {a} {a}.
(TableName b ~ QualifiedObject a, Hashable (Column b)) =&gt;
SchemaName -&gt; a -&gt; [(Column b, Column b)] -&gt; RelUsing b a
</span><a href="#local-6989586621690600491"><span class="hs-identifier hs-var">manualConfig</span></a></span><span>
</span><span id="line-851"></span><span>                </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span>
</span><span id="line-852"></span><span>                </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_permission_agg&quot;</span></span><span>
</span><span id="line-853"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;role_name&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;role_name&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-854"></span><span>          </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-855"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-856"></span><span>          </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span>
</span><span id="line-857"></span><span>          </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_cron_triggers&quot;</span></span><span>
</span><span id="line-858"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall {a} {a}. NonEmptyText -&gt; a -&gt; Either a (RelDef a)
</span><a href="#local-6989586621690600489"><span class="hs-identifier hs-var">arrayRel</span></a></span><span> </span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.NonEmpty.html#nonEmptyText"><span class="hs-identifier hs-type">nonEmptyText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;cron_events&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-859"></span><span>              </span><span class="annot"><span class="annottext">forall (b :: BackendType) a. a -&gt; RelUsing b a
</span><a href="Hasura.RQL.Types.Relationships.Local.html#RUFKeyOn"><span class="hs-identifier hs-var">RUFKeyOn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-860"></span><span>                </span><span class="annot"><span class="annottext">forall (b :: BackendType).
TableName b -&gt; NonEmpty (Column b) -&gt; ArrRelUsingFKeyOn b
</span><a href="Hasura.RQL.Types.Relationships.Local.html#ArrRelUsingFKeyOn"><span class="hs-identifier hs-var">ArrRelUsingFKeyOn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SchemaName -&gt; a -&gt; QualifiedObject a
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedObject"><span class="hs-identifier hs-var">QualifiedObject</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_cron_events&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;trigger_name&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-861"></span><span>          </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-862"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-863"></span><span>          </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span>
</span><span id="line-864"></span><span>          </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_cron_events&quot;</span></span><span>
</span><span id="line-865"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall {a} {b}. NonEmptyText -&gt; a -&gt; Either (RelDef a) b
</span><a href="#local-6989586621690600494"><span class="hs-identifier hs-var">objectRel</span></a></span><span> </span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.NonEmpty.html#nonEmptyText"><span class="hs-identifier hs-type">nonEmptyText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;cron_trigger&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) a. a -&gt; RelUsing b a
</span><a href="Hasura.RQL.Types.Relationships.Local.html#RUFKeyOn"><span class="hs-identifier hs-var">RUFKeyOn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType).
NonEmpty (Column b) -&gt; ObjRelUsingChoice b
</span><a href="Hasura.RQL.Types.Relationships.Local.html#SameTable"><span class="hs-identifier hs-var">SameTable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;trigger_name&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-866"></span><span>            </span><span class="annot"><span class="annottext">forall {a} {a}. NonEmptyText -&gt; a -&gt; Either a (RelDef a)
</span><a href="#local-6989586621690600489"><span class="hs-identifier hs-var">arrayRel</span></a></span><span> </span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.NonEmpty.html#nonEmptyText"><span class="hs-identifier hs-type">nonEmptyText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;cron_event_logs&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-867"></span><span>              </span><span class="annot"><span class="annottext">forall (b :: BackendType) a. a -&gt; RelUsing b a
</span><a href="Hasura.RQL.Types.Relationships.Local.html#RUFKeyOn"><span class="hs-identifier hs-var">RUFKeyOn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-868"></span><span>                </span><span class="annot"><span class="annottext">forall (b :: BackendType).
TableName b -&gt; NonEmpty (Column b) -&gt; ArrRelUsingFKeyOn b
</span><a href="Hasura.RQL.Types.Relationships.Local.html#ArrRelUsingFKeyOn"><span class="hs-identifier hs-var">ArrRelUsingFKeyOn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SchemaName -&gt; a -&gt; QualifiedObject a
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedObject"><span class="hs-identifier hs-var">QualifiedObject</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_cron_event_invocation_logs&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;event_id&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-869"></span><span>          </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-870"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-871"></span><span>          </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span>
</span><span id="line-872"></span><span>          </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_cron_event_invocation_logs&quot;</span></span><span>
</span><span id="line-873"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall {a} {b}. NonEmptyText -&gt; a -&gt; Either (RelDef a) b
</span><a href="#local-6989586621690600494"><span class="hs-identifier hs-var">objectRel</span></a></span><span> </span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.NonEmpty.html#nonEmptyText"><span class="hs-identifier hs-type">nonEmptyText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;cron_event&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) a. a -&gt; RelUsing b a
</span><a href="Hasura.RQL.Types.Relationships.Local.html#RUFKeyOn"><span class="hs-identifier hs-var">RUFKeyOn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType).
NonEmpty (Column b) -&gt; ObjRelUsingChoice b
</span><a href="Hasura.RQL.Types.Relationships.Local.html#SameTable"><span class="hs-identifier hs-var">SameTable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;event_id&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-874"></span><span>          </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-875"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-876"></span><span>          </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span>
</span><span id="line-877"></span><span>          </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_scheduled_events&quot;</span></span><span>
</span><span id="line-878"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall {a} {a}. NonEmptyText -&gt; a -&gt; Either a (RelDef a)
</span><a href="#local-6989586621690600489"><span class="hs-identifier hs-var">arrayRel</span></a></span><span> </span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.NonEmpty.html#nonEmptyText"><span class="hs-identifier hs-type">nonEmptyText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;scheduled_event_logs&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-879"></span><span>              </span><span class="annot"><span class="annottext">forall (b :: BackendType) a. a -&gt; RelUsing b a
</span><a href="Hasura.RQL.Types.Relationships.Local.html#RUFKeyOn"><span class="hs-identifier hs-var">RUFKeyOn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-880"></span><span>                </span><span class="annot"><span class="annottext">forall (b :: BackendType).
TableName b -&gt; NonEmpty (Column b) -&gt; ArrRelUsingFKeyOn b
</span><a href="Hasura.RQL.Types.Relationships.Local.html#ArrRelUsingFKeyOn"><span class="hs-identifier hs-var">ArrRelUsingFKeyOn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SchemaName -&gt; a -&gt; QualifiedObject a
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedObject"><span class="hs-identifier hs-var">QualifiedObject</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_scheduled_event_invocation_logs&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;event_id&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-881"></span><span>          </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-882"></span><span>        </span><span class="annot"><span class="annottext">forall {a} {b}. SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-883"></span><span>          </span><span class="annot"><span class="annottext">SchemaName
</span><span class="hs-string">&quot;hdb_catalog&quot;</span></span><span>
</span><span id="line-884"></span><span>          </span><span class="annot"><span class="annottext">TableName
</span><span class="hs-string">&quot;hdb_scheduled_event_invocation_logs&quot;</span></span><span>
</span><span id="line-885"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall {a} {b}. NonEmptyText -&gt; a -&gt; Either (RelDef a) b
</span><a href="#local-6989586621690600494"><span class="hs-identifier hs-var">objectRel</span></a></span><span> </span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.NonEmpty.html#nonEmptyText"><span class="hs-identifier hs-type">nonEmptyText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;scheduled_event&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) a. a -&gt; RelUsing b a
</span><a href="Hasura.RQL.Types.Relationships.Local.html#RUFKeyOn"><span class="hs-identifier hs-var">RUFKeyOn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType).
NonEmpty (Column b) -&gt; ObjRelUsingChoice b
</span><a href="Hasura.RQL.Types.Relationships.Local.html#SameTable"><span class="hs-identifier hs-var">SameTable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;event_id&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-886"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-887"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-888"></span><span>
</span><span id="line-889"></span><span>    </span><span id="local-6989586621690600490"><span class="annot"><span class="annottext">tableNameMapping :: [(PGCol, PGCol)]
</span><a href="#local-6989586621690600490"><span class="hs-identifier hs-var hs-var">tableNameMapping</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-890"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;table_schema&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;table_schema&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-891"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;table_name&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PGCol
</span><span class="hs-string">&quot;table_name&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-892"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-893"></span><span>
</span><span id="line-894"></span><span>    </span><span id="local-6989586621690600495"><span class="annot"><span class="annottext">table :: SchemaName -&gt; a -&gt; b -&gt; (QualifiedObject a, b)
</span><a href="#local-6989586621690600495"><span class="hs-identifier hs-var hs-var">table</span></a></span></span><span> </span><span id="local-6989586621690600481"><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690600481"><span class="hs-identifier hs-var">schemaName</span></a></span></span><span> </span><span id="local-6989586621690600480"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690600480"><span class="hs-identifier hs-var">tableName</span></a></span></span><span> </span><span id="local-6989586621690600479"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621690600479"><span class="hs-identifier hs-var">relationships</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SchemaName -&gt; a -&gt; QualifiedObject a
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedObject"><span class="hs-identifier hs-var">QualifiedObject</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690600481"><span class="hs-identifier hs-var">schemaName</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690600480"><span class="hs-identifier hs-var">tableName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621690600479"><span class="hs-identifier hs-var">relationships</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-895"></span><span>    </span><span id="local-6989586621690600494"><span class="annot"><span class="annottext">objectRel :: NonEmptyText -&gt; a -&gt; Either (RelDef a) b
</span><a href="#local-6989586621690600494"><span class="hs-identifier hs-var hs-var">objectRel</span></a></span></span><span> </span><span id="local-6989586621690600478"><span class="annot"><span class="annottext">NonEmptyText
</span><a href="#local-6989586621690600478"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621690600477"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690600477"><span class="hs-identifier hs-var">using</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. RelName -&gt; a -&gt; Maybe Text -&gt; RelDef a
</span><a href="Hasura.RQL.Types.Relationships.Local.html#RelDef"><span class="hs-identifier hs-var">RelDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmptyText -&gt; RelName
</span><a href="Hasura.RQL.Types.Common.html#RelName"><span class="hs-identifier hs-var">RelName</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmptyText
</span><a href="#local-6989586621690600478"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690600477"><span class="hs-identifier hs-var">using</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-896"></span><span>    </span><span id="local-6989586621690600489"><span class="annot"><span class="annottext">arrayRel :: NonEmptyText -&gt; a -&gt; Either a (RelDef a)
</span><a href="#local-6989586621690600489"><span class="hs-identifier hs-var hs-var">arrayRel</span></a></span></span><span> </span><span id="local-6989586621690600475"><span class="annot"><span class="annottext">NonEmptyText
</span><a href="#local-6989586621690600475"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621690600474"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690600474"><span class="hs-identifier hs-var">using</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. RelName -&gt; a -&gt; Maybe Text -&gt; RelDef a
</span><a href="Hasura.RQL.Types.Relationships.Local.html#RelDef"><span class="hs-identifier hs-var">RelDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmptyText -&gt; RelName
</span><a href="Hasura.RQL.Types.Common.html#RelName"><span class="hs-identifier hs-var">RelName</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmptyText
</span><a href="#local-6989586621690600475"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690600474"><span class="hs-identifier hs-var">using</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-897"></span><span>    </span><span id="local-6989586621690600491"><span class="annot"><span class="annottext">manualConfig :: SchemaName -&gt; a -&gt; [(Column b, Column b)] -&gt; RelUsing b a
</span><a href="#local-6989586621690600491"><span class="hs-identifier hs-var hs-var">manualConfig</span></a></span></span><span> </span><span id="local-6989586621690600467"><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690600467"><span class="hs-identifier hs-var">schemaName</span></a></span></span><span> </span><span id="local-6989586621690600466"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690600466"><span class="hs-identifier hs-var">tableName</span></a></span></span><span> </span><span id="local-6989586621690600465"><span class="annot"><span class="annottext">[(Column b, Column b)]
</span><a href="#local-6989586621690600465"><span class="hs-identifier hs-var">columns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-898"></span><span>      </span><span class="annot"><span class="annottext">forall (b :: BackendType) a. RelManualConfig b -&gt; RelUsing b a
</span><a href="Hasura.RQL.Types.Relationships.Local.html#RUManual"><span class="hs-identifier hs-var">RUManual</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType).
TableName b
-&gt; HashMap (Column b) (Column b)
-&gt; Maybe InsertOrder
-&gt; RelManualConfig b
</span><a href="Hasura.RQL.Types.Relationships.Local.html#RelManualConfig"><span class="hs-identifier hs-var">RelManualConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SchemaName -&gt; a -&gt; QualifiedObject a
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedObject"><span class="hs-identifier hs-var">QualifiedObject</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621690600467"><span class="hs-identifier hs-var">schemaName</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690600466"><span class="hs-identifier hs-var">tableName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; HashMap k v
</span><span class="hs-identifier hs-var">HM.fromList</span></span><span> </span><span class="annot"><span class="annottext">[(Column b, Column b)]
</span><a href="#local-6989586621690600465"><span class="hs-identifier hs-var">columns</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-899"></span></pre></body></html>