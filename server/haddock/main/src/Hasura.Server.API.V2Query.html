<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-- | The RQL query ('/v2/query')</span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hasura.Server.API.V2Query</span><span>
</span><span id="line-5"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQLQuery"><span class="hs-identifier">RQLQuery</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>    </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#queryModifiesSchema"><span class="hs-identifier">queryModifiesSchema</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#runQuery"><span class="hs-identifier">runQuery</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">where</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Concurrent.Async.Lifted</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapConcurrently</span></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">preview</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_Right</span></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Control</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadBaseControl</span></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Parser</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics.Extended</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">constrName</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.App.State.html"><span class="hs-identifier">Hasura.App.State</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.BigQuery.DDL.RunSQL.html"><span class="hs-identifier">Hasura.Backends.BigQuery.DDL.RunSQL</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BigQuery</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.DataConnector.Adapter.RunSQL.html"><span class="hs-identifier">Hasura.Backends.DataConnector.Adapter.RunSQL</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DataConnector</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.DataConnector.Adapter.Types.html"><span class="hs-identifier">Hasura.Backends.DataConnector.Adapter.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.DataConnector.html#DataConnectorName"><span class="hs-identifier">DataConnectorName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.DataConnector.html#mkDataConnectorName"><span class="hs-identifier">mkDataConnectorName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.MSSQL.DDL.RunSQL.html"><span class="hs-identifier">Hasura.Backends.MSSQL.DDL.RunSQL</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MSSQL</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.DDL.RunSQL.html"><span class="hs-identifier">Hasura.Backends.Postgres.DDL.RunSQL</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Postgres</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hasura.Base.Error</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hasura.EncJSON</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Metadata.Class.html"><span class="hs-identifier">Hasura.Metadata.Class</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier">Hasura.Prelude</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.QueryTags.html"><span class="hs-identifier">Hasura.QueryTags</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Schema.html"><span class="hs-identifier">Hasura.RQL.DDL.Schema</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Schema.Cache.Config.html"><span class="hs-identifier">Hasura.RQL.DDL.Schema.Cache.Config</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Count.html"><span class="hs-identifier">Hasura.RQL.DML.Count</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Delete.html"><span class="hs-identifier">Hasura.RQL.DML.Delete</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Insert.html"><span class="hs-identifier">Hasura.RQL.DML.Insert</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Select.html"><span class="hs-identifier">Hasura.RQL.DML.Select</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Types.html"><span class="hs-identifier">Hasura.RQL.DML.Types</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Types.html#CountQuery"><span class="hs-identifier">CountQuery</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DML.Types.html#DeleteQuery"><span class="hs-identifier">DeleteQuery</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DML.Types.html#InsertQuery"><span class="hs-identifier">InsertQuery</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SelectQuery"><span class="hs-identifier">SelectQuery</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DML.Types.html#UpdateQuery"><span class="hs-identifier">UpdateQuery</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Update.html"><span class="hs-identifier">Hasura.RQL.DML.Update</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html"><span class="hs-identifier">Hasura.RQL.Types.BackendType</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html"><span class="hs-identifier">Hasura.RQL.Types.Common</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.html"><span class="hs-identifier">Hasura.RQL.Types.Metadata</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html"><span class="hs-identifier">Hasura.RQL.Types.SchemaCache</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#MetadataWithResourceVersion"><span class="hs-identifier">MetadataWithResourceVersion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#MetadataWithResourceVersion"><span class="hs-identifier">MetadataWithResourceVersion</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.Build.html"><span class="hs-identifier">Hasura.RQL.Types.SchemaCache.Build</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Source.html"><span class="hs-identifier">Hasura.RQL.Types.Source</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Types.html"><span class="hs-identifier">Hasura.Server.Types</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Services.html"><span class="hs-identifier">Hasura.Services</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Session.html"><span class="hs-identifier">Hasura.Session</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Tracing.html"><span class="hs-identifier">Hasura.Tracing</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Tracing</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src"><span class="hs-identifier">Language.GraphQL.Draft.Syntax</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">GQL</span></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span id="local-6989586621690942045"><span id="local-6989586621690942046"></span></span><span class="hs-keyword">data</span><span> </span><span id="RQLQuery"><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQLQuery"><span class="hs-identifier hs-var">RQLQuery</span></a></span></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="RQInsert"><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQInsert"><span class="hs-identifier hs-var">RQInsert</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.RQL.DML.Types.html#InsertQuery"><span class="hs-identifier hs-type">InsertQuery</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RQSelect"><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQSelect"><span class="hs-identifier hs-var">RQSelect</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SelectQuery"><span class="hs-identifier hs-type">SelectQuery</span></a></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RQUpdate"><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQUpdate"><span class="hs-identifier hs-var">RQUpdate</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.RQL.DML.Types.html#UpdateQuery"><span class="hs-identifier hs-type">UpdateQuery</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RQDelete"><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQDelete"><span class="hs-identifier hs-var">RQDelete</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.RQL.DML.Types.html#DeleteQuery"><span class="hs-identifier hs-type">DeleteQuery</span></a></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RQCount"><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQCount"><span class="hs-identifier hs-var">RQCount</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.RQL.DML.Types.html#CountQuery"><span class="hs-identifier hs-type">CountQuery</span></a></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RQRunSql"><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQRunSql"><span class="hs-identifier hs-var">RQRunSql</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Backends.Postgres.DDL.RunSQL.html#RunSQL"><span class="hs-identifier hs-type">Postgres.RunSQL</span></a></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RQMssqlRunSql"><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQMssqlRunSql"><span class="hs-identifier hs-var">RQMssqlRunSql</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Backends.MSSQL.DDL.RunSQL.html#MSSQLRunSQL"><span class="hs-identifier hs-type">MSSQL.MSSQLRunSQL</span></a></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RQCitusRunSql"><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQCitusRunSql"><span class="hs-identifier hs-var">RQCitusRunSql</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Backends.Postgres.DDL.RunSQL.html#RunSQL"><span class="hs-identifier hs-type">Postgres.RunSQL</span></a></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RQCockroachRunSql"><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQCockroachRunSql"><span class="hs-identifier hs-var">RQCockroachRunSql</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Backends.Postgres.DDL.RunSQL.html#RunSQL"><span class="hs-identifier hs-type">Postgres.RunSQL</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RQBigqueryRunSql"><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQBigqueryRunSql"><span class="hs-identifier hs-var">RQBigqueryRunSql</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Backends.BigQuery.DDL.RunSQL.html#BigQueryRunSQL"><span class="hs-identifier hs-type">BigQuery.BigQueryRunSQL</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RQDataConnectorRunSql"><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQDataConnectorRunSql"><span class="hs-identifier hs-var">RQDataConnectorRunSql</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.RQL.Types.DataConnector.html#DataConnectorName"><span class="hs-identifier hs-type">DataConnectorName</span></a></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Backends.DataConnector.Adapter.RunSQL.html#DataConnectorRunSQL"><span class="hs-identifier hs-type">DataConnector.DataConnectorRunSQL</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RQBigqueryDatabaseInspection"><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQBigqueryDatabaseInspection"><span class="hs-identifier hs-var">RQBigqueryDatabaseInspection</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Backends.BigQuery.DDL.RunSQL.html#BigQueryRunSQL"><span class="hs-identifier hs-type">BigQuery.BigQueryRunSQL</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RQBulk"><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQBulk"><span class="hs-identifier hs-var">RQBulk</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQLQuery"><span class="hs-identifier hs-type">RQLQuery</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | A variant of 'RQBulk' that runs a bulk of read-only queries concurrently.</span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-comment">--   Asserts that queries on this lists are not modifying the schema.</span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-comment">--   This is mainly used by the graphql-engine console.</span><span>
</span><span id="line-73"></span><span>    </span><span id="RQConcurrentBulk"><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQConcurrentBulk"><span class="hs-identifier hs-var">RQConcurrentBulk</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQLQuery"><span class="hs-identifier hs-type">RQLQuery</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall x. Rep RQLQuery x -&gt; RQLQuery
forall x. RQLQuery -&gt; Rep RQLQuery x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep RQLQuery x -&gt; RQLQuery
$cfrom :: forall x. RQLQuery -&gt; Rep RQLQuery x
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | This instance has been written by hand so that &quot;wildcard&quot; prefixes of _run_sql can be delegated to data connectors.</span><span>
</span><span id="line-77"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621690942024"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQLQuery"><span class="hs-identifier hs-type">RQLQuery</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-78"></span><span>  </span><span id="local-6989586621690941916"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser RQLQuery
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;RQLQuery&quot;</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621690941913"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621690941913"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-79"></span><span>    </span><span id="local-6989586621690941912"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690941912"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621690941913"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;type&quot;</span></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621690941910"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621690942246"><span class="annot"><a href="#local-6989586621690942246"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621690942246"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="#local-6989586621690942246"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-81"></span><span>        </span><span id="local-6989586621690941910"><span class="annot"><span class="annottext">args :: forall a. FromJSON a =&gt; Parser a
</span><a href="#local-6989586621690941910"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621690941913"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;args&quot;</span></span><span>
</span><span id="line-82"></span><span>        </span><span id="local-6989586621690941894"><span class="annot"><span class="annottext">dcNameFromRunSql :: Text -&gt; Maybe DataConnectorName
</span><a href="#local-6989586621690941894"><span class="hs-identifier hs-var hs-var">dcNameFromRunSql</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Maybe Text
</span><span class="hs-identifier hs-var">T.stripSuffix</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;_run_sql&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Name
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src"><span class="hs-identifier hs-var">GQL.mkName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a.
MonadReader s m =&gt;
Getting (First a) s a -&gt; m (Maybe a)
</span><span class="hs-identifier hs-var">preview</span></span><span> </span><span class="annot"><span class="annottext">forall c a b. Prism (Either c a) (Either c b) a b
</span><span class="hs-identifier hs-var">_Right</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Either String DataConnectorName
</span><a href="Hasura.RQL.Types.DataConnector.html#mkDataConnectorName"><span class="hs-identifier hs-var">mkDataConnectorName</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690941912"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-84"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;insert&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InsertQuery -&gt; RQLQuery
</span><a href="Hasura.Server.API.V2Query.html#RQInsert"><span class="hs-identifier hs-var">RQInsert</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Parser a
</span><a href="#local-6989586621690941910"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-85"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;select&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SelectQuery -&gt; RQLQuery
</span><a href="Hasura.Server.API.V2Query.html#RQSelect"><span class="hs-identifier hs-var">RQSelect</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Parser a
</span><a href="#local-6989586621690941910"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-86"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;update&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UpdateQuery -&gt; RQLQuery
</span><a href="Hasura.Server.API.V2Query.html#RQUpdate"><span class="hs-identifier hs-var">RQUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Parser a
</span><a href="#local-6989586621690941910"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-87"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;delete&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DeleteQuery -&gt; RQLQuery
</span><a href="Hasura.Server.API.V2Query.html#RQDelete"><span class="hs-identifier hs-var">RQDelete</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Parser a
</span><a href="#local-6989586621690941910"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-88"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;count&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CountQuery -&gt; RQLQuery
</span><a href="Hasura.Server.API.V2Query.html#RQCount"><span class="hs-identifier hs-var">RQCount</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Parser a
</span><a href="#local-6989586621690941910"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-89"></span><span>      </span><span class="hs-comment">-- Optionally, we can specify a `pg_` prefix. This primarily makes some</span><span>
</span><span id="line-90"></span><span>      </span><span class="hs-comment">-- string interpolation easier in the cross-backend tests.</span><span>
</span><span id="line-91"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;run_sql&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RunSQL -&gt; RQLQuery
</span><a href="Hasura.Server.API.V2Query.html#RQRunSql"><span class="hs-identifier hs-var">RQRunSql</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Parser a
</span><a href="#local-6989586621690941910"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-92"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;pg_run_sql&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RunSQL -&gt; RQLQuery
</span><a href="Hasura.Server.API.V2Query.html#RQRunSql"><span class="hs-identifier hs-var">RQRunSql</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Parser a
</span><a href="#local-6989586621690941910"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-93"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;mssql_run_sql&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MSSQLRunSQL -&gt; RQLQuery
</span><a href="Hasura.Server.API.V2Query.html#RQMssqlRunSql"><span class="hs-identifier hs-var">RQMssqlRunSql</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Parser a
</span><a href="#local-6989586621690941910"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-94"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;citus_run_sql&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RunSQL -&gt; RQLQuery
</span><a href="Hasura.Server.API.V2Query.html#RQCitusRunSql"><span class="hs-identifier hs-var">RQCitusRunSql</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Parser a
</span><a href="#local-6989586621690941910"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-95"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;cockroach_run_sql&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RunSQL -&gt; RQLQuery
</span><a href="Hasura.Server.API.V2Query.html#RQCockroachRunSql"><span class="hs-identifier hs-var">RQCockroachRunSql</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Parser a
</span><a href="#local-6989586621690941910"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-96"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;bigquery_run_sql&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BigQueryRunSQL -&gt; RQLQuery
</span><a href="Hasura.Server.API.V2Query.html#RQBigqueryRunSql"><span class="hs-identifier hs-var">RQBigqueryRunSql</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Parser a
</span><a href="#local-6989586621690941910"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-97"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Maybe DataConnectorName
</span><a href="#local-6989586621690941894"><span class="hs-identifier hs-var">dcNameFromRunSql</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621690941888"><span class="annot"><span class="annottext">DataConnectorName
</span><a href="#local-6989586621690941888"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DataConnectorName -&gt; DataConnectorRunSQL -&gt; RQLQuery
</span><a href="Hasura.Server.API.V2Query.html#RQDataConnectorRunSql"><span class="hs-identifier hs-var">RQDataConnectorRunSql</span></a></span><span> </span><span class="annot"><span class="annottext">DataConnectorName
</span><a href="#local-6989586621690941888"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Parser a
</span><a href="#local-6989586621690941910"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-98"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;bigquery_database_inspection&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BigQueryRunSQL -&gt; RQLQuery
</span><a href="Hasura.Server.API.V2Query.html#RQBigqueryDatabaseInspection"><span class="hs-identifier hs-var">RQBigqueryDatabaseInspection</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Parser a
</span><a href="#local-6989586621690941910"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-99"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;bulk&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[RQLQuery] -&gt; RQLQuery
</span><a href="Hasura.Server.API.V2Query.html#RQBulk"><span class="hs-identifier hs-var">RQBulk</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Parser a
</span><a href="#local-6989586621690941910"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-100"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;concurrent_bulk&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[RQLQuery] -&gt; RQLQuery
</span><a href="Hasura.Server.API.V2Query.html#RQConcurrentBulk"><span class="hs-identifier hs-var">RQConcurrentBulk</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Parser a
</span><a href="#local-6989586621690941910"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-101"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unrecognised RQLQuery type: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690941912"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span id="local-6989586621690942211"><span class="annot"><a href="Hasura.Server.API.V2Query.html#runQuery"><span class="hs-identifier hs-type">runQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690942211"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadBaseControl</span></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690942211"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">QErr</span></span><span> </span><span class="annot"><a href="#local-6989586621690942211"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><a href="Hasura.App.State.html#HasAppEnv"><span class="hs-identifier hs-type">HasAppEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690942211"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Schema.Cache.Config.html#HasCacheStaticConfig"><span class="hs-identifier hs-type">HasCacheStaticConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690942211"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><a href="Hasura.Tracing.Class.html#MonadTrace"><span class="hs-identifier hs-type">Tracing.MonadTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690942211"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><a href="Hasura.Metadata.Class.html#MonadMetadataStorage"><span class="hs-identifier hs-type">MonadMetadataStorage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690942211"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-111"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Source.html#MonadResolveSource"><span class="hs-identifier hs-type">MonadResolveSource</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690942211"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><a href="Hasura.QueryTags.html#MonadQueryTags"><span class="hs-identifier hs-type">MonadQueryTags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690942211"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-113"></span><span>    </span><span class="annot"><a href="Hasura.Services.html#ProvidesHasuraServices"><span class="hs-identifier hs-type">ProvidesHasuraServices</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690942211"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Session.html#UserInfoM"><span class="hs-identifier hs-type">UserInfoM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690942211"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-116"></span><span>  </span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-117"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DDL.Schema.Cache.Common.html#RebuildableSchemaCache"><span class="hs-identifier hs-type">RebuildableSchemaCache</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-118"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQLQuery"><span class="hs-identifier hs-type">RQLQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-119"></span><span>  </span><span class="annot"><a href="#local-6989586621690942211"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EncJSON</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Schema.Cache.Common.html#RebuildableSchemaCache"><span class="hs-identifier hs-type">RebuildableSchemaCache</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-120"></span><span id="runQuery"><span class="annot"><span class="annottext">runQuery :: forall (m :: * -&gt; *).
(MonadIO m, MonadBaseControl IO m, MonadError QErr m, HasAppEnv m,
 HasCacheStaticConfig m, MonadTrace m, MonadMetadataStorage m,
 MonadResolveSource m, MonadQueryTags m, ProvidesHasuraServices m,
 UserInfoM m) =&gt;
AppContext
-&gt; RebuildableSchemaCache
-&gt; RQLQuery
-&gt; m (EncJSON, RebuildableSchemaCache)
</span><a href="Hasura.Server.API.V2Query.html#runQuery"><span class="hs-identifier hs-var hs-var">runQuery</span></a></span></span><span> </span><span id="local-6989586621690941807"><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621690941807"><span class="hs-identifier hs-var">appContext</span></a></span></span><span> </span><span id="local-6989586621690941806"><span class="annot"><span class="annottext">RebuildableSchemaCache
</span><a href="#local-6989586621690941806"><span class="hs-identifier hs-var">schemaCache</span></a></span></span><span> </span><span id="local-6989586621690941805"><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690941805"><span class="hs-identifier hs-var">rqlQuery</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><a href="Hasura.App.State.html#AppEnv"><span class="hs-identifier hs-type">AppEnv</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621690941774"><span id="local-6989586621690941775"><span id="local-6989586621690941776"><span id="local-6989586621690941777"><span id="local-6989586621690941778"><span id="local-6989586621690941779"><span id="local-6989586621690941780"><span id="local-6989586621690941781"><span id="local-6989586621690941782"><span id="local-6989586621690941783"><span id="local-6989586621690941784"><span id="local-6989586621690941785"><span id="local-6989586621690941786"><span id="local-6989586621690941787"><span id="local-6989586621690941788"><span id="local-6989586621690941789"><span id="local-6989586621690941790"><span id="local-6989586621690941791"><span id="local-6989586621690941792"><span id="local-6989586621690941793"><span id="local-6989586621690941794"><span id="local-6989586621690941795"><span id="local-6989586621690941796"><span id="local-6989586621690941797"><span id="local-6989586621690941798"><span id="local-6989586621690941799"><span id="local-6989586621690941800"><span id="local-6989586621690941801"><span id="local-6989586621690941802"><span id="local-6989586621690941803"><span class="annot"><span class="annottext">Maybe Text
Maybe PGPool
Maybe (CredentialCache AgentLicenseKey)
SamplingPolicy
PGPool
ConnParams
TxIsolation
TMVar MetadataResourceVersion
Refined NonNegative Seconds
Manager
CheckFeatureFlag
ServerMetrics
EventingMode
ReadOnlyMode
MaintenanceMode ()
InstanceId
PrometheusMetrics
ShutdownLatch
LoggingSettings
LockedEventsCtx
HostPreference
ConnectionOptions
WSConnectionInitTimeout
KeepAliveDelay
OptionalInterval
Port
SubscriptionsState
Loggers
appEnvLicenseKeyCache :: AppEnv -&gt; Maybe (CredentialCache AgentLicenseKey)
appEnvCheckFeatureFlag :: AppEnv -&gt; CheckFeatureFlag
appEnvSchemaPollInterval :: AppEnv -&gt; OptionalInterval
appEnvGracefulShutdownTimeout :: AppEnv -&gt; Refined NonNegative Seconds
appEnvWebSocketConnectionInitTimeout :: AppEnv -&gt; WSConnectionInitTimeout
appEnvWebSocketKeepAlive :: AppEnv -&gt; KeepAliveDelay
appEnvConnectionOptions :: AppEnv -&gt; ConnectionOptions
appEnvConsoleSentryDsn :: AppEnv -&gt; Maybe Text
appEnvConsoleAssetsDir :: AppEnv -&gt; Maybe Text
appEnvTxIso :: AppEnv -&gt; TxIsolation
appEnvConnParams :: AppEnv -&gt; ConnParams
appEnvLockedEventsCtx :: AppEnv -&gt; LockedEventsCtx
appEnvSubscriptionState :: AppEnv -&gt; SubscriptionsState
appEnvTraceSamplingPolicy :: AppEnv -&gt; SamplingPolicy
appEnvPrometheusMetrics :: AppEnv -&gt; PrometheusMetrics
appEnvMetaVersionRef :: AppEnv -&gt; TMVar MetadataResourceVersion
appEnvShutdownLatch :: AppEnv -&gt; ShutdownLatch
appEnvServerMetrics :: AppEnv -&gt; ServerMetrics
appEnvEnableReadOnlyMode :: AppEnv -&gt; ReadOnlyMode
appEnvEventingMode :: AppEnv -&gt; EventingMode
appEnvLoggingSettings :: AppEnv -&gt; LoggingSettings
appEnvEnableMaintenanceMode :: AppEnv -&gt; MaintenanceMode ()
appEnvInstanceId :: AppEnv -&gt; InstanceId
appEnvMetadataVersionRef :: AppEnv -&gt; TMVar MetadataResourceVersion
appEnvLoggers :: AppEnv -&gt; Loggers
appEnvManager :: AppEnv -&gt; Manager
appEnvIntrospectionDbPool :: AppEnv -&gt; Maybe PGPool
appEnvMetadataDbPool :: AppEnv -&gt; PGPool
appEnvHost :: AppEnv -&gt; HostPreference
appEnvPort :: AppEnv -&gt; Port
appEnvLicenseKeyCache :: Maybe (CredentialCache AgentLicenseKey)
appEnvCheckFeatureFlag :: CheckFeatureFlag
appEnvSchemaPollInterval :: OptionalInterval
appEnvGracefulShutdownTimeout :: Refined NonNegative Seconds
appEnvWebSocketConnectionInitTimeout :: WSConnectionInitTimeout
appEnvWebSocketKeepAlive :: KeepAliveDelay
appEnvConnectionOptions :: ConnectionOptions
appEnvConsoleSentryDsn :: Maybe Text
appEnvConsoleAssetsDir :: Maybe Text
appEnvTxIso :: TxIsolation
appEnvConnParams :: ConnParams
appEnvLockedEventsCtx :: LockedEventsCtx
appEnvSubscriptionState :: SubscriptionsState
appEnvTraceSamplingPolicy :: SamplingPolicy
appEnvPrometheusMetrics :: PrometheusMetrics
appEnvMetaVersionRef :: TMVar MetadataResourceVersion
appEnvShutdownLatch :: ShutdownLatch
appEnvServerMetrics :: ServerMetrics
appEnvEnableReadOnlyMode :: ReadOnlyMode
appEnvEventingMode :: EventingMode
appEnvLoggingSettings :: LoggingSettings
appEnvEnableMaintenanceMode :: MaintenanceMode ()
appEnvInstanceId :: InstanceId
appEnvMetadataVersionRef :: TMVar MetadataResourceVersion
appEnvLoggers :: Loggers
appEnvManager :: Manager
appEnvIntrospectionDbPool :: Maybe PGPool
appEnvMetadataDbPool :: PGPool
appEnvHost :: HostPreference
appEnvPort :: Port
</span><a href="Hasura.App.State.html#appEnvLicenseKeyCache"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). HasAppEnv m =&gt; m AppEnv
</span><a href="Hasura.App.State.html#askAppEnv"><span class="hs-identifier hs-var">askAppEnv</span></a></span><span>
</span><span id="line-122"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReadOnlyMode
</span><a href="#local-6989586621690941792"><span class="hs-identifier hs-var">appEnvEnableReadOnlyMode</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">ReadOnlyMode
</span><a href="Hasura.Server.Types.html#ReadOnlyModeEnabled"><span class="hs-identifier hs-var">ReadOnlyModeEnabled</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">RQLQuery -&gt; Bool
</span><a href="Hasura.Server.API.V2Query.html#queryModifiesUserDB"><span class="hs-identifier hs-var">queryModifiesUserDB</span></a></span><span> </span><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690941805"><span class="hs-identifier hs-var">rqlQuery</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><span class="hs-identifier hs-var">throw400</span></span><span> </span><span class="annot"><span class="annottext">Code
</span><span class="hs-identifier hs-var">NotSupported</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Cannot run write queries when read-only mode is enabled&quot;</span></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690941736"><span class="annot"><span class="annottext">dynamicConfig :: CacheDynamicConfig
</span><a href="#local-6989586621690941736"><span class="hs-identifier hs-var hs-var">dynamicConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AppContext -&gt; CacheDynamicConfig
</span><a href="Hasura.App.State.html#buildCacheDynamicConfig"><span class="hs-identifier hs-var">buildCacheDynamicConfig</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621690941807"><span class="hs-identifier hs-var">appContext</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#MetadataWithResourceVersion"><span class="hs-identifier hs-type">MetadataWithResourceVersion</span></a></span><span> </span><span id="local-6989586621690941734"><span class="annot"><span class="annottext">Metadata
</span><a href="#local-6989586621690941734"><span class="hs-identifier hs-var">metadata</span></a></span></span><span> </span><span id="local-6989586621690941733"><span class="annot"><span class="annottext">MetadataResourceVersion
</span><a href="#local-6989586621690941733"><span class="hs-identifier hs-var">currentResourceVersion</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadIO m, MonadTrace m) =&gt;
Text -&gt; m a -&gt; m a
</span><a href="Hasura.Tracing.Class.html#newSpan"><span class="hs-identifier hs-var">Tracing.newSpan</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;fetchMetadata&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. MonadError e m =&gt; m (Either e a) -&gt; m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier hs-var">liftEitherM</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
m (Either QErr MetadataWithResourceVersion)
</span><a href="Hasura.Metadata.Class.html#fetchMetadata"><span class="hs-identifier hs-var">fetchMetadata</span></a></span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621690941729"><span class="annot"><span class="annottext">EncJSON
</span><a href="#local-6989586621690941729"><span class="hs-identifier hs-var">result</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690941728"><span class="annot"><span class="annottext">Metadata
</span><a href="#local-6989586621690941728"><span class="hs-identifier hs-var">updatedMetadata</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621690941727"><span class="annot"><span class="annottext">RebuildableSchemaCache
</span><a href="#local-6989586621690941727"><span class="hs-identifier hs-var">updatedCache</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690941726"><span class="annot"><span class="annottext">CacheInvalidations
</span><a href="#local-6989586621690941726"><span class="hs-identifier hs-var">invalidations</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadError QErr m, MonadIO m, MonadBaseControl IO m, UserInfoM m,
 CacheRWM m, MonadTrace m, MetadataM m, MonadQueryTags m) =&gt;
SQLGenCtx -&gt; RQLQuery -&gt; m EncJSON
</span><a href="Hasura.Server.API.V2Query.html#runQueryM"><span class="hs-identifier hs-var">runQueryM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppContext -&gt; SQLGenCtx
</span><a href="Hasura.App.State.html#acSQLGenCtx"><span class="hs-identifier hs-var">acSQLGenCtx</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621690941807"><span class="hs-identifier hs-var">appContext</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690941805"><span class="hs-identifier hs-var">rqlQuery</span></a></span><span>
</span><span id="line-129"></span><span>      </span><span class="hs-comment">-- We can use defaults here unconditionally, since there is no MD export function in V2Query</span><span>
</span><span id="line-130"></span><span>      </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
Metadata -&gt; MetadataDefaults -&gt; MetadataT m a -&gt; m (a, Metadata)
</span><a href="Hasura.RQL.Types.SchemaCache.Build.html#runMetadataT"><span class="hs-identifier hs-var">runMetadataT</span></a></span><span> </span><span class="annot"><span class="annottext">Metadata
</span><a href="#local-6989586621690941734"><span class="hs-identifier hs-var">metadata</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppContext -&gt; MetadataDefaults
</span><a href="Hasura.App.State.html#acMetadataDefaults"><span class="hs-identifier hs-var">acMetadataDefaults</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621690941807"><span class="hs-identifier hs-var">appContext</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>      </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
Monad m =&gt;
CacheDynamicConfig
-&gt; RebuildableSchemaCache
-&gt; CacheRWT m a
-&gt; m (a, RebuildableSchemaCache, CacheInvalidations)
</span><a href="Hasura.RQL.DDL.Schema.Cache.html#runCacheRWT"><span class="hs-identifier hs-var">runCacheRWT</span></a></span><span> </span><span class="annot"><span class="annottext">CacheDynamicConfig
</span><a href="#local-6989586621690941736"><span class="hs-identifier hs-var">dynamicConfig</span></a></span><span> </span><span class="annot"><span class="annottext">RebuildableSchemaCache
</span><a href="#local-6989586621690941806"><span class="hs-identifier hs-var">schemaCache</span></a></span><span>
</span><span id="line-132"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RQLQuery -&gt; Bool
</span><a href="Hasura.Server.API.V2Query.html#queryModifiesSchema"><span class="hs-identifier hs-var">queryModifiesSchema</span></a></span><span> </span><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690941805"><span class="hs-identifier hs-var">rqlQuery</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MaintenanceMode ()
</span><a href="#local-6989586621690941795"><span class="hs-identifier hs-var">appEnvEnableMaintenanceMode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-134"></span><span>      </span><span class="annot"><span class="annottext">MaintenanceMode ()
</span><a href="Hasura.Server.Types.html#MaintenanceModeDisabled"><span class="hs-identifier hs-var">MaintenanceModeDisabled</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-135"></span><span>        </span><span class="hs-comment">-- set modified metadata in storage</span><span>
</span><span id="line-136"></span><span>        </span><span id="local-6989586621690941718"><span class="annot"><span class="annottext">MetadataResourceVersion
</span><a href="#local-6989586621690941718"><span class="hs-identifier hs-var">newResourceVersion</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-137"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadIO m, MonadTrace m) =&gt;
Text -&gt; m a -&gt; m a
</span><a href="Hasura.Tracing.Class.html#newSpan"><span class="hs-identifier hs-var">Tracing.newSpan</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;setMetadata&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-138"></span><span>            </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. MonadError e m =&gt; m (Either e a) -&gt; m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier hs-var">liftEitherM</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-139"></span><span>              </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
MetadataResourceVersion
-&gt; Metadata -&gt; m (Either QErr MetadataResourceVersion)
</span><a href="Hasura.Metadata.Class.html#setMetadata"><span class="hs-identifier hs-var">setMetadata</span></a></span><span> </span><span class="annot"><span class="annottext">MetadataResourceVersion
</span><a href="#local-6989586621690941733"><span class="hs-identifier hs-var">currentResourceVersion</span></a></span><span> </span><span class="annot"><span class="annottext">Metadata
</span><a href="#local-6989586621690941728"><span class="hs-identifier hs-var">updatedMetadata</span></a></span><span>
</span><span id="line-140"></span><span>        </span><span class="hs-comment">-- notify schema cache sync</span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadIO m, MonadTrace m) =&gt;
Text -&gt; m a -&gt; m a
</span><a href="Hasura.Tracing.Class.html#newSpan"><span class="hs-identifier hs-var">Tracing.newSpan</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;notifySchemaCacheSync&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-142"></span><span>          </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. MonadError e m =&gt; m (Either e a) -&gt; m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier hs-var">liftEitherM</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-143"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
MetadataResourceVersion
-&gt; InstanceId -&gt; CacheInvalidations -&gt; m (Either QErr ())
</span><a href="Hasura.Metadata.Class.html#notifySchemaCacheSync"><span class="hs-identifier hs-var">notifySchemaCacheSync</span></a></span><span> </span><span class="annot"><span class="annottext">MetadataResourceVersion
</span><a href="#local-6989586621690941718"><span class="hs-identifier hs-var">newResourceVersion</span></a></span><span> </span><span class="annot"><span class="annottext">InstanceId
</span><a href="#local-6989586621690941796"><span class="hs-identifier hs-var">appEnvInstanceId</span></a></span><span> </span><span class="annot"><span class="annottext">CacheInvalidations
</span><a href="#local-6989586621690941726"><span class="hs-identifier hs-var">invalidations</span></a></span><span>
</span><span id="line-144"></span><span>      </span><span class="annot"><a href="Hasura.Server.Types.html#MaintenanceModeEnabled"><span class="hs-identifier hs-type">MaintenanceModeEnabled</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-145"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a
</span><span class="hs-identifier hs-var">throw500</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;metadata cannot be modified in maintenance mode&quot;</span></span><span>
</span><span id="line-146"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EncJSON
</span><a href="#local-6989586621690941729"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RebuildableSchemaCache
</span><a href="#local-6989586621690941727"><span class="hs-identifier hs-var">updatedCache</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="annot"><a href="Hasura.Server.API.V2Query.html#queryModifiesSchema"><span class="hs-identifier hs-type">queryModifiesSchema</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQLQuery"><span class="hs-identifier hs-type">RQLQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-149"></span><span id="queryModifiesSchema"><span class="annot"><span class="annottext">queryModifiesSchema :: RQLQuery -&gt; Bool
</span><a href="Hasura.Server.API.V2Query.html#queryModifiesSchema"><span class="hs-identifier hs-var hs-var">queryModifiesSchema</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-150"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQInsert"><span class="hs-identifier hs-type">RQInsert</span></a></span><span> </span><span class="annot"><span class="annottext">InsertQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-151"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQSelect"><span class="hs-identifier hs-type">RQSelect</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-152"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQUpdate"><span class="hs-identifier hs-type">RQUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">UpdateQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-153"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQDelete"><span class="hs-identifier hs-type">RQDelete</span></a></span><span> </span><span class="annot"><span class="annottext">DeleteQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQCount"><span class="hs-identifier hs-type">RQCount</span></a></span><span> </span><span class="annot"><span class="annottext">CountQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-155"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQRunSql"><span class="hs-identifier hs-type">RQRunSql</span></a></span><span> </span><span id="local-6989586621690941713"><span class="annot"><span class="annottext">RunSQL
</span><a href="#local-6989586621690941713"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RunSQL -&gt; Bool
</span><a href="Hasura.Backends.Postgres.DDL.RunSQL.html#isSchemaCacheBuildRequiredRunSQL"><span class="hs-identifier hs-var">Postgres.isSchemaCacheBuildRequiredRunSQL</span></a></span><span> </span><span class="annot"><span class="annottext">RunSQL
</span><a href="#local-6989586621690941713"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-156"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQCitusRunSql"><span class="hs-identifier hs-type">RQCitusRunSql</span></a></span><span> </span><span id="local-6989586621690941711"><span class="annot"><span class="annottext">RunSQL
</span><a href="#local-6989586621690941711"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RunSQL -&gt; Bool
</span><a href="Hasura.Backends.Postgres.DDL.RunSQL.html#isSchemaCacheBuildRequiredRunSQL"><span class="hs-identifier hs-var">Postgres.isSchemaCacheBuildRequiredRunSQL</span></a></span><span> </span><span class="annot"><span class="annottext">RunSQL
</span><a href="#local-6989586621690941711"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-157"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQCockroachRunSql"><span class="hs-identifier hs-type">RQCockroachRunSql</span></a></span><span> </span><span id="local-6989586621690941710"><span class="annot"><span class="annottext">RunSQL
</span><a href="#local-6989586621690941710"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RunSQL -&gt; Bool
</span><a href="Hasura.Backends.Postgres.DDL.RunSQL.html#isSchemaCacheBuildRequiredRunSQL"><span class="hs-identifier hs-var">Postgres.isSchemaCacheBuildRequiredRunSQL</span></a></span><span> </span><span class="annot"><span class="annottext">RunSQL
</span><a href="#local-6989586621690941710"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-158"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQMssqlRunSql"><span class="hs-identifier hs-type">RQMssqlRunSql</span></a></span><span> </span><span id="local-6989586621690941709"><span class="annot"><span class="annottext">MSSQLRunSQL
</span><a href="#local-6989586621690941709"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MSSQLRunSQL -&gt; Bool
</span><a href="Hasura.Backends.MSSQL.DDL.RunSQL.html#isSchemaCacheBuildRequiredRunSQL"><span class="hs-identifier hs-var">MSSQL.isSchemaCacheBuildRequiredRunSQL</span></a></span><span> </span><span class="annot"><span class="annottext">MSSQLRunSQL
</span><a href="#local-6989586621690941709"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-159"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQBigqueryRunSql"><span class="hs-identifier hs-type">RQBigqueryRunSql</span></a></span><span> </span><span class="annot"><span class="annottext">BigQueryRunSQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-160"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQDataConnectorRunSql"><span class="hs-identifier hs-type">RQDataConnectorRunSql</span></a></span><span> </span><span class="annot"><span class="annottext">DataConnectorName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DataConnectorRunSQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-161"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQBigqueryDatabaseInspection"><span class="hs-identifier hs-type">RQBigqueryDatabaseInspection</span></a></span><span> </span><span class="annot"><span class="annottext">BigQueryRunSQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-162"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQBulk"><span class="hs-identifier hs-type">RQBulk</span></a></span><span> </span><span id="local-6989586621690941707"><span class="annot"><span class="annottext">[RQLQuery]
</span><a href="#local-6989586621690941707"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">any</span></a></span><span> </span><span class="annot"><span class="annottext">RQLQuery -&gt; Bool
</span><a href="Hasura.Server.API.V2Query.html#queryModifiesSchema"><span class="hs-identifier hs-var">queryModifiesSchema</span></a></span><span> </span><span class="annot"><span class="annottext">[RQLQuery]
</span><a href="#local-6989586621690941707"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-163"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQConcurrentBulk"><span class="hs-identifier hs-type">RQConcurrentBulk</span></a></span><span> </span><span id="local-6989586621690941705"><span class="annot"><span class="annottext">[RQLQuery]
</span><a href="#local-6989586621690941705"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">any</span></a></span><span> </span><span class="annot"><span class="annottext">RQLQuery -&gt; Bool
</span><a href="Hasura.Server.API.V2Query.html#queryModifiesSchema"><span class="hs-identifier hs-var">queryModifiesSchema</span></a></span><span> </span><span class="annot"><span class="annottext">[RQLQuery]
</span><a href="#local-6989586621690941705"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span id="local-6989586621690942119"><span class="annot"><a href="Hasura.Server.API.V2Query.html#runQueryM"><span class="hs-identifier hs-type">runQueryM</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">QErr</span></span><span> </span><span class="annot"><a href="#local-6989586621690942119"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690942119"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadBaseControl</span></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690942119"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-169"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Session.html#UserInfoM"><span class="hs-identifier hs-type">UserInfoM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690942119"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-170"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.Build.html#CacheRWM"><span class="hs-identifier hs-type">CacheRWM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690942119"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-171"></span><span>    </span><span class="annot"><a href="Hasura.Tracing.Class.html#MonadTrace"><span class="hs-identifier hs-type">Tracing.MonadTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690942119"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.html#MetadataM"><span class="hs-identifier hs-type">MetadataM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690942119"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><a href="Hasura.QueryTags.html#MonadQueryTags"><span class="hs-identifier hs-type">MonadQueryTags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690942119"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-175"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#SQLGenCtx"><span class="hs-identifier hs-type">SQLGenCtx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-176"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQLQuery"><span class="hs-identifier hs-type">RQLQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-177"></span><span>  </span><span class="annot"><a href="#local-6989586621690942119"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EncJSON</span></span></span><span>
</span><span id="line-178"></span><span id="runQueryM"><span class="annot"><span class="annottext">runQueryM :: forall (m :: * -&gt; *).
(MonadError QErr m, MonadIO m, MonadBaseControl IO m, UserInfoM m,
 CacheRWM m, MonadTrace m, MetadataM m, MonadQueryTags m) =&gt;
SQLGenCtx -&gt; RQLQuery -&gt; m EncJSON
</span><a href="Hasura.Server.API.V2Query.html#runQueryM"><span class="hs-identifier hs-var hs-var">runQueryM</span></a></span></span><span> </span><span id="local-6989586621690941455"><span class="annot"><span class="annottext">SQLGenCtx
</span><a href="#local-6989586621690941455"><span class="hs-identifier hs-var">sqlGen</span></a></span></span><span> </span><span id="local-6989586621690941454"><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690941454"><span class="hs-identifier hs-var">rq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadIO m, MonadTrace m) =&gt;
Text -&gt; m a -&gt; m a
</span><a href="Hasura.Tracing.Class.html#newSpan"><span class="hs-identifier hs-var">Tracing.newSpan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. (HasConstructor (Rep a), Generic a) =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">constrName</span></span><span> </span><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690941454"><span class="hs-identifier hs-var">rq</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690941454"><span class="hs-identifier hs-var">rq</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-179"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQInsert"><span class="hs-identifier hs-type">RQInsert</span></a></span><span> </span><span id="local-6989586621690941452"><span class="annot"><span class="annottext">InsertQuery
</span><a href="#local-6989586621690941452"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(QErrM m, UserInfoM m, CacheRM m, MonadIO m, MonadTrace m,
 MonadBaseControl IO m, MetadataM m) =&gt;
SQLGenCtx -&gt; InsertQuery -&gt; m EncJSON
</span><a href="Hasura.RQL.DML.Insert.html#runInsert"><span class="hs-identifier hs-var">runInsert</span></a></span><span> </span><span class="annot"><span class="annottext">SQLGenCtx
</span><a href="#local-6989586621690941455"><span class="hs-identifier hs-var">sqlGen</span></a></span><span> </span><span class="annot"><span class="annottext">InsertQuery
</span><a href="#local-6989586621690941452"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-180"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQSelect"><span class="hs-identifier hs-type">RQSelect</span></a></span><span> </span><span id="local-6989586621690941450"><span class="annot"><span class="annottext">SelectQuery
</span><a href="#local-6989586621690941450"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(QErrM m, UserInfoM m, CacheRM m, MonadIO m, MonadBaseControl IO m,
 MonadTrace m, MetadataM m) =&gt;
SQLGenCtx -&gt; SelectQuery -&gt; m EncJSON
</span><a href="Hasura.RQL.DML.Select.html#runSelect"><span class="hs-identifier hs-var">runSelect</span></a></span><span> </span><span class="annot"><span class="annottext">SQLGenCtx
</span><a href="#local-6989586621690941455"><span class="hs-identifier hs-var">sqlGen</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQuery
</span><a href="#local-6989586621690941450"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-181"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQUpdate"><span class="hs-identifier hs-type">RQUpdate</span></a></span><span> </span><span id="local-6989586621690941448"><span class="annot"><span class="annottext">UpdateQuery
</span><a href="#local-6989586621690941448"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(QErrM m, UserInfoM m, CacheRM m, MonadBaseControl IO m, MonadIO m,
 MonadTrace m, MetadataM m) =&gt;
SQLGenCtx -&gt; UpdateQuery -&gt; m EncJSON
</span><a href="Hasura.RQL.DML.Update.html#runUpdate"><span class="hs-identifier hs-var">runUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">SQLGenCtx
</span><a href="#local-6989586621690941455"><span class="hs-identifier hs-var">sqlGen</span></a></span><span> </span><span class="annot"><span class="annottext">UpdateQuery
</span><a href="#local-6989586621690941448"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-182"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQDelete"><span class="hs-identifier hs-type">RQDelete</span></a></span><span> </span><span id="local-6989586621690941446"><span class="annot"><span class="annottext">DeleteQuery
</span><a href="#local-6989586621690941446"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(QErrM m, UserInfoM m, CacheRM m, MonadIO m, MonadTrace m,
 MonadBaseControl IO m, MetadataM m) =&gt;
SQLGenCtx -&gt; DeleteQuery -&gt; m EncJSON
</span><a href="Hasura.RQL.DML.Delete.html#runDelete"><span class="hs-identifier hs-var">runDelete</span></a></span><span> </span><span class="annot"><span class="annottext">SQLGenCtx
</span><a href="#local-6989586621690941455"><span class="hs-identifier hs-var">sqlGen</span></a></span><span> </span><span class="annot"><span class="annottext">DeleteQuery
</span><a href="#local-6989586621690941446"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQCount"><span class="hs-identifier hs-type">RQCount</span></a></span><span> </span><span id="local-6989586621690941444"><span class="annot"><span class="annottext">CountQuery
</span><a href="#local-6989586621690941444"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(QErrM m, UserInfoM m, CacheRM m, MonadIO m, MonadBaseControl IO m,
 MonadTrace m, MetadataM m) =&gt;
CountQuery -&gt; m EncJSON
</span><a href="Hasura.RQL.DML.Count.html#runCount"><span class="hs-identifier hs-var">runCount</span></a></span><span> </span><span class="annot"><span class="annottext">CountQuery
</span><a href="#local-6989586621690941444"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-184"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQRunSql"><span class="hs-identifier hs-type">RQRunSql</span></a></span><span> </span><span id="local-6989586621690941442"><span class="annot"><span class="annottext">RunSQL
</span><a href="#local-6989586621690941442"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(BackendMetadata ('Postgres pgKind), ToMetadataFetchQuery pgKind,
 FetchTableMetadata pgKind, FetchFunctionMetadata pgKind,
 CacheRWM m, MetadataM m, MonadBaseControl IO m, MonadError QErr m,
 MonadIO m, MonadTrace m, UserInfoM m) =&gt;
SQLGenCtx -&gt; RunSQL -&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.DDL.RunSQL.html#runRunSQL"><span class="hs-identifier hs-var">Postgres.runRunSQL</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span> </span><span class="annot"><span class="annottext">SQLGenCtx
</span><a href="#local-6989586621690941455"><span class="hs-identifier hs-var">sqlGen</span></a></span><span> </span><span class="annot"><span class="annottext">RunSQL
</span><a href="#local-6989586621690941442"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-185"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQMssqlRunSql"><span class="hs-identifier hs-type">RQMssqlRunSql</span></a></span><span> </span><span id="local-6989586621690941440"><span class="annot"><span class="annottext">MSSQLRunSQL
</span><a href="#local-6989586621690941440"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadBaseControl IO m, CacheRWM m, MonadError QErr m,
 MetadataM m) =&gt;
MSSQLRunSQL -&gt; m EncJSON
</span><a href="Hasura.Backends.MSSQL.DDL.RunSQL.html#runSQL"><span class="hs-identifier hs-var">MSSQL.runSQL</span></a></span><span> </span><span class="annot"><span class="annottext">MSSQLRunSQL
</span><a href="#local-6989586621690941440"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQCitusRunSql"><span class="hs-identifier hs-type">RQCitusRunSql</span></a></span><span> </span><span id="local-6989586621690941438"><span class="annot"><span class="annottext">RunSQL
</span><a href="#local-6989586621690941438"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(BackendMetadata ('Postgres pgKind), ToMetadataFetchQuery pgKind,
 FetchTableMetadata pgKind, FetchFunctionMetadata pgKind,
 CacheRWM m, MetadataM m, MonadBaseControl IO m, MonadError QErr m,
 MonadIO m, MonadTrace m, UserInfoM m) =&gt;
SQLGenCtx -&gt; RunSQL -&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.DDL.RunSQL.html#runRunSQL"><span class="hs-identifier hs-var">Postgres.runRunSQL</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Citus"><span class="hs-identifier hs-type">Citus</span></a></span><span> </span><span class="annot"><span class="annottext">SQLGenCtx
</span><a href="#local-6989586621690941455"><span class="hs-identifier hs-var">sqlGen</span></a></span><span> </span><span class="annot"><span class="annottext">RunSQL
</span><a href="#local-6989586621690941438"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-187"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQCockroachRunSql"><span class="hs-identifier hs-type">RQCockroachRunSql</span></a></span><span> </span><span id="local-6989586621690941437"><span class="annot"><span class="annottext">RunSQL
</span><a href="#local-6989586621690941437"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(BackendMetadata ('Postgres pgKind), ToMetadataFetchQuery pgKind,
 FetchTableMetadata pgKind, FetchFunctionMetadata pgKind,
 CacheRWM m, MetadataM m, MonadBaseControl IO m, MonadError QErr m,
 MonadIO m, MonadTrace m, UserInfoM m) =&gt;
SQLGenCtx -&gt; RunSQL -&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.DDL.RunSQL.html#runRunSQL"><span class="hs-identifier hs-var">Postgres.runRunSQL</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Cockroach"><span class="hs-identifier hs-type">Cockroach</span></a></span><span> </span><span class="annot"><span class="annottext">SQLGenCtx
</span><a href="#local-6989586621690941455"><span class="hs-identifier hs-var">sqlGen</span></a></span><span> </span><span class="annot"><span class="annottext">RunSQL
</span><a href="#local-6989586621690941437"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-188"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQBigqueryRunSql"><span class="hs-identifier hs-type">RQBigqueryRunSql</span></a></span><span> </span><span id="local-6989586621690941436"><span class="annot"><span class="annottext">BigQueryRunSQL
</span><a href="#local-6989586621690941436"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, CacheRWM m, MonadError QErr m, MetadataM m) =&gt;
BigQueryRunSQL -&gt; m EncJSON
</span><a href="Hasura.Backends.BigQuery.DDL.RunSQL.html#runSQL"><span class="hs-identifier hs-var">BigQuery.runSQL</span></a></span><span> </span><span class="annot"><span class="annottext">BigQueryRunSQL
</span><a href="#local-6989586621690941436"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-189"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQDataConnectorRunSql"><span class="hs-identifier hs-type">RQDataConnectorRunSql</span></a></span><span> </span><span id="local-6989586621690941434"><span class="annot"><span class="annottext">DataConnectorName
</span><a href="#local-6989586621690941434"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621690941433"><span class="annot"><span class="annottext">DataConnectorRunSQL
</span><a href="#local-6989586621690941433"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, CacheRWM m, MonadError QErr m, MetadataM m) =&gt;
DataConnectorName -&gt; DataConnectorRunSQL -&gt; m EncJSON
</span><a href="Hasura.Backends.DataConnector.Adapter.RunSQL.html#runSQL"><span class="hs-identifier hs-var">DataConnector.runSQL</span></a></span><span> </span><span class="annot"><span class="annottext">DataConnectorName
</span><a href="#local-6989586621690941434"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">DataConnectorRunSQL
</span><a href="#local-6989586621690941433"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQBigqueryDatabaseInspection"><span class="hs-identifier hs-type">RQBigqueryDatabaseInspection</span></a></span><span> </span><span id="local-6989586621690941431"><span class="annot"><span class="annottext">BigQueryRunSQL
</span><a href="#local-6989586621690941431"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, CacheRWM m, MonadError QErr m, MetadataM m) =&gt;
BigQueryRunSQL -&gt; m EncJSON
</span><a href="Hasura.Backends.BigQuery.DDL.RunSQL.html#runDatabaseInspection"><span class="hs-identifier hs-var">BigQuery.runDatabaseInspection</span></a></span><span> </span><span class="annot"><span class="annottext">BigQueryRunSQL
</span><a href="#local-6989586621690941431"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-191"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQBulk"><span class="hs-identifier hs-type">RQBulk</span></a></span><span> </span><span id="local-6989586621690941429"><span class="annot"><span class="annottext">[RQLQuery]
</span><a href="#local-6989586621690941429"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[EncJSON] -&gt; EncJSON
</span><span class="hs-identifier hs-var">encJFromList</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. QErrM m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">indexedMapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadError QErr m, MonadIO m, MonadBaseControl IO m, UserInfoM m,
 CacheRWM m, MonadTrace m, MetadataM m, MonadQueryTags m) =&gt;
SQLGenCtx -&gt; RQLQuery -&gt; m EncJSON
</span><a href="Hasura.Server.API.V2Query.html#runQueryM"><span class="hs-identifier hs-var">runQueryM</span></a></span><span> </span><span class="annot"><span class="annottext">SQLGenCtx
</span><a href="#local-6989586621690941455"><span class="hs-identifier hs-var">sqlGen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[RQLQuery]
</span><a href="#local-6989586621690941429"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-192"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQConcurrentBulk"><span class="hs-identifier hs-type">RQConcurrentBulk</span></a></span><span> </span><span id="local-6989586621690941426"><span class="annot"><span class="annottext">[RQLQuery]
</span><a href="#local-6989586621690941426"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RQLQuery -&gt; Bool
</span><a href="Hasura.Server.API.V2Query.html#queryModifiesSchema"><span class="hs-identifier hs-var">queryModifiesSchema</span></a></span><span> </span><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690941454"><span class="hs-identifier hs-var">rq</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-194"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a
</span><span class="hs-identifier hs-var">throw500</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Only read-only queries are allowed in a concurrent_bulk&quot;</span></span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><span class="annottext">[EncJSON] -&gt; EncJSON
</span><span class="hs-identifier hs-var">encJFromList</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, MonadBaseControl IO m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapConcurrently</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadError QErr m, MonadIO m, MonadBaseControl IO m, UserInfoM m,
 CacheRWM m, MonadTrace m, MetadataM m, MonadQueryTags m) =&gt;
SQLGenCtx -&gt; RQLQuery -&gt; m EncJSON
</span><a href="Hasura.Server.API.V2Query.html#runQueryM"><span class="hs-identifier hs-var">runQueryM</span></a></span><span> </span><span class="annot"><span class="annottext">SQLGenCtx
</span><a href="#local-6989586621690941455"><span class="hs-identifier hs-var">sqlGen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[RQLQuery]
</span><a href="#local-6989586621690941426"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="annot"><a href="Hasura.Server.API.V2Query.html#queryModifiesUserDB"><span class="hs-identifier hs-type">queryModifiesUserDB</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQLQuery"><span class="hs-identifier hs-type">RQLQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-198"></span><span id="queryModifiesUserDB"><span class="annot"><span class="annottext">queryModifiesUserDB :: RQLQuery -&gt; Bool
</span><a href="Hasura.Server.API.V2Query.html#queryModifiesUserDB"><span class="hs-identifier hs-var hs-var">queryModifiesUserDB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-199"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQInsert"><span class="hs-identifier hs-type">RQInsert</span></a></span><span> </span><span class="annot"><span class="annottext">InsertQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-200"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQSelect"><span class="hs-identifier hs-type">RQSelect</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-201"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQUpdate"><span class="hs-identifier hs-type">RQUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">UpdateQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-202"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQDelete"><span class="hs-identifier hs-type">RQDelete</span></a></span><span> </span><span class="annot"><span class="annottext">DeleteQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-203"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQCount"><span class="hs-identifier hs-type">RQCount</span></a></span><span> </span><span class="annot"><span class="annottext">CountQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-204"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQRunSql"><span class="hs-identifier hs-type">RQRunSql</span></a></span><span> </span><span id="local-6989586621690941425"><span class="annot"><span class="annottext">RunSQL
</span><a href="#local-6989586621690941425"><span class="hs-identifier hs-var">runsql</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RunSQL -&gt; Bool
</span><a href="Hasura.Backends.Postgres.DDL.RunSQL.html#isReadOnly"><span class="hs-identifier hs-var">Postgres.isReadOnly</span></a></span><span> </span><span class="annot"><span class="annottext">RunSQL
</span><a href="#local-6989586621690941425"><span class="hs-identifier hs-var">runsql</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQCitusRunSql"><span class="hs-identifier hs-type">RQCitusRunSql</span></a></span><span> </span><span id="local-6989586621690941422"><span class="annot"><span class="annottext">RunSQL
</span><a href="#local-6989586621690941422"><span class="hs-identifier hs-var">runsql</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RunSQL -&gt; Bool
</span><a href="Hasura.Backends.Postgres.DDL.RunSQL.html#isReadOnly"><span class="hs-identifier hs-var">Postgres.isReadOnly</span></a></span><span> </span><span class="annot"><span class="annottext">RunSQL
</span><a href="#local-6989586621690941422"><span class="hs-identifier hs-var">runsql</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQCockroachRunSql"><span class="hs-identifier hs-type">RQCockroachRunSql</span></a></span><span> </span><span id="local-6989586621690941421"><span class="annot"><span class="annottext">RunSQL
</span><a href="#local-6989586621690941421"><span class="hs-identifier hs-var">runsql</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RunSQL -&gt; Bool
</span><a href="Hasura.Backends.Postgres.DDL.RunSQL.html#isReadOnly"><span class="hs-identifier hs-var">Postgres.isReadOnly</span></a></span><span> </span><span class="annot"><span class="annottext">RunSQL
</span><a href="#local-6989586621690941421"><span class="hs-identifier hs-var">runsql</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQMssqlRunSql"><span class="hs-identifier hs-type">RQMssqlRunSql</span></a></span><span> </span><span class="annot"><span class="annottext">MSSQLRunSQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-208"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQBigqueryRunSql"><span class="hs-identifier hs-type">RQBigqueryRunSql</span></a></span><span> </span><span class="annot"><span class="annottext">BigQueryRunSQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-209"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQDataConnectorRunSql"><span class="hs-identifier hs-type">RQDataConnectorRunSql</span></a></span><span> </span><span class="annot"><span class="annottext">DataConnectorName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DataConnectorRunSQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-210"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQBigqueryDatabaseInspection"><span class="hs-identifier hs-type">RQBigqueryDatabaseInspection</span></a></span><span> </span><span class="annot"><span class="annottext">BigQueryRunSQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-211"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQBulk"><span class="hs-identifier hs-type">RQBulk</span></a></span><span> </span><span id="local-6989586621690941420"><span class="annot"><span class="annottext">[RQLQuery]
</span><a href="#local-6989586621690941420"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">any</span></a></span><span> </span><span class="annot"><span class="annottext">RQLQuery -&gt; Bool
</span><a href="Hasura.Server.API.V2Query.html#queryModifiesUserDB"><span class="hs-identifier hs-var">queryModifiesUserDB</span></a></span><span> </span><span class="annot"><span class="annottext">[RQLQuery]
</span><a href="#local-6989586621690941420"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-212"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQConcurrentBulk"><span class="hs-identifier hs-type">RQConcurrentBulk</span></a></span><span> </span><span class="annot"><span class="annottext">[RQLQuery]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-213"></span></pre></body></html>