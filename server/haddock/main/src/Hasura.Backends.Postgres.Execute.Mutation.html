<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | Postgres Execute Mutation</span><span>
</span><span id="line-2"></span><span class="hs-comment">--</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Generic combinators for translating and excecuting IR mutation statements.</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Used by the specific mutation modules, e.g. 'Hasura.Backends.Postgres.Execute.Insert'.</span><span>
</span><span id="line-5"></span><span class="hs-comment">--</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- See 'Hasura.Backends.Postgres.Instances.Execute'.</span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hasura.Backends.Postgres.Execute.Mutation</span><span>
</span><span id="line-8"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#MutateResp"><span class="hs-identifier">MutateResp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#execDeleteQuery"><span class="hs-identifier">execDeleteQuery</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#execInsertQuery"><span class="hs-identifier">execInsertQuery</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#execUpdateQuery"><span class="hs-identifier">execUpdateQuery</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#executeMutationOutputQuery"><span class="hs-identifier">executeMutationOutputQuery</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mutateAndFetchCols"><span class="hs-identifier">mutateAndFetchCols</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">where</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier">Control.Monad.Writer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier">runWriter</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier">Data.Sequence</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DS</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier">Database.PG.Query</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PG</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.html"><span class="hs-identifier">Hasura.Backends.Postgres.Connection</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html"><span class="hs-identifier">Hasura.Backends.Postgres.SQL.DML</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html"><span class="hs-identifier">Hasura.Backends.Postgres.SQL.Types</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Value.html"><span class="hs-identifier">Hasura.Backends.Postgres.SQL.Value</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Delete.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Delete</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Insert.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Insert</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Mutation.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Mutation</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Returning.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Returning</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Select</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Select.Internal.Helpers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#customSQLToTopLevelCTEs"><span class="hs-identifier">customSQLToTopLevelCTEs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#toQuery"><span class="hs-identifier">toQuery</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Update.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Update</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hasura.Base.Error</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hasura.EncJSON</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.NamingCase.html"><span class="hs-identifier">Hasura.GraphQL.Schema.NamingCase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Schema.NamingCase.html#NamingCase"><span class="hs-identifier">NamingCase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier">Hasura.Prelude</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.QueryTags.html"><span class="hs-identifier">Hasura.QueryTags</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.BoolExp.html"><span class="hs-identifier">Hasura.RQL.IR.BoolExp</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Delete.html"><span class="hs-identifier">Hasura.RQL.IR.Delete</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html"><span class="hs-identifier">Hasura.RQL.IR.Insert</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Returning.html"><span class="hs-identifier">Hasura.RQL.IR.Returning</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html"><span class="hs-identifier">Hasura.RQL.IR.Select</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Update.html"><span class="hs-identifier">Hasura.RQL.IR.Update</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html"><span class="hs-identifier">Hasura.RQL.Types.Backend</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html"><span class="hs-identifier">Hasura.RQL.Types.BackendType</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Column.html"><span class="hs-identifier">Hasura.RQL.Types.Column</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html"><span class="hs-identifier">Hasura.RQL.Types.Common</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html"><span class="hs-identifier">Hasura.RQL.Types.Schema.Options</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Options</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Session.html"><span class="hs-identifier">Hasura.Session</span></a></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span id="local-6989586621690936307"><span id="local-6989586621690936308"></span></span><span class="hs-keyword">data</span><span> </span><span id="MutateResp"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#MutateResp"><span class="hs-identifier hs-var">MutateResp</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621690936804"><span class="annot"><a href="#local-6989586621690936804"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#BackendType"><span class="hs-identifier hs-type">BackendType</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621690936803"><span class="annot"><a href="#local-6989586621690936803"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MutateResp"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#MutateResp"><span class="hs-identifier hs-var">MutateResp</span></a></span></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_mrAffectedRows"><span class="annot"><span class="annottext">forall (b :: BackendType) a. MutateResp b a -&gt; Int
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#_mrAffectedRows"><span class="hs-identifier hs-var hs-var">_mrAffectedRows</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>    </span><span id="_mrReturningColumns"><span class="annot"><span class="annottext">forall (b :: BackendType) a. MutateResp b a -&gt; [ColumnValues b a]
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#_mrReturningColumns"><span class="hs-identifier hs-var hs-var">_mrReturningColumns</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnValues"><span class="hs-identifier hs-type">ColumnValues</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936804"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936803"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall (b :: BackendType) a x.
Rep (MutateResp b a) x -&gt; MutateResp b a
forall (b :: BackendType) a x.
MutateResp b a -&gt; Rep (MutateResp b a) x
$cto :: forall (b :: BackendType) a x.
Rep (MutateResp b a) x -&gt; MutateResp b a
$cfrom :: forall (b :: BackendType) a x.
MutateResp b a -&gt; Rep (MutateResp b a) x
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span id="local-6989586621690936287"><span id="local-6989586621690936289"><span id="local-6989586621690936298"><span id="local-6989586621690936784"><span id="local-6989586621690936785"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936785"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936784"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#MutateResp"><span class="hs-identifier hs-type">MutateResp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936785"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936784"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span id="local-6989586621690936276"><span id="local-6989586621690936283"><span id="local-6989586621690936778"><span id="local-6989586621690936779"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936779"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936778"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#MutateResp"><span class="hs-identifier hs-type">MutateResp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936779"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936778"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621690936267"><span id="local-6989586621690936269"><span id="local-6989586621690936271"><span id="local-6989586621690936773"><span id="local-6989586621690936774"><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936774"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621690936773"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#MutateResp"><span class="hs-identifier hs-type">MutateResp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936774"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936773"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-63"></span><span>  </span><span id="local-6989586621690936165"><span class="annot"><span class="annottext">toJSON :: MutateResp b a -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(Generic a, GToJSON' Value Zero (Rep a)) =&gt;
Options -&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">genericToJSON</span></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier hs-var">hasuraJSON</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621690936159"><span id="local-6989586621690936645"><span id="local-6989586621690936646"><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936646"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621690936645"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#MutateResp"><span class="hs-identifier hs-type">MutateResp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936646"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936645"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-66"></span><span>  </span><span id="local-6989586621690936084"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (MutateResp b a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(Generic a, GFromJSON Zero (Rep a)) =&gt;
Options -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">genericParseJSON</span></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier hs-var">hasuraJSON</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">data</span><span> </span><span id="Mutation"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#Mutation"><span class="hs-identifier hs-var">Mutation</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621690936578"><span class="annot"><a href="#local-6989586621690936578"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#BackendType"><span class="hs-identifier hs-type">BackendType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Mutation"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#Mutation"><span class="hs-identifier hs-var">Mutation</span></a></span></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_mTable"><span class="annot"><span class="annottext">forall (b :: BackendType). Mutation b -&gt; QualifiedTable
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#_mTable"><span class="hs-identifier hs-var hs-var">_mTable</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedTable"><span class="hs-identifier hs-type">QualifiedTable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>    </span><span id="_mQuery"><span class="annot"><span class="annottext">forall (b :: BackendType). Mutation b -&gt; (MutationCTE, Seq PrepArg)
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#_mQuery"><span class="hs-identifier hs-var hs-var">_mQuery</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Returning.html#MutationCTE"><span class="hs-identifier hs-type">MutationCTE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">DS.Seq</span></a></span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.PrepArg</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>    </span><span id="_mOutput"><span class="annot"><span class="annottext">forall (b :: BackendType). Mutation b -&gt; MutationOutput b
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#_mOutput"><span class="hs-identifier hs-var hs-var">_mOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Returning.html#MutationOutput"><span class="hs-identifier hs-type">MutationOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936578"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>    </span><span id="_mCols"><span class="annot"><span class="annottext">forall (b :: BackendType). Mutation b -&gt; [ColumnInfo b]
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#_mCols"><span class="hs-identifier hs-var hs-var">_mCols</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnInfo"><span class="hs-identifier hs-type">ColumnInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936578"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>    </span><span id="_mStrfyNum"><span class="annot"><span class="annottext">forall (b :: BackendType). Mutation b -&gt; StringifyNumbers
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#_mStrfyNum"><span class="hs-identifier hs-var hs-var">_mStrfyNum</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>    </span><span id="_mNamingConvention"><span class="annot"><span class="annottext">forall (b :: BackendType). Mutation b -&gt; Maybe NamingCase
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#_mNamingConvention"><span class="hs-identifier hs-var hs-var">_mNamingConvention</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.NamingCase.html#NamingCase"><span class="hs-identifier hs-type">NamingCase</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span id="local-6989586621690936560"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mkMutation"><span class="hs-identifier hs-type">mkMutation</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-78"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedTable"><span class="hs-identifier hs-type">QualifiedTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Returning.html#MutationCTE"><span class="hs-identifier hs-type">MutationCTE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">DS.Seq</span></a></span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.PrepArg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Returning.html#MutationOutput"><span class="hs-identifier hs-type">MutationOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936560"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnInfo"><span class="hs-identifier hs-type">ColumnInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936560"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-83"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-84"></span><span>  </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.NamingCase.html#NamingCase"><span class="hs-identifier hs-type">NamingCase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-85"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#Mutation"><span class="hs-identifier hs-type">Mutation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936560"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-86"></span><span id="mkMutation"><span class="annot"><span class="annottext">mkMutation :: forall (pgKind :: PostgresKind).
UserInfo
-&gt; QualifiedTable
-&gt; (MutationCTE, Seq PrepArg)
-&gt; MutationOutput ('Postgres pgKind)
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; Mutation ('Postgres pgKind)
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mkMutation"><span class="hs-identifier hs-var hs-var">mkMutation</span></a></span></span><span> </span><span id="local-6989586621690936073"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690936073"><span class="hs-identifier hs-var">_userInfo</span></a></span></span><span> </span><span id="local-6989586621690936072"><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690936072"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span id="local-6989586621690936071"><span class="annot"><span class="annottext">(MutationCTE, Seq PrepArg)
</span><a href="#local-6989586621690936071"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span id="local-6989586621690936070"><span class="annot"><span class="annottext">MutationOutput ('Postgres pgKind)
</span><a href="#local-6989586621690936070"><span class="hs-identifier hs-var">output</span></a></span></span><span> </span><span id="local-6989586621690936069"><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621690936069"><span class="hs-identifier hs-var">allCols</span></a></span></span><span> </span><span id="local-6989586621690936068"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621690936068"><span class="hs-identifier hs-var">strfyNum</span></a></span></span><span> </span><span id="local-6989586621690936067"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621690936067"><span class="hs-identifier hs-var">tCase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-87"></span><span>  </span><span class="annot"><span class="annottext">forall (b :: BackendType).
QualifiedTable
-&gt; (MutationCTE, Seq PrepArg)
-&gt; MutationOutput b
-&gt; [ColumnInfo b]
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; Mutation b
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#Mutation"><span class="hs-identifier hs-var">Mutation</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690936072"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">(MutationCTE, Seq PrepArg)
</span><a href="#local-6989586621690936071"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">MutationOutput ('Postgres pgKind)
</span><a href="#local-6989586621690936070"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621690936069"><span class="hs-identifier hs-var">allCols</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621690936068"><span class="hs-identifier hs-var">strfyNum</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621690936067"><span class="hs-identifier hs-var">tCase</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span id="local-6989586621690936555"><span id="local-6989586621690936557"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#runMutation"><span class="hs-identifier hs-type">runMutation</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936557"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936555"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.AnnotatedFieldJSON.html#PostgresAnnotatedFieldJSON"><span class="hs-identifier hs-type">PostgresAnnotatedFieldJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936555"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Hasura.QueryTags.html#QueryTagsComment"><span class="hs-identifier hs-type">QueryTagsComment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936557"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-95"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#Mutation"><span class="hs-identifier hs-type">Mutation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936555"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-96"></span><span>  </span><span class="annot"><a href="#local-6989586621690936557"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EncJSON</span></span></span></span><span>
</span><span id="line-97"></span><span id="runMutation"><span class="annot"><span class="annottext">runMutation :: forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresAnnotatedFieldJSON pgKind,
 MonadReader QueryTagsComment m) =&gt;
Mutation ('Postgres pgKind) -&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#runMutation"><span class="hs-identifier hs-var hs-var">runMutation</span></a></span></span><span> </span><span id="local-6989586621690936053"><span class="annot"><span class="annottext">Mutation ('Postgres pgKind)
</span><a href="#local-6989586621690936053"><span class="hs-identifier hs-var">mut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-98"></span><span>  </span><span class="annot"><span class="annottext">forall a. a -&gt; a -&gt; Bool -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">bool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresAnnotatedFieldJSON pgKind,
 MonadReader QueryTagsComment m) =&gt;
Mutation ('Postgres pgKind) -&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mutateAndReturn"><span class="hs-identifier hs-var">mutateAndReturn</span></a></span><span> </span><span class="annot"><span class="annottext">Mutation ('Postgres pgKind)
</span><a href="#local-6989586621690936053"><span class="hs-identifier hs-var">mut</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresAnnotatedFieldJSON pgKind,
 MonadReader QueryTagsComment m) =&gt;
Mutation ('Postgres pgKind) -&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mutateAndSel"><span class="hs-identifier hs-var">mutateAndSel</span></a></span><span> </span><span class="annot"><span class="annottext">Mutation ('Postgres pgKind)
</span><a href="#local-6989586621690936053"><span class="hs-identifier hs-var">mut</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span class="annot"><span class="annottext">forall (backend :: BackendType) r a.
MutationOutputG backend r a -&gt; Bool
</span><a href="Hasura.RQL.IR.Returning.html#hasNestedFld"><span class="hs-identifier hs-var">hasNestedFld</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-100"></span><span>      </span><span class="annot"><span class="annottext">forall (b :: BackendType). Mutation b -&gt; MutationOutput b
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#_mOutput"><span class="hs-identifier hs-var">_mOutput</span></a></span><span> </span><span class="annot"><span class="annottext">Mutation ('Postgres pgKind)
</span><a href="#local-6989586621690936053"><span class="hs-identifier hs-var">mut</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span id="local-6989586621690936047"><span id="local-6989586621690936048"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mutateAndReturn"><span class="hs-identifier hs-type">mutateAndReturn</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936048"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936047"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.AnnotatedFieldJSON.html#PostgresAnnotatedFieldJSON"><span class="hs-identifier hs-type">PostgresAnnotatedFieldJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936047"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Hasura.QueryTags.html#QueryTagsComment"><span class="hs-identifier hs-type">QueryTagsComment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936048"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#Mutation"><span class="hs-identifier hs-type">Mutation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936047"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><a href="#local-6989586621690936048"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EncJSON</span></span></span></span><span>
</span><span id="line-110"></span><span id="mutateAndReturn"><span class="annot"><span class="annottext">mutateAndReturn :: forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresAnnotatedFieldJSON pgKind,
 MonadReader QueryTagsComment m) =&gt;
Mutation ('Postgres pgKind) -&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mutateAndReturn"><span class="hs-identifier hs-var hs-var">mutateAndReturn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#Mutation"><span class="hs-identifier hs-type">Mutation</span></a></span><span> </span><span id="local-6989586621690936036"><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690936036"><span class="hs-identifier hs-var">qt</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621690936035"><span class="annot"><span class="annottext">MutationCTE
</span><a href="#local-6989586621690936035"><span class="hs-identifier hs-var">cte</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690936034"><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621690936034"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621690936033"><span class="annot"><span class="annottext">MutationOutput ('Postgres pgKind)
</span><a href="#local-6989586621690936033"><span class="hs-identifier hs-var">mutationOutput</span></a></span></span><span> </span><span id="local-6989586621690936032"><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621690936032"><span class="hs-identifier hs-var">allCols</span></a></span></span><span> </span><span id="local-6989586621690936031"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621690936031"><span class="hs-identifier hs-var">strfyNum</span></a></span></span><span> </span><span id="local-6989586621690936030"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621690936030"><span class="hs-identifier hs-var">tCase</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><span class="annottext">forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresAnnotatedFieldJSON pgKind,
 MonadReader QueryTagsComment m) =&gt;
QualifiedTable
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; Maybe Int
-&gt; MutationCTE
-&gt; MutationOutput ('Postgres pgKind)
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; [PrepArg]
-&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#executeMutationOutputQuery"><span class="hs-identifier hs-var">executeMutationOutputQuery</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690936036"><span class="hs-identifier hs-var">qt</span></a></span><span> </span><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621690936032"><span class="hs-identifier hs-var">allCols</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">MutationCTE
</span><a href="#local-6989586621690936035"><span class="hs-identifier hs-var">cte</span></a></span><span> </span><span class="annot"><span class="annottext">MutationOutput ('Postgres pgKind)
</span><a href="#local-6989586621690936033"><span class="hs-identifier hs-var">mutationOutput</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621690936031"><span class="hs-identifier hs-var">strfyNum</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621690936030"><span class="hs-identifier hs-var">tCase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621690936034"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#execUpdateQuery"><span class="hs-identifier hs-type">execUpdateQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621690936531"><span class="annot"><a href="#local-6989586621690936531"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span> </span><span id="local-6989586621690936532"><span class="annot"><a href="#local-6989586621690936532"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936532"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-116"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936531"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-117"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.AnnotatedFieldJSON.html#PostgresAnnotatedFieldJSON"><span class="hs-identifier hs-type">PostgresAnnotatedFieldJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936531"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-118"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Hasura.QueryTags.html#QueryTagsComment"><span class="hs-identifier hs-type">QueryTagsComment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936532"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-120"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.NamingCase.html#NamingCase"><span class="hs-identifier hs-type">NamingCase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-122"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Update.html#AnnotatedUpdate"><span class="hs-identifier hs-type">AnnotatedUpdate</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936531"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">DS.Seq</span></a></span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.PrepArg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-124"></span><span>  </span><span class="annot"><a href="#local-6989586621690936532"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EncJSON</span></span><span>
</span><span id="line-125"></span><span id="execUpdateQuery"><span class="annot"><span class="annottext">execUpdateQuery :: forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresAnnotatedFieldJSON pgKind,
 MonadReader QueryTagsComment m) =&gt;
StringifyNumbers
-&gt; Maybe NamingCase
-&gt; UserInfo
-&gt; (AnnotatedUpdate ('Postgres pgKind), Seq PrepArg)
-&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#execUpdateQuery"><span class="hs-identifier hs-var hs-var">execUpdateQuery</span></a></span></span><span> </span><span id="local-6989586621690936009"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621690936009"><span class="hs-identifier hs-var">strfyNum</span></a></span></span><span> </span><span id="local-6989586621690936008"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621690936008"><span class="hs-identifier hs-var">tCase</span></a></span></span><span> </span><span id="local-6989586621690936007"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690936007"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621690936006"><span class="annot"><span class="annottext">AnnotatedUpdate ('Postgres pgKind)
</span><a href="#local-6989586621690936006"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690936005"><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621690936005"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UpdateCTE
</span><a href="#local-6989586621690936004"><span class="hs-identifier hs-var">updateCTE</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Update.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span id="local-6989586621690936002"><span class="annot"><span class="annottext">TopLevelCTE
</span><a href="#local-6989586621690936002"><span class="hs-identifier hs-var">singleUpdate</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TopLevelCTE -&gt; m EncJSON
</span><a href="#local-6989586621690936001"><span class="hs-identifier hs-var">runCTE</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelCTE
</span><a href="#local-6989586621690936002"><span class="hs-identifier hs-var">singleUpdate</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Update.html#MultiUpdate"><span class="hs-identifier hs-type">MultiUpdate</span></a></span><span> </span><span id="local-6989586621690935999"><span class="annot"><span class="annottext">[TopLevelCTE]
</span><a href="#local-6989586621690935999"><span class="hs-identifier hs-var">ctes</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[EncJSON] -&gt; EncJSON
</span><span class="hs-identifier hs-var">encJFromList</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelCTE -&gt; m EncJSON
</span><a href="#local-6989586621690936001"><span class="hs-identifier hs-var">runCTE</span></a></span><span> </span><span class="annot"><span class="annottext">[TopLevelCTE]
</span><a href="#local-6989586621690935999"><span class="hs-identifier hs-var">ctes</span></a></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><a href="#local-6989586621690936004"><span class="hs-identifier hs-type">updateCTE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Update.html#UpdateCTE"><span class="hs-identifier hs-type">UpdateCTE</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span id="local-6989586621690936004"><span class="annot"><span class="annottext">updateCTE :: UpdateCTE
</span><a href="#local-6989586621690936004"><span class="hs-identifier hs-var hs-var">updateCTE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (pgKind :: PostgresKind).
Backend ('Postgres pgKind) =&gt;
AnnotatedUpdate ('Postgres pgKind) -&gt; UpdateCTE
</span><a href="Hasura.Backends.Postgres.Translate.Update.html#mkUpdateCTE"><span class="hs-identifier hs-var">mkUpdateCTE</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedUpdate ('Postgres pgKind)
</span><a href="#local-6989586621690936006"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span>    </span><span class="annot"><a href="#local-6989586621690936001"><span class="hs-identifier hs-type">runCTE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#TopLevelCTE"><span class="hs-identifier hs-type">S.TopLevelCTE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690936532"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EncJSON</span></span><span>
</span><span id="line-134"></span><span>    </span><span id="local-6989586621690936001"><span class="annot"><span class="annottext">runCTE :: TopLevelCTE -&gt; m EncJSON
</span><a href="#local-6989586621690936001"><span class="hs-identifier hs-var hs-var">runCTE</span></a></span></span><span> </span><span id="local-6989586621690935994"><span class="annot"><span class="annottext">TopLevelCTE
</span><a href="#local-6989586621690935994"><span class="hs-identifier hs-var">cte</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-135"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresAnnotatedFieldJSON pgKind,
 MonadReader QueryTagsComment m) =&gt;
Mutation ('Postgres pgKind) -&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#runMutation"><span class="hs-identifier hs-var">runMutation</span></a></span><span>
</span><span id="line-136"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (pgKind :: PostgresKind).
UserInfo
-&gt; QualifiedTable
-&gt; (MutationCTE, Seq PrepArg)
-&gt; MutationOutput ('Postgres pgKind)
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; Mutation ('Postgres pgKind)
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mkMutation"><span class="hs-identifier hs-var">mkMutation</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690936007"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType) r v.
AnnotatedUpdateG b r v -&gt; TableName b
</span><a href="Hasura.RQL.IR.Update.html#_auTable"><span class="hs-identifier hs-var">_auTable</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedUpdate ('Postgres pgKind)
</span><a href="#local-6989586621690936006"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TopLevelCTE -&gt; MutationCTE
</span><a href="Hasura.Backends.Postgres.Translate.Returning.html#MCCheckConstraint"><span class="hs-identifier hs-var">MCCheckConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelCTE
</span><a href="#local-6989586621690935994"><span class="hs-identifier hs-var">cte</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621690936005"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType) r v.
AnnotatedUpdateG b r v -&gt; MutationOutputG b r v
</span><a href="Hasura.RQL.IR.Update.html#_auOutput"><span class="hs-identifier hs-var">_auOutput</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedUpdate ('Postgres pgKind)
</span><a href="#local-6989586621690936006"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType) r v.
AnnotatedUpdateG b r v -&gt; [ColumnInfo b]
</span><a href="Hasura.RQL.IR.Update.html#_auAllCols"><span class="hs-identifier hs-var">_auAllCols</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedUpdate ('Postgres pgKind)
</span><a href="#local-6989586621690936006"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621690936009"><span class="hs-identifier hs-var">strfyNum</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621690936008"><span class="hs-identifier hs-var">tCase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#execDeleteQuery"><span class="hs-identifier hs-type">execDeleteQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621690936501"><span class="annot"><a href="#local-6989586621690936501"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span> </span><span id="local-6989586621690936502"><span class="annot"><a href="#local-6989586621690936502"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936502"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936501"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.AnnotatedFieldJSON.html#PostgresAnnotatedFieldJSON"><span class="hs-identifier hs-type">PostgresAnnotatedFieldJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936501"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Hasura.QueryTags.html#QueryTagsComment"><span class="hs-identifier hs-type">QueryTagsComment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936502"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-145"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-146"></span><span>  </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.NamingCase.html#NamingCase"><span class="hs-identifier hs-type">NamingCase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-147"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Delete.html#AnnDel"><span class="hs-identifier hs-type">AnnDel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936501"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">DS.Seq</span></a></span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.PrepArg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-149"></span><span>  </span><span class="annot"><a href="#local-6989586621690936502"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EncJSON</span></span><span>
</span><span id="line-150"></span><span id="execDeleteQuery"><span class="annot"><span class="annottext">execDeleteQuery :: forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresAnnotatedFieldJSON pgKind,
 MonadReader QueryTagsComment m) =&gt;
StringifyNumbers
-&gt; Maybe NamingCase
-&gt; UserInfo
-&gt; (AnnDel ('Postgres pgKind), Seq PrepArg)
-&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#execDeleteQuery"><span class="hs-identifier hs-var hs-var">execDeleteQuery</span></a></span></span><span> </span><span id="local-6989586621690935980"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621690935980"><span class="hs-identifier hs-var">strfyNum</span></a></span></span><span> </span><span id="local-6989586621690935979"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621690935979"><span class="hs-identifier hs-var">tCase</span></a></span></span><span> </span><span id="local-6989586621690935978"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690935978"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621690935977"><span class="annot"><span class="annottext">AnnDel ('Postgres pgKind)
</span><a href="#local-6989586621690935977"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690935976"><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621690935976"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-151"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresAnnotatedFieldJSON pgKind,
 MonadReader QueryTagsComment m) =&gt;
Mutation ('Postgres pgKind) -&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#runMutation"><span class="hs-identifier hs-var">runMutation</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (pgKind :: PostgresKind).
UserInfo
-&gt; QualifiedTable
-&gt; (MutationCTE, Seq PrepArg)
-&gt; MutationOutput ('Postgres pgKind)
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; Mutation ('Postgres pgKind)
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mkMutation"><span class="hs-identifier hs-var">mkMutation</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690935978"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType) r v. AnnDelG b r v -&gt; TableName b
</span><a href="Hasura.RQL.IR.Delete.html#_adTable"><span class="hs-identifier hs-var">_adTable</span></a></span><span> </span><span class="annot"><span class="annottext">AnnDel ('Postgres pgKind)
</span><a href="#local-6989586621690935977"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SQLDelete -&gt; MutationCTE
</span><a href="Hasura.Backends.Postgres.Translate.Returning.html#MCDelete"><span class="hs-identifier hs-var">MCDelete</span></a></span><span> </span><span class="annot"><span class="annottext">SQLDelete
</span><a href="#local-6989586621690935973"><span class="hs-identifier hs-var">delete</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621690935976"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType) r v.
AnnDelG b r v -&gt; MutationOutputG b r v
</span><a href="Hasura.RQL.IR.Delete.html#_adOutput"><span class="hs-identifier hs-var">_adOutput</span></a></span><span> </span><span class="annot"><span class="annottext">AnnDel ('Postgres pgKind)
</span><a href="#local-6989586621690935977"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType) r v. AnnDelG b r v -&gt; [ColumnInfo b]
</span><a href="Hasura.RQL.IR.Delete.html#_adAllCols"><span class="hs-identifier hs-var">_adAllCols</span></a></span><span> </span><span class="annot"><span class="annottext">AnnDel ('Postgres pgKind)
</span><a href="#local-6989586621690935977"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621690935980"><span class="hs-identifier hs-var">strfyNum</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621690935979"><span class="hs-identifier hs-var">tCase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-154"></span><span>    </span><span id="local-6989586621690935973"><span class="annot"><span class="annottext">delete :: SQLDelete
</span><a href="#local-6989586621690935973"><span class="hs-identifier hs-var hs-var">delete</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (pgKind :: PostgresKind).
Backend ('Postgres pgKind) =&gt;
AnnDel ('Postgres pgKind) -&gt; SQLDelete
</span><a href="Hasura.Backends.Postgres.Translate.Delete.html#mkDelete"><span class="hs-identifier hs-var">mkDelete</span></a></span><span> </span><span class="annot"><span class="annottext">AnnDel ('Postgres pgKind)
</span><a href="#local-6989586621690935977"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span id="local-6989586621690936484"><span id="local-6989586621690936485"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#execInsertQuery"><span class="hs-identifier hs-type">execInsertQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936485"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-158"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936484"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-159"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.AnnotatedFieldJSON.html#PostgresAnnotatedFieldJSON"><span class="hs-identifier hs-type">PostgresAnnotatedFieldJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936484"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-160"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Hasura.QueryTags.html#QueryTagsComment"><span class="hs-identifier hs-type">QueryTagsComment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936485"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-162"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-163"></span><span>  </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.NamingCase.html#NamingCase"><span class="hs-identifier hs-type">NamingCase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-164"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#InsertQueryP1"><span class="hs-identifier hs-type">InsertQueryP1</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936484"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">DS.Seq</span></a></span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.PrepArg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-166"></span><span>  </span><span class="annot"><a href="#local-6989586621690936485"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EncJSON</span></span></span></span><span>
</span><span id="line-167"></span><span id="execInsertQuery"><span class="annot"><span class="annottext">execInsertQuery :: forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresAnnotatedFieldJSON pgKind,
 MonadReader QueryTagsComment m) =&gt;
StringifyNumbers
-&gt; Maybe NamingCase
-&gt; UserInfo
-&gt; (InsertQueryP1 ('Postgres pgKind), Seq PrepArg)
-&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#execInsertQuery"><span class="hs-identifier hs-var hs-var">execInsertQuery</span></a></span></span><span> </span><span id="local-6989586621690935960"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621690935960"><span class="hs-identifier hs-var">strfyNum</span></a></span></span><span> </span><span id="local-6989586621690935959"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621690935959"><span class="hs-identifier hs-var">tCase</span></a></span></span><span> </span><span id="local-6989586621690935958"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690935958"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621690935957"><span class="annot"><span class="annottext">InsertQueryP1 ('Postgres pgKind)
</span><a href="#local-6989586621690935957"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690935956"><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621690935956"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-168"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresAnnotatedFieldJSON pgKind,
 MonadReader QueryTagsComment m) =&gt;
Mutation ('Postgres pgKind) -&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#runMutation"><span class="hs-identifier hs-var">runMutation</span></a></span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (pgKind :: PostgresKind).
UserInfo
-&gt; QualifiedTable
-&gt; (MutationCTE, Seq PrepArg)
-&gt; MutationOutput ('Postgres pgKind)
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; Mutation ('Postgres pgKind)
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mkMutation"><span class="hs-identifier hs-var">mkMutation</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690935958"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType). InsertQueryP1 b -&gt; TableName b
</span><a href="Hasura.RQL.IR.Insert.html#iqp1Table"><span class="hs-identifier hs-var">iqp1Table</span></a></span><span> </span><span class="annot"><span class="annottext">InsertQueryP1 ('Postgres pgKind)
</span><a href="#local-6989586621690935957"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TopLevelCTE -&gt; MutationCTE
</span><a href="Hasura.Backends.Postgres.Translate.Returning.html#MCCheckConstraint"><span class="hs-identifier hs-var">MCCheckConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelCTE
</span><a href="#local-6989586621690935954"><span class="hs-identifier hs-var">insertCTE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621690935956"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType). InsertQueryP1 b -&gt; MutationOutput b
</span><a href="Hasura.RQL.IR.Insert.html#iqp1Output"><span class="hs-identifier hs-var">iqp1Output</span></a></span><span> </span><span class="annot"><span class="annottext">InsertQueryP1 ('Postgres pgKind)
</span><a href="#local-6989586621690935957"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType). InsertQueryP1 b -&gt; [ColumnInfo b]
</span><a href="Hasura.RQL.IR.Insert.html#iqp1AllCols"><span class="hs-identifier hs-var">iqp1AllCols</span></a></span><span> </span><span class="annot"><span class="annottext">InsertQueryP1 ('Postgres pgKind)
</span><a href="#local-6989586621690935957"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621690935960"><span class="hs-identifier hs-var">strfyNum</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621690935959"><span class="hs-identifier hs-var">tCase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-171"></span><span>    </span><span id="local-6989586621690935954"><span class="annot"><span class="annottext">insertCTE :: TopLevelCTE
</span><a href="#local-6989586621690935954"><span class="hs-identifier hs-var hs-var">insertCTE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (pgKind :: PostgresKind).
Backend ('Postgres pgKind) =&gt;
InsertQueryP1 ('Postgres pgKind) -&gt; TopLevelCTE
</span><a href="Hasura.Backends.Postgres.Translate.Insert.html#mkInsertCTE"><span class="hs-identifier hs-var">mkInsertCTE</span></a></span><span> </span><span class="annot"><span class="annottext">InsertQueryP1 ('Postgres pgKind)
</span><a href="#local-6989586621690935957"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">{- Note: [Prepared statements in Mutations]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The SQL statements we generate for mutations seem to include the actual values
in the statements in some cases which pretty much makes them unfit for reuse
(Handling relationships in the returning clause is the source of this
complexity). Further, `PGConn` has an internal cache which maps a statement to
a 'prepared statement id' on Postgres. As we prepare more and more single-use
SQL statements we end up leaking memory both on graphql-engine and Postgres
till the connection is closed. So a simpler but very crude fix is to not use
prepared statements for mutations. The performance of insert mutations
shouldn't be affected but updates and delete mutations with complex boolean
conditions **might** see some degradation.
-}</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mutateAndSel"><span class="hs-identifier hs-type">mutateAndSel</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621690936546"><span class="annot"><a href="#local-6989586621690936546"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span> </span><span id="local-6989586621690936547"><span class="annot"><a href="#local-6989586621690936547"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936547"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936546"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.AnnotatedFieldJSON.html#PostgresAnnotatedFieldJSON"><span class="hs-identifier hs-type">PostgresAnnotatedFieldJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936546"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Hasura.QueryTags.html#QueryTagsComment"><span class="hs-identifier hs-type">QueryTagsComment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936547"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-194"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#Mutation"><span class="hs-identifier hs-type">Mutation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936546"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-195"></span><span>  </span><span class="annot"><a href="#local-6989586621690936547"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EncJSON</span></span><span>
</span><span id="line-196"></span><span id="mutateAndSel"><span class="annot"><span class="annottext">mutateAndSel :: forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresAnnotatedFieldJSON pgKind,
 MonadReader QueryTagsComment m) =&gt;
Mutation ('Postgres pgKind) -&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mutateAndSel"><span class="hs-identifier hs-var hs-var">mutateAndSel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#Mutation"><span class="hs-identifier hs-type">Mutation</span></a></span><span> </span><span id="local-6989586621690935933"><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690935933"><span class="hs-identifier hs-var">qt</span></a></span></span><span> </span><span id="local-6989586621690935932"><span class="annot"><span class="annottext">(MutationCTE, Seq PrepArg)
</span><a href="#local-6989586621690935932"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621690935931"><span class="annot"><span class="annottext">MutationOutput ('Postgres pgKind)
</span><a href="#local-6989586621690935931"><span class="hs-identifier hs-var">mutationOutput</span></a></span></span><span> </span><span id="local-6989586621690935930"><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621690935930"><span class="hs-identifier hs-var">allCols</span></a></span></span><span> </span><span id="local-6989586621690935929"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621690935929"><span class="hs-identifier hs-var">strfyNum</span></a></span></span><span> </span><span id="local-6989586621690935928"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621690935928"><span class="hs-identifier hs-var">tCase</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-comment">-- Perform mutation and fetch unique columns</span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#MutateResp"><span class="hs-identifier hs-type">MutateResp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621690935927"><span class="annot"><span class="annottext">[ColumnValues ('Postgres pgKind) TxtEncodedVal]
</span><a href="#local-6989586621690935927"><span class="hs-identifier hs-var">columnVals</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (pgKind :: PostgresKind).
(Backend ('Postgres pgKind), PostgresAnnotatedFieldJSON pgKind) =&gt;
QualifiedTable
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; (MutationCTE, Seq PrepArg)
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; TxE QErr (MutateResp ('Postgres pgKind) TxtEncodedVal)
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mutateAndFetchCols"><span class="hs-identifier hs-var">mutateAndFetchCols</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690935933"><span class="hs-identifier hs-var">qt</span></a></span><span> </span><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621690935930"><span class="hs-identifier hs-var">allCols</span></a></span><span> </span><span class="annot"><span class="annottext">(MutationCTE, Seq PrepArg)
</span><a href="#local-6989586621690935932"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621690935929"><span class="hs-identifier hs-var">strfyNum</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621690935928"><span class="hs-identifier hs-var">tCase</span></a></span><span>
</span><span id="line-199"></span><span>  </span><span id="local-6989586621690935925"><span class="annot"><span class="annottext">Select
</span><a href="#local-6989586621690935925"><span class="hs-identifier hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (pgKind :: PostgresKind) (m :: * -&gt; *).
MonadError QErr m =&gt;
QualifiedTable
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; [ColumnValues ('Postgres pgKind) TxtEncodedVal]
-&gt; m Select
</span><a href="Hasura.Backends.Postgres.Translate.Mutation.html#mkSelectExpFromColumnValues"><span class="hs-identifier hs-var">mkSelectExpFromColumnValues</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690935933"><span class="hs-identifier hs-var">qt</span></a></span><span> </span><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621690935930"><span class="hs-identifier hs-var">allCols</span></a></span><span> </span><span class="annot"><span class="annottext">[ColumnValues ('Postgres pgKind) TxtEncodedVal]
</span><a href="#local-6989586621690935927"><span class="hs-identifier hs-var">columnVals</span></a></span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-comment">-- Perform select query and fetch returning fields</span><span>
</span><span id="line-201"></span><span>  </span><span class="annot"><span class="annottext">forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresAnnotatedFieldJSON pgKind,
 MonadReader QueryTagsComment m) =&gt;
QualifiedTable
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; Maybe Int
-&gt; MutationCTE
-&gt; MutationOutput ('Postgres pgKind)
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; [PrepArg]
-&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#executeMutationOutputQuery"><span class="hs-identifier hs-var">executeMutationOutputQuery</span></a></span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690935933"><span class="hs-identifier hs-var">qt</span></a></span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621690935930"><span class="hs-identifier hs-var">allCols</span></a></span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Select -&gt; MutationCTE
</span><a href="Hasura.Backends.Postgres.Translate.Returning.html#MCSelectValues"><span class="hs-identifier hs-var">MCSelectValues</span></a></span><span> </span><span class="annot"><span class="annottext">Select
</span><a href="#local-6989586621690935925"><span class="hs-identifier hs-var">select</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><span class="annottext">MutationOutput ('Postgres pgKind)
</span><a href="#local-6989586621690935931"><span class="hs-identifier hs-var">mutationOutput</span></a></span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621690935929"><span class="hs-identifier hs-var">strfyNum</span></a></span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621690935928"><span class="hs-identifier hs-var">tCase</span></a></span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span id="local-6989586621690936463"><span id="local-6989586621690936464"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#withCheckPermission"><span class="hs-identifier hs-type">withCheckPermission</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">QErr</span></span><span> </span><span class="annot"><a href="#local-6989586621690936464"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690936464"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621690936463"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690936464"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936463"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-212"></span><span id="withCheckPermission"><span class="annot"><span class="annottext">withCheckPermission :: forall (m :: * -&gt; *) a. MonadError QErr m =&gt; m (a, Bool) -&gt; m a
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#withCheckPermission"><span class="hs-identifier hs-var hs-var">withCheckPermission</span></a></span></span><span> </span><span id="local-6989586621690935910"><span class="annot"><span class="annottext">m (a, Bool)
</span><a href="#local-6989586621690935910"><span class="hs-identifier hs-var">sqlTx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621690935909"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690935909"><span class="hs-identifier hs-var">rawResponse</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690935908"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690935908"><span class="hs-identifier hs-var">checkConstraint</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (a, Bool)
</span><a href="#local-6989586621690935910"><span class="hs-identifier hs-var">sqlTx</span></a></span><span>
</span><span id="line-214"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690935908"><span class="hs-identifier hs-var">checkConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><span class="hs-identifier hs-var">throw400</span></span><span> </span><span class="annot"><span class="annottext">Code
</span><span class="hs-identifier hs-var">PermissionError</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-216"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;check constraint of an insert/update permission has failed&quot;</span></span><span>
</span><span id="line-217"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690935909"><span class="hs-identifier hs-var">rawResponse</span></a></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#executeMutationOutputQuery"><span class="hs-identifier hs-type">executeMutationOutputQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621690936535"><span class="annot"><a href="#local-6989586621690936535"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span> </span><span id="local-6989586621690936536"><span class="annot"><a href="#local-6989586621690936536"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936536"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936535"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.AnnotatedFieldJSON.html#PostgresAnnotatedFieldJSON"><span class="hs-identifier hs-type">PostgresAnnotatedFieldJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936535"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-224"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Hasura.QueryTags.html#QueryTagsComment"><span class="hs-identifier hs-type">QueryTagsComment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936536"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-226"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedTable"><span class="hs-identifier hs-type">QualifiedTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnInfo"><span class="hs-identifier hs-type">ColumnInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936535"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-228"></span><span>  </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-229"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Returning.html#MutationCTE"><span class="hs-identifier hs-type">MutationCTE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-230"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Returning.html#MutationOutput"><span class="hs-identifier hs-type">MutationOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936535"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-232"></span><span>  </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.NamingCase.html#NamingCase"><span class="hs-identifier hs-type">NamingCase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-comment">-- | Prepared params</span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.PrepArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><a href="#local-6989586621690936536"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EncJSON</span></span><span>
</span><span id="line-236"></span><span id="executeMutationOutputQuery"><span class="annot"><span class="annottext">executeMutationOutputQuery :: forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresAnnotatedFieldJSON pgKind,
 MonadReader QueryTagsComment m) =&gt;
QualifiedTable
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; Maybe Int
-&gt; MutationCTE
-&gt; MutationOutput ('Postgres pgKind)
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; [PrepArg]
-&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#executeMutationOutputQuery"><span class="hs-identifier hs-var hs-var">executeMutationOutputQuery</span></a></span></span><span> </span><span id="local-6989586621690935880"><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690935880"><span class="hs-identifier hs-var">qt</span></a></span></span><span> </span><span id="local-6989586621690935879"><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621690935879"><span class="hs-identifier hs-var">allCols</span></a></span></span><span> </span><span id="local-6989586621690935878"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621690935878"><span class="hs-identifier hs-var">preCalAffRows</span></a></span></span><span> </span><span id="local-6989586621690935877"><span class="annot"><span class="annottext">MutationCTE
</span><a href="#local-6989586621690935877"><span class="hs-identifier hs-var">cte</span></a></span></span><span> </span><span id="local-6989586621690935876"><span class="annot"><span class="annottext">MutationOutput ('Postgres pgKind)
</span><a href="#local-6989586621690935876"><span class="hs-identifier hs-var">mutOutput</span></a></span></span><span> </span><span id="local-6989586621690935875"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621690935875"><span class="hs-identifier hs-var">strfyNum</span></a></span></span><span> </span><span id="local-6989586621690935874"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621690935874"><span class="hs-identifier hs-var">tCase</span></a></span></span><span> </span><span id="local-6989586621690935873"><span class="annot"><span class="annottext">[PrepArg]
</span><a href="#local-6989586621690935873"><span class="hs-identifier hs-var">prepArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-237"></span><span>  </span><span id="local-6989586621690935872"><span class="annot"><span class="annottext">QueryTagsComment
</span><a href="#local-6989586621690935872"><span class="hs-identifier hs-var">queryTags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">ask</span></a></span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690936440"><span class="annot"><a href="#local-6989586621690935870"><span class="hs-identifier hs-type">queryTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.FromRes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936440"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690936536"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936440"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-239"></span><span>      </span><span id="local-6989586621690935870"><span class="annot"><span class="annottext">queryTx :: forall a. FromRes a =&gt; m a
</span><a href="#local-6989586621690935870"><span class="hs-identifier hs-var hs-var">queryTx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-240"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690935860"><span class="annot"><span class="annottext">selectWith :: SelectWith
</span><a href="#local-6989586621690935860"><span class="hs-identifier hs-var hs-var">selectWith</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (pgKind :: PostgresKind).
(Backend ('Postgres pgKind), PostgresAnnotatedFieldJSON pgKind) =&gt;
QualifiedTable
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; Maybe Int
-&gt; MutationCTE
-&gt; MutationOutput ('Postgres pgKind)
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; SelectWith
</span><a href="Hasura.Backends.Postgres.Translate.Returning.html#mkMutationOutputExp"><span class="hs-identifier hs-var">mkMutationOutputExp</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690935880"><span class="hs-identifier hs-var">qt</span></a></span><span> </span><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621690935879"><span class="hs-identifier hs-var">allCols</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621690935878"><span class="hs-identifier hs-var">preCalAffRows</span></a></span><span> </span><span class="annot"><span class="annottext">MutationCTE
</span><a href="#local-6989586621690935877"><span class="hs-identifier hs-var">cte</span></a></span><span> </span><span class="annot"><span class="annottext">MutationOutput ('Postgres pgKind)
</span><a href="#local-6989586621690935876"><span class="hs-identifier hs-var">mutOutput</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621690935875"><span class="hs-identifier hs-var">strfyNum</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621690935874"><span class="hs-identifier hs-var">tCase</span></a></span><span>
</span><span id="line-241"></span><span>            </span><span id="local-6989586621690935858"><span class="annot"><span class="annottext">query :: Query
</span><a href="#local-6989586621690935858"><span class="hs-identifier hs-var hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectWith -&gt; Query
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#toQuery"><span class="hs-identifier hs-var">toQuery</span></a></span><span> </span><span class="annot"><span class="annottext">SelectWith
</span><a href="#local-6989586621690935860"><span class="hs-identifier hs-var">selectWith</span></a></span><span>
</span><span id="line-242"></span><span>            </span><span id="local-6989586621690935857"><span class="annot"><span class="annottext">queryWithQueryTags :: Query
</span><a href="#local-6989586621690935857"><span class="hs-identifier hs-var hs-var">queryWithQueryTags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621690935858"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">getQueryText :: Text
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.getQueryText</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query -&gt; Text
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.getQueryText</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621690935858"><span class="hs-identifier hs-var">query</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QueryTagsComment -&gt; Text
</span><a href="Hasura.QueryTags.html#_unQueryTagsComment"><span class="hs-identifier hs-var">_unQueryTagsComment</span></a></span><span> </span><span class="annot"><span class="annottext">QueryTagsComment
</span><a href="#local-6989586621690935872"><span class="hs-identifier hs-var">queryTags</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-243"></span><span>        </span><span class="hs-comment">-- See Note [Prepared statements in Mutations]</span><span>
</span><span id="line-244"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a e.
(MonadIO m, FromRes a) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; [PrepArg] -&gt; Bool -&gt; TxET e m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.rawQE</span></a></span><span> </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#dmlTxErrorHandler"><span class="hs-identifier hs-var">dmlTxErrorHandler</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621690935857"><span class="hs-identifier hs-var">queryWithQueryTags</span></a></span><span> </span><span class="annot"><span class="annottext">[PrepArg]
</span><a href="#local-6989586621690935873"><span class="hs-identifier hs-var">prepArgs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">MutationCTE -&gt; Bool
</span><a href="Hasura.Backends.Postgres.Translate.Returning.html#checkPermissionRequired"><span class="hs-identifier hs-var">checkPermissionRequired</span></a></span><span> </span><span class="annot"><span class="annottext">MutationCTE
</span><a href="#local-6989586621690935877"><span class="hs-identifier hs-var">cte</span></a></span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadError QErr m =&gt; m (a, Bool) -&gt; m a
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#withCheckPermission"><span class="hs-identifier hs-var">withCheckPermission</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. SingleRow a -&gt; a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.getRow</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromRes a =&gt; m a
</span><a href="#local-6989586621690935870"><span class="hs-identifier hs-var">queryTx</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. Identity a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">runIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. SingleRow a -&gt; a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.getRow</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromRes a =&gt; m a
</span><a href="#local-6989586621690935870"><span class="hs-identifier hs-var">queryTx</span></a></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mutateAndFetchCols"><span class="hs-identifier hs-type">mutateAndFetchCols</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621690936468"><span class="annot"><a href="#local-6989586621690936468"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936468"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.AnnotatedFieldJSON.html#PostgresAnnotatedFieldJSON"><span class="hs-identifier hs-type">PostgresAnnotatedFieldJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936468"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-253"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedTable"><span class="hs-identifier hs-type">QualifiedTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnInfo"><span class="hs-identifier hs-type">ColumnInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936468"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Returning.html#MutationCTE"><span class="hs-identifier hs-type">MutationCTE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">DS.Seq</span></a></span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.PrepArg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-256"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-257"></span><span>  </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.NamingCase.html#NamingCase"><span class="hs-identifier hs-type">NamingCase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.TxE</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">QErr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#MutateResp"><span class="hs-identifier hs-type">MutateResp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936468"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.SQL.Value.html#TxtEncodedVal"><span class="hs-identifier hs-type">TxtEncodedVal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span id="mutateAndFetchCols"><span class="annot"><span class="annottext">mutateAndFetchCols :: forall (pgKind :: PostgresKind).
(Backend ('Postgres pgKind), PostgresAnnotatedFieldJSON pgKind) =&gt;
QualifiedTable
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; (MutationCTE, Seq PrepArg)
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; TxE QErr (MutateResp ('Postgres pgKind) TxtEncodedVal)
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mutateAndFetchCols"><span class="hs-identifier hs-var hs-var">mutateAndFetchCols</span></a></span></span><span> </span><span id="local-6989586621690935804"><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690935804"><span class="hs-identifier hs-var">qt</span></a></span></span><span> </span><span id="local-6989586621690935803"><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621690935803"><span class="hs-identifier hs-var">cols</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621690935802"><span class="annot"><span class="annottext">MutationCTE
</span><a href="#local-6989586621690935802"><span class="hs-identifier hs-var">cte</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690935801"><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621690935801"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621690935800"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621690935800"><span class="hs-identifier hs-var">strfyNum</span></a></span></span><span> </span><span id="local-6989586621690935799"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621690935799"><span class="hs-identifier hs-var">tCase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690936404"><span class="annot"><a href="#local-6989586621690935798"><span class="hs-identifier hs-type">mutationTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.FromRes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936404"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.TxE</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">QErr</span></span><span> </span><span class="annot"><a href="#local-6989586621690936404"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-261"></span><span>      </span><span id="local-6989586621690935798"><span class="annot"><span class="annottext">mutationTx :: forall a. FromRes a =&gt; TxE QErr a
</span><a href="#local-6989586621690935798"><span class="hs-identifier hs-var hs-var">mutationTx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-262"></span><span>        </span><span class="hs-comment">-- See Note [Prepared statements in Mutations]</span><span>
</span><span id="line-263"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a e.
(MonadIO m, FromRes a) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; [PrepArg] -&gt; Bool -&gt; TxET e m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.rawQE</span></a></span><span> </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#dmlTxErrorHandler"><span class="hs-identifier hs-var">dmlTxErrorHandler</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621690935793"><span class="hs-identifier hs-var">sqlText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621690935801"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">MutationCTE -&gt; Bool
</span><a href="Hasura.Backends.Postgres.Translate.Returning.html#checkPermissionRequired"><span class="hs-identifier hs-var">checkPermissionRequired</span></a></span><span> </span><span class="annot"><span class="annottext">MutationCTE
</span><a href="#local-6989586621690935802"><span class="hs-identifier hs-var">cte</span></a></span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadError QErr m =&gt; m (a, Bool) -&gt; m a
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#withCheckPermission"><span class="hs-identifier hs-var">withCheckPermission</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. ViaJSON a -&gt; a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.getViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. SingleRow a -&gt; a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.getRow</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromRes a =&gt; TxE QErr a
</span><a href="#local-6989586621690935798"><span class="hs-identifier hs-var">mutationTx</span></a></span><span>
</span><span id="line-267"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. ViaJSON a -&gt; a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.getViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Identity a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">runIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. SingleRow a -&gt; a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.getRow</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromRes a =&gt; TxE QErr a
</span><a href="#local-6989586621690935798"><span class="hs-identifier hs-var">mutationTx</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-269"></span><span>    </span><span id="local-6989586621690935791"><span class="annot"><span class="annottext">rawAlias :: TableAlias
</span><a href="#local-6989586621690935791"><span class="hs-identifier hs-var hs-var">rawAlias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; TableAlias
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#mkTableAlias"><span class="hs-identifier hs-var">S.mkTableAlias</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;mutres__&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. ToTxt a =&gt; QualifiedObject a -&gt; Text
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#qualifiedObjectToText"><span class="hs-identifier hs-var">qualifiedObjectToText</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690935804"><span class="hs-identifier hs-var">qt</span></a></span><span>
</span><span id="line-270"></span><span>    </span><span id="local-6989586621690935788"><span class="annot"><span class="annottext">rawIdentifier :: TableIdentifier
</span><a href="#local-6989586621690935788"><span class="hs-identifier hs-var hs-var">rawIdentifier</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TableAlias -&gt; TableIdentifier
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#tableAliasToIdentifier"><span class="hs-identifier hs-var">S.tableAliasToIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">TableAlias
</span><a href="#local-6989586621690935791"><span class="hs-identifier hs-var">rawAlias</span></a></span><span>
</span><span id="line-271"></span><span>    </span><span id="local-6989586621690935786"><span class="annot"><span class="annottext">tabFrom :: SelectFromG ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621690935786"><span class="hs-identifier hs-var hs-var">tabFrom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) v. FIIdentifier -&gt; SelectFromG b v
</span><a href="Hasura.RQL.IR.Select.From.html#FromIdentifier"><span class="hs-identifier hs-var">FromIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; FIIdentifier
</span><a href="Hasura.RQL.IR.Select.From.html#FIIdentifier"><span class="hs-identifier hs-var">FIIdentifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableIdentifier -&gt; Text
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#unTableIdentifier"><span class="hs-identifier hs-var">unTableIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621690935788"><span class="hs-identifier hs-var">rawIdentifier</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>    </span><span id="local-6989586621690935782"><span class="annot"><span class="annottext">tabPerm :: TablePermG b v
</span><a href="#local-6989586621690935782"><span class="hs-identifier hs-var hs-var">tabPerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) v.
AnnBoolExp b v -&gt; Maybe Int -&gt; TablePermG b v
</span><a href="Hasura.RQL.IR.Select.TablePerm.html#TablePerm"><span class="hs-identifier hs-var">TablePerm</span></a></span><span> </span><span class="annot"><span class="annottext">forall (backend :: BackendType) scalar. AnnBoolExp backend scalar
</span><a href="Hasura.RQL.IR.BoolExp.html#annBoolExpTrue"><span class="hs-identifier hs-var">annBoolExpTrue</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-273"></span><span>    </span><span id="local-6989586621690935779"><span class="annot"><span class="annottext">selFlds :: [(FieldName, AnnFieldG ('Postgres pgKind) Void SQLExp)]
</span><a href="#local-6989586621690935779"><span class="hs-identifier hs-var hs-var">selFlds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621690935803"><span class="hs-identifier hs-var">cols</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-274"></span><span>      </span><span class="hs-glyph">\</span><span id="local-6989586621690935777"><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind)
</span><a href="#local-6989586621690935777"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType). Backend b =&gt; Column b -&gt; FieldName
</span><a href="Hasura.RQL.Types.Column.html#fromCol"><span class="hs-identifier hs-var">fromCol</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690936468"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType). ColumnInfo b -&gt; Column b
</span><a href="Hasura.RQL.Types.Column.html#ciColumn"><span class="hs-identifier hs-var">ciColumn</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind)
</span><a href="#local-6989586621690935777"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (backend :: BackendType) r v.
ColumnInfo backend -&gt; AnnFieldG backend r v
</span><a href="Hasura.RQL.IR.Select.html#mkAnnColumnFieldAsText"><span class="hs-identifier hs-var">mkAnnColumnFieldAsText</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind)
</span><a href="#local-6989586621690935777"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621690935793"><span class="annot"><span class="annottext">sqlText :: Query
</span><a href="#local-6989586621690935793"><span class="hs-identifier hs-var hs-var">sqlText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectWith -&gt; Query
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#toQuery"><span class="hs-identifier hs-var">toQuery</span></a></span><span> </span><span class="annot"><span class="annottext">SelectWith
</span><a href="#local-6989586621690935773"><span class="hs-identifier hs-var">selectWith</span></a></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span>    </span><span id="local-6989586621690935772"><span class="annot"><span class="annottext">select :: Select
</span><a href="#local-6989586621690935772"><span class="hs-identifier hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-279"></span><span>      </span><span class="annot"><span class="annottext">Select
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#mkSelect"><span class="hs-identifier hs-var">S.mkSelect</span></a></span><span>
</span><span id="line-280"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">selExtr :: [Extractor]
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#selExtr"><span class="hs-identifier hs-var">S.selExtr</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-281"></span><span>            </span><span class="annot"><span class="annottext">SQLExp -&gt; Maybe ColumnAlias -&gt; Extractor
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#Extractor"><span class="hs-identifier hs-var">S.Extractor</span></a></span><span> </span><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621690935768"><span class="hs-identifier hs-var">extrExp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-282"></span><span>              </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a -&gt; Bool -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">bool</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SQLExp -&gt; Maybe ColumnAlias -&gt; Extractor
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#Extractor"><span class="hs-identifier hs-var">S.Extractor</span></a></span><span> </span><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621690935767"><span class="hs-identifier hs-var">checkErrExp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MutationCTE -&gt; Bool
</span><a href="Hasura.Backends.Postgres.Translate.Returning.html#checkPermissionRequired"><span class="hs-identifier hs-var">checkPermissionRequired</span></a></span><span> </span><span class="annot"><span class="annottext">MutationCTE
</span><a href="#local-6989586621690935802"><span class="hs-identifier hs-var">cte</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span>    </span><span id="local-6989586621690935773"><span class="annot"><span class="annottext">selectWith :: SelectWith
</span><a href="#local-6989586621690935773"><span class="hs-identifier hs-var hs-var">selectWith</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-286"></span><span>      </span><span class="annot"><span class="annottext">forall statement.
[(TableAlias, statement)] -&gt; Select -&gt; SelectWithG statement
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SelectWith"><span class="hs-identifier hs-var">S.SelectWith</span></a></span><span>
</span><span id="line-287"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableAlias
</span><a href="#local-6989586621690935791"><span class="hs-identifier hs-var">rawAlias</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MutationCTE -&gt; TopLevelCTE
</span><a href="Hasura.Backends.Postgres.Translate.Returning.html#getMutationCTE"><span class="hs-identifier hs-var">getMutationCTE</span></a></span><span> </span><span class="annot"><span class="annottext">MutationCTE
</span><a href="#local-6989586621690935802"><span class="hs-identifier hs-var">cte</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-288"></span><span>            </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CustomSQLCTEs -&gt; [(TableAlias, TopLevelCTE)]
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#customSQLToTopLevelCTEs"><span class="hs-identifier hs-var">customSQLToTopLevelCTEs</span></a></span><span> </span><span class="annot"><span class="annottext">CustomSQLCTEs
</span><a href="#local-6989586621690935764"><span class="hs-identifier hs-var">customSQLCTEs</span></a></span><span>
</span><span id="line-289"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>        </span><span class="annot"><span class="annottext">Select
</span><a href="#local-6989586621690935772"><span class="hs-identifier hs-var">select</span></a></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span>    </span><span id="local-6989586621690935767"><span class="annot"><span class="annottext">checkErrExp :: SQLExp
</span><a href="#local-6989586621690935767"><span class="hs-identifier hs-var hs-var">checkErrExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TableIdentifier -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.Translate.Returning.html#mkCheckErrorExp"><span class="hs-identifier hs-var">mkCheckErrorExp</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621690935788"><span class="hs-identifier hs-var">rawIdentifier</span></a></span><span>
</span><span id="line-293"></span><span>    </span><span id="local-6989586621690935768"><span class="annot"><span class="annottext">extrExp :: SQLExp
</span><a href="#local-6989586621690935768"><span class="hs-identifier hs-var hs-var">extrExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-294"></span><span>      </span><span class="annot"><span class="annottext">[SQLExp] -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#applyJsonBuildObj"><span class="hs-identifier hs-var">S.applyJsonBuildObj</span></a></span><span>
</span><span id="line-295"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SELit"><span class="hs-identifier hs-var">S.SELit</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;affected_rows&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-296"></span><span>          </span><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621690935760"><span class="hs-identifier hs-var">affRowsSel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-297"></span><span>          </span><span class="annot"><span class="annottext">Text -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SELit"><span class="hs-identifier hs-var">S.SELit</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;returning_columns&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-298"></span><span>          </span><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621690935759"><span class="hs-identifier hs-var">colSel</span></a></span><span>
</span><span id="line-299"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span>    </span><span id="local-6989586621690935760"><span class="annot"><span class="annottext">affRowsSel :: SQLExp
</span><a href="#local-6989586621690935760"><span class="hs-identifier hs-var hs-var">affRowsSel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-302"></span><span>      </span><span class="annot"><span class="annottext">Select -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SESelect"><span class="hs-identifier hs-var">S.SESelect</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-303"></span><span>        </span><span class="annot"><span class="annottext">Select
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#mkSelect"><span class="hs-identifier hs-var">S.mkSelect</span></a></span><span>
</span><span id="line-304"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">selExtr :: [Extractor]
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#selExtr"><span class="hs-identifier hs-var">S.selExtr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SQLExp -&gt; Maybe ColumnAlias -&gt; Extractor
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#Extractor"><span class="hs-identifier hs-var">S.Extractor</span></a></span><span> </span><span class="annot"><span class="annottext">SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#countStar"><span class="hs-identifier hs-var">S.countStar</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-305"></span><span>            </span><span class="annot"><span class="annottext">selFrom :: Maybe FromExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#selFrom"><span class="hs-identifier hs-var">S.selFrom</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[FromItem] -&gt; FromExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#FromExp"><span class="hs-identifier hs-var">S.FromExp</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TableIdentifier -&gt; FromItem
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#FIIdentifier"><span class="hs-identifier hs-var">S.FIIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621690935788"><span class="hs-identifier hs-var">rawIdentifier</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-306"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621690935759"><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621690935759"><span class="hs-identifier hs-var">colSel</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690935764"><span class="annot"><span class="annottext">CustomSQLCTEs
</span><a href="#local-6989586621690935764"><span class="hs-identifier hs-var">customSQLCTEs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-309"></span><span>      </span><span class="annot"><span class="annottext">forall w a. Writer w a -&gt; (a, w)
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runWriter</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-310"></span><span>        </span><span class="annot"><span class="annottext">Select -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SESelect"><span class="hs-identifier hs-var">S.SESelect</span></a></span><span>
</span><span id="line-311"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(Backend ('Postgres pgKind), PostgresAnnotatedFieldJSON pgKind,
 MonadWriter CustomSQLCTEs m) =&gt;
JsonAggSelect -&gt; AnnSimpleSelect ('Postgres pgKind) -&gt; m Select
</span><a href="Hasura.Backends.Postgres.Translate.Select.Simple.html#mkSQLSelect"><span class="hs-identifier hs-var">mkSQLSelect</span></a></span><span>
</span><span id="line-312"></span><span>            </span><span class="annot"><span class="annottext">JsonAggSelect
</span><a href="Hasura.RQL.Types.Common.html#JASMultipleRows"><span class="hs-identifier hs-var">JASMultipleRows</span></a></span><span>
</span><span id="line-313"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) (f :: * -&gt; *) v.
Fields (f v)
-&gt; SelectFromG b v
-&gt; TablePermG b v
-&gt; SelectArgsG b v
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; AnnSelectG b f v
</span><a href="Hasura.RQL.IR.Select.AnnSelectG.html#AnnSelectG"><span class="hs-identifier hs-var">AnnSelectG</span></a></span><span> </span><span class="annot"><span class="annottext">[(FieldName, AnnFieldG ('Postgres pgKind) Void SQLExp)]
</span><a href="#local-6989586621690935779"><span class="hs-identifier hs-var">selFlds</span></a></span><span> </span><span class="annot"><span class="annottext">SelectFromG ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621690935786"><span class="hs-identifier hs-var">tabFrom</span></a></span><span> </span><span class="annot"><span class="annottext">forall {b :: BackendType} {v}. TablePermG b v
</span><a href="#local-6989586621690935782"><span class="hs-identifier hs-var">tabPerm</span></a></span><span> </span><span class="annot"><span class="annottext">forall (backend :: BackendType) v. SelectArgsG backend v
</span><a href="Hasura.RQL.IR.Select.Args.html#noSelectArgs"><span class="hs-identifier hs-var">noSelectArgs</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621690935800"><span class="hs-identifier hs-var">strfyNum</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621690935799"><span class="hs-identifier hs-var">tCase</span></a></span><span>
</span><span id="line-314"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-315"></span></pre></body></html>