<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | Warnings for metadata APIs</span><span>
</span><span id="line-2"></span><span class="hs-comment">--</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- This module provides a mechanism for metadata APIs to emit warnings. An example use of @MonadWarnings@ to emit</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- warnings with success message is given below:</span><span>
</span><span id="line-5"></span><span class="hs-comment">--</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- &gt; import Hasura.RQL.DDL.Warnings</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- &gt; someMetadataAPIHandler :: args -&gt; m EncJSON</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- &gt; someMetadataAPIHandler args = successMsgWithWarnings $ do</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- &gt;   -- do some stuff</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- &gt;   let warning = MetadataWarning (MOSource defaultSource) &quot;some warning message&quot;</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- &gt;   warn $ warning</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- &gt;   -- do some more stuff</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- &gt;   pure ()</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hasura.RQL.DDL.Warnings</span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#AllowWarnings"><span class="hs-identifier">AllowWarnings</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#MetadataWarning"><span class="hs-identifier">MetadataWarning</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#MetadataWarnings"><span class="hs-identifier">MetadataWarnings</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#MonadWarnings"><span class="hs-identifier">MonadWarnings</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#runMetadataWarnings"><span class="hs-identifier">runMetadataWarnings</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#mkSuccessResponseWithWarnings"><span class="hs-identifier">mkSuccessResponseWithWarnings</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#successMsgWithWarnings"><span class="hs-identifier">successMsgWithWarnings</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">where</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">FromJSON</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ToJSON</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Aeson</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Aeson.Extended.html"><span class="hs-identifier">Data.Aeson.Extended</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(.=)</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier">Data.Sequence</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Seq</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.EncJSON.html"><span class="hs-identifier">Hasura.EncJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.EncJSON.html#EncJSON"><span class="hs-identifier">EncJSON</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.EncJSON.html#encJFromJValue"><span class="hs-identifier">encJFromJValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier">Hasura.Prelude</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.Object.html"><span class="hs-identifier">Hasura.RQL.Types.Metadata.Object</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-comment">{- Note [Warnings in metadata API]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The metadata API handlers return EncJSON, which is just a Bytestring Builder. Now, in order to add warnings to the API
response, we cannot use the `runMetadataWarnings` at the top level (i.e. in `runMetadataQueryM`) as appending something
to the EncJSON will require us to parse the JSON and then re-serialize it. This is wasteful and we should avoid it.

As a result, we are using the `MonadWarnings` class to add warnings at the API handler level, i.e., the API handler will
use the runMetadataWarnings function to run the handler and get the warnings. Then, the API handler will use the warnings
to construct the response.

We can however avoid this by changing the return type of the metadata API handlers to something like:

&gt; data MetadataAPIOutput =
&gt;     RawOutput EncJSON
&gt;   | SuccessWithWarnings MetadataWarnings
&gt;   | InconsistentMetadataWithWarnings MetadataWarnings

This will allow us to cater to the metadata APIs:
- That contacts some external service and passes the raw response (like the export_metadata API).
- That returns a success message with warnings (like the replace_metadata v1 API).
- That returns inconsistent metadata with warnings (like the replace_metadata v2 API).

Also, we can expand the scope of `MetadataAPIOutput` to include other types of responses as well in the future.
-}</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-comment">-- | Allow/Disallow metadata warnings</span><span>
</span><span id="line-61"></span><span class="hs-keyword">data</span><span> </span><span id="AllowWarnings"><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#AllowWarnings"><span class="hs-identifier hs-var">AllowWarnings</span></a></span></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="AllowWarnings"><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#AllowWarnings"><span class="hs-identifier hs-var">AllowWarnings</span></a></span></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NoAllowWarnings"><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#NoAllowWarnings"><span class="hs-identifier hs-var">NoAllowWarnings</span></a></span></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621690820297"><span id="local-6989586621690820299"><span id="local-6989586621690820301"><span class="annot"><span class="annottext">Int -&gt; AllowWarnings -&gt; ShowS
[AllowWarnings] -&gt; ShowS
AllowWarnings -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [AllowWarnings] -&gt; ShowS
$cshowList :: [AllowWarnings] -&gt; ShowS
show :: AllowWarnings -&gt; String
$cshow :: AllowWarnings -&gt; String
showsPrec :: Int -&gt; AllowWarnings -&gt; ShowS
$cshowsPrec :: Int -&gt; AllowWarnings -&gt; ShowS
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690820292"><span id="local-6989586621690820294"><span class="annot"><span class="annottext">AllowWarnings -&gt; AllowWarnings -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: AllowWarnings -&gt; AllowWarnings -&gt; Bool
$c/= :: AllowWarnings -&gt; AllowWarnings -&gt; Bool
== :: AllowWarnings -&gt; AllowWarnings -&gt; Bool
$c== :: AllowWarnings -&gt; AllowWarnings -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621690820288"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#AllowWarnings"><span class="hs-identifier hs-type">AllowWarnings</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-67"></span><span>  </span><span id="local-6989586621690820284"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser AllowWarnings
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><span class="annottext">forall a. String -&gt; (Bool -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">Aeson.withBool</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;AllowWarnings&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-69"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a -&gt; Bool -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">bool</span></a></span><span> </span><span class="annot"><span class="annottext">AllowWarnings
</span><a href="Hasura.RQL.DDL.Warnings.html#NoAllowWarnings"><span class="hs-identifier hs-var">NoAllowWarnings</span></a></span><span> </span><span class="annot"><span class="annottext">AllowWarnings
</span><a href="Hasura.RQL.DDL.Warnings.html#AllowWarnings"><span class="hs-identifier hs-var">AllowWarnings</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621690820273"><span id="local-6989586621690820275"><span id="local-6989586621690820277"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#AllowWarnings"><span class="hs-identifier hs-type">AllowWarnings</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-72"></span><span>  </span><span id="local-6989586621690820269"><span class="annot"><span class="annottext">toJSON :: AllowWarnings -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">Aeson.toJSON</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">AllowWarnings -&gt; Bool
</span><a href="#local-6989586621690820267"><span class="hs-identifier hs-var">toBool</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-74"></span><span>      </span><span id="local-6989586621690820267"><span class="annot"><span class="annottext">toBool :: AllowWarnings -&gt; Bool
</span><a href="#local-6989586621690820267"><span class="hs-identifier hs-var hs-var">toBool</span></a></span></span><span> </span><span class="annot"><span class="annottext">AllowWarnings
</span><a href="Hasura.RQL.DDL.Warnings.html#AllowWarnings"><span class="hs-identifier hs-var">AllowWarnings</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-75"></span><span>      </span><span class="annot"><a href="#local-6989586621690820267"><span class="hs-identifier hs-var">toBool</span></a></span><span> </span><span class="annot"><span class="annottext">AllowWarnings
</span><a href="Hasura.RQL.DDL.Warnings.html#NoAllowWarnings"><span class="hs-identifier hs-var">NoAllowWarnings</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-keyword">data</span><span> </span><span id="MetadataWarning"><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#MetadataWarning"><span class="hs-identifier hs-var">MetadataWarning</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MetadataWarning"><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#MetadataWarning"><span class="hs-identifier hs-var">MetadataWarning</span></a></span></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_mwMetadataObj"><span class="annot"><span class="annottext">MetadataWarning -&gt; MetadataObjId
</span><a href="Hasura.RQL.DDL.Warnings.html#_mwMetadataObj"><span class="hs-identifier hs-var hs-var">_mwMetadataObj</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.Object.html#MetadataObjId"><span class="hs-identifier hs-type">MetadataObjId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-79"></span><span>    </span><span id="_mwMessage"><span class="annot"><span class="annottext">MetadataWarning -&gt; Text
</span><a href="Hasura.RQL.DDL.Warnings.html#_mwMessage"><span class="hs-identifier hs-var hs-var">_mwMessage</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621690820256"><span id="local-6989586621690820262"><span class="annot"><span class="annottext">MetadataWarning -&gt; MetadataWarning -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: MetadataWarning -&gt; MetadataWarning -&gt; Bool
$c/= :: MetadataWarning -&gt; MetadataWarning -&gt; Bool
== :: MetadataWarning -&gt; MetadataWarning -&gt; Bool
$c== :: MetadataWarning -&gt; MetadataWarning -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690820231"><span id="local-6989586621690820233"><span id="local-6989586621690820236"><span id="local-6989586621690820239"><span id="local-6989586621690820242"><span id="local-6989586621690820246"><span id="local-6989586621690820252"><span class="annot"><span class="annottext">Eq MetadataWarning
MetadataWarning -&gt; MetadataWarning -&gt; Bool
MetadataWarning -&gt; MetadataWarning -&gt; Ordering
MetadataWarning -&gt; MetadataWarning -&gt; MetadataWarning
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: MetadataWarning -&gt; MetadataWarning -&gt; MetadataWarning
$cmin :: MetadataWarning -&gt; MetadataWarning -&gt; MetadataWarning
max :: MetadataWarning -&gt; MetadataWarning -&gt; MetadataWarning
$cmax :: MetadataWarning -&gt; MetadataWarning -&gt; MetadataWarning
&gt;= :: MetadataWarning -&gt; MetadataWarning -&gt; Bool
$c&gt;= :: MetadataWarning -&gt; MetadataWarning -&gt; Bool
&gt; :: MetadataWarning -&gt; MetadataWarning -&gt; Bool
$c&gt; :: MetadataWarning -&gt; MetadataWarning -&gt; Bool
&lt;= :: MetadataWarning -&gt; MetadataWarning -&gt; Bool
$c&lt;= :: MetadataWarning -&gt; MetadataWarning -&gt; Bool
&lt; :: MetadataWarning -&gt; MetadataWarning -&gt; Bool
$c&lt; :: MetadataWarning -&gt; MetadataWarning -&gt; Bool
compare :: MetadataWarning -&gt; MetadataWarning -&gt; Ordering
$ccompare :: MetadataWarning -&gt; MetadataWarning -&gt; Ordering
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621690820223"><span id="local-6989586621690820225"><span id="local-6989586621690820227"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#MetadataWarning"><span class="hs-identifier hs-type">MetadataWarning</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-84"></span><span>  </span><span id="local-6989586621690820213"><span class="annot"><span class="annottext">toJSON :: MetadataWarning -&gt; Value
</span><a href="#local-6989586621690820213"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#MetadataWarning"><span class="hs-identifier hs-type">MetadataWarning</span></a></span><span> </span><span id="local-6989586621690820212"><span class="annot"><span class="annottext">MetadataObjId
</span><a href="#local-6989586621690820212"><span class="hs-identifier hs-var">mObj</span></a></span></span><span> </span><span id="local-6989586621690820211"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690820211"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">Aeson.object</span></span><span>
</span><span id="line-86"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;message&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690820211"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-87"></span><span>        </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;type&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">MetadataObjId -&gt; Text
</span><a href="Hasura.RQL.Types.Metadata.Object.html#moiTypeName"><span class="hs-identifier hs-var">moiTypeName</span></a></span><span> </span><span class="annot"><span class="annottext">MetadataObjId
</span><a href="#local-6989586621690820212"><span class="hs-identifier hs-var">mObj</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-88"></span><span>        </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;name&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">MetadataObjId -&gt; Text
</span><a href="Hasura.RQL.Types.Metadata.Object.html#moiName"><span class="hs-identifier hs-var">moiName</span></a></span><span> </span><span class="annot"><span class="annottext">MetadataObjId
</span><a href="#local-6989586621690820212"><span class="hs-identifier hs-var">mObj</span></a></span><span>
</span><span id="line-89"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-keyword">type</span><span> </span><span id="MetadataWarnings"><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#MetadataWarnings"><span class="hs-identifier hs-var">MetadataWarnings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Seq</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#MetadataWarning"><span class="hs-identifier hs-type">MetadataWarning</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690820381"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="MonadWarnings"><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#MonadWarnings"><span class="hs-identifier hs-var">MonadWarnings</span></a></span></span><span> </span><span id="local-6989586621690820381"><span class="annot"><a href="#local-6989586621690820381"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-comment">-- | Add a warning to the current context</span><span>
</span><span id="line-95"></span><span>  </span><span id="warn"><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#warn"><span class="hs-identifier hs-type">warn</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#MetadataWarning"><span class="hs-identifier hs-type">MetadataWarning</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690820381"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621690820375"><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690820375"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#MonadWarnings"><span class="hs-identifier hs-type">MonadWarnings</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#MetadataWarnings"><span class="hs-identifier hs-type">MetadataWarnings</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621690820375"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-98"></span><span>  </span><span id="local-6989586621690820196"><span class="annot"><span class="annottext">warn :: MetadataWarning -&gt; StateT MetadataWarnings m ()
</span><a href="#local-6989586621690820196"><span class="hs-identifier hs-var hs-var hs-var hs-var">warn</span></a></span></span><span> </span><span id="local-6989586621690820195"><span class="annot"><span class="annottext">MetadataWarning
</span><a href="#local-6989586621690820195"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MetadataWarning
</span><a href="#local-6989586621690820195"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Seq a -&gt; Seq a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/containers-0.6.5.1/src"><span class="hs-operator hs-var">Seq.:&lt;|</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span id="local-6989586621690820367"><span id="local-6989586621690820368"><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#runMetadataWarnings"><span class="hs-identifier hs-type">runMetadataWarnings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#MetadataWarnings"><span class="hs-identifier hs-type">MetadataWarnings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690820368"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690820367"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690820368"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621690820367"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#MetadataWarnings"><span class="hs-identifier hs-type">MetadataWarnings</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-101"></span><span id="runMetadataWarnings"><span class="annot"><span class="annottext">runMetadataWarnings :: forall (m :: * -&gt; *) a.
StateT MetadataWarnings m a -&gt; m (a, MetadataWarnings)
</span><a href="Hasura.RQL.DDL.Warnings.html#runMetadataWarnings"><span class="hs-identifier hs-var hs-var">runMetadataWarnings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#mkSuccessResponseWithWarnings"><span class="hs-identifier hs-type">mkSuccessResponseWithWarnings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#MetadataWarnings"><span class="hs-identifier hs-type">MetadataWarnings</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span><span>
</span><span id="line-104"></span><span id="mkSuccessResponseWithWarnings"><span class="annot"><span class="annottext">mkSuccessResponseWithWarnings :: MetadataWarnings -&gt; EncJSON
</span><a href="Hasura.RQL.DDL.Warnings.html#mkSuccessResponseWithWarnings"><span class="hs-identifier hs-var hs-var">mkSuccessResponseWithWarnings</span></a></span></span><span> </span><span id="local-6989586621690820188"><span class="annot"><span class="annottext">MetadataWarnings
</span><a href="#local-6989586621690820188"><span class="hs-identifier hs-var">warnings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-105"></span><span>  </span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; EncJSON
</span><a href="Hasura.EncJSON.html#encJFromJValue"><span class="hs-identifier hs-var">encJFromJValue</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">Aeson.object</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;message&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;success&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-108"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;warnings&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">MetadataWarnings
</span><a href="#local-6989586621690820188"><span class="hs-identifier hs-var">warnings</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">MetadataWarnings
</span><a href="#local-6989586621690820188"><span class="hs-identifier hs-var">warnings</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span id="local-6989586621690820353"><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#successMsgWithWarnings"><span class="hs-identifier hs-type">successMsgWithWarnings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690820353"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Warnings.html#MetadataWarnings"><span class="hs-identifier hs-type">MetadataWarnings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690820353"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690820353"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span></span><span>
</span><span id="line-111"></span><span id="successMsgWithWarnings"><span class="annot"><span class="annottext">successMsgWithWarnings :: forall (m :: * -&gt; *).
Monad m =&gt;
StateT MetadataWarnings m () -&gt; m EncJSON
</span><a href="Hasura.RQL.DDL.Warnings.html#successMsgWithWarnings"><span class="hs-identifier hs-var hs-var">successMsgWithWarnings</span></a></span></span><span> </span><span id="local-6989586621690820180"><span class="annot"><span class="annottext">StateT MetadataWarnings m ()
</span><a href="#local-6989586621690820180"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690820179"><span class="annot"><span class="annottext">MetadataWarnings
</span><a href="#local-6989586621690820179"><span class="hs-identifier hs-var">warnings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
StateT MetadataWarnings m a -&gt; m (a, MetadataWarnings)
</span><a href="Hasura.RQL.DDL.Warnings.html#runMetadataWarnings"><span class="hs-identifier hs-var">runMetadataWarnings</span></a></span><span> </span><span class="annot"><span class="annottext">StateT MetadataWarnings m ()
</span><a href="#local-6989586621690820180"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MetadataWarnings -&gt; EncJSON
</span><a href="Hasura.RQL.DDL.Warnings.html#mkSuccessResponseWithWarnings"><span class="hs-identifier hs-var">mkSuccessResponseWithWarnings</span></a></span><span> </span><span class="annot"><span class="annottext">MetadataWarnings
</span><a href="#local-6989586621690820179"><span class="hs-identifier hs-var">warnings</span></a></span><span>
</span><span id="line-114"></span></pre></body></html>