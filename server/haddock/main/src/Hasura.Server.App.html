<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hasura.Server.App</span><span>
</span><span id="line-5"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#APIResp"><span class="hs-identifier">APIResp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.App.html#JSONResp"><span class="hs-identifier">JSONResp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#RawResp"><span class="hs-identifier">RawResp</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#ConsoleRenderer"><span class="hs-identifier">ConsoleRenderer</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#MonadVersionAPIWithExtraData"><span class="hs-identifier">MonadVersionAPIWithExtraData</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#Handler"><span class="hs-identifier">Handler</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#HandlerCtx"><span class="hs-identifier">HandlerCtx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.App.html#hcReqHeaders"><span class="hs-identifier">hcReqHeaders</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#hcAppContext"><span class="hs-identifier">hcAppContext</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#hcAppEnv"><span class="hs-identifier">hcAppEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#hcUser"><span class="hs-identifier">hcUser</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#HasuraApp"><span class="hs-identifier">HasuraApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.App.html#HasuraApp"><span class="hs-identifier">HasuraApp</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Hasura.App.State.html#Loggers"><span class="hs-identifier">Loggers</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#MonadConfigApiHandler"><span class="hs-identifier">MonadConfigApiHandler</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#MonadMetadataApiAuthorization"><span class="hs-identifier">MonadMetadataApiAuthorization</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier">AppContext</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#boolToText"><span class="hs-identifier">boolToText</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#configApiGetHandler"><span class="hs-identifier">configApiGetHandler</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#isAdminSecretSet"><span class="hs-identifier">isAdminSecretSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#mkGetHandler"><span class="hs-identifier">mkGetHandler</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#mkSpockAction"><span class="hs-identifier">mkSpockAction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#mkWaiApp"><span class="hs-identifier">mkWaiApp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#onlyAdmin"><span class="hs-identifier">onlyAdmin</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#renderHtmlTemplate"><span class="hs-identifier">renderHtmlTemplate</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">where</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Concurrent.Async.Lifted.Safe</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LA</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Control.Exception</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">IOException</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">try</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Control.Monad.Stateless.html"><span class="hs-identifier">Control.Monad.Stateless</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Control</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadBaseControl</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Control</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MTC</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">json</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">J</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.Key</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">K</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.KeyMap</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">KM</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.Types</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">J</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier">Data.ByteString.Builder</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BB</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier">Data.ByteString.Char8</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B8</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BL</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.CaseInsensitive</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CI</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashSet</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.String</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">fromString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Conversions</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">convertText</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Text.Extended.html"><span class="hs-identifier">Data.Text.Extended</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Lazy</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LT</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Lazy.Encoding</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TL</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Stats.Extended.html"><span class="hs-identifier">GHC.Stats.Extended</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">RTS</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.App.State.html"><span class="hs-identifier">Hasura.App.State</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/dc-api-1.0.0/opt/doc/html/dc-api/src"><span class="hs-identifier">Hasura.Backends.DataConnector.API</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/dc-api-1.0.0/opt/doc/html/dc-api/src"><span class="hs-identifier">openApiSchema</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Types.html"><span class="hs-identifier">Hasura.Backends.Postgres.Execute.Types</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Base.Error.html"><span class="hs-identifier">Hasura.Base.Error</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.EncJSON.html"><span class="hs-identifier">Hasura.EncJSON</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.html"><span class="hs-identifier">Hasura.GraphQL.Execute</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">E</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.Backend.html"><span class="hs-identifier">Hasura.GraphQL.Execute.Backend</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">EB</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.Subscription.State.html"><span class="hs-identifier">Hasura.GraphQL.Execute.Subscription.State</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ES</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Explain.html"><span class="hs-identifier">Hasura.GraphQL.Explain</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">GE</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Logging.html"><span class="hs-identifier">Hasura.GraphQL.Logging</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Logging.html#MonadQueryLog"><span class="hs-identifier">MonadQueryLog</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.html"><span class="hs-identifier">Hasura.GraphQL.Transport.HTTP</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">GH</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html"><span class="hs-identifier">Hasura.GraphQL.Transport.HTTP.Protocol</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">GH</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Transport.WSServerApp.html"><span class="hs-identifier">Hasura.GraphQL.Transport.WSServerApp</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">WS</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Transport.WebSocket.Server.html"><span class="hs-identifier">Hasura.GraphQL.Transport.WebSocket.Server</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">WS</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.HTTP.html"><span class="hs-identifier">Hasura.HTTP</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Logging.html"><span class="hs-identifier">Hasura.Logging</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Metadata.Class.html"><span class="hs-identifier">Hasura.Metadata.Class</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier">Hasura.Prelude</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier">get</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier">put</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.EventTrigger.html"><span class="hs-identifier">Hasura.RQL.DDL.EventTrigger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DDL.EventTrigger.html#MonadEventLogCleanup"><span class="hs-identifier">MonadEventLogCleanup</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Schema.html"><span class="hs-identifier">Hasura.RQL.DDL.Schema</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Endpoint.html"><span class="hs-identifier">Hasura.RQL.Types.Endpoint</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">EP</span></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html"><span class="hs-identifier">Hasura.RQL.Types.SchemaCache</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Source.html"><span class="hs-identifier">Hasura.RQL.Types.Source</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.SQL.Backend.html"><span class="hs-identifier">Hasura.SQL.Backend</span></a></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.API.Config.html"><span class="hs-identifier">Hasura.Server.API.Config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.API.Config.html#runGetConfig"><span class="hs-identifier">runGetConfig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.API.Metadata.html"><span class="hs-identifier">Hasura.Server.API.Metadata</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.API.PGDump.html"><span class="hs-identifier">Hasura.Server.API.PGDump</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PGD</span></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.API.Query.html"><span class="hs-identifier">Hasura.Server.API.Query</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.API.V2Query.html"><span class="hs-identifier">Hasura.Server.API.V2Query</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V2Q</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Auth.html"><span class="hs-identifier">Hasura.Server.Auth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Auth.html#AuthMode"><span class="hs-identifier">AuthMode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.Auth.html#UserAuthentication"><span class="hs-identifier">UserAuthentication</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Compression.html"><span class="hs-identifier">Hasura.Server.Compression</span></a></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Cors.html"><span class="hs-identifier">Hasura.Server.Cors</span></a></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Init.html"><span class="hs-identifier">Hasura.Server.Init</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Init.FeatureFlag.html#checkFeatureFlag"><span class="hs-identifier">checkFeatureFlag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Limits.html"><span class="hs-identifier">Hasura.Server.Limits</span></a></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html"><span class="hs-identifier">Hasura.Server.Logging</span></a></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Middleware.html"><span class="hs-identifier">Hasura.Server.Middleware</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Middleware.html#corsMiddleware"><span class="hs-identifier">corsMiddleware</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.OpenAPI.html"><span class="hs-identifier">Hasura.Server.OpenAPI</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.OpenAPI.html#buildOpenAPI"><span class="hs-identifier">buildOpenAPI</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Rest.html"><span class="hs-identifier">Hasura.Server.Rest</span></a></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.SchemaCacheRef.html"><span class="hs-identifier">Hasura.Server.SchemaCacheRef</span></a></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Server.SchemaCacheRef.html#SchemaCacheRef"><span class="hs-identifier">SchemaCacheRef</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><a href="Hasura.Server.SchemaCacheRef.html#getSchemaCache"><span class="hs-identifier">getSchemaCache</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><a href="Hasura.Server.SchemaCacheRef.html#readSchemaCacheRef"><span class="hs-identifier">readSchemaCacheRef</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><a href="Hasura.Server.SchemaCacheRef.html#withSchemaCacheUpdate"><span class="hs-identifier">withSchemaCacheUpdate</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Types.html"><span class="hs-identifier">Hasura.Server.Types</span></a></span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Utils.html"><span class="hs-identifier">Hasura.Server.Utils</span></a></span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Version.html"><span class="hs-identifier">Hasura.Server.Version</span></a></span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Services.html"><span class="hs-identifier">Hasura.Services</span></a></span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Session.html"><span class="hs-identifier">Hasura.Session</span></a></span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Tracing.html"><span class="hs-identifier">Hasura.Tracing</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Tracing</span></span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Types</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HTTP</span></span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Network.Mime</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">defaultMimeLookup</span></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.Wai.Extended.html"><span class="hs-identifier">Network.Wai.Extended</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Wai</span></span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.Wai.Handler.WebSockets.Custom.html"><span class="hs-identifier">Network.Wai.Handler.WebSockets.Custom</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">WSC</span></span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/filepath-1.4.2.2/src"><span class="hs-identifier">System.FilePath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/filepath-1.4.2.2/src"><span class="hs-identifier">joinPath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/filepath-1.4.2.2/src"><span class="hs-identifier">takeFileName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">System.Mem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">performMajorGC</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Metrics</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">EKG</span></span><span>
</span><span id="line-106"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Metrics.Json</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">EKG</span></span><span>
</span><span id="line-107"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Mustache</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-108"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Web.Spock.Core</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;//&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Web.Spock.Core</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Spock</span></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-keyword">data</span><span> </span><span id="HandlerCtx"><span class="annot"><a href="Hasura.Server.App.html#HandlerCtx"><span class="hs-identifier hs-var">HandlerCtx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HandlerCtx"><span class="annot"><a href="Hasura.Server.App.html#HandlerCtx"><span class="hs-identifier hs-var">HandlerCtx</span></a></span></span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="hcAppContext"><span class="annot"><span class="annottext">HandlerCtx -&gt; AppContext
</span><a href="Hasura.Server.App.html#hcAppContext"><span class="hs-identifier hs-var hs-var">hcAppContext</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-113"></span><span>    </span><span id="hcAppEnv"><span class="annot"><span class="annottext">HandlerCtx -&gt; AppEnv
</span><a href="Hasura.Server.App.html#hcAppEnv"><span class="hs-identifier hs-var hs-var">hcAppEnv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.App.State.html#AppEnv"><span class="hs-identifier hs-type">AppEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>    </span><span id="hcUser"><span class="annot"><span class="annottext">HandlerCtx -&gt; UserInfo
</span><a href="Hasura.Server.App.html#hcUser"><span class="hs-identifier hs-var hs-var">hcUser</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-115"></span><span>    </span><span id="hcReqHeaders"><span class="annot"><span class="annottext">HandlerCtx -&gt; [Header]
</span><a href="Hasura.Server.App.html#hcReqHeaders"><span class="hs-identifier hs-var hs-var">hcReqHeaders</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">HTTP.Header</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-116"></span><span>    </span><span id="hcRequestId"><span class="annot"><span class="annottext">HandlerCtx -&gt; RequestId
</span><a href="Hasura.Server.App.html#hcRequestId"><span class="hs-identifier hs-var hs-var">hcRequestId</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Server.Types.html#RequestId"><span class="hs-identifier hs-type">RequestId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-117"></span><span>    </span><span id="hcSourceIpAddress"><span class="annot"><span class="annottext">HandlerCtx -&gt; IpAddress
</span><a href="Hasura.Server.App.html#hcSourceIpAddress"><span class="hs-identifier hs-var hs-var">hcSourceIpAddress</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Network.Wai.Extended.html#IpAddress"><span class="hs-identifier hs-type">Wai.IpAddress</span></a></span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-keyword">newtype</span><span> </span><span id="Handler"><span class="annot"><a href="Hasura.Server.App.html#Handler"><span class="hs-identifier hs-var">Handler</span></a></span></span><span> </span><span id="local-6989586621690828385"><span class="annot"><a href="#local-6989586621690828385"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621690828086"><span class="annot"><a href="#local-6989586621690828086"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Handler"><span class="annot"><a href="Hasura.Server.App.html#Handler"><span class="hs-identifier hs-var">Handler</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">ReaderT</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.App.html#HandlerCtx"><span class="hs-identifier hs-type">HandlerCtx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">ExceptT</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828385"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621690828086"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-keyword">deriving</span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-special">(</span><span> </span><span id="local-6989586621690827534"><span id="local-6989586621690827540"><span class="annot"><span class="annottext">forall a b. a -&gt; Handler m b -&gt; Handler m a
forall a b. (a -&gt; b) -&gt; Handler m a -&gt; Handler m b
forall (m :: * -&gt; *) a b.
Functor m =&gt;
a -&gt; Handler m b -&gt; Handler m a
forall (m :: * -&gt; *) a b.
Functor m =&gt;
(a -&gt; b) -&gt; Handler m a -&gt; Handler m b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: forall a b. a -&gt; Handler m b -&gt; Handler m a
$c&lt;$ :: forall (m :: * -&gt; *) a b.
Functor m =&gt;
a -&gt; Handler m b -&gt; Handler m a
fmap :: forall a b. (a -&gt; b) -&gt; Handler m a -&gt; Handler m b
$cfmap :: forall (m :: * -&gt; *) a b.
Functor m =&gt;
(a -&gt; b) -&gt; Handler m a -&gt; Handler m b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></a></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-123"></span><span>      </span><span id="local-6989586621690827501"><span id="local-6989586621690827506"><span id="local-6989586621690827511"><span id="local-6989586621690827516"><span id="local-6989586621690827522"><span class="annot"><span class="annottext">forall a. a -&gt; Handler m a
forall a b. Handler m a -&gt; Handler m b -&gt; Handler m a
forall a b. Handler m a -&gt; Handler m b -&gt; Handler m b
forall a b. Handler m (a -&gt; b) -&gt; Handler m a -&gt; Handler m b
forall a b c.
(a -&gt; b -&gt; c) -&gt; Handler m a -&gt; Handler m b -&gt; Handler m c
forall {m :: * -&gt; *}. Monad m =&gt; Functor (Handler m)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Handler m a
forall (m :: * -&gt; *) a b.
Monad m =&gt;
Handler m a -&gt; Handler m b -&gt; Handler m a
forall (m :: * -&gt; *) a b.
Monad m =&gt;
Handler m a -&gt; Handler m b -&gt; Handler m b
forall (m :: * -&gt; *) a b.
Monad m =&gt;
Handler m (a -&gt; b) -&gt; Handler m a -&gt; Handler m b
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; b -&gt; c) -&gt; Handler m a -&gt; Handler m b -&gt; Handler m c
forall (f :: * -&gt; *).
Functor f
-&gt; (forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
&lt;* :: forall a b. Handler m a -&gt; Handler m b -&gt; Handler m a
$c&lt;* :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
Handler m a -&gt; Handler m b -&gt; Handler m a
*&gt; :: forall a b. Handler m a -&gt; Handler m b -&gt; Handler m b
$c*&gt; :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
Handler m a -&gt; Handler m b -&gt; Handler m b
liftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; Handler m a -&gt; Handler m b -&gt; Handler m c
$cliftA2 :: forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; b -&gt; c) -&gt; Handler m a -&gt; Handler m b -&gt; Handler m c
&lt;*&gt; :: forall a b. Handler m (a -&gt; b) -&gt; Handler m a -&gt; Handler m b
$c&lt;*&gt; :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
Handler m (a -&gt; b) -&gt; Handler m a -&gt; Handler m b
pure :: forall a. a -&gt; Handler m a
$cpure :: forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Handler m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></a></span></span></span></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-124"></span><span>      </span><span id="local-6989586621690827476"><span id="local-6989586621690827481"><span id="local-6989586621690827487"><span class="annot"><span class="annottext">forall a. a -&gt; Handler m a
forall a b. Handler m a -&gt; Handler m b -&gt; Handler m b
forall a b. Handler m a -&gt; (a -&gt; Handler m b) -&gt; Handler m b
forall (m :: * -&gt; *). Monad m =&gt; Applicative (Handler m)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Handler m a
forall (m :: * -&gt; *) a b.
Monad m =&gt;
Handler m a -&gt; Handler m b -&gt; Handler m b
forall (m :: * -&gt; *) a b.
Monad m =&gt;
Handler m a -&gt; (a -&gt; Handler m b) -&gt; Handler m b
forall (m :: * -&gt; *).
Applicative m
-&gt; (forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
return :: forall a. a -&gt; Handler m a
$creturn :: forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Handler m a
&gt;&gt; :: forall a b. Handler m a -&gt; Handler m b -&gt; Handler m b
$c&gt;&gt; :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
Handler m a -&gt; Handler m b -&gt; Handler m b
&gt;&gt;= :: forall a b. Handler m a -&gt; (a -&gt; Handler m b) -&gt; Handler m b
$c&gt;&gt;= :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
Handler m a -&gt; (a -&gt; Handler m b) -&gt; Handler m b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></a></span></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-125"></span><span>      </span><span id="local-6989586621690827464"><span class="annot"><span class="annottext">forall a. IO a -&gt; Handler m a
forall (m :: * -&gt; *).
Monad m -&gt; (forall a. IO a -&gt; m a) -&gt; MonadIO m
forall {m :: * -&gt; *}. MonadIO m =&gt; Monad (Handler m)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; Handler m a
liftIO :: forall a. IO a -&gt; Handler m a
$cliftIO :: forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; Handler m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">MonadIO</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-126"></span><span>      </span><span id="local-6989586621690827450"><span class="annot"><span class="annottext">forall a. (a -&gt; Handler m a) -&gt; Handler m a
forall (m :: * -&gt; *).
Monad m -&gt; (forall a. (a -&gt; m a) -&gt; m a) -&gt; MonadFix m
forall {m :: * -&gt; *}. MonadFix m =&gt; Monad (Handler m)
forall (m :: * -&gt; *) a.
MonadFix m =&gt;
(a -&gt; Handler m a) -&gt; Handler m a
mfix :: forall a. (a -&gt; Handler m a) -&gt; Handler m a
$cmfix :: forall (m :: * -&gt; *) a.
MonadFix m =&gt;
(a -&gt; Handler m a) -&gt; Handler m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">MonadFix</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-127"></span><span>      </span><span id="local-6989586621690827428"><span id="local-6989586621690828312"><span class="annot"><span class="hs-identifier hs-type">MonadBase</span></span><span> </span><span class="annot"><a href="#local-6989586621690828312"><span class="hs-identifier hs-type">b</span></a></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-128"></span><span>      </span><span id="local-6989586621690827405"><span id="local-6989586621690827412"><span id="local-6989586621690828293"><span class="annot"><span class="hs-identifier hs-type">MonadBaseControl</span></span><span> </span><span class="annot"><a href="#local-6989586621690828293"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-129"></span><span>      </span><span id="local-6989586621690827381"><span id="local-6989586621690827386"><span id="local-6989586621690827392"><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.App.html#HandlerCtx"><span class="hs-identifier hs-type">HandlerCtx</span></a></span></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-130"></span><span>      </span><span id="local-6989586621690827365"><span id="local-6989586621690827371"><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-131"></span><span>      </span><span class="hs-comment">-- Tracing.HasReporter,</span><span>
</span><span id="line-132"></span><span>      </span><span id="local-6989586621690827327"><span id="local-6989586621690827332"><span id="local-6989586621690827337"><span id="local-6989586621690827342"><span id="local-6989586621690827347"><span id="local-6989586621690827353"><span class="annot"><span class="annottext">Handler m (IORef TracingMetadata)
Handler m SamplingDecision
Handler m TraceContext
Handler m Reporter
TracingMetadata -&gt; Handler m ()
forall a. Text -&gt; Handler m a -&gt; Handler m a
forall (m :: * -&gt; *).
Monad m
-&gt; (forall a. Text -&gt; m a -&gt; m a)
-&gt; m TraceContext
-&gt; m Reporter
-&gt; m (IORef TracingMetadata)
-&gt; m SamplingDecision
-&gt; (TracingMetadata -&gt; m ())
-&gt; MonadTrace m
forall {m :: * -&gt; *}. MonadTrace m =&gt; Monad (Handler m)
forall (m :: * -&gt; *).
MonadTrace m =&gt;
Handler m (IORef TracingMetadata)
forall (m :: * -&gt; *). MonadTrace m =&gt; Handler m SamplingDecision
forall (m :: * -&gt; *). MonadTrace m =&gt; Handler m TraceContext
forall (m :: * -&gt; *). MonadTrace m =&gt; Handler m Reporter
forall (m :: * -&gt; *).
MonadTrace m =&gt;
TracingMetadata -&gt; Handler m ()
forall (m :: * -&gt; *) a.
MonadTrace m =&gt;
Text -&gt; Handler m a -&gt; Handler m a
attachMetadata :: TracingMetadata -&gt; Handler m ()
$cattachMetadata :: forall (m :: * -&gt; *).
MonadTrace m =&gt;
TracingMetadata -&gt; Handler m ()
currentSamplingDecision :: Handler m SamplingDecision
$ccurrentSamplingDecision :: forall (m :: * -&gt; *). MonadTrace m =&gt; Handler m SamplingDecision
currentMetadataRef :: Handler m (IORef TracingMetadata)
$ccurrentMetadataRef :: forall (m :: * -&gt; *).
MonadTrace m =&gt;
Handler m (IORef TracingMetadata)
currentReporter :: Handler m Reporter
$ccurrentReporter :: forall (m :: * -&gt; *). MonadTrace m =&gt; Handler m Reporter
currentContext :: Handler m TraceContext
$ccurrentContext :: forall (m :: * -&gt; *). MonadTrace m =&gt; Handler m TraceContext
trace :: forall a. Text -&gt; Handler m a -&gt; Handler m a
$ctrace :: forall (m :: * -&gt; *) a.
MonadTrace m =&gt;
Text -&gt; Handler m a -&gt; Handler m a
</span><a href="Hasura.Tracing.html#C%3AMonadTrace"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Tracing.MonadTrace</span></a></span></span></span></span></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-133"></span><span>      </span><span id="local-6989586621690827308"><span id="local-6989586621690827314"><span class="annot"><span class="annottext">Handler m ResourceLimits
RequestId -&gt; UserInfo -&gt; ApiLimit -&gt; Handler m ResourceLimits
forall (m :: * -&gt; *).
Monad m
-&gt; m ResourceLimits
-&gt; (RequestId -&gt; UserInfo -&gt; ApiLimit -&gt; m ResourceLimits)
-&gt; HasResourceLimits m
forall {m :: * -&gt; *}. HasResourceLimits m =&gt; Monad (Handler m)
forall (m :: * -&gt; *).
HasResourceLimits m =&gt;
Handler m ResourceLimits
forall (m :: * -&gt; *).
HasResourceLimits m =&gt;
RequestId -&gt; UserInfo -&gt; ApiLimit -&gt; Handler m ResourceLimits
askGraphqlOperationLimit :: RequestId -&gt; UserInfo -&gt; ApiLimit -&gt; Handler m ResourceLimits
$caskGraphqlOperationLimit :: forall (m :: * -&gt; *).
HasResourceLimits m =&gt;
RequestId -&gt; UserInfo -&gt; ApiLimit -&gt; Handler m ResourceLimits
askHTTPHandlerLimit :: Handler m ResourceLimits
$caskHTTPHandlerLimit :: forall (m :: * -&gt; *).
HasResourceLimits m =&gt;
Handler m ResourceLimits
</span><a href="Hasura.Server.Limits.html#C%3AHasResourceLimits"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">HasResourceLimits</span></a></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-134"></span><span>      </span><span id="local-6989586621690827288"><span id="local-6989586621690827295"><span class="annot"><span class="annottext">Handler m (SourceResolver ('Postgres 'Vanilla))
Handler m (SourceResolver 'MSSQL)
forall (m :: * -&gt; *).
Monad m
-&gt; m (SourceResolver ('Postgres 'Vanilla))
-&gt; m (SourceResolver 'MSSQL)
-&gt; MonadResolveSource m
forall {m :: * -&gt; *}. MonadResolveSource m =&gt; Monad (Handler m)
forall (m :: * -&gt; *).
MonadResolveSource m =&gt;
Handler m (SourceResolver ('Postgres 'Vanilla))
forall (m :: * -&gt; *).
MonadResolveSource m =&gt;
Handler m (SourceResolver 'MSSQL)
getMSSQLSourceResolver :: Handler m (SourceResolver 'MSSQL)
$cgetMSSQLSourceResolver :: forall (m :: * -&gt; *).
MonadResolveSource m =&gt;
Handler m (SourceResolver 'MSSQL)
getPGSourceResolver :: Handler m (SourceResolver ('Postgres 'Vanilla))
$cgetPGSourceResolver :: forall (m :: * -&gt; *).
MonadResolveSource m =&gt;
Handler m (SourceResolver ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.Types.Source.html#C%3AMonadResolveSource"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadResolveSource</span></a></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-135"></span><span>      </span><span id="local-6989586621690827274"><span class="annot"><span class="annottext">Handler m ServerConfigCtx
forall (m :: * -&gt; *).
Monad m -&gt; m ServerConfigCtx -&gt; HasServerConfigCtx m
forall {m :: * -&gt; *}. HasServerConfigCtx m =&gt; Monad (Handler m)
forall (m :: * -&gt; *).
HasServerConfigCtx m =&gt;
Handler m ServerConfigCtx
askServerConfigCtx :: Handler m ServerConfigCtx
$caskServerConfigCtx :: forall (m :: * -&gt; *).
HasServerConfigCtx m =&gt;
Handler m ServerConfigCtx
</span><a href="Hasura.Server.Types.html#C%3AHasServerConfigCtx"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">HasServerConfigCtx</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-136"></span><span>      </span><span id="local-6989586621690827249"><span id="local-6989586621690827254"><span id="local-6989586621690827260"><span class="annot"><span class="annottext">UserInfo
-&gt; ([Header], IpAddress)
-&gt; AllowListStatus
-&gt; SchemaCache
-&gt; GQLReqUnparsed
-&gt; RequestId
-&gt; Handler m (Either QErr GQLReqParsed)
UserInfo
-&gt; Value
-&gt; SetGraphqlIntrospectionOptions
-&gt; Handler m (Either QErr ExecutionStep)
UserInfo
-&gt; RequestId
-&gt; [GQLReqUnparsed]
-&gt; SchemaCache
-&gt; Handler m (Either QErr ())
forall (m :: * -&gt; *).
Monad m
-&gt; (UserInfo
    -&gt; ([Header], IpAddress)
    -&gt; AllowListStatus
    -&gt; SchemaCache
    -&gt; GQLReqUnparsed
    -&gt; RequestId
    -&gt; m (Either QErr GQLReqParsed))
-&gt; (UserInfo
    -&gt; Value
    -&gt; SetGraphqlIntrospectionOptions
    -&gt; m (Either QErr ExecutionStep))
-&gt; (UserInfo
    -&gt; RequestId
    -&gt; [GQLReqUnparsed]
    -&gt; SchemaCache
    -&gt; m (Either QErr ()))
-&gt; MonadGQLExecutionCheck m
forall {m :: * -&gt; *}. MonadGQLExecutionCheck m =&gt; Monad (Handler m)
forall (m :: * -&gt; *).
MonadGQLExecutionCheck m =&gt;
UserInfo
-&gt; ([Header], IpAddress)
-&gt; AllowListStatus
-&gt; SchemaCache
-&gt; GQLReqUnparsed
-&gt; RequestId
-&gt; Handler m (Either QErr GQLReqParsed)
forall (m :: * -&gt; *).
MonadGQLExecutionCheck m =&gt;
UserInfo
-&gt; Value
-&gt; SetGraphqlIntrospectionOptions
-&gt; Handler m (Either QErr ExecutionStep)
forall (m :: * -&gt; *).
MonadGQLExecutionCheck m =&gt;
UserInfo
-&gt; RequestId
-&gt; [GQLReqUnparsed]
-&gt; SchemaCache
-&gt; Handler m (Either QErr ())
checkGQLBatchedReqs :: UserInfo
-&gt; RequestId
-&gt; [GQLReqUnparsed]
-&gt; SchemaCache
-&gt; Handler m (Either QErr ())
$ccheckGQLBatchedReqs :: forall (m :: * -&gt; *).
MonadGQLExecutionCheck m =&gt;
UserInfo
-&gt; RequestId
-&gt; [GQLReqUnparsed]
-&gt; SchemaCache
-&gt; Handler m (Either QErr ())
executeIntrospection :: UserInfo
-&gt; Value
-&gt; SetGraphqlIntrospectionOptions
-&gt; Handler m (Either QErr ExecutionStep)
$cexecuteIntrospection :: forall (m :: * -&gt; *).
MonadGQLExecutionCheck m =&gt;
UserInfo
-&gt; Value
-&gt; SetGraphqlIntrospectionOptions
-&gt; Handler m (Either QErr ExecutionStep)
checkGQLExecution :: UserInfo
-&gt; ([Header], IpAddress)
-&gt; AllowListStatus
-&gt; SchemaCache
-&gt; GQLReqUnparsed
-&gt; RequestId
-&gt; Handler m (Either QErr GQLReqParsed)
$ccheckGQLExecution :: forall (m :: * -&gt; *).
MonadGQLExecutionCheck m =&gt;
UserInfo
-&gt; ([Header], IpAddress)
-&gt; AllowListStatus
-&gt; SchemaCache
-&gt; GQLReqUnparsed
-&gt; RequestId
-&gt; Handler m (Either QErr GQLReqParsed)
</span><a href="Hasura.GraphQL.Execute.Common.html#C%3AMonadGQLExecutionCheck"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">E.MonadGQLExecutionCheck</span></a></span></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-137"></span><span>      </span><span id="local-6989586621690827225"><span id="local-6989586621690827230"><span id="local-6989586621690827236"><span class="annot"><span class="annottext">Logger Hasura
-&gt; InsOrdHashMap SourceName BackendSourceMetadata
-&gt; InsOrdHashMap SourceName BackendSourceMetadata
-&gt; SchemaCache
-&gt; Handler m (Either QErr ())
AnyBackend SourceInfo
-&gt; TriggerName
-&gt; AutoTriggerLogCleanupConfig
-&gt; Handler m (Either QErr ())
TriggerLogCleanupConfig -&gt; Handler m (Either QErr EncJSON)
forall (m :: * -&gt; *).
Monad m
-&gt; (TriggerLogCleanupConfig -&gt; m (Either QErr EncJSON))
-&gt; (AnyBackend SourceInfo
    -&gt; TriggerName
    -&gt; AutoTriggerLogCleanupConfig
    -&gt; m (Either QErr ()))
-&gt; (Logger Hasura
    -&gt; InsOrdHashMap SourceName BackendSourceMetadata
    -&gt; InsOrdHashMap SourceName BackendSourceMetadata
    -&gt; SchemaCache
    -&gt; m (Either QErr ()))
-&gt; MonadEventLogCleanup m
forall {m :: * -&gt; *}. MonadEventLogCleanup m =&gt; Monad (Handler m)
forall (m :: * -&gt; *).
MonadEventLogCleanup m =&gt;
Logger Hasura
-&gt; InsOrdHashMap SourceName BackendSourceMetadata
-&gt; InsOrdHashMap SourceName BackendSourceMetadata
-&gt; SchemaCache
-&gt; Handler m (Either QErr ())
forall (m :: * -&gt; *).
MonadEventLogCleanup m =&gt;
AnyBackend SourceInfo
-&gt; TriggerName
-&gt; AutoTriggerLogCleanupConfig
-&gt; Handler m (Either QErr ())
forall (m :: * -&gt; *).
MonadEventLogCleanup m =&gt;
TriggerLogCleanupConfig -&gt; Handler m (Either QErr EncJSON)
updateTriggerCleanupSchedules :: Logger Hasura
-&gt; InsOrdHashMap SourceName BackendSourceMetadata
-&gt; InsOrdHashMap SourceName BackendSourceMetadata
-&gt; SchemaCache
-&gt; Handler m (Either QErr ())
$cupdateTriggerCleanupSchedules :: forall (m :: * -&gt; *).
MonadEventLogCleanup m =&gt;
Logger Hasura
-&gt; InsOrdHashMap SourceName BackendSourceMetadata
-&gt; InsOrdHashMap SourceName BackendSourceMetadata
-&gt; SchemaCache
-&gt; Handler m (Either QErr ())
generateCleanupSchedules :: AnyBackend SourceInfo
-&gt; TriggerName
-&gt; AutoTriggerLogCleanupConfig
-&gt; Handler m (Either QErr ())
$cgenerateCleanupSchedules :: forall (m :: * -&gt; *).
MonadEventLogCleanup m =&gt;
AnyBackend SourceInfo
-&gt; TriggerName
-&gt; AutoTriggerLogCleanupConfig
-&gt; Handler m (Either QErr ())
runLogCleaner :: TriggerLogCleanupConfig -&gt; Handler m (Either QErr EncJSON)
$crunLogCleaner :: forall (m :: * -&gt; *).
MonadEventLogCleanup m =&gt;
TriggerLogCleanupConfig -&gt; Handler m (Either QErr EncJSON)
</span><a href="Hasura.RQL.DDL.EventTrigger.html#C%3AMonadEventLogCleanup"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadEventLogCleanup</span></a></span></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-138"></span><span>      </span><span id="local-6989586621690827212"><span class="annot"><span class="annottext">Logger Hasura -&gt; QueryLog -&gt; Handler m ()
forall (m :: * -&gt; *).
Monad m -&gt; (Logger Hasura -&gt; QueryLog -&gt; m ()) -&gt; MonadQueryLog m
forall {m :: * -&gt; *}. MonadQueryLog m =&gt; Monad (Handler m)
forall (m :: * -&gt; *).
MonadQueryLog m =&gt;
Logger Hasura -&gt; QueryLog -&gt; Handler m ()
logQueryLog :: Logger Hasura -&gt; QueryLog -&gt; Handler m ()
$clogQueryLog :: forall (m :: * -&gt; *).
MonadQueryLog m =&gt;
Logger Hasura -&gt; QueryLog -&gt; Handler m ()
</span><a href="Hasura.GraphQL.Logging.html#C%3AMonadQueryLog"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">MonadQueryLog</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-139"></span><span>      </span><span id="local-6989586621690827198"><span class="annot"><span class="annottext">QueryTagsAttributes
-&gt; Maybe QueryTagsConfig -&gt; Tagged (Handler m) QueryTagsComment
forall (m :: * -&gt; *).
Monad m
-&gt; (QueryTagsAttributes
    -&gt; Maybe QueryTagsConfig -&gt; Tagged m QueryTagsComment)
-&gt; MonadQueryTags m
forall {m :: * -&gt; *}. MonadQueryTags m =&gt; Monad (Handler m)
forall (m :: * -&gt; *).
MonadQueryTags m =&gt;
QueryTagsAttributes
-&gt; Maybe QueryTagsConfig -&gt; Tagged (Handler m) QueryTagsComment
createQueryTags :: QueryTagsAttributes
-&gt; Maybe QueryTagsConfig -&gt; Tagged (Handler m) QueryTagsComment
$ccreateQueryTags :: forall (m :: * -&gt; *).
MonadQueryTags m =&gt;
QueryTagsAttributes
-&gt; Maybe QueryTagsConfig -&gt; Tagged (Handler m) QueryTagsComment
</span><a href="Hasura.GraphQL.Execute.Backend.html#C%3AMonadQueryTags"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">EB.MonadQueryTags</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-140"></span><span>      </span><span id="local-6989586621690827178"><span id="local-6989586621690827184"><span class="annot"><span class="annottext">[RemoteSchemaInfo]
-&gt; [ActionsInfo]
-&gt; QueryCacheKey
-&gt; Maybe CachedDirective
-&gt; TraceT (ExceptT QErr (Handler m)) ([Header], Maybe EncJSON)
QueryCacheKey
-&gt; Maybe CachedDirective
-&gt; EncJSON
-&gt; TraceT (ExceptT QErr (Handler m)) CacheStoreResponse
forall (m :: * -&gt; *).
Monad m
-&gt; ([RemoteSchemaInfo]
    -&gt; [ActionsInfo]
    -&gt; QueryCacheKey
    -&gt; Maybe CachedDirective
    -&gt; TraceT (ExceptT QErr m) ([Header], Maybe EncJSON))
-&gt; (QueryCacheKey
    -&gt; Maybe CachedDirective
    -&gt; EncJSON
    -&gt; TraceT (ExceptT QErr m) CacheStoreResponse)
-&gt; MonadExecuteQuery m
forall {m :: * -&gt; *}. MonadExecuteQuery m =&gt; Monad (Handler m)
forall (m :: * -&gt; *).
MonadExecuteQuery m =&gt;
[RemoteSchemaInfo]
-&gt; [ActionsInfo]
-&gt; QueryCacheKey
-&gt; Maybe CachedDirective
-&gt; TraceT (ExceptT QErr (Handler m)) ([Header], Maybe EncJSON)
forall (m :: * -&gt; *).
MonadExecuteQuery m =&gt;
QueryCacheKey
-&gt; Maybe CachedDirective
-&gt; EncJSON
-&gt; TraceT (ExceptT QErr (Handler m)) CacheStoreResponse
cacheStore :: QueryCacheKey
-&gt; Maybe CachedDirective
-&gt; EncJSON
-&gt; TraceT (ExceptT QErr (Handler m)) CacheStoreResponse
$ccacheStore :: forall (m :: * -&gt; *).
MonadExecuteQuery m =&gt;
QueryCacheKey
-&gt; Maybe CachedDirective
-&gt; EncJSON
-&gt; TraceT (ExceptT QErr (Handler m)) CacheStoreResponse
cacheLookup :: [RemoteSchemaInfo]
-&gt; [ActionsInfo]
-&gt; QueryCacheKey
-&gt; Maybe CachedDirective
-&gt; TraceT (ExceptT QErr (Handler m)) ([Header], Maybe EncJSON)
$ccacheLookup :: forall (m :: * -&gt; *).
MonadExecuteQuery m =&gt;
[RemoteSchemaInfo]
-&gt; [ActionsInfo]
-&gt; QueryCacheKey
-&gt; Maybe CachedDirective
-&gt; TraceT (ExceptT QErr (Handler m)) ([Header], Maybe EncJSON)
</span><a href="Hasura.GraphQL.Transport.HTTP.html#C%3AMonadExecuteQuery"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">GH.MonadExecuteQuery</span></a></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-141"></span><span>      </span><span id="local-6989586621690827154"><span id="local-6989586621690827159"><span id="local-6989586621690827165"><span class="annot"><span class="annottext">RQLQuery -&gt; HandlerCtx -&gt; Handler m (Either QErr ())
RQLQuery -&gt; HandlerCtx -&gt; Handler m (Either QErr ())
RQLMetadata -&gt; HandlerCtx -&gt; Handler m (Either QErr ())
forall (m :: * -&gt; *).
Monad m
-&gt; (RQLQuery -&gt; HandlerCtx -&gt; m (Either QErr ()))
-&gt; (RQLMetadata -&gt; HandlerCtx -&gt; m (Either QErr ()))
-&gt; (RQLQuery -&gt; HandlerCtx -&gt; m (Either QErr ()))
-&gt; MonadMetadataApiAuthorization m
forall {m :: * -&gt; *}.
MonadMetadataApiAuthorization m =&gt;
Monad (Handler m)
forall (m :: * -&gt; *).
MonadMetadataApiAuthorization m =&gt;
RQLQuery -&gt; HandlerCtx -&gt; Handler m (Either QErr ())
forall (m :: * -&gt; *).
MonadMetadataApiAuthorization m =&gt;
RQLQuery -&gt; HandlerCtx -&gt; Handler m (Either QErr ())
forall (m :: * -&gt; *).
MonadMetadataApiAuthorization m =&gt;
RQLMetadata -&gt; HandlerCtx -&gt; Handler m (Either QErr ())
authorizeV2QueryApi :: RQLQuery -&gt; HandlerCtx -&gt; Handler m (Either QErr ())
$cauthorizeV2QueryApi :: forall (m :: * -&gt; *).
MonadMetadataApiAuthorization m =&gt;
RQLQuery -&gt; HandlerCtx -&gt; Handler m (Either QErr ())
authorizeV1MetadataApi :: RQLMetadata -&gt; HandlerCtx -&gt; Handler m (Either QErr ())
$cauthorizeV1MetadataApi :: forall (m :: * -&gt; *).
MonadMetadataApiAuthorization m =&gt;
RQLMetadata -&gt; HandlerCtx -&gt; Handler m (Either QErr ())
authorizeV1QueryApi :: RQLQuery -&gt; HandlerCtx -&gt; Handler m (Either QErr ())
$cauthorizeV1QueryApi :: forall (m :: * -&gt; *).
MonadMetadataApiAuthorization m =&gt;
RQLQuery -&gt; HandlerCtx -&gt; Handler m (Either QErr ())
</span><a href="Hasura.Server.App.html#C%3AMonadMetadataApiAuthorization"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadMetadataApiAuthorization</span></a></span></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-142"></span><span>      </span><span id="local-6989586621690827005"><span id="local-6989586621690827010"><span id="local-6989586621690827015"><span id="local-6989586621690827020"><span id="local-6989586621690827025"><span id="local-6989586621690827030"><span id="local-6989586621690827035"><span id="local-6989586621690827040"><span id="local-6989586621690827045"><span id="local-6989586621690827050"><span id="local-6989586621690827055"><span id="local-6989586621690827060"><span id="local-6989586621690827065"><span id="local-6989586621690827070"><span id="local-6989586621690827075"><span id="local-6989586621690827080"><span id="local-6989586621690827085"><span id="local-6989586621690827090"><span id="local-6989586621690827095"><span id="local-6989586621690827100"><span id="local-6989586621690827105"><span id="local-6989586621690827110"><span id="local-6989586621690827115"><span id="local-6989586621690827120"><span id="local-6989586621690827125"><span id="local-6989586621690827130"><span id="local-6989586621690827135"><span id="local-6989586621690827141"><span class="annot"><span class="annottext">Handler m (Either QErr [ActionLogItem])
Handler m (Either QErr ())
Handler m (Either QErr ([CronEvent], [OneOffScheduledEvent]))
Handler m (Either QErr (Metadata, MetadataResourceVersion))
Handler m (Either QErr CatalogState)
Handler m (Either QErr MetadataDbId)
Handler m (Either QErr MetadataResourceVersion)
[TriggerName] -&gt; Handler m (Either QErr [CronTriggerStats])
[CronEventSeed] -&gt; Handler m (Either QErr ())
ScheduledEventId
-&gt; ScheduledEventType -&gt; Handler m (Either QErr ())
ScheduledEventId
-&gt; ScheduledEventOp
-&gt; ScheduledEventType
-&gt; Handler m (Either QErr ())
Invocation 'ScheduledType
-&gt; ScheduledEventType -&gt; Handler m (Either QErr ())
TriggerName
-&gt; ScheduledEventPagination
-&gt; [ScheduledEventStatus]
-&gt; RowsCountOption
-&gt; Handler m (Either QErr (WithOptionalTotalCount [CronEvent]))
OneOffEvent -&gt; Handler m (Either QErr ScheduledEventId)
ScheduledEventType
-&gt; [ScheduledEventId] -&gt; Handler m (Either QErr Int)
ScheduledEventPagination
-&gt; [ScheduledEventStatus]
-&gt; RowsCountOption
-&gt; Handler
     m (Either QErr (WithOptionalTotalCount [OneOffScheduledEvent]))
ClearCronEvents -&gt; Handler m (Either QErr ())
GetScheduledEventInvocations
-&gt; Handler
     m (Either QErr (WithOptionalTotalCount [ScheduledEventInvocation]))
LockedActionIdArray -&gt; Handler m (Either QErr ())
ActionId -&gt; Handler m (Either QErr ActionLogResponse)
ActionId -&gt; AsyncActionStatus -&gt; Handler m (Either QErr ())
ActionName -&gt; Handler m (Either QErr ())
ActionName
-&gt; SessionVariables
-&gt; [Header]
-&gt; Value
-&gt; Handler m (Either QErr ActionId)
CatalogStateType -&gt; Value -&gt; Handler m (Either QErr ())
MetadataResourceVersion
-&gt; Metadata -&gt; Handler m (Either QErr MetadataResourceVersion)
MetadataResourceVersion
-&gt; InstanceId
-&gt; Handler
     m (Either QErr [(MetadataResourceVersion, CacheInvalidations)])
MetadataResourceVersion
-&gt; InstanceId -&gt; CacheInvalidations -&gt; Handler m (Either QErr ())
forall (m :: * -&gt; *).
Monad m
-&gt; m (Either QErr MetadataResourceVersion)
-&gt; m (Either QErr (Metadata, MetadataResourceVersion))
-&gt; (MetadataResourceVersion
    -&gt; InstanceId
    -&gt; m (Either QErr [(MetadataResourceVersion, CacheInvalidations)]))
-&gt; (MetadataResourceVersion
    -&gt; Metadata -&gt; m (Either QErr MetadataResourceVersion))
-&gt; (MetadataResourceVersion
    -&gt; InstanceId -&gt; CacheInvalidations -&gt; m (Either QErr ()))
-&gt; m (Either QErr CatalogState)
-&gt; (CatalogStateType -&gt; Value -&gt; m (Either QErr ()))
-&gt; m (Either QErr MetadataDbId)
-&gt; m (Either QErr ())
-&gt; ([TriggerName] -&gt; m (Either QErr [CronTriggerStats]))
-&gt; m (Either QErr ([CronEvent], [OneOffScheduledEvent]))
-&gt; ([CronEventSeed] -&gt; m (Either QErr ()))
-&gt; (OneOffEvent -&gt; m (Either QErr ScheduledEventId))
-&gt; (Invocation 'ScheduledType
    -&gt; ScheduledEventType -&gt; m (Either QErr ()))
-&gt; (ScheduledEventId
    -&gt; ScheduledEventOp -&gt; ScheduledEventType -&gt; m (Either QErr ()))
-&gt; (ScheduledEventType
    -&gt; [ScheduledEventId] -&gt; m (Either QErr Int))
-&gt; m (Either QErr ())
-&gt; (ClearCronEvents -&gt; m (Either QErr ()))
-&gt; (ScheduledEventPagination
    -&gt; [ScheduledEventStatus]
    -&gt; RowsCountOption
    -&gt; m (Either QErr (WithOptionalTotalCount [OneOffScheduledEvent])))
-&gt; (TriggerName
    -&gt; ScheduledEventPagination
    -&gt; [ScheduledEventStatus]
    -&gt; RowsCountOption
    -&gt; m (Either QErr (WithOptionalTotalCount [CronEvent])))
-&gt; (GetScheduledEventInvocations
    -&gt; m (Either
            QErr (WithOptionalTotalCount [ScheduledEventInvocation])))
-&gt; (ScheduledEventId -&gt; ScheduledEventType -&gt; m (Either QErr ()))
-&gt; (ActionName
    -&gt; SessionVariables
    -&gt; [Header]
    -&gt; Value
    -&gt; m (Either QErr ActionId))
-&gt; m (Either QErr [ActionLogItem])
-&gt; (ActionId -&gt; AsyncActionStatus -&gt; m (Either QErr ()))
-&gt; (ActionId -&gt; m (Either QErr ActionLogResponse))
-&gt; (ActionName -&gt; m (Either QErr ()))
-&gt; (LockedActionIdArray -&gt; m (Either QErr ()))
-&gt; MonadMetadataStorage m
forall {m :: * -&gt; *}. MonadMetadataStorage m =&gt; Monad (Handler m)
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
Handler m (Either QErr [ActionLogItem])
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
Handler m (Either QErr ())
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
Handler m (Either QErr ([CronEvent], [OneOffScheduledEvent]))
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
Handler m (Either QErr (Metadata, MetadataResourceVersion))
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
Handler m (Either QErr CatalogState)
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
Handler m (Either QErr MetadataDbId)
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
Handler m (Either QErr MetadataResourceVersion)
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
[TriggerName] -&gt; Handler m (Either QErr [CronTriggerStats])
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
[CronEventSeed] -&gt; Handler m (Either QErr ())
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
ScheduledEventId
-&gt; ScheduledEventType -&gt; Handler m (Either QErr ())
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
ScheduledEventId
-&gt; ScheduledEventOp
-&gt; ScheduledEventType
-&gt; Handler m (Either QErr ())
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
Invocation 'ScheduledType
-&gt; ScheduledEventType -&gt; Handler m (Either QErr ())
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
TriggerName
-&gt; ScheduledEventPagination
-&gt; [ScheduledEventStatus]
-&gt; RowsCountOption
-&gt; Handler m (Either QErr (WithOptionalTotalCount [CronEvent]))
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
OneOffEvent -&gt; Handler m (Either QErr ScheduledEventId)
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
ScheduledEventType
-&gt; [ScheduledEventId] -&gt; Handler m (Either QErr Int)
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
ScheduledEventPagination
-&gt; [ScheduledEventStatus]
-&gt; RowsCountOption
-&gt; Handler
     m (Either QErr (WithOptionalTotalCount [OneOffScheduledEvent]))
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
ClearCronEvents -&gt; Handler m (Either QErr ())
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
GetScheduledEventInvocations
-&gt; Handler
     m (Either QErr (WithOptionalTotalCount [ScheduledEventInvocation]))
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
LockedActionIdArray -&gt; Handler m (Either QErr ())
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
ActionId -&gt; Handler m (Either QErr ActionLogResponse)
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
ActionId -&gt; AsyncActionStatus -&gt; Handler m (Either QErr ())
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
ActionName -&gt; Handler m (Either QErr ())
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
ActionName
-&gt; SessionVariables
-&gt; [Header]
-&gt; Value
-&gt; Handler m (Either QErr ActionId)
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
CatalogStateType -&gt; Value -&gt; Handler m (Either QErr ())
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
MetadataResourceVersion
-&gt; Metadata -&gt; Handler m (Either QErr MetadataResourceVersion)
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
MetadataResourceVersion
-&gt; InstanceId
-&gt; Handler
     m (Either QErr [(MetadataResourceVersion, CacheInvalidations)])
forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
MetadataResourceVersion
-&gt; InstanceId -&gt; CacheInvalidations -&gt; Handler m (Either QErr ())
setProcessingActionLogsToPending :: LockedActionIdArray -&gt; Handler m (Either QErr ())
$csetProcessingActionLogsToPending :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
LockedActionIdArray -&gt; Handler m (Either QErr ())
clearActionData :: ActionName -&gt; Handler m (Either QErr ())
$cclearActionData :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
ActionName -&gt; Handler m (Either QErr ())
fetchActionResponse :: ActionId -&gt; Handler m (Either QErr ActionLogResponse)
$cfetchActionResponse :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
ActionId -&gt; Handler m (Either QErr ActionLogResponse)
setActionStatus :: ActionId -&gt; AsyncActionStatus -&gt; Handler m (Either QErr ())
$csetActionStatus :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
ActionId -&gt; AsyncActionStatus -&gt; Handler m (Either QErr ())
fetchUndeliveredActionEvents :: Handler m (Either QErr [ActionLogItem])
$cfetchUndeliveredActionEvents :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
Handler m (Either QErr [ActionLogItem])
insertAction :: ActionName
-&gt; SessionVariables
-&gt; [Header]
-&gt; Value
-&gt; Handler m (Either QErr ActionId)
$cinsertAction :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
ActionName
-&gt; SessionVariables
-&gt; [Header]
-&gt; Value
-&gt; Handler m (Either QErr ActionId)
deleteScheduledEvent :: ScheduledEventId
-&gt; ScheduledEventType -&gt; Handler m (Either QErr ())
$cdeleteScheduledEvent :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
ScheduledEventId
-&gt; ScheduledEventType -&gt; Handler m (Either QErr ())
getScheduledEventInvocations :: GetScheduledEventInvocations
-&gt; Handler
     m (Either QErr (WithOptionalTotalCount [ScheduledEventInvocation]))
$cgetScheduledEventInvocations :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
GetScheduledEventInvocations
-&gt; Handler
     m (Either QErr (WithOptionalTotalCount [ScheduledEventInvocation]))
getCronEvents :: TriggerName
-&gt; ScheduledEventPagination
-&gt; [ScheduledEventStatus]
-&gt; RowsCountOption
-&gt; Handler m (Either QErr (WithOptionalTotalCount [CronEvent]))
$cgetCronEvents :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
TriggerName
-&gt; ScheduledEventPagination
-&gt; [ScheduledEventStatus]
-&gt; RowsCountOption
-&gt; Handler m (Either QErr (WithOptionalTotalCount [CronEvent]))
getOneOffScheduledEvents :: ScheduledEventPagination
-&gt; [ScheduledEventStatus]
-&gt; RowsCountOption
-&gt; Handler
     m (Either QErr (WithOptionalTotalCount [OneOffScheduledEvent]))
$cgetOneOffScheduledEvents :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
ScheduledEventPagination
-&gt; [ScheduledEventStatus]
-&gt; RowsCountOption
-&gt; Handler
     m (Either QErr (WithOptionalTotalCount [OneOffScheduledEvent]))
clearFutureCronEvents :: ClearCronEvents -&gt; Handler m (Either QErr ())
$cclearFutureCronEvents :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
ClearCronEvents -&gt; Handler m (Either QErr ())
unlockAllLockedScheduledEvents :: Handler m (Either QErr ())
$cunlockAllLockedScheduledEvents :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
Handler m (Either QErr ())
unlockScheduledEvents :: ScheduledEventType
-&gt; [ScheduledEventId] -&gt; Handler m (Either QErr Int)
$cunlockScheduledEvents :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
ScheduledEventType
-&gt; [ScheduledEventId] -&gt; Handler m (Either QErr Int)
setScheduledEventOp :: ScheduledEventId
-&gt; ScheduledEventOp
-&gt; ScheduledEventType
-&gt; Handler m (Either QErr ())
$csetScheduledEventOp :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
ScheduledEventId
-&gt; ScheduledEventOp
-&gt; ScheduledEventType
-&gt; Handler m (Either QErr ())
insertScheduledEventInvocation :: Invocation 'ScheduledType
-&gt; ScheduledEventType -&gt; Handler m (Either QErr ())
$cinsertScheduledEventInvocation :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
Invocation 'ScheduledType
-&gt; ScheduledEventType -&gt; Handler m (Either QErr ())
insertOneOffScheduledEvent :: OneOffEvent -&gt; Handler m (Either QErr ScheduledEventId)
$cinsertOneOffScheduledEvent :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
OneOffEvent -&gt; Handler m (Either QErr ScheduledEventId)
insertCronEvents :: [CronEventSeed] -&gt; Handler m (Either QErr ())
$cinsertCronEvents :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
[CronEventSeed] -&gt; Handler m (Either QErr ())
getScheduledEventsForDelivery :: Handler m (Either QErr ([CronEvent], [OneOffScheduledEvent]))
$cgetScheduledEventsForDelivery :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
Handler m (Either QErr ([CronEvent], [OneOffScheduledEvent]))
getDeprivedCronTriggerStats :: [TriggerName] -&gt; Handler m (Either QErr [CronTriggerStats])
$cgetDeprivedCronTriggerStats :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
[TriggerName] -&gt; Handler m (Either QErr [CronTriggerStats])
checkMetadataStorageHealth :: Handler m (Either QErr ())
$ccheckMetadataStorageHealth :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
Handler m (Either QErr ())
getMetadataDbUid :: Handler m (Either QErr MetadataDbId)
$cgetMetadataDbUid :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
Handler m (Either QErr MetadataDbId)
setCatalogState :: CatalogStateType -&gt; Value -&gt; Handler m (Either QErr ())
$csetCatalogState :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
CatalogStateType -&gt; Value -&gt; Handler m (Either QErr ())
getCatalogState :: Handler m (Either QErr CatalogState)
$cgetCatalogState :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
Handler m (Either QErr CatalogState)
notifySchemaCacheSync :: MetadataResourceVersion
-&gt; InstanceId -&gt; CacheInvalidations -&gt; Handler m (Either QErr ())
$cnotifySchemaCacheSync :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
MetadataResourceVersion
-&gt; InstanceId -&gt; CacheInvalidations -&gt; Handler m (Either QErr ())
setMetadata :: MetadataResourceVersion
-&gt; Metadata -&gt; Handler m (Either QErr MetadataResourceVersion)
$csetMetadata :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
MetadataResourceVersion
-&gt; Metadata -&gt; Handler m (Either QErr MetadataResourceVersion)
fetchMetadataNotifications :: MetadataResourceVersion
-&gt; InstanceId
-&gt; Handler
     m (Either QErr [(MetadataResourceVersion, CacheInvalidations)])
$cfetchMetadataNotifications :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
MetadataResourceVersion
-&gt; InstanceId
-&gt; Handler
     m (Either QErr [(MetadataResourceVersion, CacheInvalidations)])
fetchMetadata :: Handler m (Either QErr (Metadata, MetadataResourceVersion))
$cfetchMetadata :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
Handler m (Either QErr (Metadata, MetadataResourceVersion))
fetchMetadataResourceVersion :: Handler m (Either QErr MetadataResourceVersion)
$cfetchMetadataResourceVersion :: forall (m :: * -&gt; *).
MonadMetadataStorage m =&gt;
Handler m (Either QErr MetadataResourceVersion)
</span><a href="Hasura.Metadata.Class.html#C%3AMonadMetadataStorage"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadMetadataStorage</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-143"></span><span>      </span><span id="local-6989586621690826951"><span id="local-6989586621690826956"><span id="local-6989586621690826961"><span id="local-6989586621690826966"><span id="local-6989586621690826971"><span id="local-6989586621690826976"><span id="local-6989586621690826981"><span id="local-6989586621690826986"><span id="local-6989586621690826992"><span class="annot"><span class="annottext">Handler m (Either QErr CatalogState)
[CronEventSeed] -&gt; Handler m (Either QErr ())
ScheduledEventId
-&gt; ScheduledEventType -&gt; Handler m (Either QErr ())
OneOffEvent -&gt; Handler m (Either QErr ScheduledEventId)
GetScheduledEvents -&gt; Handler m (Either QErr Value)
ClearCronEvents -&gt; Handler m (Either QErr ())
GetScheduledEventInvocations
-&gt; Handler
     m (Either QErr (WithOptionalTotalCount [ScheduledEventInvocation]))
ActionName -&gt; Handler m (Either QErr ())
CatalogStateType -&gt; Value -&gt; Handler m (Either QErr ())
forall {m :: * -&gt; *}.
MonadMetadataStorageQueryAPI m =&gt;
MonadMetadataStorage (Handler m)
forall (m :: * -&gt; *).
MonadMetadataStorageQueryAPI m =&gt;
Handler m (Either QErr CatalogState)
forall (m :: * -&gt; *).
MonadMetadataStorageQueryAPI m =&gt;
[CronEventSeed] -&gt; Handler m (Either QErr ())
forall (m :: * -&gt; *).
MonadMetadataStorageQueryAPI m =&gt;
ScheduledEventId
-&gt; ScheduledEventType -&gt; Handler m (Either QErr ())
forall (m :: * -&gt; *).
MonadMetadataStorageQueryAPI m =&gt;
OneOffEvent -&gt; Handler m (Either QErr ScheduledEventId)
forall (m :: * -&gt; *).
MonadMetadataStorageQueryAPI m =&gt;
GetScheduledEvents -&gt; Handler m (Either QErr Value)
forall (m :: * -&gt; *).
MonadMetadataStorageQueryAPI m =&gt;
ClearCronEvents -&gt; Handler m (Either QErr ())
forall (m :: * -&gt; *).
MonadMetadataStorageQueryAPI m =&gt;
GetScheduledEventInvocations
-&gt; Handler
     m (Either QErr (WithOptionalTotalCount [ScheduledEventInvocation]))
forall (m :: * -&gt; *).
MonadMetadataStorageQueryAPI m =&gt;
ActionName -&gt; Handler m (Either QErr ())
forall (m :: * -&gt; *).
MonadMetadataStorageQueryAPI m =&gt;
CatalogStateType -&gt; Value -&gt; Handler m (Either QErr ())
forall (m :: * -&gt; *).
MonadMetadataStorage m
-&gt; (OneOffEvent -&gt; m (Either QErr ScheduledEventId))
-&gt; ([CronEventSeed] -&gt; m (Either QErr ()))
-&gt; (ClearCronEvents -&gt; m (Either QErr ()))
-&gt; (ActionName -&gt; m (Either QErr ()))
-&gt; (GetScheduledEventInvocations
    -&gt; m (Either
            QErr (WithOptionalTotalCount [ScheduledEventInvocation])))
-&gt; (GetScheduledEvents -&gt; m (Either QErr Value))
-&gt; (ScheduledEventId -&gt; ScheduledEventType -&gt; m (Either QErr ()))
-&gt; m (Either QErr CatalogState)
-&gt; (CatalogStateType -&gt; Value -&gt; m (Either QErr ()))
-&gt; MonadMetadataStorageQueryAPI m
updateCatalogState :: CatalogStateType -&gt; Value -&gt; Handler m (Either QErr ())
$cupdateCatalogState :: forall (m :: * -&gt; *).
MonadMetadataStorageQueryAPI m =&gt;
CatalogStateType -&gt; Value -&gt; Handler m (Either QErr ())
fetchCatalogState :: Handler m (Either QErr CatalogState)
$cfetchCatalogState :: forall (m :: * -&gt; *).
MonadMetadataStorageQueryAPI m =&gt;
Handler m (Either QErr CatalogState)
dropEvent :: ScheduledEventId
-&gt; ScheduledEventType -&gt; Handler m (Either QErr ())
$cdropEvent :: forall (m :: * -&gt; *).
MonadMetadataStorageQueryAPI m =&gt;
ScheduledEventId
-&gt; ScheduledEventType -&gt; Handler m (Either QErr ())
fetchScheduledEvents :: GetScheduledEvents -&gt; Handler m (Either QErr Value)
$cfetchScheduledEvents :: forall (m :: * -&gt; *).
MonadMetadataStorageQueryAPI m =&gt;
GetScheduledEvents -&gt; Handler m (Either QErr Value)
fetchScheduledEventInvocations :: GetScheduledEventInvocations
-&gt; Handler
     m (Either QErr (WithOptionalTotalCount [ScheduledEventInvocation]))
$cfetchScheduledEventInvocations :: forall (m :: * -&gt; *).
MonadMetadataStorageQueryAPI m =&gt;
GetScheduledEventInvocations
-&gt; Handler
     m (Either QErr (WithOptionalTotalCount [ScheduledEventInvocation]))
deleteActionData :: ActionName -&gt; Handler m (Either QErr ())
$cdeleteActionData :: forall (m :: * -&gt; *).
MonadMetadataStorageQueryAPI m =&gt;
ActionName -&gt; Handler m (Either QErr ())
dropFutureCronEvents :: ClearCronEvents -&gt; Handler m (Either QErr ())
$cdropFutureCronEvents :: forall (m :: * -&gt; *).
MonadMetadataStorageQueryAPI m =&gt;
ClearCronEvents -&gt; Handler m (Either QErr ())
createCronEvents :: [CronEventSeed] -&gt; Handler m (Either QErr ())
$ccreateCronEvents :: forall (m :: * -&gt; *).
MonadMetadataStorageQueryAPI m =&gt;
[CronEventSeed] -&gt; Handler m (Either QErr ())
createOneOffScheduledEvent :: OneOffEvent -&gt; Handler m (Either QErr ScheduledEventId)
$ccreateOneOffScheduledEvent :: forall (m :: * -&gt; *).
MonadMetadataStorageQueryAPI m =&gt;
OneOffEvent -&gt; Handler m (Either QErr ScheduledEventId)
</span><a href="Hasura.Metadata.Class.html#C%3AMonadMetadataStorageQueryAPI"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadMetadataStorageQueryAPI</span></a></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-144"></span><span>      </span><span id="local-6989586621690826938"><span class="annot"><span class="annottext">Handler m Manager
forall (m :: * -&gt; *). Monad m -&gt; m Manager -&gt; ProvidesNetwork m
forall {m :: * -&gt; *}. ProvidesNetwork m =&gt; Monad (Handler m)
forall (m :: * -&gt; *). ProvidesNetwork m =&gt; Handler m Manager
askHTTPManager :: Handler m Manager
$caskHTTPManager :: forall (m :: * -&gt; *). ProvidesNetwork m =&gt; Handler m Manager
</span><a href="Hasura.Services.Network.html#C%3AProvidesNetwork"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">ProvidesNetwork</span></a></span></span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">MonadTrans</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.App.html#Handler"><span class="hs-identifier hs-type">Handler</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-148"></span><span>  </span><span id="local-6989586621690826919"><span class="annot"><span class="annottext">lift :: forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; Handler m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">lift</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
ReaderT HandlerCtx (ExceptT QErr m) a -&gt; Handler m a
</span><a href="Hasura.Server.App.html#Handler"><span class="hs-identifier hs-var">Handler</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span id="local-6989586621690828081"><span id="local-6989586621690828082"><span class="annot"><a href="Hasura.Server.App.html#runHandler"><span class="hs-identifier hs-type">runHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Limits.html#HasResourceLimits"><span class="hs-identifier hs-type">HasResourceLimits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828082"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadBaseControl</span></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828082"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#HandlerCtx"><span class="hs-identifier hs-type">HandlerCtx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#Handler"><span class="hs-identifier hs-type">Handler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828082"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828081"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690828082"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828081"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-151"></span><span id="runHandler"><span class="annot"><span class="annottext">runHandler :: forall (m :: * -&gt; *) a.
(HasResourceLimits m, MonadBaseControl IO m) =&gt;
HandlerCtx -&gt; Handler m a -&gt; m (Either QErr a)
</span><a href="Hasura.Server.App.html#runHandler"><span class="hs-identifier hs-var hs-var">runHandler</span></a></span></span><span> </span><span id="local-6989586621690826906"><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826906"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.App.html#Handler"><span class="hs-identifier hs-type">Handler</span></a></span><span> </span><span id="local-6989586621690826905"><span class="annot"><span class="annottext">ReaderT HandlerCtx (ExceptT QErr m) a
</span><a href="#local-6989586621690826905"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-152"></span><span>  </span><span id="local-6989586621690826904"><span class="annot"><span class="annottext">ResourceLimits
</span><a href="#local-6989586621690826904"><span class="hs-identifier hs-var">handlerLimit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). HasResourceLimits m =&gt; m ResourceLimits
</span><a href="Hasura.Server.Limits.html#askHTTPHandlerLimit"><span class="hs-identifier hs-var">askHTTPHandlerLimit</span></a></span><span>
</span><span id="line-153"></span><span>  </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runReaderT</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826906"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ResourceLimits
-&gt; forall (m :: * -&gt; *) a.
   (MonadBaseControl IO m, MonadError QErr m) =&gt;
   m a -&gt; m a
</span><a href="Hasura.Server.Limits.html#runResourceLimits"><span class="hs-identifier hs-var">runResourceLimits</span></a></span><span> </span><span class="annot"><span class="annottext">ResourceLimits
</span><a href="#local-6989586621690826904"><span class="hs-identifier hs-var">handlerLimit</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT HandlerCtx (ExceptT QErr m) a
</span><a href="#local-6989586621690826905"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-keyword">data</span><span> </span><span id="APIResp"><span class="annot"><a href="Hasura.Server.App.html#APIResp"><span class="hs-identifier hs-var">APIResp</span></a></span></span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="JSONResp"><span class="annot"><a href="Hasura.Server.App.html#JSONResp"><span class="hs-identifier hs-var">JSONResp</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.HTTP.html#HttpResponse"><span class="hs-identifier hs-type">HttpResponse</span></a></span><span> </span><span class="annot"><a href="Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RawResp"><span class="annot"><a href="Hasura.Server.App.html#RawResp"><span class="hs-identifier hs-var">RawResp</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.HTTP.html#HttpResponse"><span class="hs-identifier hs-type">HttpResponse</span></a></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-type">BL.ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-comment">-- | API request handlers for different endpoints</span><span>
</span><span id="line-160"></span><span class="hs-keyword">data</span><span> </span><span id="APIHandler"><span class="annot"><a href="Hasura.Server.App.html#APIHandler"><span class="hs-identifier hs-var">APIHandler</span></a></span></span><span> </span><span id="local-6989586621690826898"><span class="annot"><a href="#local-6989586621690826898"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621690826897"><span class="annot"><a href="#local-6989586621690826897"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-comment">-- | A simple GET request</span><span>
</span><span id="line-162"></span><span>  </span><span id="local-6989586621690828057"><span id="local-6989586621690828058"><span id="AHGet"><span class="annot"><a href="Hasura.Server.App.html#AHGet"><span class="hs-identifier hs-var">AHGet</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.App.html#Handler"><span class="hs-identifier hs-type">Handler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828058"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogGraphQLInfo"><span class="hs-identifier hs-type">HttpLogGraphQLInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#APIResp"><span class="hs-identifier hs-type">APIResp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#APIHandler"><span class="hs-identifier hs-type">APIHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828058"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828057"><span class="hs-identifier hs-type">void</span></a></span></span></span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-comment">-- | A simple POST request that expects a request body from which an 'a' can be extracted</span><span>
</span><span id="line-164"></span><span>  </span><span id="local-6989586621690826894"><span id="local-6989586621690826895"><span id="AHPost"><span class="annot"><a href="Hasura.Server.App.html#AHPost"><span class="hs-identifier hs-var">AHPost</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621690826895"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#Handler"><span class="hs-identifier hs-type">Handler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690826894"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogGraphQLInfo"><span class="hs-identifier hs-type">HttpLogGraphQLInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#APIResp"><span class="hs-identifier hs-type">APIResp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#APIHandler"><span class="hs-identifier hs-type">APIHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690826894"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690826895"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-comment">-- | A general GraphQL request (query or mutation) for which the content of the query</span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-comment">-- is made available to the handler for authentication.</span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-comment">-- This is a more specific version of the 'AHPost' constructor.</span><span>
</span><span id="line-168"></span><span>  </span><span id="local-6989586621690826892"><span id="AHGraphQLRequest"><span class="annot"><a href="Hasura.Server.App.html#AHGraphQLRequest"><span class="hs-identifier hs-var">AHGraphQLRequest</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#ReqsText"><span class="hs-identifier hs-type">GH.ReqsText</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#Handler"><span class="hs-identifier hs-type">Handler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690826892"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogGraphQLInfo"><span class="hs-identifier hs-type">HttpLogGraphQLInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#APIResp"><span class="hs-identifier hs-type">APIResp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#APIHandler"><span class="hs-identifier hs-type">APIHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690826892"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#ReqsText"><span class="hs-identifier hs-type">GH.ReqsText</span></a></span></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="annot"><a href="Hasura.Server.App.html#boolToText"><span class="hs-identifier hs-type">boolToText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-171"></span><span id="boolToText"><span class="annot"><span class="annottext">boolToText :: Bool -&gt; Text
</span><a href="Hasura.Server.App.html#boolToText"><span class="hs-identifier hs-var hs-var">boolToText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a -&gt; Bool -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">bool</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;false&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;true&quot;</span></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="annot"><a href="Hasura.Server.App.html#isAdminSecretSet"><span class="hs-identifier hs-type">isAdminSecretSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Auth.html#AuthMode"><span class="hs-identifier hs-type">AuthMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-174"></span><span id="isAdminSecretSet"><span class="annot"><span class="annottext">isAdminSecretSet :: AuthMode -&gt; Text
</span><a href="Hasura.Server.App.html#isAdminSecretSet"><span class="hs-identifier hs-var hs-var">isAdminSecretSet</span></a></span></span><span> </span><span class="annot"><span class="annottext">AuthMode
</span><a href="Hasura.Server.Auth.html#AMNoAuth"><span class="hs-identifier hs-var">AMNoAuth</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Text
</span><a href="Hasura.Server.App.html#boolToText"><span class="hs-identifier hs-var">boolToText</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-175"></span><span class="annot"><a href="Hasura.Server.App.html#isAdminSecretSet"><span class="hs-identifier hs-var">isAdminSecretSet</span></a></span><span> </span><span class="annot"><span class="annottext">AuthMode
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Text
</span><a href="Hasura.Server.App.html#boolToText"><span class="hs-identifier hs-var">boolToText</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span id="local-6989586621690828062"><span class="annot"><a href="Hasura.Server.App.html#mkGetHandler"><span class="hs-identifier hs-type">mkGetHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#Handler"><span class="hs-identifier hs-type">Handler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828062"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogGraphQLInfo"><span class="hs-identifier hs-type">HttpLogGraphQLInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#APIResp"><span class="hs-identifier hs-type">APIResp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#APIHandler"><span class="hs-identifier hs-type">APIHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828062"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-178"></span><span id="mkGetHandler"><span class="annot"><span class="annottext">mkGetHandler :: forall (m :: * -&gt; *).
Handler m (HttpLogGraphQLInfo, APIResp) -&gt; APIHandler m ()
</span><a href="Hasura.Server.App.html#mkGetHandler"><span class="hs-identifier hs-var hs-var">mkGetHandler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) void.
Handler m (HttpLogGraphQLInfo, APIResp) -&gt; APIHandler m void
</span><a href="Hasura.Server.App.html#AHGet"><span class="hs-identifier hs-var">AHGet</span></a></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span id="local-6989586621690828055"><span id="local-6989586621690828056"><span class="annot"><a href="Hasura.Server.App.html#mkPostHandler"><span class="hs-identifier hs-type">mkPostHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621690828056"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#Handler"><span class="hs-identifier hs-type">Handler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828055"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogGraphQLInfo"><span class="hs-identifier hs-type">HttpLogGraphQLInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#APIResp"><span class="hs-identifier hs-type">APIResp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#APIHandler"><span class="hs-identifier hs-type">APIHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828055"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828056"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-181"></span><span id="mkPostHandler"><span class="annot"><span class="annottext">mkPostHandler :: forall a (m :: * -&gt; *).
(a -&gt; Handler m (HttpLogGraphQLInfo, APIResp)) -&gt; APIHandler m a
</span><a href="Hasura.Server.App.html#mkPostHandler"><span class="hs-identifier hs-var hs-var">mkPostHandler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(a -&gt; Handler m (HttpLogGraphQLInfo, APIResp)) -&gt; APIHandler m a
</span><a href="Hasura.Server.App.html#AHPost"><span class="hs-identifier hs-var">AHPost</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span id="local-6989586621690828053"><span class="annot"><a href="Hasura.Server.App.html#mkGQLRequestHandler"><span class="hs-identifier hs-type">mkGQLRequestHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#ReqsText"><span class="hs-identifier hs-type">GH.ReqsText</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#Handler"><span class="hs-identifier hs-type">Handler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828053"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogGraphQLInfo"><span class="hs-identifier hs-type">HttpLogGraphQLInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#APIResp"><span class="hs-identifier hs-type">APIResp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#APIHandler"><span class="hs-identifier hs-type">APIHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828053"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#ReqsText"><span class="hs-identifier hs-type">GH.ReqsText</span></a></span></span><span>
</span><span id="line-184"></span><span id="mkGQLRequestHandler"><span class="annot"><span class="annottext">mkGQLRequestHandler :: forall (m :: * -&gt; *).
(ReqsText -&gt; Handler m (HttpLogGraphQLInfo, APIResp))
-&gt; APIHandler m ReqsText
</span><a href="Hasura.Server.App.html#mkGQLRequestHandler"><span class="hs-identifier hs-var hs-var">mkGQLRequestHandler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(ReqsText -&gt; Handler m (HttpLogGraphQLInfo, APIResp))
-&gt; APIHandler m ReqsText
</span><a href="Hasura.Server.App.html#AHGraphQLRequest"><span class="hs-identifier hs-var">AHGraphQLRequest</span></a></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span id="local-6989586621690828051"><span id="local-6989586621690828052"><span class="annot"><a href="Hasura.Server.App.html#mkAPIRespHandler"><span class="hs-identifier hs-type">mkAPIRespHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828052"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621690828051"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#Handler"><span class="hs-identifier hs-type">Handler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828052"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.HTTP.html#HttpResponse"><span class="hs-identifier hs-type">HttpResponse</span></a></span><span> </span><span class="annot"><a href="Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621690828051"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#Handler"><span class="hs-identifier hs-type">Handler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828052"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.App.html#APIResp"><span class="hs-identifier hs-type">APIResp</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-187"></span><span id="mkAPIRespHandler"><span class="annot"><span class="annottext">mkAPIRespHandler :: forall (m :: * -&gt; *) a.
Functor m =&gt;
(a -&gt; Handler m (HttpResponse EncJSON)) -&gt; a -&gt; Handler m APIResp
</span><a href="Hasura.Server.App.html#mkAPIRespHandler"><span class="hs-identifier hs-var hs-var">mkAPIRespHandler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HttpResponse EncJSON -&gt; APIResp
</span><a href="Hasura.Server.App.html#JSONResp"><span class="hs-identifier hs-var">JSONResp</span></a></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span id="local-6989586621690828044"><span id="local-6989586621690828045"><span id="local-6989586621690828046"><span class="annot"><a href="Hasura.Server.App.html#mkGQLAPIRespHandler"><span class="hs-identifier hs-type">mkGQLAPIRespHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828046"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621690828045"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#Handler"><span class="hs-identifier hs-type">Handler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828046"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621690828044"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.HTTP.html#HttpResponse"><span class="hs-identifier hs-type">HttpResponse</span></a></span><span> </span><span class="annot"><a href="Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621690828045"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#Handler"><span class="hs-identifier hs-type">Handler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828046"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621690828044"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#APIResp"><span class="hs-identifier hs-type">APIResp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-193"></span><span id="mkGQLAPIRespHandler"><span class="annot"><span class="annottext">mkGQLAPIRespHandler :: forall (m :: * -&gt; *) a b.
Functor m =&gt;
(a -&gt; Handler m (b, HttpResponse EncJSON))
-&gt; a -&gt; Handler m (b, APIResp)
</span><a href="Hasura.Server.App.html#mkGQLAPIRespHandler"><span class="hs-identifier hs-var hs-var">mkGQLAPIRespHandler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HttpResponse EncJSON -&gt; APIResp
</span><a href="Hasura.Server.App.html#JSONResp"><span class="hs-identifier hs-var">JSONResp</span></a></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="annot"><a href="Hasura.Server.App.html#isMetadataEnabled"><span class="hs-identifier hs-type">isMetadataEnabled</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-196"></span><span id="isMetadataEnabled"><span class="annot"><span class="annottext">isMetadataEnabled :: AppContext -&gt; Bool
</span><a href="Hasura.Server.App.html#isMetadataEnabled"><span class="hs-identifier hs-var hs-var">isMetadataEnabled</span></a></span></span><span> </span><span id="local-6989586621690826874"><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621690826874"><span class="hs-identifier hs-var">ac</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Hashable a) =&gt; a -&gt; HashSet a -&gt; Bool
</span><span class="hs-identifier hs-var">S.member</span></span><span> </span><span class="annot"><span class="annottext">API
</span><a href="Hasura.Server.Init.Config.html#METADATA"><span class="hs-identifier hs-var">METADATA</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext -&gt; HashSet API
</span><a href="Hasura.App.State.html#acEnabledAPIs"><span class="hs-identifier hs-var">acEnabledAPIs</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621690826874"><span class="hs-identifier hs-var">ac</span></a></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="annot"><a href="Hasura.Server.App.html#isGraphQLEnabled"><span class="hs-identifier hs-type">isGraphQLEnabled</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-199"></span><span id="isGraphQLEnabled"><span class="annot"><span class="annottext">isGraphQLEnabled :: AppContext -&gt; Bool
</span><a href="Hasura.Server.App.html#isGraphQLEnabled"><span class="hs-identifier hs-var hs-var">isGraphQLEnabled</span></a></span></span><span> </span><span id="local-6989586621690826869"><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621690826869"><span class="hs-identifier hs-var">ac</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Hashable a) =&gt; a -&gt; HashSet a -&gt; Bool
</span><span class="hs-identifier hs-var">S.member</span></span><span> </span><span class="annot"><span class="annottext">API
</span><a href="Hasura.Server.Init.Config.html#GRAPHQL"><span class="hs-identifier hs-var">GRAPHQL</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext -&gt; HashSet API
</span><a href="Hasura.App.State.html#acEnabledAPIs"><span class="hs-identifier hs-var">acEnabledAPIs</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621690826869"><span class="hs-identifier hs-var">ac</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="annot"><a href="Hasura.Server.App.html#isPGDumpEnabled"><span class="hs-identifier hs-type">isPGDumpEnabled</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-202"></span><span id="isPGDumpEnabled"><span class="annot"><span class="annottext">isPGDumpEnabled :: AppContext -&gt; Bool
</span><a href="Hasura.Server.App.html#isPGDumpEnabled"><span class="hs-identifier hs-var hs-var">isPGDumpEnabled</span></a></span></span><span> </span><span id="local-6989586621690826866"><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621690826866"><span class="hs-identifier hs-var">ac</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Hashable a) =&gt; a -&gt; HashSet a -&gt; Bool
</span><span class="hs-identifier hs-var">S.member</span></span><span> </span><span class="annot"><span class="annottext">API
</span><a href="Hasura.Server.Init.Config.html#PGDUMP"><span class="hs-identifier hs-var">PGDUMP</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext -&gt; HashSet API
</span><a href="Hasura.App.State.html#acEnabledAPIs"><span class="hs-identifier hs-var">acEnabledAPIs</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621690826866"><span class="hs-identifier hs-var">ac</span></a></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="annot"><a href="Hasura.Server.App.html#isConfigEnabled"><span class="hs-identifier hs-type">isConfigEnabled</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-205"></span><span id="isConfigEnabled"><span class="annot"><span class="annottext">isConfigEnabled :: AppContext -&gt; Bool
</span><a href="Hasura.Server.App.html#isConfigEnabled"><span class="hs-identifier hs-var hs-var">isConfigEnabled</span></a></span></span><span> </span><span id="local-6989586621690826863"><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621690826863"><span class="hs-identifier hs-var">ac</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Hashable a) =&gt; a -&gt; HashSet a -&gt; Bool
</span><span class="hs-identifier hs-var">S.member</span></span><span> </span><span class="annot"><span class="annottext">API
</span><a href="Hasura.Server.Init.Config.html#CONFIG"><span class="hs-identifier hs-var">CONFIG</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext -&gt; HashSet API
</span><a href="Hasura.App.State.html#acEnabledAPIs"><span class="hs-identifier hs-var">acEnabledAPIs</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621690826863"><span class="hs-identifier hs-var">ac</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="annot"><a href="Hasura.Server.App.html#isDeveloperAPIEnabled"><span class="hs-identifier hs-type">isDeveloperAPIEnabled</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-208"></span><span id="isDeveloperAPIEnabled"><span class="annot"><span class="annottext">isDeveloperAPIEnabled :: AppContext -&gt; Bool
</span><a href="Hasura.Server.App.html#isDeveloperAPIEnabled"><span class="hs-identifier hs-var hs-var">isDeveloperAPIEnabled</span></a></span></span><span> </span><span id="local-6989586621690826860"><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621690826860"><span class="hs-identifier hs-var">ac</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Hashable a) =&gt; a -&gt; HashSet a -&gt; Bool
</span><span class="hs-identifier hs-var">S.member</span></span><span> </span><span class="annot"><span class="annottext">API
</span><a href="Hasura.Server.Init.Config.html#DEVELOPER"><span class="hs-identifier hs-var">DEVELOPER</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext -&gt; HashSet API
</span><a href="Hasura.App.State.html#acEnabledAPIs"><span class="hs-identifier hs-var">acEnabledAPIs</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621690826860"><span class="hs-identifier hs-var">ac</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">-- {-# SCC parseBody #-}</span><span>
</span><span id="line-211"></span><span id="local-6989586621690828035"><span id="local-6989586621690828037"><span class="annot"><a href="Hasura.Server.App.html#parseBody"><span class="hs-identifier hs-type">parseBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621690828037"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828035"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-type">BL.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690828035"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621690828037"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-212"></span><span id="parseBody"><span class="annot"><span class="annottext">parseBody :: forall a (m :: * -&gt; *).
(FromJSON a, MonadError QErr m) =&gt;
ByteString -&gt; m (Value, a)
</span><a href="Hasura.Server.App.html#parseBody"><span class="hs-identifier hs-var hs-var">parseBody</span></a></span></span><span> </span><span id="local-6989586621690826845"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690826845"><span class="hs-identifier hs-var">reqBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; ByteString -&gt; Either [Char] a
</span><span class="hs-identifier hs-var">eitherDecode'</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690826845"><span class="hs-identifier hs-var">reqBody</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621690826843"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621690826843"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#InvalidJSON"><span class="hs-identifier hs-var">InvalidJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621690826843"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621690826839"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621690826839"><span class="hs-identifier hs-var">jVal</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621690826839"><span class="hs-identifier hs-var">jVal</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *). (FromJSON a, QErrM m) =&gt; Value -&gt; m a
</span><a href="Hasura.Base.Error.html#decodeValue"><span class="hs-identifier hs-var">decodeValue</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621690826839"><span class="hs-identifier hs-var">jVal</span></a></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span id="local-6989586621690828021"><span class="annot"><a href="Hasura.Server.App.html#onlyAdmin"><span class="hs-identifier hs-type">onlyAdmin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828021"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.App.html#HandlerCtx"><span class="hs-identifier hs-type">HandlerCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828021"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690828021"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-218"></span><span id="onlyAdmin"><span class="annot"><span class="annottext">onlyAdmin :: forall (m :: * -&gt; *).
(MonadError QErr m, MonadReader HandlerCtx m) =&gt;
m ()
</span><a href="Hasura.Server.App.html#onlyAdmin"><span class="hs-identifier hs-var hs-var">onlyAdmin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-219"></span><span>  </span><span id="local-6989586621690826825"><span class="annot"><span class="annottext">RoleName
</span><a href="#local-6989586621690826825"><span class="hs-identifier hs-var">uRole</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UserInfo -&gt; RoleName
</span><a href="Hasura.Session.html#_uiRole"><span class="hs-identifier hs-var">_uiRole</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; UserInfo
</span><a href="Hasura.Server.App.html#hcUser"><span class="hs-identifier hs-var">hcUser</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoleName
</span><a href="#local-6989586621690826825"><span class="hs-identifier hs-var">uRole</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">RoleName
</span><a href="Hasura.Session.html#adminRoleName"><span class="hs-identifier hs-var">adminRoleName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#AccessDenied"><span class="hs-identifier hs-var">AccessDenied</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;You have to be an admin to access this endpoint&quot;</span></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span id="local-6989586621690828012"><span id="local-6989586621690828013"><span class="annot"><a href="Hasura.Server.App.html#setHeader"><span class="hs-identifier hs-type">setHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828013"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HTTP.Header</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Spock.ActionCtxT</span></span><span> </span><span class="annot"><a href="#local-6989586621690828012"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828013"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-224"></span><span id="setHeader"><span class="annot"><span class="annottext">setHeader :: forall (m :: * -&gt; *) ctx.
MonadIO m =&gt;
Header -&gt; ActionCtxT ctx m ()
</span><a href="Hasura.Server.App.html#setHeader"><span class="hs-identifier hs-var hs-var">setHeader</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621690826816"><span class="annot"><span class="annottext">HeaderName
</span><a href="#local-6989586621690826816"><span class="hs-identifier hs-var">headerName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826815"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690826815"><span class="hs-identifier hs-var">headerValue</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-225"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx.
MonadIO m =&gt;
Text -&gt; Text -&gt; ActionCtxT ctx m ()
</span><span class="hs-identifier hs-var">Spock.setHeader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier hs-var">bsToTxt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. CI s -&gt; s
</span><span class="hs-identifier hs-var">CI.original</span></span><span> </span><span class="annot"><span class="annottext">HeaderName
</span><a href="#local-6989586621690826816"><span class="hs-identifier hs-var">headerName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier hs-var">bsToTxt</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690826815"><span class="hs-identifier hs-var">headerValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="hs-comment">-- | Typeclass representing the metadata API authorization effect</span><span>
</span><span id="line-228"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828154"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="MonadMetadataApiAuthorization"><span class="annot"><a href="Hasura.Server.App.html#MonadMetadataApiAuthorization"><span class="hs-identifier hs-var">MonadMetadataApiAuthorization</span></a></span></span><span> </span><span id="local-6989586621690828154"><span class="annot"><a href="#local-6989586621690828154"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-229"></span><span>  </span><span id="authorizeV1QueryApi"><span class="annot"><a href="Hasura.Server.App.html#authorizeV1QueryApi"><span class="hs-identifier hs-type">authorizeV1QueryApi</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-230"></span><span>    </span><span class="annot"><a href="Hasura.Server.API.Query.html#RQLQuery"><span class="hs-identifier hs-type">RQLQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#HandlerCtx"><span class="hs-identifier hs-type">HandlerCtx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690828154"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span>  </span><span id="authorizeV1MetadataApi"><span class="annot"><a href="Hasura.Server.App.html#authorizeV1MetadataApi"><span class="hs-identifier hs-type">authorizeV1MetadataApi</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-233"></span><span>    </span><span class="annot"><a href="Hasura.Server.API.Metadata.html#RQLMetadata"><span class="hs-identifier hs-type">RQLMetadata</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#HandlerCtx"><span class="hs-identifier hs-type">HandlerCtx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690828154"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span>  </span><span id="authorizeV2QueryApi"><span class="annot"><a href="Hasura.Server.App.html#authorizeV2QueryApi"><span class="hs-identifier hs-type">authorizeV2QueryApi</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-236"></span><span>    </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQLQuery"><span class="hs-identifier hs-type">V2Q.RQLQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#HandlerCtx"><span class="hs-identifier hs-type">HandlerCtx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690828154"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621690828149"><span id="local-6989586621690828150"><span class="annot"><a href="Hasura.Server.App.html#MonadMetadataApiAuthorization"><span class="hs-identifier hs-type">MonadMetadataApiAuthorization</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828150"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#MonadMetadataApiAuthorization"><span class="hs-identifier hs-type">MonadMetadataApiAuthorization</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">ReaderT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828149"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828150"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-239"></span><span>  </span><span id="local-6989586621690826798"><span class="annot"><span class="annottext">authorizeV1QueryApi :: RQLQuery -&gt; HandlerCtx -&gt; ReaderT r m (Either QErr ())
</span><a href="#local-6989586621690826798"><span class="hs-identifier hs-var hs-var hs-var hs-var">authorizeV1QueryApi</span></a></span></span><span> </span><span id="local-6989586621690826797"><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690826797"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621690826796"><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826796"><span class="hs-identifier hs-var">hc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadMetadataApiAuthorization m =&gt;
RQLQuery -&gt; HandlerCtx -&gt; m (Either QErr ())
</span><a href="Hasura.Server.App.html#authorizeV1QueryApi"><span class="hs-identifier hs-var">authorizeV1QueryApi</span></a></span><span> </span><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690826797"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826796"><span class="hs-identifier hs-var">hc</span></a></span><span>
</span><span id="line-240"></span><span>  </span><span id="local-6989586621690826792"><span class="annot"><span class="annottext">authorizeV1MetadataApi :: RQLMetadata -&gt; HandlerCtx -&gt; ReaderT r m (Either QErr ())
</span><a href="#local-6989586621690826792"><span class="hs-identifier hs-var hs-var hs-var hs-var">authorizeV1MetadataApi</span></a></span></span><span> </span><span id="local-6989586621690826791"><span class="annot"><span class="annottext">RQLMetadata
</span><a href="#local-6989586621690826791"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621690826790"><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826790"><span class="hs-identifier hs-var">hc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadMetadataApiAuthorization m =&gt;
RQLMetadata -&gt; HandlerCtx -&gt; m (Either QErr ())
</span><a href="Hasura.Server.App.html#authorizeV1MetadataApi"><span class="hs-identifier hs-var">authorizeV1MetadataApi</span></a></span><span> </span><span class="annot"><span class="annottext">RQLMetadata
</span><a href="#local-6989586621690826791"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826790"><span class="hs-identifier hs-var">hc</span></a></span><span>
</span><span id="line-241"></span><span>  </span><span id="local-6989586621690826786"><span class="annot"><span class="annottext">authorizeV2QueryApi :: RQLQuery -&gt; HandlerCtx -&gt; ReaderT r m (Either QErr ())
</span><a href="#local-6989586621690826786"><span class="hs-identifier hs-var hs-var hs-var hs-var">authorizeV2QueryApi</span></a></span></span><span> </span><span id="local-6989586621690826785"><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690826785"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621690826784"><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826784"><span class="hs-identifier hs-var">hc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadMetadataApiAuthorization m =&gt;
RQLQuery -&gt; HandlerCtx -&gt; m (Either QErr ())
</span><a href="Hasura.Server.App.html#authorizeV2QueryApi"><span class="hs-identifier hs-var">authorizeV2QueryApi</span></a></span><span> </span><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690826785"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826784"><span class="hs-identifier hs-var">hc</span></a></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621690828151"><span id="local-6989586621690828152"><span class="annot"><a href="Hasura.Server.App.html#MonadMetadataApiAuthorization"><span class="hs-identifier hs-type">MonadMetadataApiAuthorization</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828152"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#MonadMetadataApiAuthorization"><span class="hs-identifier hs-type">MonadMetadataApiAuthorization</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">ExceptT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828151"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690828152"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-244"></span><span>  </span><span id="local-6989586621690826773"><span class="annot"><span class="annottext">authorizeV1QueryApi :: RQLQuery -&gt; HandlerCtx -&gt; ExceptT e m (Either QErr ())
</span><a href="#local-6989586621690826773"><span class="hs-identifier hs-var hs-var hs-var hs-var">authorizeV1QueryApi</span></a></span></span><span> </span><span id="local-6989586621690826772"><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690826772"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621690826771"><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826771"><span class="hs-identifier hs-var">hc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadMetadataApiAuthorization m =&gt;
RQLQuery -&gt; HandlerCtx -&gt; m (Either QErr ())
</span><a href="Hasura.Server.App.html#authorizeV1QueryApi"><span class="hs-identifier hs-var">authorizeV1QueryApi</span></a></span><span> </span><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690826772"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826771"><span class="hs-identifier hs-var">hc</span></a></span><span>
</span><span id="line-245"></span><span>  </span><span id="local-6989586621690826767"><span class="annot"><span class="annottext">authorizeV1MetadataApi :: RQLMetadata -&gt; HandlerCtx -&gt; ExceptT e m (Either QErr ())
</span><a href="#local-6989586621690826767"><span class="hs-identifier hs-var hs-var hs-var hs-var">authorizeV1MetadataApi</span></a></span></span><span> </span><span id="local-6989586621690826766"><span class="annot"><span class="annottext">RQLMetadata
</span><a href="#local-6989586621690826766"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621690826765"><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826765"><span class="hs-identifier hs-var">hc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadMetadataApiAuthorization m =&gt;
RQLMetadata -&gt; HandlerCtx -&gt; m (Either QErr ())
</span><a href="Hasura.Server.App.html#authorizeV1MetadataApi"><span class="hs-identifier hs-var">authorizeV1MetadataApi</span></a></span><span> </span><span class="annot"><span class="annottext">RQLMetadata
</span><a href="#local-6989586621690826766"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826765"><span class="hs-identifier hs-var">hc</span></a></span><span>
</span><span id="line-246"></span><span>  </span><span id="local-6989586621690826761"><span class="annot"><span class="annottext">authorizeV2QueryApi :: RQLQuery -&gt; HandlerCtx -&gt; ExceptT e m (Either QErr ())
</span><a href="#local-6989586621690826761"><span class="hs-identifier hs-var hs-var hs-var hs-var">authorizeV2QueryApi</span></a></span></span><span> </span><span id="local-6989586621690826760"><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690826760"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621690826759"><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826759"><span class="hs-identifier hs-var">hc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadMetadataApiAuthorization m =&gt;
RQLQuery -&gt; HandlerCtx -&gt; m (Either QErr ())
</span><a href="Hasura.Server.App.html#authorizeV2QueryApi"><span class="hs-identifier hs-var">authorizeV2QueryApi</span></a></span><span> </span><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690826760"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826759"><span class="hs-identifier hs-var">hc</span></a></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621690827997"><span class="annot"><a href="Hasura.Server.App.html#MonadMetadataApiAuthorization"><span class="hs-identifier hs-type">MonadMetadataApiAuthorization</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827997"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#MonadMetadataApiAuthorization"><span class="hs-identifier hs-type">MonadMetadataApiAuthorization</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Tracing.html#TraceT"><span class="hs-identifier hs-type">Tracing.TraceT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827997"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-249"></span><span>  </span><span id="local-6989586621690826745"><span class="annot"><span class="annottext">authorizeV1QueryApi :: RQLQuery -&gt; HandlerCtx -&gt; TraceT m (Either QErr ())
</span><a href="#local-6989586621690826745"><span class="hs-identifier hs-var hs-var hs-var hs-var">authorizeV1QueryApi</span></a></span></span><span> </span><span id="local-6989586621690826744"><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690826744"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621690826743"><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826743"><span class="hs-identifier hs-var">hc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadMetadataApiAuthorization m =&gt;
RQLQuery -&gt; HandlerCtx -&gt; m (Either QErr ())
</span><a href="Hasura.Server.App.html#authorizeV1QueryApi"><span class="hs-identifier hs-var">authorizeV1QueryApi</span></a></span><span> </span><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690826744"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826743"><span class="hs-identifier hs-var">hc</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span id="local-6989586621690826739"><span class="annot"><span class="annottext">authorizeV1MetadataApi :: RQLMetadata -&gt; HandlerCtx -&gt; TraceT m (Either QErr ())
</span><a href="#local-6989586621690826739"><span class="hs-identifier hs-var hs-var hs-var hs-var">authorizeV1MetadataApi</span></a></span></span><span> </span><span id="local-6989586621690826738"><span class="annot"><span class="annottext">RQLMetadata
</span><a href="#local-6989586621690826738"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621690826737"><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826737"><span class="hs-identifier hs-var">hc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadMetadataApiAuthorization m =&gt;
RQLMetadata -&gt; HandlerCtx -&gt; m (Either QErr ())
</span><a href="Hasura.Server.App.html#authorizeV1MetadataApi"><span class="hs-identifier hs-var">authorizeV1MetadataApi</span></a></span><span> </span><span class="annot"><span class="annottext">RQLMetadata
</span><a href="#local-6989586621690826738"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826737"><span class="hs-identifier hs-var">hc</span></a></span><span>
</span><span id="line-251"></span><span>  </span><span id="local-6989586621690826733"><span class="annot"><span class="annottext">authorizeV2QueryApi :: RQLQuery -&gt; HandlerCtx -&gt; TraceT m (Either QErr ())
</span><a href="#local-6989586621690826733"><span class="hs-identifier hs-var hs-var hs-var hs-var">authorizeV2QueryApi</span></a></span></span><span> </span><span id="local-6989586621690826732"><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690826732"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621690826731"><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826731"><span class="hs-identifier hs-var">hc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadMetadataApiAuthorization m =&gt;
RQLQuery -&gt; HandlerCtx -&gt; m (Either QErr ())
</span><a href="Hasura.Server.App.html#authorizeV2QueryApi"><span class="hs-identifier hs-var">authorizeV2QueryApi</span></a></span><span> </span><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690826732"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826731"><span class="hs-identifier hs-var">hc</span></a></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-comment">-- | The config API (/v1alpha1/config) handler</span><span>
</span><span id="line-254"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827996"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="MonadConfigApiHandler"><span class="annot"><a href="Hasura.Server.App.html#MonadConfigApiHandler"><span class="hs-identifier hs-var">MonadConfigApiHandler</span></a></span></span><span> </span><span id="local-6989586621690827996"><span class="annot"><a href="#local-6989586621690827996"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-255"></span><span>  </span><span id="runConfigApiHandler"><span class="annot"><a href="Hasura.Server.App.html#runConfigApiHandler"><span class="hs-identifier hs-type">runConfigApiHandler</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-256"></span><span>    </span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-257"></span><span>    </span><span class="annot"><a href="Hasura.App.State.html#AppEnv"><span class="hs-identifier hs-type">AppEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-258"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Spock.SpockCtxT</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621690827996"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span id="local-6989586621690827992"><span id="local-6989586621690827993"><span id="local-6989586621690827994"><span class="annot"><a href="Hasura.Server.App.html#mapActionT"><span class="hs-identifier hs-type">mapActionT</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827994"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827993"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621690827994"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MTC.StT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Spock.ActionCtxT</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621690827992"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690827993"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MTC.StT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Spock.ActionCtxT</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621690827992"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-263"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Spock.ActionT</span></span><span> </span><span class="annot"><a href="#local-6989586621690827994"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827992"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-264"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Spock.ActionT</span></span><span> </span><span class="annot"><a href="#local-6989586621690827993"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827992"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-265"></span><span id="mapActionT"><span class="annot"><span class="annottext">mapActionT :: forall (m :: * -&gt; *) (n :: * -&gt; *) a.
(Monad m, Monad n) =&gt;
(m (StT (ActionCtxT ()) a) -&gt; n (StT (ActionCtxT ()) a))
-&gt; ActionT m a -&gt; ActionT n a
</span><a href="Hasura.Server.App.html#mapActionT"><span class="hs-identifier hs-var hs-var">mapActionT</span></a></span></span><span> </span><span id="local-6989586621690826715"><span class="annot"><span class="annottext">m (StT (ActionCtxT ()) a) -&gt; n (StT (ActionCtxT ()) a)
</span><a href="#local-6989586621690826715"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621690826714"><span class="annot"><span class="annottext">ActionT m a
</span><a href="#local-6989586621690826714"><span class="hs-identifier hs-var">tma</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
m (StT t a) -&gt; t m a
</span><span class="hs-identifier hs-var">MTC.restoreT</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
(Run t -&gt; m a) -&gt; t m a
</span><span class="hs-identifier hs-var">MTC.liftWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621690826710"><span class="annot"><span class="annottext">Run (ActionCtxT ())
</span><a href="#local-6989586621690826710"><span class="hs-identifier hs-var">run</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (StT (ActionCtxT ()) a) -&gt; n (StT (ActionCtxT ()) a)
</span><a href="#local-6989586621690826715"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Run (ActionCtxT ())
</span><a href="#local-6989586621690826710"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">ActionT m a
</span><a href="#local-6989586621690826714"><span class="hs-identifier hs-var">tma</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="annot"><a href="Hasura.Server.App.html#mkSpockAction"><span class="hs-identifier hs-type">mkSpockAction</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621690827971"><span class="annot"><a href="#local-6989586621690827971"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621690827970"><span class="annot"><a href="#local-6989586621690827970"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827971"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-270"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadBaseControl</span></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827971"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-271"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621690827970"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-272"></span><span>    </span><span class="annot"><a href="Hasura.Server.Auth.html#UserAuthentication"><span class="hs-identifier hs-type">UserAuthentication</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Tracing.html#TraceT"><span class="hs-identifier hs-type">Tracing.TraceT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827971"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-273"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLog"><span class="hs-identifier hs-type">HttpLog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827971"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-274"></span><span>    </span><span class="annot"><a href="Hasura.Tracing.html#HasReporter"><span class="hs-identifier hs-type">Tracing.HasReporter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827971"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-275"></span><span>    </span><span class="annot"><a href="Hasura.Server.Limits.html#HasResourceLimits"><span class="hs-identifier hs-type">HasResourceLimits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827971"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-277"></span><span>  </span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-278"></span><span>  </span><span class="annot"><a href="Hasura.App.State.html#AppEnv"><span class="hs-identifier hs-type">AppEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-comment">-- | `QErr` JSON encoder function</span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-comment">-- | `QErr` modifier</span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-283"></span><span>  </span><span class="annot"><a href="Hasura.Server.App.html#APIHandler"><span class="hs-identifier hs-type">APIHandler</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Tracing.html#TraceT"><span class="hs-identifier hs-type">Tracing.TraceT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827971"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621690827970"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-284"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Spock.ActionT</span></span><span> </span><span class="annot"><a href="#local-6989586621690827971"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span id="mkSpockAction"><span class="annot"><span class="annottext">mkSpockAction :: forall (m :: * -&gt; *) a.
(MonadIO m, MonadBaseControl IO m, FromJSON a,
 UserAuthentication (TraceT m), HttpLog m, HasReporter m,
 HasResourceLimits m) =&gt;
AppContext
-&gt; AppEnv
-&gt; (Bool -&gt; QErr -&gt; Value)
-&gt; (QErr -&gt; QErr)
-&gt; APIHandler (TraceT m) a
-&gt; ActionT m ()
</span><a href="Hasura.Server.App.html#mkSpockAction"><span class="hs-identifier hs-var hs-var">mkSpockAction</span></a></span></span><span> </span><span id="local-6989586621690826611"><span class="annot"><span class="annottext">appCtx :: AppContext
</span><a href="#local-6989586621690826611"><span class="hs-identifier hs-var">appCtx</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621690826588"><span id="local-6989586621690826589"><span id="local-6989586621690826590"><span id="local-6989586621690826591"><span id="local-6989586621690826592"><span id="local-6989586621690826593"><span id="local-6989586621690826594"><span id="local-6989586621690826595"><span id="local-6989586621690826596"><span id="local-6989586621690826597"><span id="local-6989586621690826598"><span id="local-6989586621690826599"><span id="local-6989586621690826600"><span id="local-6989586621690826601"><span id="local-6989586621690826602"><span id="local-6989586621690826603"><span id="local-6989586621690826604"><span id="local-6989586621690826605"><span id="local-6989586621690826606"><span id="local-6989586621690826607"><span id="local-6989586621690826608"><span id="local-6989586621690826609"><span class="annot"><span class="annottext">HashSet ExperimentalFeature
HashSet API
Environment
Refined NonNegative Int
Refined NonNegative Milliseconds
Refined Positive Int
StreamQueriesOptions
NamingCase
RemoteSchemaPermissions
InferFunctionPermissions
SQLGenCtx
CorsConfig
MetadataDefaults
SchemaCacheRef
AuthMode
ResponseInternalErrorsConfig
OptionalInterval
TelemetryStatus
AllowListStatus
ConsoleStatus
acSchemaPollInterval :: AppContext -&gt; OptionalInterval
acAsyncActionsFetchInterval :: AppContext -&gt; OptionalInterval
acEventsFetchBatchSize :: AppContext -&gt; Refined NonNegative Int
acEventsFetchInterval :: AppContext -&gt; Refined NonNegative Milliseconds
acEventsHttpPoolSize :: AppContext -&gt; Refined Positive Int
acEnableTelemetry :: AppContext -&gt; TelemetryStatus
acConsoleStatus :: AppContext -&gt; ConsoleStatus
acCorsConfig :: AppContext -&gt; CorsConfig
acStreamQueryOptions :: AppContext -&gt; StreamQueriesOptions
acLiveQueryOptions :: AppContext -&gt; StreamQueriesOptions
acMetadataDefaults :: AppContext -&gt; MetadataDefaults
acDefaultNamingConvention :: AppContext -&gt; NamingCase
acExperimentalFeatures :: AppContext -&gt; HashSet ExperimentalFeature
acFunctionPermsCtx :: AppContext -&gt; InferFunctionPermissions
acRemoteSchemaPermsCtx :: AppContext -&gt; RemoteSchemaPermissions
acEnvironment :: AppContext -&gt; Environment
acResponseInternalErrorsConfig :: AppContext -&gt; ResponseInternalErrorsConfig
acEnableAllowlist :: AppContext -&gt; AllowListStatus
acSQLGenCtx :: AppContext -&gt; SQLGenCtx
acAuthMode :: AppContext -&gt; AuthMode
acCacheRef :: AppContext -&gt; SchemaCacheRef
acSchemaPollInterval :: OptionalInterval
acAsyncActionsFetchInterval :: OptionalInterval
acEventsFetchBatchSize :: Refined NonNegative Int
acEventsFetchInterval :: Refined NonNegative Milliseconds
acEventsHttpPoolSize :: Refined Positive Int
acEnableTelemetry :: TelemetryStatus
acConsoleStatus :: ConsoleStatus
acCorsConfig :: CorsConfig
acStreamQueryOptions :: StreamQueriesOptions
acLiveQueryOptions :: StreamQueriesOptions
acMetadataDefaults :: MetadataDefaults
acDefaultNamingConvention :: NamingCase
acExperimentalFeatures :: HashSet ExperimentalFeature
acFunctionPermsCtx :: InferFunctionPermissions
acRemoteSchemaPermsCtx :: RemoteSchemaPermissions
acEnvironment :: Environment
acResponseInternalErrorsConfig :: ResponseInternalErrorsConfig
acEnableAllowlist :: AllowListStatus
acEnabledAPIs :: HashSet API
acSQLGenCtx :: SQLGenCtx
acAuthMode :: AuthMode
acCacheRef :: SchemaCacheRef
acEnabledAPIs :: AppContext -&gt; HashSet API
</span><a href="Hasura.App.State.html#acSchemaPollInterval"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621690826566"><span class="annot"><span class="annottext">appEnv :: AppEnv
</span><a href="#local-6989586621690826566"><span class="hs-identifier hs-var">appEnv</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Hasura.App.State.html#AppEnv"><span class="hs-identifier hs-type">AppEnv</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621690826538"><span id="local-6989586621690826539"><span id="local-6989586621690826540"><span id="local-6989586621690826541"><span id="local-6989586621690826542"><span id="local-6989586621690826543"><span id="local-6989586621690826544"><span id="local-6989586621690826545"><span id="local-6989586621690826546"><span id="local-6989586621690826547"><span id="local-6989586621690826548"><span id="local-6989586621690826549"><span id="local-6989586621690826550"><span id="local-6989586621690826551"><span id="local-6989586621690826552"><span id="local-6989586621690826553"><span id="local-6989586621690826554"><span id="local-6989586621690826555"><span id="local-6989586621690826556"><span id="local-6989586621690826557"><span id="local-6989586621690826558"><span id="local-6989586621690826559"><span id="local-6989586621690826560"><span id="local-6989586621690826561"><span id="local-6989586621690826562"><span id="local-6989586621690826563"><span id="local-6989586621690826564"><span class="annot"><span class="annottext">Maybe Text
SamplingPolicy
PGPool
ConnParams
TxIsolation
TMVar MetadataResourceVersion
Refined NonNegative Seconds
Manager
ServerMetrics
PrometheusMetrics
ShutdownLatch
EventingMode
ReadOnlyMode
MaintenanceMode ()
InstanceId
LockedEventsCtx
LoggingSettings
HostPreference
ConnectionOptions
WSConnectionInitTimeout
KeepAliveDelay
Port
SubscriptionsState
Loggers
FeatureFlag -&gt; IO Bool
appEnvCheckFeatureFlag :: AppEnv -&gt; FeatureFlag -&gt; IO Bool
appEnvGracefulShutdownTimeout :: AppEnv -&gt; Refined NonNegative Seconds
appEnvWebSocketConnectionInitTimeout :: AppEnv -&gt; WSConnectionInitTimeout
appEnvWebSocketKeepAlive :: AppEnv -&gt; KeepAliveDelay
appEnvConnectionOptions :: AppEnv -&gt; ConnectionOptions
appEnvConsoleSentryDsn :: AppEnv -&gt; Maybe Text
appEnvConsoleAssetsDir :: AppEnv -&gt; Maybe Text
appEnvTxIso :: AppEnv -&gt; TxIsolation
appEnvConnParams :: AppEnv -&gt; ConnParams
appEnvLockedEventsCtx :: AppEnv -&gt; LockedEventsCtx
appEnvSubscriptionState :: AppEnv -&gt; SubscriptionsState
appEnvTraceSamplingPolicy :: AppEnv -&gt; SamplingPolicy
appEnvPrometheusMetrics :: AppEnv -&gt; PrometheusMetrics
appEnvMetaVersionRef :: AppEnv -&gt; TMVar MetadataResourceVersion
appEnvShutdownLatch :: AppEnv -&gt; ShutdownLatch
appEnvServerMetrics :: AppEnv -&gt; ServerMetrics
appEnvEnableReadOnlyMode :: AppEnv -&gt; ReadOnlyMode
appEnvEventingMode :: AppEnv -&gt; EventingMode
appEnvLoggingSettings :: AppEnv -&gt; LoggingSettings
appEnvEnableMaintenanceMode :: AppEnv -&gt; MaintenanceMode ()
appEnvInstanceId :: AppEnv -&gt; InstanceId
appEnvMetadataVersionRef :: AppEnv -&gt; TMVar MetadataResourceVersion
appEnvLoggers :: AppEnv -&gt; Loggers
appEnvManager :: AppEnv -&gt; Manager
appEnvMetadataDbPool :: AppEnv -&gt; PGPool
appEnvHost :: AppEnv -&gt; HostPreference
appEnvPort :: AppEnv -&gt; Port
appEnvCheckFeatureFlag :: FeatureFlag -&gt; IO Bool
appEnvGracefulShutdownTimeout :: Refined NonNegative Seconds
appEnvWebSocketConnectionInitTimeout :: WSConnectionInitTimeout
appEnvWebSocketKeepAlive :: KeepAliveDelay
appEnvConnectionOptions :: ConnectionOptions
appEnvConsoleSentryDsn :: Maybe Text
appEnvConsoleAssetsDir :: Maybe Text
appEnvTxIso :: TxIsolation
appEnvConnParams :: ConnParams
appEnvLockedEventsCtx :: LockedEventsCtx
appEnvSubscriptionState :: SubscriptionsState
appEnvTraceSamplingPolicy :: SamplingPolicy
appEnvPrometheusMetrics :: PrometheusMetrics
appEnvMetaVersionRef :: TMVar MetadataResourceVersion
appEnvShutdownLatch :: ShutdownLatch
appEnvServerMetrics :: ServerMetrics
appEnvEnableReadOnlyMode :: ReadOnlyMode
appEnvEventingMode :: EventingMode
appEnvLoggingSettings :: LoggingSettings
appEnvEnableMaintenanceMode :: MaintenanceMode ()
appEnvInstanceId :: InstanceId
appEnvMetadataVersionRef :: TMVar MetadataResourceVersion
appEnvLoggers :: Loggers
appEnvManager :: Manager
appEnvMetadataDbPool :: PGPool
appEnvHost :: HostPreference
appEnvPort :: Port
</span><a href="Hasura.App.State.html#appEnvCheckFeatureFlag"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621690826510"><span class="annot"><span class="annottext">Bool -&gt; QErr -&gt; Value
</span><a href="#local-6989586621690826510"><span class="hs-identifier hs-var">qErrEncoder</span></a></span></span><span> </span><span id="local-6989586621690826509"><span class="annot"><span class="annottext">QErr -&gt; QErr
</span><a href="#local-6989586621690826509"><span class="hs-identifier hs-var">qErrModifier</span></a></span></span><span> </span><span id="local-6989586621690826508"><span class="annot"><span class="annottext">APIHandler (TraceT m) a
</span><a href="#local-6989586621690826508"><span class="hs-identifier hs-var">apiHandler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-286"></span><span>  </span><span id="local-6989586621690826507"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690826507"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx. MonadIO m =&gt; ActionCtxT ctx m Request
</span><span class="hs-identifier hs-var">Spock.request</span></span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690826505"><span class="annot"><span class="annottext">origHeaders :: [Header]
</span><a href="#local-6989586621690826505"><span class="hs-identifier hs-var hs-var">origHeaders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; [Header]
</span><span class="hs-identifier hs-var">Wai.requestHeaders</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690826507"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-288"></span><span>      </span><span id="local-6989586621690826503"><span class="annot"><span class="annottext">ipAddress :: IpAddress
</span><a href="#local-6989586621690826503"><span class="hs-identifier hs-var hs-var">ipAddress</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; IpAddress
</span><a href="Network.Wai.Extended.html#getSourceFromFallback"><span class="hs-identifier hs-var">Wai.getSourceFromFallback</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690826507"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-289"></span><span>      </span><span id="local-6989586621690826501"><span class="annot"><span class="annottext">pathInfo :: ByteString
</span><a href="#local-6989586621690826501"><span class="hs-identifier hs-var hs-var">pathInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><span class="hs-identifier hs-var">Wai.rawPathInfo</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690826507"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-comment">-- Bytes are actually read from the socket here. Time this.</span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621690826499"><span class="annot"><span class="annottext">DiffTime
</span><a href="#local-6989586621690826499"><span class="hs-identifier hs-var">ioWaitTime</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826498"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690826498"><span class="hs-identifier hs-var">reqBody</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; m a -&gt; m (DiffTime, a)
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier hs-var">withElapsedTime</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; IO ByteString
</span><span class="hs-identifier hs-var">Wai.strictRequestBody</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690826507"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621690826494"><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621690826494"><span class="hs-identifier hs-var">requestId</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826493"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826493"><span class="hs-identifier hs-var">headers</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadIO m =&gt;
[Header] -&gt; m (RequestId, [Header])
</span><a href="Hasura.Server.Types.html#getRequestId"><span class="hs-identifier hs-var">getRequestId</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826505"><span class="hs-identifier hs-var">origHeaders</span></a></span><span>
</span><span id="line-295"></span><span>  </span><span id="local-6989586621690826491"><span class="annot"><span class="annottext">Maybe TraceContext
</span><a href="#local-6989586621690826491"><span class="hs-identifier hs-var">tracingCtx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Header] -&gt; IO (Maybe TraceContext)
</span><a href="Hasura.Tracing.html#extractB3HttpContext"><span class="hs-identifier hs-var">Tracing.extractB3HttpContext</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826493"><span class="hs-identifier hs-var">headers</span></a></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621690826489"><span class="hs-identifier hs-type">runTraceT</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-298"></span><span>        </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621690827902"><span class="annot"><a href="#local-6989586621690827902"><span class="hs-identifier hs-type">m1</span></a></span></span><span> </span><span id="local-6989586621690827901"><span class="annot"><a href="#local-6989586621690827901"><span class="hs-identifier hs-type">a1</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-299"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827902"><span class="hs-identifier hs-type">m1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadBaseControl</span></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827902"><span class="hs-identifier hs-type">m1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Tracing.html#HasReporter"><span class="hs-identifier hs-type">Tracing.HasReporter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827902"><span class="hs-identifier hs-type">m1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-300"></span><span>        </span><span class="annot"><a href="Hasura.Tracing.html#TraceT"><span class="hs-identifier hs-type">Tracing.TraceT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827902"><span class="hs-identifier hs-type">m1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827901"><span class="hs-identifier hs-type">a1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-301"></span><span>        </span><span class="annot"><a href="#local-6989586621690827902"><span class="hs-identifier hs-type">m1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827901"><span class="hs-identifier hs-type">a1</span></a></span><span>
</span><span id="line-302"></span><span>      </span><span id="local-6989586621690826489"><span class="annot"><span class="annottext">runTraceT :: forall (m1 :: * -&gt; *) a1.
(MonadIO m1, MonadBaseControl IO m1, HasReporter m1) =&gt;
TraceT m1 a1 -&gt; m1 a1
</span><a href="#local-6989586621690826489"><span class="hs-identifier hs-var hs-var">runTraceT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-303"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(HasReporter m, MonadIO m, MonadBaseControl IO m) =&gt;
SamplingPolicy -&gt; Text -&gt; TraceT m a -&gt; m a
</span><a href="Hasura.Tracing.html#runTraceT"><span class="hs-identifier hs-var">Tracing.runTraceT</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadIO m, MonadBaseControl IO m, HasReporter m) =&gt;
TraceContext -&gt; SamplingPolicy -&gt; Text -&gt; TraceT m a -&gt; m a
</span><a href="Hasura.Tracing.html#runTraceTInContext"><span class="hs-identifier hs-var">Tracing.runTraceTInContext</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TraceContext
</span><a href="#local-6989586621690826491"><span class="hs-identifier hs-var">tracingCtx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>          </span><span class="annot"><span class="annottext">SamplingPolicy
</span><a href="#local-6989586621690826549"><span class="hs-identifier hs-var">appEnvTraceSamplingPolicy</span></a></span><span>
</span><span id="line-305"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. IsString a =&gt; [Char] -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; [Char]
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-var">B8.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690826501"><span class="hs-identifier hs-var">pathInfo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span>      </span><span id="local-6989586621690826474"><span class="annot"><span class="annottext">getInfo :: Maybe ReqsText
-&gt; ActionCtxT
     () (TraceT m) (UserInfo, [Header], HandlerCtx, Bool, ExtraUserInfo)
</span><a href="#local-6989586621690826474"><span class="hs-identifier hs-var hs-var">getInfo</span></a></span></span><span> </span><span id="local-6989586621690826473"><span class="annot"><span class="annottext">Maybe ReqsText
</span><a href="#local-6989586621690826473"><span class="hs-identifier hs-var">parsedRequest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-308"></span><span>        </span><span id="local-6989586621690826472"><span class="annot"><span class="annottext">Either QErr (UserInfo, Maybe UTCTime, [Header], ExtraUserInfo)
</span><a href="#local-6989586621690826472"><span class="hs-identifier hs-var">authenticationResp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
UserAuthentication m =&gt;
Logger Hasura
-&gt; Manager
-&gt; [Header]
-&gt; AuthMode
-&gt; Maybe ReqsText
-&gt; m (Either
        QErr (UserInfo, Maybe UTCTime, [Header], ExtraUserInfo))
</span><a href="Hasura.Server.Auth.html#resolveUserInfo"><span class="hs-identifier hs-var">resolveUserInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Loggers -&gt; Logger Hasura
</span><a href="Hasura.App.State.html#_lsLogger"><span class="hs-identifier hs-var">_lsLogger</span></a></span><span> </span><span class="annot"><span class="annottext">Loggers
</span><a href="#local-6989586621690826560"><span class="hs-identifier hs-var">appEnvLoggers</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621690826561"><span class="hs-identifier hs-var">appEnvManager</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826493"><span class="hs-identifier hs-var">headers</span></a></span><span> </span><span class="annot"><span class="annottext">AuthMode
</span><a href="#local-6989586621690826608"><span class="hs-identifier hs-var">acAuthMode</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ReqsText
</span><a href="#local-6989586621690826473"><span class="hs-identifier hs-var">parsedRequest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>        </span><span id="local-6989586621690826469"><span class="annot"><span class="annottext">(UserInfo, Maybe UTCTime, [Header], ExtraUserInfo)
</span><a href="#local-6989586621690826469"><span class="hs-identifier hs-var">authInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e a.
Applicative m =&gt;
Either e a -&gt; (e -&gt; m a) -&gt; m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier hs-var">onLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Either QErr (UserInfo, Maybe UTCTime, [Header], ExtraUserInfo)
</span><a href="#local-6989586621690826472"><span class="hs-identifier hs-var">authenticationResp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m3 :: * -&gt; *) a3 ctx.
(MonadIO m3, HttpLog m3) =&gt;
Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; Bool
-&gt; [Header]
-&gt; ExtraUserInfo
-&gt; QErr
-&gt; ActionCtxT ctx m3 a3
</span><a href="#local-6989586621690826467"><span class="hs-identifier hs-var">logErrorAndResp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621690826494"><span class="hs-identifier hs-var">requestId</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690826507"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690826498"><span class="hs-identifier hs-var">reqBody</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826505"><span class="hs-identifier hs-var">origHeaders</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text -&gt; ExtraUserInfo
</span><a href="Hasura.Session.html#ExtraUserInfo"><span class="hs-identifier hs-var">ExtraUserInfo</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">QErr -&gt; QErr
</span><a href="#local-6989586621690826509"><span class="hs-identifier hs-var">qErrModifier</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621690826465"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690826465"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe UTCTime
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826464"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826464"><span class="hs-identifier hs-var">authHeaders</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826463"><span class="annot"><span class="annottext">ExtraUserInfo
</span><a href="#local-6989586621690826463"><span class="hs-identifier hs-var">extraUserInfo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(UserInfo, Maybe UTCTime, [Header], ExtraUserInfo)
</span><a href="#local-6989586621690826469"><span class="hs-identifier hs-var">authInfo</span></a></span><span>
</span><span id="line-311"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-312"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690826465"><span class="hs-identifier hs-var">userInfo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-313"></span><span>            </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826464"><span class="hs-identifier hs-var">authHeaders</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-314"></span><span>            </span><span class="annot"><span class="annottext">AppContext
-&gt; AppEnv
-&gt; UserInfo
-&gt; [Header]
-&gt; RequestId
-&gt; IpAddress
-&gt; HandlerCtx
</span><a href="Hasura.Server.App.html#HandlerCtx"><span class="hs-identifier hs-var">HandlerCtx</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621690826611"><span class="hs-identifier hs-var">appCtx</span></a></span><span> </span><span class="annot"><span class="annottext">AppEnv
</span><a href="#local-6989586621690826566"><span class="hs-identifier hs-var">appEnv</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690826465"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826493"><span class="hs-identifier hs-var">headers</span></a></span><span> </span><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621690826494"><span class="hs-identifier hs-var">requestId</span></a></span><span> </span><span class="annot"><span class="annottext">IpAddress
</span><a href="#local-6989586621690826503"><span class="hs-identifier hs-var">ipAddress</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-315"></span><span>            </span><span class="annot"><span class="annottext">RoleName -&gt; ResponseInternalErrorsConfig -&gt; Bool
</span><a href="Hasura.Server.Init.Config.html#shouldIncludeInternal"><span class="hs-identifier hs-var">shouldIncludeInternal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UserInfo -&gt; RoleName
</span><a href="Hasura.Session.html#_uiRole"><span class="hs-identifier hs-var">_uiRole</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690826465"><span class="hs-identifier hs-var">userInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ResponseInternalErrorsConfig
</span><a href="#local-6989586621690826604"><span class="hs-identifier hs-var">acResponseInternalErrorsConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-316"></span><span>            </span><span class="annot"><span class="annottext">ExtraUserInfo
</span><a href="#local-6989586621690826463"><span class="hs-identifier hs-var">extraUserInfo</span></a></span><span>
</span><span id="line-317"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (n :: * -&gt; *) a.
(Monad m, Monad n) =&gt;
(m (StT (ActionCtxT ()) a) -&gt; n (StT (ActionCtxT ()) a))
-&gt; ActionT m a -&gt; ActionT n a
</span><a href="Hasura.Server.App.html#mapActionT"><span class="hs-identifier hs-var">mapActionT</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m1 :: * -&gt; *) a1.
(MonadIO m1, MonadBaseControl IO m1, HasReporter m1) =&gt;
TraceT m1 a1 -&gt; m1 a1
</span><a href="#local-6989586621690826489"><span class="hs-identifier hs-var">runTraceT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-320"></span><span>    </span><span class="hs-comment">-- Add the request ID to the tracing metadata so that we</span><span>
</span><span id="line-321"></span><span>    </span><span class="hs-comment">-- can correlate requests and traces</span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadTrace m =&gt; TracingMetadata -&gt; m ()
</span><a href="Hasura.Tracing.html#attachMetadata"><span class="hs-identifier hs-var">Tracing.attachMetadata</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;request_id&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RequestId -&gt; Text
</span><a href="Hasura.Server.Types.html#unRequestId"><span class="hs-identifier hs-var">unRequestId</span></a></span><span> </span><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621690826494"><span class="hs-identifier hs-var">requestId</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621690826459"><span class="annot"><span class="annottext">DiffTime
</span><a href="#local-6989586621690826459"><span class="hs-identifier hs-var">serviceTime</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621690826458"><span class="annot"><span class="annottext">Either QErr (HttpLogGraphQLInfo, APIResp)
</span><a href="#local-6989586621690826458"><span class="hs-identifier hs-var">result</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826457"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690826457"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826456"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826456"><span class="hs-identifier hs-var">authHeaders</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826455"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690826455"><span class="hs-identifier hs-var">includeInternal</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826454"><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621690826454"><span class="hs-identifier hs-var">queryJSON</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826453"><span class="annot"><span class="annottext">ExtraUserInfo
</span><a href="#local-6989586621690826453"><span class="hs-identifier hs-var">extraUserInfo</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; m a -&gt; m (DiffTime, a)
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier hs-var">withElapsedTime</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">APIHandler (TraceT m) a
</span><a href="#local-6989586621690826508"><span class="hs-identifier hs-var">apiHandler</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-325"></span><span>      </span><span class="hs-comment">-- in the case of a simple get/post we don't have to send the webhook anything</span><span>
</span><span id="line-326"></span><span>      </span><span class="annot"><a href="Hasura.Server.App.html#AHGet"><span class="hs-identifier hs-type">AHGet</span></a></span><span> </span><span id="local-6989586621690826452"><span class="annot"><span class="annottext">Handler (TraceT m) (HttpLogGraphQLInfo, APIResp)
</span><a href="#local-6989586621690826452"><span class="hs-identifier hs-var">handler</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-327"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621690826451"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690826451"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826450"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826450"><span class="hs-identifier hs-var">authHeaders</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826449"><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826449"><span class="hs-identifier hs-var">handlerState</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826448"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690826448"><span class="hs-identifier hs-var">includeInternal</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826447"><span class="annot"><span class="annottext">ExtraUserInfo
</span><a href="#local-6989586621690826447"><span class="hs-identifier hs-var">extraUserInfo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe ReqsText
-&gt; ActionCtxT
     () (TraceT m) (UserInfo, [Header], HandlerCtx, Bool, ExtraUserInfo)
</span><a href="#local-6989586621690826474"><span class="hs-identifier hs-var">getInfo</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-328"></span><span>        </span><span id="local-6989586621690826446"><span class="annot"><span class="annottext">Either QErr (HttpLogGraphQLInfo, APIResp)
</span><a href="#local-6989586621690826446"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(HasResourceLimits m, MonadBaseControl IO m) =&gt;
HandlerCtx -&gt; Handler m a -&gt; m (Either QErr a)
</span><a href="Hasura.Server.App.html#runHandler"><span class="hs-identifier hs-var">runHandler</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826449"><span class="hs-identifier hs-var">handlerState</span></a></span><span> </span><span class="annot"><span class="annottext">Handler (TraceT m) (HttpLogGraphQLInfo, APIResp)
</span><a href="#local-6989586621690826452"><span class="hs-identifier hs-var">handler</span></a></span><span>
</span><span id="line-329"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either QErr (HttpLogGraphQLInfo, APIResp)
</span><a href="#local-6989586621690826446"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690826451"><span class="hs-identifier hs-var">userInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826450"><span class="hs-identifier hs-var">authHeaders</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690826448"><span class="hs-identifier hs-var">includeInternal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExtraUserInfo
</span><a href="#local-6989586621690826447"><span class="hs-identifier hs-var">extraUserInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>      </span><span class="annot"><a href="Hasura.Server.App.html#AHPost"><span class="hs-identifier hs-type">AHPost</span></a></span><span> </span><span id="local-6989586621690826445"><span class="annot"><span class="annottext">a -&gt; Handler (TraceT m) (HttpLogGraphQLInfo, APIResp)
</span><a href="#local-6989586621690826445"><span class="hs-identifier hs-var">handler</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-331"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621690826444"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690826444"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826443"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826443"><span class="hs-identifier hs-var">authHeaders</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826442"><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826442"><span class="hs-identifier hs-var">handlerState</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826441"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690826441"><span class="hs-identifier hs-var">includeInternal</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826440"><span class="annot"><span class="annottext">ExtraUserInfo
</span><a href="#local-6989586621690826440"><span class="hs-identifier hs-var">extraUserInfo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe ReqsText
-&gt; ActionCtxT
     () (TraceT m) (UserInfo, [Header], HandlerCtx, Bool, ExtraUserInfo)
</span><a href="#local-6989586621690826474"><span class="hs-identifier hs-var">getInfo</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-332"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621690826439"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621690826439"><span class="hs-identifier hs-var">queryJSON</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826438"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690826438"><span class="hs-identifier hs-var">parsedReq</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-333"></span><span>          </span><span class="annot"><span class="annottext">forall e a. Except e a -&gt; Either e a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runExcept</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(FromJSON a, MonadError QErr m) =&gt;
ByteString -&gt; m (Value, a)
</span><a href="Hasura.Server.App.html#parseBody"><span class="hs-identifier hs-var">parseBody</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690826498"><span class="hs-identifier hs-var">reqBody</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e a.
Applicative m =&gt;
Either e a -&gt; (e -&gt; m a) -&gt; m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-operator hs-var">`onLeft`</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621690826436"><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621690826436"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-334"></span><span>            </span><span class="annot"><span class="annottext">forall (m3 :: * -&gt; *) a3 ctx.
(MonadIO m3, HttpLog m3) =&gt;
Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; Bool
-&gt; [Header]
-&gt; ExtraUserInfo
-&gt; QErr
-&gt; ActionCtxT ctx m3 a3
</span><a href="#local-6989586621690826467"><span class="hs-identifier hs-var">logErrorAndResp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690826444"><span class="hs-identifier hs-var">userInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621690826494"><span class="hs-identifier hs-var">requestId</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690826507"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690826498"><span class="hs-identifier hs-var">reqBody</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690826441"><span class="hs-identifier hs-var">includeInternal</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826505"><span class="hs-identifier hs-var">origHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">ExtraUserInfo
</span><a href="#local-6989586621690826440"><span class="hs-identifier hs-var">extraUserInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QErr -&gt; QErr
</span><a href="#local-6989586621690826509"><span class="hs-identifier hs-var">qErrModifier</span></a></span><span> </span><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621690826436"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>        </span><span id="local-6989586621690826435"><span class="annot"><span class="annottext">Either QErr (HttpLogGraphQLInfo, APIResp)
</span><a href="#local-6989586621690826435"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(HasResourceLimits m, MonadBaseControl IO m) =&gt;
HandlerCtx -&gt; Handler m a -&gt; m (Either QErr a)
</span><a href="Hasura.Server.App.html#runHandler"><span class="hs-identifier hs-var">runHandler</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826442"><span class="hs-identifier hs-var">handlerState</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Handler (TraceT m) (HttpLogGraphQLInfo, APIResp)
</span><a href="#local-6989586621690826445"><span class="hs-identifier hs-var">handler</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690826438"><span class="hs-identifier hs-var">parsedReq</span></a></span><span>
</span><span id="line-336"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either QErr (HttpLogGraphQLInfo, APIResp)
</span><a href="#local-6989586621690826435"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690826444"><span class="hs-identifier hs-var">userInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826443"><span class="hs-identifier hs-var">authHeaders</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690826441"><span class="hs-identifier hs-var">includeInternal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621690826439"><span class="hs-identifier hs-var">queryJSON</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExtraUserInfo
</span><a href="#local-6989586621690826440"><span class="hs-identifier hs-var">extraUserInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>      </span><span class="hs-comment">-- in this case we parse the request _first_ and then send the request to the webhook for auth</span><span>
</span><span id="line-338"></span><span>      </span><span class="annot"><a href="Hasura.Server.App.html#AHGraphQLRequest"><span class="hs-identifier hs-type">AHGraphQLRequest</span></a></span><span> </span><span id="local-6989586621690826418"><span class="annot"><span class="annottext">ReqsText -&gt; Handler (TraceT m) (HttpLogGraphQLInfo, APIResp)
</span><a href="#local-6989586621690826418"><span class="hs-identifier hs-var">handler</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-339"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621690826417"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621690826417"><span class="hs-identifier hs-var">queryJSON</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826416"><span class="annot"><span class="annottext">ReqsText
</span><a href="#local-6989586621690826416"><span class="hs-identifier hs-var">parsedReq</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-340"></span><span>          </span><span class="annot"><span class="annottext">forall e a. Except e a -&gt; Either e a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runExcept</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(FromJSON a, MonadError QErr m) =&gt;
ByteString -&gt; m (Value, a)
</span><a href="Hasura.Server.App.html#parseBody"><span class="hs-identifier hs-var">parseBody</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690826498"><span class="hs-identifier hs-var">reqBody</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e a.
Applicative m =&gt;
Either e a -&gt; (e -&gt; m a) -&gt; m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-operator hs-var">`onLeft`</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621690826415"><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621690826415"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-341"></span><span>            </span><span class="hs-comment">-- if the request fails to parse, call the webhook without a request body</span><span>
</span><span id="line-342"></span><span>            </span><span class="hs-comment">-- TODO should we signal this to the webhook somehow?</span><span>
</span><span id="line-343"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621690826414"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690826414"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Header]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HandlerCtx
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826413"><span class="annot"><span class="annottext">ExtraUserInfo
</span><a href="#local-6989586621690826413"><span class="hs-identifier hs-var">extraUserInfo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe ReqsText
-&gt; ActionCtxT
     () (TraceT m) (UserInfo, [Header], HandlerCtx, Bool, ExtraUserInfo)
</span><a href="#local-6989586621690826474"><span class="hs-identifier hs-var">getInfo</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-344"></span><span>            </span><span class="annot"><span class="annottext">forall (m3 :: * -&gt; *) a3 ctx.
(MonadIO m3, HttpLog m3) =&gt;
Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; Bool
-&gt; [Header]
-&gt; ExtraUserInfo
-&gt; QErr
-&gt; ActionCtxT ctx m3 a3
</span><a href="#local-6989586621690826467"><span class="hs-identifier hs-var">logErrorAndResp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690826414"><span class="hs-identifier hs-var">userInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621690826494"><span class="hs-identifier hs-var">requestId</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690826507"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690826498"><span class="hs-identifier hs-var">reqBody</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826505"><span class="hs-identifier hs-var">origHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">ExtraUserInfo
</span><a href="#local-6989586621690826413"><span class="hs-identifier hs-var">extraUserInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QErr -&gt; QErr
</span><a href="#local-6989586621690826509"><span class="hs-identifier hs-var">qErrModifier</span></a></span><span> </span><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621690826415"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621690826412"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690826412"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826411"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826411"><span class="hs-identifier hs-var">authHeaders</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826410"><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826410"><span class="hs-identifier hs-var">handlerState</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826409"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690826409"><span class="hs-identifier hs-var">includeInternal</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826408"><span class="annot"><span class="annottext">ExtraUserInfo
</span><a href="#local-6989586621690826408"><span class="hs-identifier hs-var">extraUserInfo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe ReqsText
-&gt; ActionCtxT
     () (TraceT m) (UserInfo, [Header], HandlerCtx, Bool, ExtraUserInfo)
</span><a href="#local-6989586621690826474"><span class="hs-identifier hs-var">getInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ReqsText
</span><a href="#local-6989586621690826416"><span class="hs-identifier hs-var">parsedReq</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span>        </span><span id="local-6989586621690826407"><span class="annot"><span class="annottext">Either QErr (HttpLogGraphQLInfo, APIResp)
</span><a href="#local-6989586621690826407"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(HasResourceLimits m, MonadBaseControl IO m) =&gt;
HandlerCtx -&gt; Handler m a -&gt; m (Either QErr a)
</span><a href="Hasura.Server.App.html#runHandler"><span class="hs-identifier hs-var">runHandler</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx
</span><a href="#local-6989586621690826410"><span class="hs-identifier hs-var">handlerState</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ReqsText -&gt; Handler (TraceT m) (HttpLogGraphQLInfo, APIResp)
</span><a href="#local-6989586621690826418"><span class="hs-identifier hs-var">handler</span></a></span><span> </span><span class="annot"><span class="annottext">ReqsText
</span><a href="#local-6989586621690826416"><span class="hs-identifier hs-var">parsedReq</span></a></span><span>
</span><span id="line-348"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either QErr (HttpLogGraphQLInfo, APIResp)
</span><a href="#local-6989586621690826407"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690826412"><span class="hs-identifier hs-var">userInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826411"><span class="hs-identifier hs-var">authHeaders</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690826409"><span class="hs-identifier hs-var">includeInternal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621690826417"><span class="hs-identifier hs-var">queryJSON</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExtraUserInfo
</span><a href="#local-6989586621690826408"><span class="hs-identifier hs-var">extraUserInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span>    </span><span class="hs-comment">-- apply the error modifier</span><span>
</span><span id="line-351"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690826406"><span class="annot"><span class="annottext">modResult :: Either QErr (HttpLogGraphQLInfo, APIResp)
</span><a href="#local-6989586621690826406"><span class="hs-identifier hs-var hs-var">modResult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a a' b. (a -&gt; a') -&gt; Either a b -&gt; Either a' b
</span><a href="Hasura.Server.Utils.html#fmapL"><span class="hs-identifier hs-var">fmapL</span></a></span><span> </span><span class="annot"><span class="annottext">QErr -&gt; QErr
</span><a href="#local-6989586621690826509"><span class="hs-identifier hs-var">qErrModifier</span></a></span><span> </span><span class="annot"><span class="annottext">Either QErr (HttpLogGraphQLInfo, APIResp)
</span><a href="#local-6989586621690826458"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span>    </span><span class="hs-comment">-- log and return result</span><span>
</span><span id="line-354"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either QErr (HttpLogGraphQLInfo, APIResp)
</span><a href="#local-6989586621690826406"><span class="hs-identifier hs-var">modResult</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-355"></span><span>      </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621690826404"><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621690826404"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-356"></span><span>        </span><span class="annot"><span class="annottext">forall (m3 :: * -&gt; *) a3 ctx.
(MonadIO m3, HttpLog m3) =&gt;
Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; Bool
-&gt; [Header]
-&gt; ExtraUserInfo
-&gt; QErr
-&gt; ActionCtxT ctx m3 a3
</span><a href="#local-6989586621690826467"><span class="hs-identifier hs-var">logErrorAndResp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690826457"><span class="hs-identifier hs-var">userInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621690826494"><span class="hs-identifier hs-var">requestId</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690826507"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690826498"><span class="hs-identifier hs-var">reqBody</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621690826454"><span class="hs-identifier hs-var">queryJSON</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690826455"><span class="hs-identifier hs-var">includeInternal</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826493"><span class="hs-identifier hs-var">headers</span></a></span><span> </span><span class="annot"><span class="annottext">ExtraUserInfo
</span><a href="#local-6989586621690826453"><span class="hs-identifier hs-var">extraUserInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621690826404"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-357"></span><span>      </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621690826403"><span class="annot"><span class="annottext">HttpLogGraphQLInfo
</span><a href="#local-6989586621690826403"><span class="hs-identifier hs-var">httpLogGraphQLInfo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826402"><span class="annot"><span class="annottext">APIResp
</span><a href="#local-6989586621690826402"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-358"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690826401"><span class="annot"><span class="annottext">httpLogMetadata :: HttpLogMetadata m
</span><a href="#local-6989586621690826401"><span class="hs-identifier hs-var hs-var">httpLogMetadata</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
HttpLog m =&gt;
HttpLogGraphQLInfo -&gt; ExtraUserInfo -&gt; HttpLogMetadata m
</span><a href="Hasura.Server.Logging.html#buildHttpLogMetadata"><span class="hs-identifier hs-var">buildHttpLogMetadata</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621690827971"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="annottext">HttpLogGraphQLInfo
</span><a href="#local-6989586621690826403"><span class="hs-identifier hs-var">httpLogGraphQLInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ExtraUserInfo
</span><a href="#local-6989586621690826453"><span class="hs-identifier hs-var">extraUserInfo</span></a></span><span>
</span><span id="line-359"></span><span>        </span><span class="annot"><span class="annottext">Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; APIResp
-&gt; Maybe (DiffTime, DiffTime)
-&gt; [Header]
-&gt; [Header]
-&gt; HttpLogMetadata m
-&gt; ActionT (TraceT m) ()
</span><a href="#local-6989586621690826399"><span class="hs-identifier hs-var">logSuccessAndResp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690826457"><span class="hs-identifier hs-var">userInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621690826494"><span class="hs-identifier hs-var">requestId</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690826507"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690826498"><span class="hs-identifier hs-var">reqBody</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621690826454"><span class="hs-identifier hs-var">queryJSON</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">APIResp
</span><a href="#local-6989586621690826402"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DiffTime
</span><a href="#local-6989586621690826499"><span class="hs-identifier hs-var">ioWaitTime</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DiffTime
</span><a href="#local-6989586621690826459"><span class="hs-identifier hs-var">serviceTime</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826505"><span class="hs-identifier hs-var">origHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826456"><span class="hs-identifier hs-var">authHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">HttpLogMetadata m
</span><a href="#local-6989586621690826401"><span class="hs-identifier hs-var">httpLogMetadata</span></a></span><span>
</span><span id="line-360"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-361"></span><span>    </span><span class="annot"><a href="#local-6989586621690826467"><span class="hs-identifier hs-type">logErrorAndResp</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-362"></span><span>      </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621690827886"><span class="annot"><a href="#local-6989586621690827886"><span class="hs-identifier hs-type">m3</span></a></span></span><span> </span><span id="local-6989586621690827884"><span class="annot"><a href="#local-6989586621690827884"><span class="hs-identifier hs-type">a3</span></a></span></span><span> </span><span id="local-6989586621690827885"><span class="annot"><a href="#local-6989586621690827885"><span class="hs-identifier hs-type">ctx</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-363"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827886"><span class="hs-identifier hs-type">m3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLog"><span class="hs-identifier hs-type">HttpLog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827886"><span class="hs-identifier hs-type">m3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-364"></span><span>      </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Hasura.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-365"></span><span>      </span><span class="annot"><a href="Hasura.Server.Types.html#RequestId"><span class="hs-identifier hs-type">RequestId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-366"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Wai.Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-367"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-type">BL.ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-368"></span><span>      </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-369"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">HTTP.Header</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-370"></span><span>      </span><span class="annot"><a href="Hasura.Session.html#ExtraUserInfo"><span class="hs-identifier hs-type">ExtraUserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-371"></span><span>      </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-372"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Spock.ActionCtxT</span></span><span> </span><span class="annot"><a href="#local-6989586621690827885"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827886"><span class="hs-identifier hs-type">m3</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827884"><span class="hs-identifier hs-type">a3</span></a></span><span>
</span><span id="line-373"></span><span>    </span><span id="local-6989586621690826467"><span class="annot"><span class="annottext">logErrorAndResp :: forall (m3 :: * -&gt; *) a3 ctx.
(MonadIO m3, HttpLog m3) =&gt;
Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; Bool
-&gt; [Header]
-&gt; ExtraUserInfo
-&gt; QErr
-&gt; ActionCtxT ctx m3 a3
</span><a href="#local-6989586621690826467"><span class="hs-identifier hs-var hs-var">logErrorAndResp</span></a></span></span><span> </span><span id="local-6989586621690826380"><span class="annot"><span class="annottext">Maybe UserInfo
</span><a href="#local-6989586621690826380"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span id="local-6989586621690826379"><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621690826379"><span class="hs-identifier hs-var">reqId</span></a></span></span><span> </span><span id="local-6989586621690826378"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690826378"><span class="hs-identifier hs-var">waiReq</span></a></span></span><span> </span><span id="local-6989586621690826377"><span class="annot"><span class="annottext">(ByteString, Maybe Value)
</span><a href="#local-6989586621690826377"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span id="local-6989586621690826376"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690826376"><span class="hs-identifier hs-var">includeInternal</span></a></span></span><span> </span><span id="local-6989586621690826375"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826375"><span class="hs-identifier hs-var">headers</span></a></span></span><span> </span><span id="local-6989586621690826374"><span class="annot"><span class="annottext">ExtraUserInfo
</span><a href="#local-6989586621690826374"><span class="hs-identifier hs-var">extraUserInfo</span></a></span></span><span> </span><span id="local-6989586621690826373"><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621690826373"><span class="hs-identifier hs-var">qErr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-374"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690826372"><span class="annot"><span class="annottext">httpLogMetadata :: HttpLogMetadata m3
</span><a href="#local-6989586621690826372"><span class="hs-identifier hs-var hs-var">httpLogMetadata</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
HttpLog m =&gt;
HttpLogGraphQLInfo -&gt; ExtraUserInfo -&gt; HttpLogMetadata m
</span><a href="Hasura.Server.Logging.html#buildHttpLogMetadata"><span class="hs-identifier hs-var">buildHttpLogMetadata</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621690827886"><span class="hs-identifier hs-type">m3</span></a></span><span> </span><span class="annot"><span class="annottext">HttpLogGraphQLInfo
</span><a href="Hasura.Server.Logging.html#emptyHttpLogGraphQLInfo"><span class="hs-identifier hs-var">emptyHttpLogGraphQLInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ExtraUserInfo
</span><a href="#local-6989586621690826374"><span class="hs-identifier hs-var">extraUserInfo</span></a></span><span>
</span><span id="line-375"></span><span>          </span><span id="local-6989586621690826370"><span class="annot"><span class="annottext">jsonResponse :: ByteString
</span><a href="#local-6989586621690826370"><span class="hs-identifier hs-var hs-var">jsonResponse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">J.encode</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; QErr -&gt; Value
</span><a href="#local-6989586621690826510"><span class="hs-identifier hs-var">qErrEncoder</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690826376"><span class="hs-identifier hs-var">includeInternal</span></a></span><span> </span><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621690826373"><span class="hs-identifier hs-var">qErr</span></a></span><span>
</span><span id="line-376"></span><span>          </span><span id="local-6989586621690826368"><span class="annot"><span class="annottext">contentLength :: Header
</span><a href="#local-6989586621690826368"><span class="hs-identifier hs-var hs-var">contentLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HeaderName
</span><span class="hs-string">&quot;Content-Length&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-var">B8.toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; ByteString
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-var">BB.toLazyByteString</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Builder
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-var">BB.int64Dec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int64
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-var">BL.length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690826370"><span class="hs-identifier hs-var">jsonResponse</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>          </span><span id="local-6989586621690826363"><span class="annot"><span class="annottext">allHeaders :: [Header]
</span><a href="#local-6989586621690826363"><span class="hs-identifier hs-var hs-var">allHeaders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Header
</span><a href="#local-6989586621690826368"><span class="hs-identifier hs-var">contentLength</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Header
</span><a href="Hasura.Server.Utils.html#jsonHeader"><span class="hs-identifier hs-var">jsonHeader</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-378"></span><span>      </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
HttpLog m =&gt;
Logger Hasura
-&gt; LoggingSettings
-&gt; Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; QErr
-&gt; [Header]
-&gt; HttpLogMetadata m
-&gt; m ()
</span><a href="Hasura.Server.Logging.html#logHttpError"><span class="hs-identifier hs-var">logHttpError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Loggers -&gt; Logger Hasura
</span><a href="Hasura.App.State.html#_lsLogger"><span class="hs-identifier hs-var">_lsLogger</span></a></span><span> </span><span class="annot"><span class="annottext">Loggers
</span><a href="#local-6989586621690826560"><span class="hs-identifier hs-var">appEnvLoggers</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LoggingSettings
</span><a href="#local-6989586621690826556"><span class="hs-identifier hs-var">appEnvLoggingSettings</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe UserInfo
</span><a href="#local-6989586621690826380"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621690826379"><span class="hs-identifier hs-var">reqId</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690826378"><span class="hs-identifier hs-var">waiReq</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString, Maybe Value)
</span><a href="#local-6989586621690826377"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621690826373"><span class="hs-identifier hs-var">qErr</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826375"><span class="hs-identifier hs-var">headers</span></a></span><span> </span><span class="annot"><span class="annottext">HttpLogMetadata m3
</span><a href="#local-6989586621690826372"><span class="hs-identifier hs-var">httpLogMetadata</span></a></span><span>
</span><span id="line-379"></span><span>      </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx.
MonadIO m =&gt;
Header -&gt; ActionCtxT ctx m ()
</span><a href="Hasura.Server.App.html#setHeader"><span class="hs-identifier hs-var">setHeader</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826363"><span class="hs-identifier hs-var">allHeaders</span></a></span><span>
</span><span id="line-380"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx.
MonadIO m =&gt;
Status -&gt; ActionCtxT ctx m ()
</span><span class="hs-identifier hs-var">Spock.setStatus</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">QErr -&gt; Status
</span><a href="Hasura.Base.Error.html#qeStatus"><span class="hs-identifier hs-var">qeStatus</span></a></span><span> </span><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621690826373"><span class="hs-identifier hs-var">qErr</span></a></span><span>
</span><span id="line-381"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx a.
MonadIO m =&gt;
ByteString -&gt; ActionCtxT ctx m a
</span><span class="hs-identifier hs-var">Spock.lazyBytes</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690826370"><span class="hs-identifier hs-var">jsonResponse</span></a></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span>    </span><span id="local-6989586621690826399"><span class="annot"><span class="annottext">logSuccessAndResp :: Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; APIResp
-&gt; Maybe (DiffTime, DiffTime)
-&gt; [Header]
-&gt; [Header]
-&gt; HttpLogMetadata m
-&gt; ActionT (TraceT m) ()
</span><a href="#local-6989586621690826399"><span class="hs-identifier hs-var hs-var">logSuccessAndResp</span></a></span></span><span> </span><span id="local-6989586621690826356"><span class="annot"><span class="annottext">Maybe UserInfo
</span><a href="#local-6989586621690826356"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span id="local-6989586621690826355"><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621690826355"><span class="hs-identifier hs-var">reqId</span></a></span></span><span> </span><span id="local-6989586621690826354"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690826354"><span class="hs-identifier hs-var">waiReq</span></a></span></span><span> </span><span id="local-6989586621690826353"><span class="annot"><span class="annottext">(ByteString, Maybe Value)
</span><a href="#local-6989586621690826353"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span id="local-6989586621690826352"><span class="annot"><span class="annottext">APIResp
</span><a href="#local-6989586621690826352"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span id="local-6989586621690826351"><span class="annot"><span class="annottext">Maybe (DiffTime, DiffTime)
</span><a href="#local-6989586621690826351"><span class="hs-identifier hs-var">qTime</span></a></span></span><span> </span><span id="local-6989586621690826350"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826350"><span class="hs-identifier hs-var">reqHeaders</span></a></span></span><span> </span><span id="local-6989586621690826349"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826349"><span class="hs-identifier hs-var">authHdrs</span></a></span></span><span> </span><span id="local-6989586621690826348"><span class="annot"><span class="annottext">HttpLogMetadata m
</span><a href="#local-6989586621690826348"><span class="hs-identifier hs-var">httpLoggingMetadata</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-384"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621690826347"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690826347"><span class="hs-identifier hs-var">respBytes</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826346"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826346"><span class="hs-identifier hs-var">respHeaders</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">APIResp
</span><a href="#local-6989586621690826352"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-385"></span><span>            </span><span class="annot"><a href="Hasura.Server.App.html#JSONResp"><span class="hs-identifier hs-type">JSONResp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.HTTP.html#HttpResponse"><span class="hs-identifier hs-type">HttpResponse</span></a></span><span> </span><span id="local-6989586621690826344"><span class="annot"><span class="annottext">EncJSON
</span><a href="#local-6989586621690826344"><span class="hs-identifier hs-var">encJson</span></a></span></span><span> </span><span id="local-6989586621690826343"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826343"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EncJSON -&gt; ByteString
</span><a href="Hasura.EncJSON.html#encJToLBS"><span class="hs-identifier hs-var">encJToLBS</span></a></span><span> </span><span class="annot"><span class="annottext">EncJSON
</span><a href="#local-6989586621690826344"><span class="hs-identifier hs-var">encJson</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Header
</span><a href="Hasura.Server.Utils.html#jsonHeader"><span class="hs-identifier hs-var">jsonHeader</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826343"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span>            </span><span class="annot"><a href="Hasura.Server.App.html#RawResp"><span class="hs-identifier hs-type">RawResp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.HTTP.html#HttpResponse"><span class="hs-identifier hs-type">HttpResponse</span></a></span><span> </span><span id="local-6989586621690826341"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690826341"><span class="hs-identifier hs-var">rawBytes</span></a></span></span><span> </span><span id="local-6989586621690826340"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826340"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690826341"><span class="hs-identifier hs-var">rawBytes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826340"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-387"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621690826339"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690826339"><span class="hs-identifier hs-var">compressedResp</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690826338"><span class="annot"><span class="annottext">EncodingType
</span><a href="#local-6989586621690826338"><span class="hs-identifier hs-var">encodingType</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Header] -&gt; ByteString -&gt; (ByteString, EncodingType)
</span><a href="Hasura.Server.Compression.html#compressResponse"><span class="hs-identifier hs-var">compressResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request -&gt; [Header]
</span><span class="hs-identifier hs-var">Wai.requestHeaders</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690826354"><span class="hs-identifier hs-var">waiReq</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690826347"><span class="hs-identifier hs-var">respBytes</span></a></span><span>
</span><span id="line-388"></span><span>          </span><span id="local-6989586621690826336"><span class="annot"><span class="annottext">encodingHeader :: [Header]
</span><a href="#local-6989586621690826336"><span class="hs-identifier hs-var hs-var">encodingHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; [a]
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybeToList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CompressionType -&gt; Header
</span><a href="Hasura.Server.Compression.html#contentEncodingHeader"><span class="hs-identifier hs-var">contentEncodingHeader</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EncodingType
</span><a href="#local-6989586621690826338"><span class="hs-identifier hs-var">encodingType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>          </span><span id="local-6989586621690826333"><span class="annot"><span class="annottext">reqIdHeader :: Header
</span><a href="#local-6989586621690826333"><span class="hs-identifier hs-var hs-var">reqIdHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. IsString a =&gt; a
</span><a href="Hasura.Server.Utils.html#requestIdHeader"><span class="hs-identifier hs-var">requestIdHeader</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier hs-var">txtToBs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RequestId -&gt; Text
</span><a href="Hasura.Server.Types.html#unRequestId"><span class="hs-identifier hs-var">unRequestId</span></a></span><span> </span><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621690826355"><span class="hs-identifier hs-var">reqId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>          </span><span id="local-6989586621690826330"><span class="annot"><span class="annottext">contentLength :: Header
</span><a href="#local-6989586621690826330"><span class="hs-identifier hs-var hs-var">contentLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HeaderName
</span><span class="hs-string">&quot;Content-Length&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-var">B8.toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; ByteString
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-var">BB.toLazyByteString</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Builder
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-var">BB.int64Dec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int64
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-var">BL.length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690826339"><span class="hs-identifier hs-var">compressedResp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>          </span><span id="local-6989586621690826329"><span class="annot"><span class="annottext">allRespHeaders :: [Header]
</span><a href="#local-6989586621690826329"><span class="hs-identifier hs-var hs-var">allRespHeaders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Header
</span><a href="#local-6989586621690826333"><span class="hs-identifier hs-var">reqIdHeader</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Header
</span><a href="#local-6989586621690826330"><span class="hs-identifier hs-var">contentLength</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826336"><span class="hs-identifier hs-var">encodingHeader</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826346"><span class="hs-identifier hs-var">respHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826349"><span class="hs-identifier hs-var">authHdrs</span></a></span><span>
</span><span id="line-392"></span><span>      </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
HttpLog m =&gt;
Logger Hasura
-&gt; LoggingSettings
-&gt; Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; ByteString
-&gt; ByteString
-&gt; Maybe (DiffTime, DiffTime)
-&gt; EncodingType
-&gt; [Header]
-&gt; HttpLogMetadata m
-&gt; m ()
</span><a href="Hasura.Server.Logging.html#logHttpSuccess"><span class="hs-identifier hs-var">logHttpSuccess</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Loggers -&gt; Logger Hasura
</span><a href="Hasura.App.State.html#_lsLogger"><span class="hs-identifier hs-var">_lsLogger</span></a></span><span> </span><span class="annot"><span class="annottext">Loggers
</span><a href="#local-6989586621690826560"><span class="hs-identifier hs-var">appEnvLoggers</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LoggingSettings
</span><a href="#local-6989586621690826556"><span class="hs-identifier hs-var">appEnvLoggingSettings</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe UserInfo
</span><a href="#local-6989586621690826356"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621690826355"><span class="hs-identifier hs-var">reqId</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690826354"><span class="hs-identifier hs-var">waiReq</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString, Maybe Value)
</span><a href="#local-6989586621690826353"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690826347"><span class="hs-identifier hs-var">respBytes</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690826339"><span class="hs-identifier hs-var">compressedResp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (DiffTime, DiffTime)
</span><a href="#local-6989586621690826351"><span class="hs-identifier hs-var">qTime</span></a></span><span> </span><span class="annot"><span class="annottext">EncodingType
</span><a href="#local-6989586621690826338"><span class="hs-identifier hs-var">encodingType</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826350"><span class="hs-identifier hs-var">reqHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">HttpLogMetadata m
</span><a href="#local-6989586621690826348"><span class="hs-identifier hs-var">httpLoggingMetadata</span></a></span><span>
</span><span id="line-393"></span><span>      </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx.
MonadIO m =&gt;
Header -&gt; ActionCtxT ctx m ()
</span><a href="Hasura.Server.App.html#setHeader"><span class="hs-identifier hs-var">setHeader</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690826329"><span class="hs-identifier hs-var">allRespHeaders</span></a></span><span>
</span><span id="line-394"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx a.
MonadIO m =&gt;
ByteString -&gt; ActionCtxT ctx m a
</span><span class="hs-identifier hs-var">Spock.lazyBytes</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690826339"><span class="hs-identifier hs-var">compressedResp</span></a></span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span id="local-6989586621690827852"><span class="annot"><a href="Hasura.Server.App.html#v1QueryHandler"><span class="hs-identifier hs-type">v1QueryHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-397"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827852"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-398"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827852"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-399"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadBaseControl</span></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827852"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-400"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#MonadMetadataApiAuthorization"><span class="hs-identifier hs-type">MonadMetadataApiAuthorization</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827852"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-401"></span><span>    </span><span class="annot"><a href="Hasura.Tracing.html#MonadTrace"><span class="hs-identifier hs-type">Tracing.MonadTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827852"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-402"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.App.html#HandlerCtx"><span class="hs-identifier hs-type">HandlerCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827852"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-403"></span><span>    </span><span class="annot"><a href="Hasura.Metadata.Class.html#MonadMetadataStorageQueryAPI"><span class="hs-identifier hs-type">MonadMetadataStorageQueryAPI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827852"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-404"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Source.html#MonadResolveSource"><span class="hs-identifier hs-type">MonadResolveSource</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827852"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-405"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Execute.Backend.html#MonadQueryTags"><span class="hs-identifier hs-type">EB.MonadQueryTags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827852"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-406"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.EventTrigger.html#MonadEventLogCleanup"><span class="hs-identifier hs-type">MonadEventLogCleanup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827852"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-407"></span><span>    </span><span class="annot"><a href="Hasura.Services.Network.html#ProvidesNetwork"><span class="hs-identifier hs-type">ProvidesNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827852"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-408"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-409"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.Query.html#RQLQuery"><span class="hs-identifier hs-type">RQLQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-410"></span><span>  </span><span class="annot"><a href="#local-6989586621690827852"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.HTTP.html#HttpResponse"><span class="hs-identifier hs-type">HttpResponse</span></a></span><span> </span><span class="annot"><a href="Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-411"></span><span id="v1QueryHandler"><span class="annot"><span class="annottext">v1QueryHandler :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m, MonadBaseControl IO m,
 MonadMetadataApiAuthorization m, MonadTrace m,
 MonadReader HandlerCtx m, MonadMetadataStorageQueryAPI m,
 MonadResolveSource m, MonadQueryTags m, MonadEventLogCleanup m,
 ProvidesNetwork m) =&gt;
RQLQuery -&gt; m (HttpResponse EncJSON)
</span><a href="Hasura.Server.App.html#v1QueryHandler"><span class="hs-identifier hs-var hs-var">v1QueryHandler</span></a></span></span><span> </span><span id="local-6989586621690826269"><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690826269"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-412"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. MonadError e m =&gt; m (Either e a) -&gt; m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier hs-var">liftEitherM</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadMetadataApiAuthorization m =&gt;
RQLQuery -&gt; HandlerCtx -&gt; m (Either QErr ())
</span><a href="Hasura.Server.App.html#authorizeV1QueryApi"><span class="hs-identifier hs-var">authorizeV1QueryApi</span></a></span><span> </span><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690826269"><span class="hs-identifier hs-var">query</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">ask</span></a></span><span>
</span><span id="line-413"></span><span>  </span><span id="local-6989586621690826266"><span class="annot"><span class="annottext">SchemaCacheRef
</span><a href="#local-6989586621690826266"><span class="hs-identifier hs-var">scRef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppContext -&gt; SchemaCacheRef
</span><a href="Hasura.App.State.html#acCacheRef"><span class="hs-identifier hs-var">acCacheRef</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppContext
</span><a href="Hasura.Server.App.html#hcAppContext"><span class="hs-identifier hs-var">hcAppContext</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>  </span><span id="local-6989586621690826265"><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621690826265"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Loggers -&gt; Logger Hasura
</span><a href="Hasura.App.State.html#_lsLogger"><span class="hs-identifier hs-var">_lsLogger</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">AppEnv -&gt; Loggers
</span><a href="Hasura.App.State.html#appEnvLoggers"><span class="hs-identifier hs-var">appEnvLoggers</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppEnv
</span><a href="Hasura.Server.App.html#hcAppEnv"><span class="hs-identifier hs-var">hcAppEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>  </span><span id="local-6989586621690826264"><span class="annot"><span class="annottext">EncJSON
</span><a href="#local-6989586621690826264"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a -&gt; Bool -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">bool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Logger Hasura -&gt; m (EncJSON, RebuildableSchemaCache)
</span><a href="#local-6989586621690826263"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621690826265"><span class="hs-identifier hs-var">logger</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadIO m, MonadBaseControl IO m) =&gt;
SchemaCacheRef
-&gt; Logger Hasura
-&gt; Maybe (TVar Bool)
-&gt; m (a, RebuildableSchemaCache)
-&gt; m a
</span><a href="Hasura.Server.SchemaCacheRef.html#withSchemaCacheUpdate"><span class="hs-identifier hs-var">withSchemaCacheUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCacheRef
</span><a href="#local-6989586621690826266"><span class="hs-identifier hs-var">scRef</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621690826265"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Logger Hasura -&gt; m (EncJSON, RebuildableSchemaCache)
</span><a href="#local-6989586621690826263"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621690826265"><span class="hs-identifier hs-var">logger</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RQLQuery -&gt; Bool
</span><a href="Hasura.Server.API.Query.html#queryModifiesSchemaCache"><span class="hs-identifier hs-var">queryModifiesSchemaCache</span></a></span><span> </span><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690826269"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-416"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [Header] -&gt; HttpResponse a
</span><a href="Hasura.HTTP.html#HttpResponse"><span class="hs-identifier hs-var">HttpResponse</span></a></span><span> </span><span class="annot"><span class="annottext">EncJSON
</span><a href="#local-6989586621690826264"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-417"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-418"></span><span>    </span><span id="local-6989586621690826263"><span class="annot"><span class="annottext">action :: Logger Hasura -&gt; m (EncJSON, RebuildableSchemaCache)
</span><a href="#local-6989586621690826263"><span class="hs-identifier hs-var hs-var">action</span></a></span></span><span> </span><span id="local-6989586621690826261"><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621690826261"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-419"></span><span>      </span><span id="local-6989586621690826260"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690826260"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; UserInfo
</span><a href="Hasura.Server.App.html#hcUser"><span class="hs-identifier hs-var">hcUser</span></a></span><span>
</span><span id="line-420"></span><span>      </span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621690826238"><span id="local-6989586621690826239"><span id="local-6989586621690826240"><span id="local-6989586621690826241"><span id="local-6989586621690826242"><span id="local-6989586621690826243"><span id="local-6989586621690826244"><span id="local-6989586621690826245"><span id="local-6989586621690826246"><span id="local-6989586621690826247"><span id="local-6989586621690826248"><span id="local-6989586621690826249"><span id="local-6989586621690826250"><span id="local-6989586621690826251"><span id="local-6989586621690826252"><span id="local-6989586621690826253"><span id="local-6989586621690826254"><span id="local-6989586621690826255"><span id="local-6989586621690826256"><span id="local-6989586621690826257"><span id="local-6989586621690826258"><span id="local-6989586621690826259"><span class="annot"><span class="annottext">HashSet ExperimentalFeature
HashSet API
Environment
Refined NonNegative Int
Refined NonNegative Milliseconds
Refined Positive Int
StreamQueriesOptions
NamingCase
RemoteSchemaPermissions
InferFunctionPermissions
SQLGenCtx
CorsConfig
MetadataDefaults
SchemaCacheRef
AuthMode
ResponseInternalErrorsConfig
OptionalInterval
TelemetryStatus
AllowListStatus
ConsoleStatus
acSchemaPollInterval :: OptionalInterval
acAsyncActionsFetchInterval :: OptionalInterval
acEventsFetchBatchSize :: Refined NonNegative Int
acEventsFetchInterval :: Refined NonNegative Milliseconds
acEventsHttpPoolSize :: Refined Positive Int
acEnableTelemetry :: TelemetryStatus
acConsoleStatus :: ConsoleStatus
acCorsConfig :: CorsConfig
acStreamQueryOptions :: StreamQueriesOptions
acLiveQueryOptions :: StreamQueriesOptions
acMetadataDefaults :: MetadataDefaults
acDefaultNamingConvention :: NamingCase
acExperimentalFeatures :: HashSet ExperimentalFeature
acFunctionPermsCtx :: InferFunctionPermissions
acRemoteSchemaPermsCtx :: RemoteSchemaPermissions
acEnvironment :: Environment
acResponseInternalErrorsConfig :: ResponseInternalErrorsConfig
acEnableAllowlist :: AllowListStatus
acEnabledAPIs :: HashSet API
acSQLGenCtx :: SQLGenCtx
acAuthMode :: AuthMode
acCacheRef :: SchemaCacheRef
acSchemaPollInterval :: AppContext -&gt; OptionalInterval
acAsyncActionsFetchInterval :: AppContext -&gt; OptionalInterval
acEventsFetchBatchSize :: AppContext -&gt; Refined NonNegative Int
acEventsFetchInterval :: AppContext -&gt; Refined NonNegative Milliseconds
acEventsHttpPoolSize :: AppContext -&gt; Refined Positive Int
acEnableTelemetry :: AppContext -&gt; TelemetryStatus
acConsoleStatus :: AppContext -&gt; ConsoleStatus
acCorsConfig :: AppContext -&gt; CorsConfig
acStreamQueryOptions :: AppContext -&gt; StreamQueriesOptions
acLiveQueryOptions :: AppContext -&gt; StreamQueriesOptions
acMetadataDefaults :: AppContext -&gt; MetadataDefaults
acDefaultNamingConvention :: AppContext -&gt; NamingCase
acExperimentalFeatures :: AppContext -&gt; HashSet ExperimentalFeature
acFunctionPermsCtx :: AppContext -&gt; InferFunctionPermissions
acRemoteSchemaPermsCtx :: AppContext -&gt; RemoteSchemaPermissions
acEnvironment :: AppContext -&gt; Environment
acResponseInternalErrorsConfig :: AppContext -&gt; ResponseInternalErrorsConfig
acEnableAllowlist :: AppContext -&gt; AllowListStatus
acSQLGenCtx :: AppContext -&gt; SQLGenCtx
acAuthMode :: AppContext -&gt; AuthMode
acCacheRef :: AppContext -&gt; SchemaCacheRef
acEnabledAPIs :: AppContext -&gt; HashSet API
</span><a href="#local-6989586621690826238"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppContext
</span><a href="Hasura.Server.App.html#hcAppContext"><span class="hs-identifier hs-var">hcAppContext</span></a></span><span>
</span><span id="line-421"></span><span>      </span><span id="local-6989586621690826237"><span class="annot"><span class="annottext">RebuildableSchemaCache
</span><a href="#local-6989586621690826237"><span class="hs-identifier hs-var">schemaCache</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCacheRef -&gt; IO (RebuildableSchemaCache, SchemaCacheVer)
</span><a href="Hasura.Server.SchemaCacheRef.html#readSchemaCacheRef"><span class="hs-identifier hs-var">readSchemaCacheRef</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCacheRef
</span><a href="#local-6989586621690826259"><span class="hs-identifier hs-var">acCacheRef</span></a></span><span>
</span><span id="line-422"></span><span>      </span><span id="local-6989586621690826236"><span class="annot"><span class="annottext">InstanceId
</span><a href="#local-6989586621690826236"><span class="hs-identifier hs-var">instanceId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppEnv -&gt; InstanceId
</span><a href="Hasura.App.State.html#appEnvInstanceId"><span class="hs-identifier hs-var">appEnvInstanceId</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppEnv
</span><a href="Hasura.Server.App.html#hcAppEnv"><span class="hs-identifier hs-var">hcAppEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span>      </span><span id="local-6989586621690826235"><span class="annot"><span class="annottext">MaintenanceMode ()
</span><a href="#local-6989586621690826235"><span class="hs-identifier hs-var">maintenanceMode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppEnv -&gt; MaintenanceMode ()
</span><a href="Hasura.App.State.html#appEnvEnableMaintenanceMode"><span class="hs-identifier hs-var">appEnvEnableMaintenanceMode</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppEnv
</span><a href="Hasura.Server.App.html#hcAppEnv"><span class="hs-identifier hs-var">hcAppEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span>      </span><span id="local-6989586621690826234"><span class="annot"><span class="annottext">EventingMode
</span><a href="#local-6989586621690826234"><span class="hs-identifier hs-var">eventingMode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppEnv -&gt; EventingMode
</span><a href="Hasura.App.State.html#appEnvEventingMode"><span class="hs-identifier hs-var">appEnvEventingMode</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppEnv
</span><a href="Hasura.Server.App.html#hcAppEnv"><span class="hs-identifier hs-var">hcAppEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span>      </span><span id="local-6989586621690826233"><span class="annot"><span class="annottext">ReadOnlyMode
</span><a href="#local-6989586621690826233"><span class="hs-identifier hs-var">readOnlyMode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppEnv -&gt; ReadOnlyMode
</span><a href="Hasura.App.State.html#appEnvEnableReadOnlyMode"><span class="hs-identifier hs-var">appEnvEnableReadOnlyMode</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppEnv
</span><a href="Hasura.Server.App.html#hcAppEnv"><span class="hs-identifier hs-var">hcAppEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>      </span><span id="local-6989586621690826232"><span class="annot"><span class="annottext">FeatureFlag -&gt; IO Bool
</span><a href="#local-6989586621690826232"><span class="hs-identifier hs-var">checkFeatureFlag</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppEnv -&gt; FeatureFlag -&gt; IO Bool
</span><a href="Hasura.App.State.html#appEnvCheckFeatureFlag"><span class="hs-identifier hs-var">appEnvCheckFeatureFlag</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppEnv
</span><a href="Hasura.Server.App.html#hcAppEnv"><span class="hs-identifier hs-var">hcAppEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690826231"><span class="annot"><span class="annottext">serverConfigCtx :: ServerConfigCtx
</span><a href="#local-6989586621690826231"><span class="hs-identifier hs-var hs-var">serverConfigCtx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-428"></span><span>            </span><span class="annot"><span class="annottext">InferFunctionPermissions
-&gt; RemoteSchemaPermissions
-&gt; SQLGenCtx
-&gt; MaintenanceMode ()
-&gt; HashSet ExperimentalFeature
-&gt; EventingMode
-&gt; ReadOnlyMode
-&gt; NamingCase
-&gt; MetadataDefaults
-&gt; (FeatureFlag -&gt; IO Bool)
-&gt; ServerConfigCtx
</span><a href="Hasura.Server.Types.html#ServerConfigCtx"><span class="hs-identifier hs-var">ServerConfigCtx</span></a></span><span>
</span><span id="line-429"></span><span>              </span><span class="annot"><span class="annottext">InferFunctionPermissions
</span><a href="#local-6989586621690826251"><span class="hs-identifier hs-var">acFunctionPermsCtx</span></a></span><span>
</span><span id="line-430"></span><span>              </span><span class="annot"><span class="annottext">RemoteSchemaPermissions
</span><a href="#local-6989586621690826252"><span class="hs-identifier hs-var">acRemoteSchemaPermsCtx</span></a></span><span>
</span><span id="line-431"></span><span>              </span><span class="annot"><span class="annottext">SQLGenCtx
</span><a href="#local-6989586621690826257"><span class="hs-identifier hs-var">acSQLGenCtx</span></a></span><span>
</span><span id="line-432"></span><span>              </span><span class="annot"><span class="annottext">MaintenanceMode ()
</span><a href="#local-6989586621690826235"><span class="hs-identifier hs-var">maintenanceMode</span></a></span><span>
</span><span id="line-433"></span><span>              </span><span class="annot"><span class="annottext">HashSet ExperimentalFeature
</span><a href="#local-6989586621690826250"><span class="hs-identifier hs-var">acExperimentalFeatures</span></a></span><span>
</span><span id="line-434"></span><span>              </span><span class="annot"><span class="annottext">EventingMode
</span><a href="#local-6989586621690826234"><span class="hs-identifier hs-var">eventingMode</span></a></span><span>
</span><span id="line-435"></span><span>              </span><span class="annot"><span class="annottext">ReadOnlyMode
</span><a href="#local-6989586621690826233"><span class="hs-identifier hs-var">readOnlyMode</span></a></span><span>
</span><span id="line-436"></span><span>              </span><span class="annot"><span class="annottext">NamingCase
</span><a href="#local-6989586621690826249"><span class="hs-identifier hs-var">acDefaultNamingConvention</span></a></span><span>
</span><span id="line-437"></span><span>              </span><span class="annot"><span class="annottext">MetadataDefaults
</span><a href="#local-6989586621690826248"><span class="hs-identifier hs-var">acMetadataDefaults</span></a></span><span>
</span><span id="line-438"></span><span>              </span><span class="annot"><span class="annottext">FeatureFlag -&gt; IO Bool
</span><a href="#local-6989586621690826232"><span class="hs-identifier hs-var">checkFeatureFlag</span></a></span><span>
</span><span id="line-439"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m, MonadTrace m, MonadBaseControl IO m,
 MonadMetadataStorageQueryAPI m, MonadResolveSource m,
 MonadQueryTags m, MonadEventLogCleanup m,
 ProvidesHasuraServices m) =&gt;
Environment
-&gt; Logger Hasura
-&gt; InstanceId
-&gt; UserInfo
-&gt; RebuildableSchemaCache
-&gt; ServerConfigCtx
-&gt; RQLQuery
-&gt; m (EncJSON, RebuildableSchemaCache)
</span><a href="Hasura.Server.API.Query.html#runQuery"><span class="hs-identifier hs-var">runQuery</span></a></span><span>
</span><span id="line-440"></span><span>        </span><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621690826253"><span class="hs-identifier hs-var">acEnvironment</span></a></span><span>
</span><span id="line-441"></span><span>        </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621690826261"><span class="hs-identifier hs-var">logger</span></a></span><span>
</span><span id="line-442"></span><span>        </span><span class="annot"><span class="annottext">InstanceId
</span><a href="#local-6989586621690826236"><span class="hs-identifier hs-var">instanceId</span></a></span><span>
</span><span id="line-443"></span><span>        </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690826260"><span class="hs-identifier hs-var">userInfo</span></a></span><span>
</span><span id="line-444"></span><span>        </span><span class="annot"><span class="annottext">RebuildableSchemaCache
</span><a href="#local-6989586621690826237"><span class="hs-identifier hs-var">schemaCache</span></a></span><span>
</span><span id="line-445"></span><span>        </span><span class="annot"><span class="annottext">ServerConfigCtx
</span><a href="#local-6989586621690826231"><span class="hs-identifier hs-var">serverConfigCtx</span></a></span><span>
</span><span id="line-446"></span><span>        </span><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690826269"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span id="local-6989586621690827837"><span class="annot"><a href="Hasura.Server.App.html#v1MetadataHandler"><span class="hs-identifier hs-type">v1MetadataHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-449"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827837"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-450"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827837"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-451"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadBaseControl</span></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827837"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-452"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.App.html#HandlerCtx"><span class="hs-identifier hs-type">HandlerCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827837"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-453"></span><span>    </span><span class="annot"><a href="Hasura.Tracing.html#MonadTrace"><span class="hs-identifier hs-type">Tracing.MonadTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827837"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-454"></span><span>    </span><span class="annot"><a href="Hasura.Metadata.Class.html#MonadMetadataStorageQueryAPI"><span class="hs-identifier hs-type">MonadMetadataStorageQueryAPI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827837"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-455"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Source.html#MonadResolveSource"><span class="hs-identifier hs-type">MonadResolveSource</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827837"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-456"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#MonadMetadataApiAuthorization"><span class="hs-identifier hs-type">MonadMetadataApiAuthorization</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827837"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-457"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.EventTrigger.html#MonadEventLogCleanup"><span class="hs-identifier hs-type">MonadEventLogCleanup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827837"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-458"></span><span>    </span><span class="annot"><a href="Hasura.Services.Network.html#ProvidesNetwork"><span class="hs-identifier hs-type">ProvidesNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827837"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-459"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-460"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.Metadata.html#RQLMetadata"><span class="hs-identifier hs-type">RQLMetadata</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-461"></span><span>  </span><span class="annot"><a href="#local-6989586621690827837"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.HTTP.html#HttpResponse"><span class="hs-identifier hs-type">HttpResponse</span></a></span><span> </span><span class="annot"><a href="Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-462"></span><span id="v1MetadataHandler"><span class="annot"><span class="annottext">v1MetadataHandler :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m, MonadBaseControl IO m,
 MonadReader HandlerCtx m, MonadTrace m,
 MonadMetadataStorageQueryAPI m, MonadResolveSource m,
 MonadMetadataApiAuthorization m, MonadEventLogCleanup m,
 ProvidesNetwork m) =&gt;
RQLMetadata -&gt; m (HttpResponse EncJSON)
</span><a href="Hasura.Server.App.html#v1MetadataHandler"><span class="hs-identifier hs-var hs-var">v1MetadataHandler</span></a></span></span><span> </span><span id="local-6989586621690826180"><span class="annot"><span class="annottext">RQLMetadata
</span><a href="#local-6989586621690826180"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTrace m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Tracing.html#trace"><span class="hs-identifier hs-var">Tracing.trace</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Metadata&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-463"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. MonadError e m =&gt; m (Either e a) -&gt; m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier hs-var">liftEitherM</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadMetadataApiAuthorization m =&gt;
RQLMetadata -&gt; HandlerCtx -&gt; m (Either QErr ())
</span><a href="Hasura.Server.App.html#authorizeV1MetadataApi"><span class="hs-identifier hs-var">authorizeV1MetadataApi</span></a></span><span> </span><span class="annot"><span class="annottext">RQLMetadata
</span><a href="#local-6989586621690826180"><span class="hs-identifier hs-var">query</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">ask</span></a></span><span>
</span><span id="line-464"></span><span>  </span><span id="local-6989586621690826178"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690826178"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; UserInfo
</span><a href="Hasura.Server.App.html#hcUser"><span class="hs-identifier hs-var">hcUser</span></a></span><span>
</span><span id="line-465"></span><span>  </span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621690826156"><span id="local-6989586621690826157"><span id="local-6989586621690826158"><span id="local-6989586621690826159"><span id="local-6989586621690826160"><span id="local-6989586621690826161"><span id="local-6989586621690826162"><span id="local-6989586621690826163"><span id="local-6989586621690826164"><span id="local-6989586621690826165"><span id="local-6989586621690826166"><span id="local-6989586621690826167"><span id="local-6989586621690826168"><span id="local-6989586621690826169"><span id="local-6989586621690826170"><span id="local-6989586621690826171"><span id="local-6989586621690826172"><span id="local-6989586621690826173"><span id="local-6989586621690826174"><span id="local-6989586621690826175"><span id="local-6989586621690826176"><span id="local-6989586621690826177"><span class="annot"><span class="annottext">HashSet ExperimentalFeature
HashSet API
Environment
Refined NonNegative Int
Refined NonNegative Milliseconds
Refined Positive Int
StreamQueriesOptions
NamingCase
RemoteSchemaPermissions
InferFunctionPermissions
SQLGenCtx
CorsConfig
MetadataDefaults
SchemaCacheRef
AuthMode
ResponseInternalErrorsConfig
OptionalInterval
TelemetryStatus
AllowListStatus
ConsoleStatus
acSchemaPollInterval :: OptionalInterval
acAsyncActionsFetchInterval :: OptionalInterval
acEventsFetchBatchSize :: Refined NonNegative Int
acEventsFetchInterval :: Refined NonNegative Milliseconds
acEventsHttpPoolSize :: Refined Positive Int
acEnableTelemetry :: TelemetryStatus
acConsoleStatus :: ConsoleStatus
acCorsConfig :: CorsConfig
acStreamQueryOptions :: StreamQueriesOptions
acLiveQueryOptions :: StreamQueriesOptions
acMetadataDefaults :: MetadataDefaults
acDefaultNamingConvention :: NamingCase
acExperimentalFeatures :: HashSet ExperimentalFeature
acFunctionPermsCtx :: InferFunctionPermissions
acRemoteSchemaPermsCtx :: RemoteSchemaPermissions
acEnvironment :: Environment
acResponseInternalErrorsConfig :: ResponseInternalErrorsConfig
acEnableAllowlist :: AllowListStatus
acEnabledAPIs :: HashSet API
acSQLGenCtx :: SQLGenCtx
acAuthMode :: AuthMode
acCacheRef :: SchemaCacheRef
acSchemaPollInterval :: AppContext -&gt; OptionalInterval
acAsyncActionsFetchInterval :: AppContext -&gt; OptionalInterval
acEventsFetchBatchSize :: AppContext -&gt; Refined NonNegative Int
acEventsFetchInterval :: AppContext -&gt; Refined NonNegative Milliseconds
acEventsHttpPoolSize :: AppContext -&gt; Refined Positive Int
acEnableTelemetry :: AppContext -&gt; TelemetryStatus
acConsoleStatus :: AppContext -&gt; ConsoleStatus
acCorsConfig :: AppContext -&gt; CorsConfig
acStreamQueryOptions :: AppContext -&gt; StreamQueriesOptions
acLiveQueryOptions :: AppContext -&gt; StreamQueriesOptions
acMetadataDefaults :: AppContext -&gt; MetadataDefaults
acDefaultNamingConvention :: AppContext -&gt; NamingCase
acExperimentalFeatures :: AppContext -&gt; HashSet ExperimentalFeature
acFunctionPermsCtx :: AppContext -&gt; InferFunctionPermissions
acRemoteSchemaPermsCtx :: AppContext -&gt; RemoteSchemaPermissions
acEnvironment :: AppContext -&gt; Environment
acResponseInternalErrorsConfig :: AppContext -&gt; ResponseInternalErrorsConfig
acEnableAllowlist :: AppContext -&gt; AllowListStatus
acSQLGenCtx :: AppContext -&gt; SQLGenCtx
acAuthMode :: AppContext -&gt; AuthMode
acCacheRef :: AppContext -&gt; SchemaCacheRef
acEnabledAPIs :: AppContext -&gt; HashSet API
</span><a href="#local-6989586621690826156"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppContext
</span><a href="Hasura.Server.App.html#hcAppContext"><span class="hs-identifier hs-var">hcAppContext</span></a></span><span>
</span><span id="line-466"></span><span>  </span><span id="local-6989586621690826155"><span class="annot"><span class="annottext">InstanceId
</span><a href="#local-6989586621690826155"><span class="hs-identifier hs-var">instanceId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppEnv -&gt; InstanceId
</span><a href="Hasura.App.State.html#appEnvInstanceId"><span class="hs-identifier hs-var">appEnvInstanceId</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppEnv
</span><a href="Hasura.Server.App.html#hcAppEnv"><span class="hs-identifier hs-var">hcAppEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span>  </span><span id="local-6989586621690826154"><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621690826154"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Loggers -&gt; Logger Hasura
</span><a href="Hasura.App.State.html#_lsLogger"><span class="hs-identifier hs-var">_lsLogger</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">AppEnv -&gt; Loggers
</span><a href="Hasura.App.State.html#appEnvLoggers"><span class="hs-identifier hs-var">appEnvLoggers</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppEnv
</span><a href="Hasura.Server.App.html#hcAppEnv"><span class="hs-identifier hs-var">hcAppEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>  </span><span id="local-6989586621690826153"><span class="annot"><span class="annottext">MaintenanceMode ()
</span><a href="#local-6989586621690826153"><span class="hs-identifier hs-var">maintenanceMode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppEnv -&gt; MaintenanceMode ()
</span><a href="Hasura.App.State.html#appEnvEnableMaintenanceMode"><span class="hs-identifier hs-var">appEnvEnableMaintenanceMode</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppEnv
</span><a href="Hasura.Server.App.html#hcAppEnv"><span class="hs-identifier hs-var">hcAppEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>  </span><span id="local-6989586621690826152"><span class="annot"><span class="annottext">EventingMode
</span><a href="#local-6989586621690826152"><span class="hs-identifier hs-var">eventingMode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppEnv -&gt; EventingMode
</span><a href="Hasura.App.State.html#appEnvEventingMode"><span class="hs-identifier hs-var">appEnvEventingMode</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppEnv
</span><a href="Hasura.Server.App.html#hcAppEnv"><span class="hs-identifier hs-var">hcAppEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>  </span><span id="local-6989586621690826151"><span class="annot"><span class="annottext">ReadOnlyMode
</span><a href="#local-6989586621690826151"><span class="hs-identifier hs-var">readOnlyMode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppEnv -&gt; ReadOnlyMode
</span><a href="Hasura.App.State.html#appEnvEnableReadOnlyMode"><span class="hs-identifier hs-var">appEnvEnableReadOnlyMode</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppEnv
</span><a href="Hasura.Server.App.html#hcAppEnv"><span class="hs-identifier hs-var">hcAppEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>  </span><span id="local-6989586621690826150"><span class="annot"><span class="annottext">FeatureFlag -&gt; IO Bool
</span><a href="#local-6989586621690826150"><span class="hs-identifier hs-var">checkFeatureFlag</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppEnv -&gt; FeatureFlag -&gt; IO Bool
</span><a href="Hasura.App.State.html#appEnvCheckFeatureFlag"><span class="hs-identifier hs-var">appEnvCheckFeatureFlag</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppEnv
</span><a href="Hasura.Server.App.html#hcAppEnv"><span class="hs-identifier hs-var">hcAppEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690826149"><span class="annot"><span class="annottext">serverConfigCtx :: ServerConfigCtx
</span><a href="#local-6989586621690826149"><span class="hs-identifier hs-var hs-var">serverConfigCtx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-473"></span><span>        </span><span class="annot"><span class="annottext">InferFunctionPermissions
-&gt; RemoteSchemaPermissions
-&gt; SQLGenCtx
-&gt; MaintenanceMode ()
-&gt; HashSet ExperimentalFeature
-&gt; EventingMode
-&gt; ReadOnlyMode
-&gt; NamingCase
-&gt; MetadataDefaults
-&gt; (FeatureFlag -&gt; IO Bool)
-&gt; ServerConfigCtx
</span><a href="Hasura.Server.Types.html#ServerConfigCtx"><span class="hs-identifier hs-var">ServerConfigCtx</span></a></span><span>
</span><span id="line-474"></span><span>          </span><span class="annot"><span class="annottext">InferFunctionPermissions
</span><a href="#local-6989586621690826169"><span class="hs-identifier hs-var">acFunctionPermsCtx</span></a></span><span>
</span><span id="line-475"></span><span>          </span><span class="annot"><span class="annottext">RemoteSchemaPermissions
</span><a href="#local-6989586621690826170"><span class="hs-identifier hs-var">acRemoteSchemaPermsCtx</span></a></span><span>
</span><span id="line-476"></span><span>          </span><span class="annot"><span class="annottext">SQLGenCtx
</span><a href="#local-6989586621690826175"><span class="hs-identifier hs-var">acSQLGenCtx</span></a></span><span>
</span><span id="line-477"></span><span>          </span><span class="annot"><span class="annottext">MaintenanceMode ()
</span><a href="#local-6989586621690826153"><span class="hs-identifier hs-var">maintenanceMode</span></a></span><span>
</span><span id="line-478"></span><span>          </span><span class="annot"><span class="annottext">HashSet ExperimentalFeature
</span><a href="#local-6989586621690826168"><span class="hs-identifier hs-var">acExperimentalFeatures</span></a></span><span>
</span><span id="line-479"></span><span>          </span><span class="annot"><span class="annottext">EventingMode
</span><a href="#local-6989586621690826152"><span class="hs-identifier hs-var">eventingMode</span></a></span><span>
</span><span id="line-480"></span><span>          </span><span class="annot"><span class="annottext">ReadOnlyMode
</span><a href="#local-6989586621690826151"><span class="hs-identifier hs-var">readOnlyMode</span></a></span><span>
</span><span id="line-481"></span><span>          </span><span class="annot"><span class="annottext">NamingCase
</span><a href="#local-6989586621690826167"><span class="hs-identifier hs-var">acDefaultNamingConvention</span></a></span><span>
</span><span id="line-482"></span><span>          </span><span class="annot"><span class="annottext">MetadataDefaults
</span><a href="#local-6989586621690826166"><span class="hs-identifier hs-var">acMetadataDefaults</span></a></span><span>
</span><span id="line-483"></span><span>          </span><span class="annot"><span class="annottext">FeatureFlag -&gt; IO Bool
</span><a href="#local-6989586621690826150"><span class="hs-identifier hs-var">checkFeatureFlag</span></a></span><span>
</span><span id="line-484"></span><span>  </span><span id="local-6989586621690826148"><span class="annot"><span class="annottext">EncJSON
</span><a href="#local-6989586621690826148"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-485"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadIO m, MonadBaseControl IO m) =&gt;
SchemaCacheRef
-&gt; Logger Hasura
-&gt; Maybe (TVar Bool)
-&gt; m (a, RebuildableSchemaCache)
-&gt; m a
</span><a href="Hasura.Server.SchemaCacheRef.html#withSchemaCacheUpdate"><span class="hs-identifier hs-var">withSchemaCacheUpdate</span></a></span><span>
</span><span id="line-486"></span><span>      </span><span class="annot"><span class="annottext">SchemaCacheRef
</span><a href="#local-6989586621690826177"><span class="hs-identifier hs-var">acCacheRef</span></a></span><span>
</span><span id="line-487"></span><span>      </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621690826154"><span class="hs-identifier hs-var">logger</span></a></span><span>
</span><span id="line-488"></span><span>      </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-489"></span><span>      </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m, MonadBaseControl IO m, MonadTrace m,
 MonadMetadataStorageQueryAPI m, MonadResolveSource m,
 MonadEventLogCleanup m, ProvidesHasuraServices m) =&gt;
Environment
-&gt; Logger Hasura
-&gt; InstanceId
-&gt; UserInfo
-&gt; ServerConfigCtx
-&gt; SchemaCacheRef
-&gt; RQLMetadata
-&gt; m (EncJSON, RebuildableSchemaCache)
</span><a href="Hasura.Server.API.Metadata.html#runMetadataQuery"><span class="hs-identifier hs-var">runMetadataQuery</span></a></span><span>
</span><span id="line-490"></span><span>        </span><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621690826171"><span class="hs-identifier hs-var">acEnvironment</span></a></span><span>
</span><span id="line-491"></span><span>        </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621690826154"><span class="hs-identifier hs-var">logger</span></a></span><span>
</span><span id="line-492"></span><span>        </span><span class="annot"><span class="annottext">InstanceId
</span><a href="#local-6989586621690826155"><span class="hs-identifier hs-var">instanceId</span></a></span><span>
</span><span id="line-493"></span><span>        </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690826178"><span class="hs-identifier hs-var">userInfo</span></a></span><span>
</span><span id="line-494"></span><span>        </span><span class="annot"><span class="annottext">ServerConfigCtx
</span><a href="#local-6989586621690826149"><span class="hs-identifier hs-var">serverConfigCtx</span></a></span><span>
</span><span id="line-495"></span><span>        </span><span class="annot"><span class="annottext">SchemaCacheRef
</span><a href="#local-6989586621690826177"><span class="hs-identifier hs-var">acCacheRef</span></a></span><span>
</span><span id="line-496"></span><span>        </span><span class="annot"><span class="annottext">RQLMetadata
</span><a href="#local-6989586621690826180"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-497"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [Header] -&gt; HttpResponse a
</span><a href="Hasura.HTTP.html#HttpResponse"><span class="hs-identifier hs-var">HttpResponse</span></a></span><span> </span><span class="annot"><span class="annottext">EncJSON
</span><a href="#local-6989586621690826148"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-498"></span><span>
</span><span id="line-499"></span><span id="local-6989586621690827834"><span class="annot"><a href="Hasura.Server.App.html#v2QueryHandler"><span class="hs-identifier hs-type">v2QueryHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-500"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827834"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-501"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827834"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-502"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadBaseControl</span></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827834"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-503"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#MonadMetadataApiAuthorization"><span class="hs-identifier hs-type">MonadMetadataApiAuthorization</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827834"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-504"></span><span>    </span><span class="annot"><a href="Hasura.Tracing.html#MonadTrace"><span class="hs-identifier hs-type">Tracing.MonadTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827834"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-505"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.App.html#HandlerCtx"><span class="hs-identifier hs-type">HandlerCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827834"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-506"></span><span>    </span><span class="annot"><a href="Hasura.Metadata.Class.html#MonadMetadataStorage"><span class="hs-identifier hs-type">MonadMetadataStorage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827834"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-507"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Source.html#MonadResolveSource"><span class="hs-identifier hs-type">MonadResolveSource</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827834"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-508"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Execute.Backend.html#MonadQueryTags"><span class="hs-identifier hs-type">EB.MonadQueryTags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827834"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-509"></span><span>    </span><span class="annot"><a href="Hasura.Services.Network.html#ProvidesNetwork"><span class="hs-identifier hs-type">ProvidesNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827834"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-510"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-511"></span><span>  </span><span class="annot"><a href="Hasura.Server.API.V2Query.html#RQLQuery"><span class="hs-identifier hs-type">V2Q.RQLQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-512"></span><span>  </span><span class="annot"><a href="#local-6989586621690827834"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.HTTP.html#HttpResponse"><span class="hs-identifier hs-type">HttpResponse</span></a></span><span> </span><span class="annot"><a href="Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-513"></span><span id="v2QueryHandler"><span class="annot"><span class="annottext">v2QueryHandler :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m, MonadBaseControl IO m,
 MonadMetadataApiAuthorization m, MonadTrace m,
 MonadReader HandlerCtx m, MonadMetadataStorage m,
 MonadResolveSource m, MonadQueryTags m, ProvidesNetwork m) =&gt;
RQLQuery -&gt; m (HttpResponse EncJSON)
</span><a href="Hasura.Server.App.html#v2QueryHandler"><span class="hs-identifier hs-var hs-var">v2QueryHandler</span></a></span></span><span> </span><span id="local-6989586621690826088"><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690826088"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTrace m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Tracing.html#trace"><span class="hs-identifier hs-var">Tracing.trace</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;v2 Query&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-514"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. MonadError e m =&gt; m (Either e a) -&gt; m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier hs-var">liftEitherM</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadMetadataApiAuthorization m =&gt;
RQLQuery -&gt; HandlerCtx -&gt; m (Either QErr ())
</span><a href="Hasura.Server.App.html#authorizeV2QueryApi"><span class="hs-identifier hs-var">authorizeV2QueryApi</span></a></span><span> </span><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690826088"><span class="hs-identifier hs-var">query</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">ask</span></a></span><span>
</span><span id="line-515"></span><span>  </span><span id="local-6989586621690826087"><span class="annot"><span class="annottext">SchemaCacheRef
</span><a href="#local-6989586621690826087"><span class="hs-identifier hs-var">scRef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppContext -&gt; SchemaCacheRef
</span><a href="Hasura.App.State.html#acCacheRef"><span class="hs-identifier hs-var">acCacheRef</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppContext
</span><a href="Hasura.Server.App.html#hcAppContext"><span class="hs-identifier hs-var">hcAppContext</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-516"></span><span>  </span><span id="local-6989586621690826086"><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621690826086"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Loggers -&gt; Logger Hasura
</span><a href="Hasura.App.State.html#_lsLogger"><span class="hs-identifier hs-var">_lsLogger</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">AppEnv -&gt; Loggers
</span><a href="Hasura.App.State.html#appEnvLoggers"><span class="hs-identifier hs-var">appEnvLoggers</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppEnv
</span><a href="Hasura.Server.App.html#hcAppEnv"><span class="hs-identifier hs-var">hcAppEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>  </span><span id="local-6989586621690826085"><span class="annot"><span class="annottext">EncJSON
</span><a href="#local-6989586621690826085"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-518"></span><span>    </span><span class="annot"><span class="annottext">forall a. a -&gt; a -&gt; Bool -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">bool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">m (EncJSON, RebuildableSchemaCache)
</span><a href="#local-6989586621690826084"><span class="hs-identifier hs-var">dbAction</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadIO m, MonadBaseControl IO m) =&gt;
SchemaCacheRef
-&gt; Logger Hasura
-&gt; Maybe (TVar Bool)
-&gt; m (a, RebuildableSchemaCache)
-&gt; m a
</span><a href="Hasura.Server.SchemaCacheRef.html#withSchemaCacheUpdate"><span class="hs-identifier hs-var">withSchemaCacheUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCacheRef
</span><a href="#local-6989586621690826087"><span class="hs-identifier hs-var">scRef</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621690826086"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">m (EncJSON, RebuildableSchemaCache)
</span><a href="#local-6989586621690826084"><span class="hs-identifier hs-var">dbAction</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-519"></span><span>      </span><span class="annot"><span class="annottext">RQLQuery -&gt; Bool
</span><a href="Hasura.Server.API.V2Query.html#queryModifiesSchema"><span class="hs-identifier hs-var">V2Q.queryModifiesSchema</span></a></span><span> </span><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690826088"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-520"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [Header] -&gt; HttpResponse a
</span><a href="Hasura.HTTP.html#HttpResponse"><span class="hs-identifier hs-var">HttpResponse</span></a></span><span> </span><span class="annot"><span class="annottext">EncJSON
</span><a href="#local-6989586621690826085"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-521"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-522"></span><span>    </span><span class="hs-comment">-- Hit postgres</span><span>
</span><span id="line-523"></span><span>    </span><span id="local-6989586621690826084"><span class="annot"><span class="annottext">dbAction :: m (EncJSON, RebuildableSchemaCache)
</span><a href="#local-6989586621690826084"><span class="hs-identifier hs-var hs-var">dbAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-524"></span><span>      </span><span id="local-6989586621690826082"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690826082"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; UserInfo
</span><a href="Hasura.Server.App.html#hcUser"><span class="hs-identifier hs-var">hcUser</span></a></span><span>
</span><span id="line-525"></span><span>      </span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621690826060"><span id="local-6989586621690826061"><span id="local-6989586621690826062"><span id="local-6989586621690826063"><span id="local-6989586621690826064"><span id="local-6989586621690826065"><span id="local-6989586621690826066"><span id="local-6989586621690826067"><span id="local-6989586621690826068"><span id="local-6989586621690826069"><span id="local-6989586621690826070"><span id="local-6989586621690826071"><span id="local-6989586621690826072"><span id="local-6989586621690826073"><span id="local-6989586621690826074"><span id="local-6989586621690826075"><span id="local-6989586621690826076"><span id="local-6989586621690826077"><span id="local-6989586621690826078"><span id="local-6989586621690826079"><span id="local-6989586621690826080"><span id="local-6989586621690826081"><span class="annot"><span class="annottext">HashSet ExperimentalFeature
HashSet API
Environment
Refined NonNegative Int
Refined NonNegative Milliseconds
Refined Positive Int
StreamQueriesOptions
NamingCase
RemoteSchemaPermissions
InferFunctionPermissions
SQLGenCtx
CorsConfig
MetadataDefaults
SchemaCacheRef
AuthMode
ResponseInternalErrorsConfig
OptionalInterval
TelemetryStatus
AllowListStatus
ConsoleStatus
acSchemaPollInterval :: OptionalInterval
acAsyncActionsFetchInterval :: OptionalInterval
acEventsFetchBatchSize :: Refined NonNegative Int
acEventsFetchInterval :: Refined NonNegative Milliseconds
acEventsHttpPoolSize :: Refined Positive Int
acEnableTelemetry :: TelemetryStatus
acConsoleStatus :: ConsoleStatus
acCorsConfig :: CorsConfig
acStreamQueryOptions :: StreamQueriesOptions
acLiveQueryOptions :: StreamQueriesOptions
acMetadataDefaults :: MetadataDefaults
acDefaultNamingConvention :: NamingCase
acExperimentalFeatures :: HashSet ExperimentalFeature
acFunctionPermsCtx :: InferFunctionPermissions
acRemoteSchemaPermsCtx :: RemoteSchemaPermissions
acEnvironment :: Environment
acResponseInternalErrorsConfig :: ResponseInternalErrorsConfig
acEnableAllowlist :: AllowListStatus
acEnabledAPIs :: HashSet API
acSQLGenCtx :: SQLGenCtx
acAuthMode :: AuthMode
acCacheRef :: SchemaCacheRef
acSchemaPollInterval :: AppContext -&gt; OptionalInterval
acAsyncActionsFetchInterval :: AppContext -&gt; OptionalInterval
acEventsFetchBatchSize :: AppContext -&gt; Refined NonNegative Int
acEventsFetchInterval :: AppContext -&gt; Refined NonNegative Milliseconds
acEventsHttpPoolSize :: AppContext -&gt; Refined Positive Int
acEnableTelemetry :: AppContext -&gt; TelemetryStatus
acConsoleStatus :: AppContext -&gt; ConsoleStatus
acCorsConfig :: AppContext -&gt; CorsConfig
acStreamQueryOptions :: AppContext -&gt; StreamQueriesOptions
acLiveQueryOptions :: AppContext -&gt; StreamQueriesOptions
acMetadataDefaults :: AppContext -&gt; MetadataDefaults
acDefaultNamingConvention :: AppContext -&gt; NamingCase
acExperimentalFeatures :: AppContext -&gt; HashSet ExperimentalFeature
acFunctionPermsCtx :: AppContext -&gt; InferFunctionPermissions
acRemoteSchemaPermsCtx :: AppContext -&gt; RemoteSchemaPermissions
acEnvironment :: AppContext -&gt; Environment
acResponseInternalErrorsConfig :: AppContext -&gt; ResponseInternalErrorsConfig
acEnableAllowlist :: AppContext -&gt; AllowListStatus
acSQLGenCtx :: AppContext -&gt; SQLGenCtx
acAuthMode :: AppContext -&gt; AuthMode
acCacheRef :: AppContext -&gt; SchemaCacheRef
acEnabledAPIs :: AppContext -&gt; HashSet API
</span><a href="#local-6989586621690826060"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppContext
</span><a href="Hasura.Server.App.html#hcAppContext"><span class="hs-identifier hs-var">hcAppContext</span></a></span><span>
</span><span id="line-526"></span><span>      </span><span id="local-6989586621690826059"><span class="annot"><span class="annottext">RebuildableSchemaCache
</span><a href="#local-6989586621690826059"><span class="hs-identifier hs-var">schemaCache</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCacheRef -&gt; IO (RebuildableSchemaCache, SchemaCacheVer)
</span><a href="Hasura.Server.SchemaCacheRef.html#readSchemaCacheRef"><span class="hs-identifier hs-var">readSchemaCacheRef</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCacheRef
</span><a href="#local-6989586621690826081"><span class="hs-identifier hs-var">acCacheRef</span></a></span><span>
</span><span id="line-527"></span><span>      </span><span id="local-6989586621690826058"><span class="annot"><span class="annottext">InstanceId
</span><a href="#local-6989586621690826058"><span class="hs-identifier hs-var">instanceId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppEnv -&gt; InstanceId
</span><a href="Hasura.App.State.html#appEnvInstanceId"><span class="hs-identifier hs-var">appEnvInstanceId</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppEnv
</span><a href="Hasura.Server.App.html#hcAppEnv"><span class="hs-identifier hs-var">hcAppEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span>      </span><span id="local-6989586621690826057"><span class="annot"><span class="annottext">MaintenanceMode ()
</span><a href="#local-6989586621690826057"><span class="hs-identifier hs-var">maintenanceMode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppEnv -&gt; MaintenanceMode ()
</span><a href="Hasura.App.State.html#appEnvEnableMaintenanceMode"><span class="hs-identifier hs-var">appEnvEnableMaintenanceMode</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppEnv
</span><a href="Hasura.Server.App.html#hcAppEnv"><span class="hs-identifier hs-var">hcAppEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-529"></span><span>      </span><span id="local-6989586621690826056"><span class="annot"><span class="annottext">EventingMode
</span><a href="#local-6989586621690826056"><span class="hs-identifier hs-var">eventingMode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppEnv -&gt; EventingMode
</span><a href="Hasura.App.State.html#appEnvEventingMode"><span class="hs-identifier hs-var">appEnvEventingMode</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppEnv
</span><a href="Hasura.Server.App.html#hcAppEnv"><span class="hs-identifier hs-var">hcAppEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>      </span><span id="local-6989586621690826055"><span class="annot"><span class="annottext">ReadOnlyMode
</span><a href="#local-6989586621690826055"><span class="hs-identifier hs-var">readOnlyMode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppEnv -&gt; ReadOnlyMode
</span><a href="Hasura.App.State.html#appEnvEnableReadOnlyMode"><span class="hs-identifier hs-var">appEnvEnableReadOnlyMode</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppEnv
</span><a href="Hasura.Server.App.html#hcAppEnv"><span class="hs-identifier hs-var">hcAppEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>      </span><span id="local-6989586621690826054"><span class="annot"><span class="annottext">FeatureFlag -&gt; IO Bool
</span><a href="#local-6989586621690826054"><span class="hs-identifier hs-var">checkFeatureFlag</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppEnv -&gt; FeatureFlag -&gt; IO Bool
</span><a href="Hasura.App.State.html#appEnvCheckFeatureFlag"><span class="hs-identifier hs-var">appEnvCheckFeatureFlag</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppEnv
</span><a href="Hasura.Server.App.html#hcAppEnv"><span class="hs-identifier hs-var">hcAppEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-532"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690826053"><span class="annot"><span class="annottext">serverConfigCtx :: ServerConfigCtx
</span><a href="#local-6989586621690826053"><span class="hs-identifier hs-var hs-var">serverConfigCtx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-533"></span><span>            </span><span class="annot"><span class="annottext">InferFunctionPermissions
-&gt; RemoteSchemaPermissions
-&gt; SQLGenCtx
-&gt; MaintenanceMode ()
-&gt; HashSet ExperimentalFeature
-&gt; EventingMode
-&gt; ReadOnlyMode
-&gt; NamingCase
-&gt; MetadataDefaults
-&gt; (FeatureFlag -&gt; IO Bool)
-&gt; ServerConfigCtx
</span><a href="Hasura.Server.Types.html#ServerConfigCtx"><span class="hs-identifier hs-var">ServerConfigCtx</span></a></span><span>
</span><span id="line-534"></span><span>              </span><span class="annot"><span class="annottext">InferFunctionPermissions
</span><a href="#local-6989586621690826073"><span class="hs-identifier hs-var">acFunctionPermsCtx</span></a></span><span>
</span><span id="line-535"></span><span>              </span><span class="annot"><span class="annottext">RemoteSchemaPermissions
</span><a href="#local-6989586621690826074"><span class="hs-identifier hs-var">acRemoteSchemaPermsCtx</span></a></span><span>
</span><span id="line-536"></span><span>              </span><span class="annot"><span class="annottext">SQLGenCtx
</span><a href="#local-6989586621690826079"><span class="hs-identifier hs-var">acSQLGenCtx</span></a></span><span>
</span><span id="line-537"></span><span>              </span><span class="annot"><span class="annottext">MaintenanceMode ()
</span><a href="#local-6989586621690826057"><span class="hs-identifier hs-var">maintenanceMode</span></a></span><span>
</span><span id="line-538"></span><span>              </span><span class="annot"><span class="annottext">HashSet ExperimentalFeature
</span><a href="#local-6989586621690826072"><span class="hs-identifier hs-var">acExperimentalFeatures</span></a></span><span>
</span><span id="line-539"></span><span>              </span><span class="annot"><span class="annottext">EventingMode
</span><a href="#local-6989586621690826056"><span class="hs-identifier hs-var">eventingMode</span></a></span><span>
</span><span id="line-540"></span><span>              </span><span class="annot"><span class="annottext">ReadOnlyMode
</span><a href="#local-6989586621690826055"><span class="hs-identifier hs-var">readOnlyMode</span></a></span><span>
</span><span id="line-541"></span><span>              </span><span class="annot"><span class="annottext">NamingCase
</span><a href="#local-6989586621690826071"><span class="hs-identifier hs-var">acDefaultNamingConvention</span></a></span><span>
</span><span id="line-542"></span><span>              </span><span class="annot"><span class="annottext">MetadataDefaults
</span><a href="#local-6989586621690826070"><span class="hs-identifier hs-var">acMetadataDefaults</span></a></span><span>
</span><span id="line-543"></span><span>              </span><span class="annot"><span class="annottext">FeatureFlag -&gt; IO Bool
</span><a href="#local-6989586621690826054"><span class="hs-identifier hs-var">checkFeatureFlag</span></a></span><span>
</span><span id="line-544"></span><span>
</span><span id="line-545"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadBaseControl IO m, MonadError QErr m, MonadTrace m,
 MonadMetadataStorage m, MonadResolveSource m, MonadQueryTags m,
 ProvidesHasuraServices m) =&gt;
Environment
-&gt; InstanceId
-&gt; UserInfo
-&gt; RebuildableSchemaCache
-&gt; ServerConfigCtx
-&gt; RQLQuery
-&gt; m (EncJSON, RebuildableSchemaCache)
</span><a href="Hasura.Server.API.V2Query.html#runQuery"><span class="hs-identifier hs-var">V2Q.runQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621690826075"><span class="hs-identifier hs-var">acEnvironment</span></a></span><span> </span><span class="annot"><span class="annottext">InstanceId
</span><a href="#local-6989586621690826058"><span class="hs-identifier hs-var">instanceId</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690826082"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">RebuildableSchemaCache
</span><a href="#local-6989586621690826059"><span class="hs-identifier hs-var">schemaCache</span></a></span><span> </span><span class="annot"><span class="annottext">ServerConfigCtx
</span><a href="#local-6989586621690826053"><span class="hs-identifier hs-var">serverConfigCtx</span></a></span><span> </span><span class="annot"><span class="annottext">RQLQuery
</span><a href="#local-6989586621690826088"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-546"></span><span>
</span><span id="line-547"></span><span id="local-6989586621690827831"><span class="annot"><a href="Hasura.Server.App.html#v1Alpha1GQHandler"><span class="hs-identifier hs-type">v1Alpha1GQHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-548"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827831"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-549"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadBaseControl</span></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827831"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-550"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Execute.Common.html#MonadGQLExecutionCheck"><span class="hs-identifier hs-type">E.MonadGQLExecutionCheck</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827831"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-551"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Logging.html#MonadQueryLog"><span class="hs-identifier hs-type">MonadQueryLog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827831"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-552"></span><span>    </span><span class="annot"><a href="Hasura.Tracing.html#MonadTrace"><span class="hs-identifier hs-type">Tracing.MonadTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827831"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-553"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.html#MonadExecuteQuery"><span class="hs-identifier hs-type">GH.MonadExecuteQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827831"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-554"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827831"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-555"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.App.html#HandlerCtx"><span class="hs-identifier hs-type">HandlerCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827831"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-556"></span><span>    </span><span class="annot"><a href="Hasura.Metadata.Class.html#MonadMetadataStorage"><span class="hs-identifier hs-type">MonadMetadataStorage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827831"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-557"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Execute.Backend.html#MonadQueryTags"><span class="hs-identifier hs-type">EB.MonadQueryTags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827831"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-558"></span><span>    </span><span class="annot"><a href="Hasura.Server.Limits.html#HasResourceLimits"><span class="hs-identifier hs-type">HasResourceLimits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827831"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-559"></span><span>    </span><span class="annot"><a href="Hasura.Services.Network.html#ProvidesNetwork"><span class="hs-identifier hs-type">ProvidesNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827831"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-560"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-561"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Execute.Types.html#GraphQLQueryType"><span class="hs-identifier hs-type">E.GraphQLQueryType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-562"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#GQLBatchedReqs"><span class="hs-identifier hs-type">GH.GQLBatchedReqs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#GQLReq"><span class="hs-identifier hs-type">GH.GQLReq</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#GQLQueryText"><span class="hs-identifier hs-type">GH.GQLQueryText</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-563"></span><span>  </span><span class="annot"><a href="#local-6989586621690827831"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogGraphQLInfo"><span class="hs-identifier hs-type">HttpLogGraphQLInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.HTTP.html#HttpResponse"><span class="hs-identifier hs-type">HttpResponse</span></a></span><span> </span><span class="annot"><a href="Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-564"></span><span id="v1Alpha1GQHandler"><span class="annot"><span class="annottext">v1Alpha1GQHandler :: forall (m :: * -&gt; *).
(MonadIO m, MonadBaseControl IO m, MonadGQLExecutionCheck m,
 MonadQueryLog m, MonadTrace m, MonadExecuteQuery m,
 MonadError QErr m, MonadReader HandlerCtx m,
 MonadMetadataStorage m, MonadQueryTags m, HasResourceLimits m,
 ProvidesNetwork m) =&gt;
GraphQLQueryType
-&gt; ReqsText -&gt; m (HttpLogGraphQLInfo, HttpResponse EncJSON)
</span><a href="Hasura.Server.App.html#v1Alpha1GQHandler"><span class="hs-identifier hs-var hs-var">v1Alpha1GQHandler</span></a></span></span><span> </span><span id="local-6989586621690826010"><span class="annot"><span class="annottext">GraphQLQueryType
</span><a href="#local-6989586621690826010"><span class="hs-identifier hs-var">queryType</span></a></span></span><span> </span><span id="local-6989586621690826009"><span class="annot"><span class="annottext">ReqsText
</span><a href="#local-6989586621690826009"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-565"></span><span>  </span><span id="local-6989586621690826008"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690826008"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; UserInfo
</span><a href="Hasura.Server.App.html#hcUser"><span class="hs-identifier hs-var">hcUser</span></a></span><span>
</span><span id="line-566"></span><span>  </span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621690825986"><span id="local-6989586621690825987"><span id="local-6989586621690825988"><span id="local-6989586621690825989"><span id="local-6989586621690825990"><span id="local-6989586621690825991"><span id="local-6989586621690825992"><span id="local-6989586621690825993"><span id="local-6989586621690825994"><span id="local-6989586621690825995"><span id="local-6989586621690825996"><span id="local-6989586621690825997"><span id="local-6989586621690825998"><span id="local-6989586621690825999"><span id="local-6989586621690826000"><span id="local-6989586621690826001"><span id="local-6989586621690826002"><span id="local-6989586621690826003"><span id="local-6989586621690826004"><span id="local-6989586621690826005"><span id="local-6989586621690826006"><span id="local-6989586621690826007"><span class="annot"><span class="annottext">HashSet ExperimentalFeature
HashSet API
Environment
Refined NonNegative Int
Refined NonNegative Milliseconds
Refined Positive Int
StreamQueriesOptions
NamingCase
RemoteSchemaPermissions
InferFunctionPermissions
SQLGenCtx
CorsConfig
MetadataDefaults
SchemaCacheRef
AuthMode
ResponseInternalErrorsConfig
OptionalInterval
TelemetryStatus
AllowListStatus
ConsoleStatus
acSchemaPollInterval :: OptionalInterval
acAsyncActionsFetchInterval :: OptionalInterval
acEventsFetchBatchSize :: Refined NonNegative Int
acEventsFetchInterval :: Refined NonNegative Milliseconds
acEventsHttpPoolSize :: Refined Positive Int
acEnableTelemetry :: TelemetryStatus
acConsoleStatus :: ConsoleStatus
acCorsConfig :: CorsConfig
acStreamQueryOptions :: StreamQueriesOptions
acLiveQueryOptions :: StreamQueriesOptions
acMetadataDefaults :: MetadataDefaults
acDefaultNamingConvention :: NamingCase
acExperimentalFeatures :: HashSet ExperimentalFeature
acFunctionPermsCtx :: InferFunctionPermissions
acRemoteSchemaPermsCtx :: RemoteSchemaPermissions
acEnvironment :: Environment
acResponseInternalErrorsConfig :: ResponseInternalErrorsConfig
acEnableAllowlist :: AllowListStatus
acEnabledAPIs :: HashSet API
acSQLGenCtx :: SQLGenCtx
acAuthMode :: AuthMode
acCacheRef :: SchemaCacheRef
acSchemaPollInterval :: AppContext -&gt; OptionalInterval
acAsyncActionsFetchInterval :: AppContext -&gt; OptionalInterval
acEventsFetchBatchSize :: AppContext -&gt; Refined NonNegative Int
acEventsFetchInterval :: AppContext -&gt; Refined NonNegative Milliseconds
acEventsHttpPoolSize :: AppContext -&gt; Refined Positive Int
acEnableTelemetry :: AppContext -&gt; TelemetryStatus
acConsoleStatus :: AppContext -&gt; ConsoleStatus
acCorsConfig :: AppContext -&gt; CorsConfig
acStreamQueryOptions :: AppContext -&gt; StreamQueriesOptions
acLiveQueryOptions :: AppContext -&gt; StreamQueriesOptions
acMetadataDefaults :: AppContext -&gt; MetadataDefaults
acDefaultNamingConvention :: AppContext -&gt; NamingCase
acExperimentalFeatures :: AppContext -&gt; HashSet ExperimentalFeature
acFunctionPermsCtx :: AppContext -&gt; InferFunctionPermissions
acRemoteSchemaPermsCtx :: AppContext -&gt; RemoteSchemaPermissions
acEnvironment :: AppContext -&gt; Environment
acResponseInternalErrorsConfig :: AppContext -&gt; ResponseInternalErrorsConfig
acEnableAllowlist :: AppContext -&gt; AllowListStatus
acSQLGenCtx :: AppContext -&gt; SQLGenCtx
acAuthMode :: AppContext -&gt; AuthMode
acCacheRef :: AppContext -&gt; SchemaCacheRef
acEnabledAPIs :: AppContext -&gt; HashSet API
</span><a href="#local-6989586621690825986"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppContext
</span><a href="Hasura.Server.App.html#hcAppContext"><span class="hs-identifier hs-var">hcAppContext</span></a></span><span>
</span><span id="line-567"></span><span>  </span><span id="local-6989586621690825985"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690825985"><span class="hs-identifier hs-var">reqHeaders</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; [Header]
</span><a href="Hasura.Server.App.html#hcReqHeaders"><span class="hs-identifier hs-var">hcReqHeaders</span></a></span><span>
</span><span id="line-568"></span><span>  </span><span id="local-6989586621690825984"><span class="annot"><span class="annottext">IpAddress
</span><a href="#local-6989586621690825984"><span class="hs-identifier hs-var">ipAddress</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; IpAddress
</span><a href="Hasura.Server.App.html#hcSourceIpAddress"><span class="hs-identifier hs-var">hcSourceIpAddress</span></a></span><span>
</span><span id="line-569"></span><span>  </span><span id="local-6989586621690825983"><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621690825983"><span class="hs-identifier hs-var">requestId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; RequestId
</span><a href="Hasura.Server.App.html#hcRequestId"><span class="hs-identifier hs-var">hcRequestId</span></a></span><span>
</span><span id="line-570"></span><span>  </span><span id="local-6989586621690825982"><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621690825982"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Loggers -&gt; Logger Hasura
</span><a href="Hasura.App.State.html#_lsLogger"><span class="hs-identifier hs-var">_lsLogger</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">AppEnv -&gt; Loggers
</span><a href="Hasura.App.State.html#appEnvLoggers"><span class="hs-identifier hs-var">appEnvLoggers</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppEnv
</span><a href="Hasura.Server.App.html#hcAppEnv"><span class="hs-identifier hs-var">hcAppEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-571"></span><span>  </span><span id="local-6989586621690825981"><span class="annot"><span class="annottext">ExecutionCtx
</span><a href="#local-6989586621690825981"><span class="hs-identifier hs-var">execCtx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadReader HandlerCtx m) =&gt;
m ExecutionCtx
</span><a href="Hasura.Server.App.html#mkExecutionContext"><span class="hs-identifier hs-var">mkExecutionContext</span></a></span><span>
</span><span id="line-572"></span><span>
</span><span id="line-573"></span><span>  </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runReaderT</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutionCtx
</span><a href="#local-6989586621690825981"><span class="hs-identifier hs-var">execCtx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-574"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadBaseControl IO m, MonadError QErr m,
 MonadReader ExecutionCtx m, MonadGQLExecutionCheck m,
 MonadQueryLog m, MonadTrace m, MonadExecuteQuery m,
 MonadMetadataStorage m, MonadQueryTags m, HasResourceLimits m,
 ProvidesNetwork m) =&gt;
Environment
-&gt; Logger Hasura
-&gt; RequestId
-&gt; ResponseInternalErrorsConfig
-&gt; UserInfo
-&gt; IpAddress
-&gt; [Header]
-&gt; GraphQLQueryType
-&gt; ReqsText
-&gt; m (HttpLogGraphQLInfo, HttpResponse EncJSON)
</span><a href="Hasura.GraphQL.Transport.HTTP.html#runGQBatched"><span class="hs-identifier hs-var">GH.runGQBatched</span></a></span><span> </span><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621690826001"><span class="hs-identifier hs-var">acEnvironment</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621690825982"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621690825983"><span class="hs-identifier hs-var">requestId</span></a></span><span> </span><span class="annot"><span class="annottext">ResponseInternalErrorsConfig
</span><a href="#local-6989586621690826002"><span class="hs-identifier hs-var">acResponseInternalErrorsConfig</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690826008"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">IpAddress
</span><a href="#local-6989586621690825984"><span class="hs-identifier hs-var">ipAddress</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690825985"><span class="hs-identifier hs-var">reqHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">GraphQLQueryType
</span><a href="#local-6989586621690826010"><span class="hs-identifier hs-var">queryType</span></a></span><span> </span><span class="annot"><span class="annottext">ReqsText
</span><a href="#local-6989586621690826009"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-575"></span><span>
</span><span id="line-576"></span><span id="local-6989586621690827827"><span class="annot"><a href="Hasura.Server.App.html#mkExecutionContext"><span class="hs-identifier hs-type">mkExecutionContext</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-577"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827827"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-578"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.App.html#HandlerCtx"><span class="hs-identifier hs-type">HandlerCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827827"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-579"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-580"></span><span>  </span><span class="annot"><a href="#local-6989586621690827827"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.html#ExecutionCtx"><span class="hs-identifier hs-type">E.ExecutionCtx</span></a></span></span><span>
</span><span id="line-581"></span><span id="mkExecutionContext"><span class="annot"><span class="annottext">mkExecutionContext :: forall (m :: * -&gt; *).
(MonadIO m, MonadReader HandlerCtx m) =&gt;
m ExecutionCtx
</span><a href="Hasura.Server.App.html#mkExecutionContext"><span class="hs-identifier hs-var hs-var">mkExecutionContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-582"></span><span>  </span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621690825942"><span id="local-6989586621690825943"><span id="local-6989586621690825944"><span id="local-6989586621690825945"><span id="local-6989586621690825946"><span id="local-6989586621690825947"><span id="local-6989586621690825948"><span id="local-6989586621690825949"><span id="local-6989586621690825950"><span id="local-6989586621690825951"><span id="local-6989586621690825952"><span id="local-6989586621690825953"><span id="local-6989586621690825954"><span id="local-6989586621690825955"><span id="local-6989586621690825956"><span id="local-6989586621690825957"><span id="local-6989586621690825958"><span id="local-6989586621690825959"><span id="local-6989586621690825960"><span id="local-6989586621690825961"><span id="local-6989586621690825962"><span id="local-6989586621690825963"><span class="annot"><span class="annottext">HashSet ExperimentalFeature
HashSet API
Environment
Refined NonNegative Int
Refined NonNegative Milliseconds
Refined Positive Int
StreamQueriesOptions
NamingCase
RemoteSchemaPermissions
InferFunctionPermissions
SQLGenCtx
CorsConfig
MetadataDefaults
SchemaCacheRef
AuthMode
ResponseInternalErrorsConfig
OptionalInterval
TelemetryStatus
AllowListStatus
ConsoleStatus
acSchemaPollInterval :: OptionalInterval
acAsyncActionsFetchInterval :: OptionalInterval
acEventsFetchBatchSize :: Refined NonNegative Int
acEventsFetchInterval :: Refined NonNegative Milliseconds
acEventsHttpPoolSize :: Refined Positive Int
acEnableTelemetry :: TelemetryStatus
acConsoleStatus :: ConsoleStatus
acCorsConfig :: CorsConfig
acStreamQueryOptions :: StreamQueriesOptions
acLiveQueryOptions :: StreamQueriesOptions
acMetadataDefaults :: MetadataDefaults
acDefaultNamingConvention :: NamingCase
acExperimentalFeatures :: HashSet ExperimentalFeature
acFunctionPermsCtx :: InferFunctionPermissions
acRemoteSchemaPermsCtx :: RemoteSchemaPermissions
acEnvironment :: Environment
acResponseInternalErrorsConfig :: ResponseInternalErrorsConfig
acEnableAllowlist :: AllowListStatus
acEnabledAPIs :: HashSet API
acSQLGenCtx :: SQLGenCtx
acAuthMode :: AuthMode
acCacheRef :: SchemaCacheRef
acSchemaPollInterval :: AppContext -&gt; OptionalInterval
acAsyncActionsFetchInterval :: AppContext -&gt; OptionalInterval
acEventsFetchBatchSize :: AppContext -&gt; Refined NonNegative Int
acEventsFetchInterval :: AppContext -&gt; Refined NonNegative Milliseconds
acEventsHttpPoolSize :: AppContext -&gt; Refined Positive Int
acEnableTelemetry :: AppContext -&gt; TelemetryStatus
acConsoleStatus :: AppContext -&gt; ConsoleStatus
acCorsConfig :: AppContext -&gt; CorsConfig
acStreamQueryOptions :: AppContext -&gt; StreamQueriesOptions
acLiveQueryOptions :: AppContext -&gt; StreamQueriesOptions
acMetadataDefaults :: AppContext -&gt; MetadataDefaults
acDefaultNamingConvention :: AppContext -&gt; NamingCase
acExperimentalFeatures :: AppContext -&gt; HashSet ExperimentalFeature
acFunctionPermsCtx :: AppContext -&gt; InferFunctionPermissions
acRemoteSchemaPermsCtx :: AppContext -&gt; RemoteSchemaPermissions
acEnvironment :: AppContext -&gt; Environment
acResponseInternalErrorsConfig :: AppContext -&gt; ResponseInternalErrorsConfig
acEnableAllowlist :: AppContext -&gt; AllowListStatus
acSQLGenCtx :: AppContext -&gt; SQLGenCtx
acAuthMode :: AppContext -&gt; AuthMode
acCacheRef :: AppContext -&gt; SchemaCacheRef
acEnabledAPIs :: AppContext -&gt; HashSet API
</span><a href="#local-6989586621690825942"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppContext
</span><a href="Hasura.Server.App.html#hcAppContext"><span class="hs-identifier hs-var">hcAppContext</span></a></span><span>
</span><span id="line-583"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621690825941"><span class="annot"><span class="annottext">RebuildableSchemaCache
</span><a href="#local-6989586621690825941"><span class="hs-identifier hs-var">sc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690825940"><span class="annot"><span class="annottext">SchemaCacheVer
</span><a href="#local-6989586621690825940"><span class="hs-identifier hs-var">scVer</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCacheRef -&gt; IO (RebuildableSchemaCache, SchemaCacheVer)
</span><a href="Hasura.Server.SchemaCacheRef.html#readSchemaCacheRef"><span class="hs-identifier hs-var">readSchemaCacheRef</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCacheRef
</span><a href="#local-6989586621690825963"><span class="hs-identifier hs-var">acCacheRef</span></a></span><span>
</span><span id="line-584"></span><span>  </span><span id="local-6989586621690825939"><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621690825939"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Loggers -&gt; Logger Hasura
</span><a href="Hasura.App.State.html#_lsLogger"><span class="hs-identifier hs-var">_lsLogger</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">AppEnv -&gt; Loggers
</span><a href="Hasura.App.State.html#appEnvLoggers"><span class="hs-identifier hs-var">appEnvLoggers</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppEnv
</span><a href="Hasura.Server.App.html#hcAppEnv"><span class="hs-identifier hs-var">hcAppEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-585"></span><span>  </span><span id="local-6989586621690825938"><span class="annot"><span class="annottext">ReadOnlyMode
</span><a href="#local-6989586621690825938"><span class="hs-identifier hs-var">readOnlyMode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppEnv -&gt; ReadOnlyMode
</span><a href="Hasura.App.State.html#appEnvEnableReadOnlyMode"><span class="hs-identifier hs-var">appEnvEnableReadOnlyMode</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppEnv
</span><a href="Hasura.Server.App.html#hcAppEnv"><span class="hs-identifier hs-var">hcAppEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-586"></span><span>  </span><span id="local-6989586621690825937"><span class="annot"><span class="annottext">PrometheusMetrics
</span><a href="#local-6989586621690825937"><span class="hs-identifier hs-var">prometheusMetrics</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppEnv -&gt; PrometheusMetrics
</span><a href="Hasura.App.State.html#appEnvPrometheusMetrics"><span class="hs-identifier hs-var">appEnvPrometheusMetrics</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppEnv
</span><a href="Hasura.Server.App.html#hcAppEnv"><span class="hs-identifier hs-var">hcAppEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-587"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
-&gt; SQLGenCtx
-&gt; SchemaCache
-&gt; SchemaCacheVer
-&gt; AllowListStatus
-&gt; ReadOnlyMode
-&gt; PrometheusMetrics
-&gt; ExecutionCtx
</span><a href="Hasura.GraphQL.Execute.html#ExecutionCtx"><span class="hs-identifier hs-var">E.ExecutionCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621690825939"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">SQLGenCtx
</span><a href="#local-6989586621690825961"><span class="hs-identifier hs-var">acSQLGenCtx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RebuildableSchemaCache -&gt; SchemaCache
</span><a href="Hasura.RQL.DDL.Schema.Cache.Common.html#lastBuiltSchemaCache"><span class="hs-identifier hs-var">lastBuiltSchemaCache</span></a></span><span> </span><span class="annot"><span class="annottext">RebuildableSchemaCache
</span><a href="#local-6989586621690825941"><span class="hs-identifier hs-var">sc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SchemaCacheVer
</span><a href="#local-6989586621690825940"><span class="hs-identifier hs-var">scVer</span></a></span><span> </span><span class="annot"><span class="annottext">AllowListStatus
</span><a href="#local-6989586621690825959"><span class="hs-identifier hs-var">acEnableAllowlist</span></a></span><span> </span><span class="annot"><span class="annottext">ReadOnlyMode
</span><a href="#local-6989586621690825938"><span class="hs-identifier hs-var">readOnlyMode</span></a></span><span> </span><span class="annot"><span class="annottext">PrometheusMetrics
</span><a href="#local-6989586621690825937"><span class="hs-identifier hs-var">prometheusMetrics</span></a></span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span id="local-6989586621690827824"><span class="annot"><a href="Hasura.Server.App.html#v1GQHandler"><span class="hs-identifier hs-type">v1GQHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-590"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827824"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-591"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadBaseControl</span></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827824"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-592"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Execute.Common.html#MonadGQLExecutionCheck"><span class="hs-identifier hs-type">E.MonadGQLExecutionCheck</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827824"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-593"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Logging.html#MonadQueryLog"><span class="hs-identifier hs-type">MonadQueryLog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827824"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-594"></span><span>    </span><span class="annot"><a href="Hasura.Tracing.html#MonadTrace"><span class="hs-identifier hs-type">Tracing.MonadTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827824"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-595"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.html#MonadExecuteQuery"><span class="hs-identifier hs-type">GH.MonadExecuteQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827824"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-596"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827824"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-597"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.App.html#HandlerCtx"><span class="hs-identifier hs-type">HandlerCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827824"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-598"></span><span>    </span><span class="annot"><a href="Hasura.Metadata.Class.html#MonadMetadataStorage"><span class="hs-identifier hs-type">MonadMetadataStorage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827824"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-599"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Execute.Backend.html#MonadQueryTags"><span class="hs-identifier hs-type">EB.MonadQueryTags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827824"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-600"></span><span>    </span><span class="annot"><a href="Hasura.Server.Limits.html#HasResourceLimits"><span class="hs-identifier hs-type">HasResourceLimits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827824"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-601"></span><span>    </span><span class="annot"><a href="Hasura.Services.Network.html#ProvidesNetwork"><span class="hs-identifier hs-type">ProvidesNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827824"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-602"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-603"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#GQLBatchedReqs"><span class="hs-identifier hs-type">GH.GQLBatchedReqs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#GQLReq"><span class="hs-identifier hs-type">GH.GQLReq</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#GQLQueryText"><span class="hs-identifier hs-type">GH.GQLQueryText</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-604"></span><span>  </span><span class="annot"><a href="#local-6989586621690827824"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogGraphQLInfo"><span class="hs-identifier hs-type">HttpLogGraphQLInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.HTTP.html#HttpResponse"><span class="hs-identifier hs-type">HttpResponse</span></a></span><span> </span><span class="annot"><a href="Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-605"></span><span id="v1GQHandler"><span class="annot"><span class="annottext">v1GQHandler :: forall (m :: * -&gt; *).
(MonadIO m, MonadBaseControl IO m, MonadGQLExecutionCheck m,
 MonadQueryLog m, MonadTrace m, MonadExecuteQuery m,
 MonadError QErr m, MonadReader HandlerCtx m,
 MonadMetadataStorage m, MonadQueryTags m, HasResourceLimits m,
 ProvidesNetwork m) =&gt;
ReqsText -&gt; m (HttpLogGraphQLInfo, HttpResponse EncJSON)
</span><a href="Hasura.Server.App.html#v1GQHandler"><span class="hs-identifier hs-var hs-var">v1GQHandler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadBaseControl IO m, MonadGQLExecutionCheck m,
 MonadQueryLog m, MonadTrace m, MonadExecuteQuery m,
 MonadError QErr m, MonadReader HandlerCtx m,
 MonadMetadataStorage m, MonadQueryTags m, HasResourceLimits m,
 ProvidesNetwork m) =&gt;
GraphQLQueryType
-&gt; ReqsText -&gt; m (HttpLogGraphQLInfo, HttpResponse EncJSON)
</span><a href="Hasura.Server.App.html#v1Alpha1GQHandler"><span class="hs-identifier hs-var">v1Alpha1GQHandler</span></a></span><span> </span><span class="annot"><span class="annottext">GraphQLQueryType
</span><a href="Hasura.GraphQL.Execute.Types.html#QueryHasura"><span class="hs-identifier hs-var">E.QueryHasura</span></a></span><span>
</span><span id="line-606"></span><span>
</span><span id="line-607"></span><span id="local-6989586621690825908"><span class="annot"><a href="Hasura.Server.App.html#v1GQRelayHandler"><span class="hs-identifier hs-type">v1GQRelayHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-608"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690825908"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-609"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadBaseControl</span></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690825908"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-610"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Execute.Common.html#MonadGQLExecutionCheck"><span class="hs-identifier hs-type">E.MonadGQLExecutionCheck</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690825908"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-611"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Logging.html#MonadQueryLog"><span class="hs-identifier hs-type">MonadQueryLog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690825908"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-612"></span><span>    </span><span class="annot"><a href="Hasura.Tracing.html#MonadTrace"><span class="hs-identifier hs-type">Tracing.MonadTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690825908"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-613"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.html#MonadExecuteQuery"><span class="hs-identifier hs-type">GH.MonadExecuteQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690825908"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-614"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690825908"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-615"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.App.html#HandlerCtx"><span class="hs-identifier hs-type">HandlerCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690825908"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-616"></span><span>    </span><span class="annot"><a href="Hasura.Metadata.Class.html#MonadMetadataStorage"><span class="hs-identifier hs-type">MonadMetadataStorage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690825908"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-617"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Execute.Backend.html#MonadQueryTags"><span class="hs-identifier hs-type">EB.MonadQueryTags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690825908"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-618"></span><span>    </span><span class="annot"><a href="Hasura.Server.Limits.html#HasResourceLimits"><span class="hs-identifier hs-type">HasResourceLimits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690825908"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-619"></span><span>    </span><span class="annot"><a href="Hasura.Services.Network.html#ProvidesNetwork"><span class="hs-identifier hs-type">ProvidesNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690825908"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-620"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-621"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#GQLBatchedReqs"><span class="hs-identifier hs-type">GH.GQLBatchedReqs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#GQLReq"><span class="hs-identifier hs-type">GH.GQLReq</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#GQLQueryText"><span class="hs-identifier hs-type">GH.GQLQueryText</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-622"></span><span>  </span><span class="annot"><a href="#local-6989586621690825908"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogGraphQLInfo"><span class="hs-identifier hs-type">HttpLogGraphQLInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.HTTP.html#HttpResponse"><span class="hs-identifier hs-type">HttpResponse</span></a></span><span> </span><span class="annot"><a href="Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-623"></span><span id="v1GQRelayHandler"><span class="annot"><span class="annottext">v1GQRelayHandler :: forall (m :: * -&gt; *).
(MonadIO m, MonadBaseControl IO m, MonadGQLExecutionCheck m,
 MonadQueryLog m, MonadTrace m, MonadExecuteQuery m,
 MonadError QErr m, MonadReader HandlerCtx m,
 MonadMetadataStorage m, MonadQueryTags m, HasResourceLimits m,
 ProvidesNetwork m) =&gt;
ReqsText -&gt; m (HttpLogGraphQLInfo, HttpResponse EncJSON)
</span><a href="Hasura.Server.App.html#v1GQRelayHandler"><span class="hs-identifier hs-var hs-var">v1GQRelayHandler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadBaseControl IO m, MonadGQLExecutionCheck m,
 MonadQueryLog m, MonadTrace m, MonadExecuteQuery m,
 MonadError QErr m, MonadReader HandlerCtx m,
 MonadMetadataStorage m, MonadQueryTags m, HasResourceLimits m,
 ProvidesNetwork m) =&gt;
GraphQLQueryType
-&gt; ReqsText -&gt; m (HttpLogGraphQLInfo, HttpResponse EncJSON)
</span><a href="Hasura.Server.App.html#v1Alpha1GQHandler"><span class="hs-identifier hs-var">v1Alpha1GQHandler</span></a></span><span> </span><span class="annot"><span class="annottext">GraphQLQueryType
</span><a href="Hasura.GraphQL.Execute.Types.html#QueryRelay"><span class="hs-identifier hs-var">E.QueryRelay</span></a></span><span>
</span><span id="line-624"></span><span>
</span><span id="line-625"></span><span class="annot"><a href="Hasura.Server.App.html#gqlExplainHandler"><span class="hs-identifier hs-type">gqlExplainHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-626"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621690827821"><span class="annot"><a href="#local-6989586621690827821"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-627"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827821"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-628"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadBaseControl</span></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827821"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-629"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827821"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-630"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.App.html#HandlerCtx"><span class="hs-identifier hs-type">HandlerCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827821"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-631"></span><span>    </span><span class="annot"><a href="Hasura.Metadata.Class.html#MonadMetadataStorage"><span class="hs-identifier hs-type">MonadMetadataStorage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827821"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-632"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Execute.Backend.html#MonadQueryTags"><span class="hs-identifier hs-type">EB.MonadQueryTags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827821"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-633"></span><span>    </span><span class="annot"><a href="Hasura.Tracing.html#MonadTrace"><span class="hs-identifier hs-type">Tracing.MonadTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827821"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-634"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-635"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Explain.html#GQLExplain"><span class="hs-identifier hs-type">GE.GQLExplain</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-636"></span><span>  </span><span class="annot"><a href="#local-6989586621690827821"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.HTTP.html#HttpResponse"><span class="hs-identifier hs-type">HttpResponse</span></a></span><span> </span><span class="annot"><a href="Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-637"></span><span id="gqlExplainHandler"><span class="annot"><span class="annottext">gqlExplainHandler :: forall (m :: * -&gt; *).
(MonadIO m, MonadBaseControl IO m, MonadError QErr m,
 MonadReader HandlerCtx m, MonadMetadataStorage m, MonadQueryTags m,
 MonadTrace m) =&gt;
GQLExplain -&gt; m (HttpResponse EncJSON)
</span><a href="Hasura.Server.App.html#gqlExplainHandler"><span class="hs-identifier hs-var hs-var">gqlExplainHandler</span></a></span></span><span> </span><span id="local-6989586621690825855"><span class="annot"><span class="annottext">GQLExplain
</span><a href="#local-6989586621690825855"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-638"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadError QErr m, MonadReader HandlerCtx m) =&gt;
m ()
</span><a href="Hasura.Server.App.html#onlyAdmin"><span class="hs-identifier hs-var">onlyAdmin</span></a></span><span>
</span><span id="line-639"></span><span>  </span><span id="local-6989586621690825854"><span class="annot"><span class="annottext">SchemaCacheRef
</span><a href="#local-6989586621690825854"><span class="hs-identifier hs-var">scRef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppContext -&gt; SchemaCacheRef
</span><a href="Hasura.App.State.html#acCacheRef"><span class="hs-identifier hs-var">acCacheRef</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppContext
</span><a href="Hasura.Server.App.html#hcAppContext"><span class="hs-identifier hs-var">hcAppContext</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>  </span><span id="local-6989586621690825853"><span class="annot"><span class="annottext">SchemaCache
</span><a href="#local-6989586621690825853"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCacheRef -&gt; IO SchemaCache
</span><a href="Hasura.Server.SchemaCacheRef.html#getSchemaCache"><span class="hs-identifier hs-var">getSchemaCache</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCacheRef
</span><a href="#local-6989586621690825854"><span class="hs-identifier hs-var">scRef</span></a></span><span>
</span><span id="line-641"></span><span>  </span><span id="local-6989586621690825852"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690825852"><span class="hs-identifier hs-var">reqHeaders</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; [Header]
</span><a href="Hasura.Server.App.html#hcReqHeaders"><span class="hs-identifier hs-var">hcReqHeaders</span></a></span><span>
</span><span id="line-642"></span><span>  </span><span id="local-6989586621690825851"><span class="annot"><span class="annottext">EncJSON
</span><a href="#local-6989586621690825851"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadError QErr m, MonadIO m, MonadBaseControl IO m,
 MonadMetadataStorage m, MonadQueryTags m, MonadTrace m) =&gt;
SchemaCache -&gt; [Header] -&gt; GQLExplain -&gt; m EncJSON
</span><a href="Hasura.GraphQL.Explain.html#explainGQLQuery"><span class="hs-identifier hs-var">GE.explainGQLQuery</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCache
</span><a href="#local-6989586621690825853"><span class="hs-identifier hs-var">sc</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690825852"><span class="hs-identifier hs-var">reqHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">GQLExplain
</span><a href="#local-6989586621690825855"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-643"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [Header] -&gt; HttpResponse a
</span><a href="Hasura.HTTP.html#HttpResponse"><span class="hs-identifier hs-var">HttpResponse</span></a></span><span> </span><span class="annot"><span class="annottext">EncJSON
</span><a href="#local-6989586621690825851"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-644"></span><span>
</span><span id="line-645"></span><span id="local-6989586621690827817"><span class="annot"><a href="Hasura.Server.App.html#v1Alpha1PGDumpHandler"><span class="hs-identifier hs-type">v1Alpha1PGDumpHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827817"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827817"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.App.html#HandlerCtx"><span class="hs-identifier hs-type">HandlerCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827817"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.API.PGDump.html#PGDumpReqBody"><span class="hs-identifier hs-type">PGD.PGDumpReqBody</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690827817"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.App.html#APIResp"><span class="hs-identifier hs-type">APIResp</span></a></span></span><span>
</span><span id="line-646"></span><span id="v1Alpha1PGDumpHandler"><span class="annot"><span class="annottext">v1Alpha1PGDumpHandler :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m, MonadReader HandlerCtx m) =&gt;
PGDumpReqBody -&gt; m APIResp
</span><a href="Hasura.Server.App.html#v1Alpha1PGDumpHandler"><span class="hs-identifier hs-var hs-var">v1Alpha1PGDumpHandler</span></a></span></span><span> </span><span id="local-6989586621690825814"><span class="annot"><span class="annottext">PGDumpReqBody
</span><a href="#local-6989586621690825814"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-647"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadError QErr m, MonadReader HandlerCtx m) =&gt;
m ()
</span><a href="Hasura.Server.App.html#onlyAdmin"><span class="hs-identifier hs-var">onlyAdmin</span></a></span><span>
</span><span id="line-648"></span><span>  </span><span id="local-6989586621690825813"><span class="annot"><span class="annottext">SchemaCacheRef
</span><a href="#local-6989586621690825813"><span class="hs-identifier hs-var">scRef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppContext -&gt; SchemaCacheRef
</span><a href="Hasura.App.State.html#acCacheRef"><span class="hs-identifier hs-var">acCacheRef</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; AppContext
</span><a href="Hasura.Server.App.html#hcAppContext"><span class="hs-identifier hs-var">hcAppContext</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-649"></span><span>  </span><span id="local-6989586621690825812"><span class="annot"><span class="annottext">SchemaCache
</span><a href="#local-6989586621690825812"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCacheRef -&gt; IO SchemaCache
</span><a href="Hasura.Server.SchemaCacheRef.html#getSchemaCache"><span class="hs-identifier hs-var">getSchemaCache</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCacheRef
</span><a href="#local-6989586621690825813"><span class="hs-identifier hs-var">scRef</span></a></span><span>
</span><span id="line-650"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690825811"><span class="annot"><span class="annottext">sources :: SourceCache
</span><a href="#local-6989586621690825811"><span class="hs-identifier hs-var hs-var">sources</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SchemaCache -&gt; SourceCache
</span><a href="Hasura.RQL.Types.SchemaCache.html#scSources"><span class="hs-identifier hs-var">scSources</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCache
</span><a href="#local-6989586621690825812"><span class="hs-identifier hs-var">sc</span></a></span><span>
</span><span id="line-651"></span><span>      </span><span id="local-6989586621690825809"><span class="annot"><span class="annottext">sourceName :: SourceName
</span><a href="#local-6989586621690825809"><span class="hs-identifier hs-var hs-var">sourceName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PGDumpReqBody -&gt; SourceName
</span><a href="Hasura.Server.API.PGDump.html#prbSource"><span class="hs-identifier hs-var">PGD.prbSource</span></a></span><span> </span><span class="annot"><span class="annottext">PGDumpReqBody
</span><a href="#local-6989586621690825814"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-652"></span><span>      </span><span id="local-6989586621690825807"><span class="annot"><span class="annottext">sourceConfig :: Maybe PGSourceConfig
</span><a href="#local-6989586621690825807"><span class="hs-identifier hs-var hs-var">sourceConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType).
HasTag b =&gt;
AnyBackend SourceInfo -&gt; Maybe (SourceConfig b)
</span><a href="Hasura.RQL.Types.Source.html#unsafeSourceConfiguration"><span class="hs-identifier hs-var">unsafeSourceConfiguration</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><a href="#local-6989586621690825809"><span class="hs-identifier hs-var">sourceName</span></a></span><span> </span><span class="annot"><span class="annottext">SourceCache
</span><a href="#local-6989586621690825811"><span class="hs-identifier hs-var">sources</span></a></span><span>
</span><span id="line-653"></span><span>  </span><span id="local-6989586621690825804"><span class="annot"><span class="annottext">ConnInfo
</span><a href="#local-6989586621690825804"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-654"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">PGSourceConfig -&gt; ConnInfo
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#_pscConnInfo"><span class="hs-identifier hs-var">_pscConnInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PGSourceConfig
</span><a href="#local-6989586621690825807"><span class="hs-identifier hs-var">sourceConfig</span></a></span><span>
</span><span id="line-655"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Applicative m =&gt; Maybe a -&gt; m a -&gt; m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-operator hs-var">`onNothing`</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotFound"><span class="hs-identifier hs-var">NotFound</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;source &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><a href="#local-6989586621690825809"><span class="hs-identifier hs-var">sourceName</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; not found&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-656"></span><span>  </span><span id="local-6989586621690825799"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690825799"><span class="hs-identifier hs-var">output</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadError QErr m, MonadIO m) =&gt;
PGDumpReqBody -&gt; ConnInfo -&gt; m ByteString
</span><a href="Hasura.Server.API.PGDump.html#execPGDump"><span class="hs-identifier hs-var">PGD.execPGDump</span></a></span><span> </span><span class="annot"><span class="annottext">PGDumpReqBody
</span><a href="#local-6989586621690825814"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">ConnInfo
</span><a href="#local-6989586621690825804"><span class="hs-identifier hs-var">ci</span></a></span><span>
</span><span id="line-657"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">HttpResponse ByteString -&gt; APIResp
</span><a href="Hasura.Server.App.html#RawResp"><span class="hs-identifier hs-var">RawResp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [Header] -&gt; HttpResponse a
</span><a href="Hasura.HTTP.html#HttpResponse"><span class="hs-identifier hs-var">HttpResponse</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690825799"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Header
</span><a href="Hasura.Server.Utils.html#sqlHeader"><span class="hs-identifier hs-var">sqlHeader</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-658"></span><span>
</span><span id="line-659"></span><span id="local-6989586621690827800"><span class="annot"><a href="Hasura.Server.App.html#consoleAssetsHandler"><span class="hs-identifier hs-type">consoleAssetsHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-660"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827800"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLog"><span class="hs-identifier hs-type">HttpLog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827800"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-661"></span><span>  </span><span class="annot"><a href="Hasura.Logging.html#Logger"><span class="hs-identifier hs-type">L.Logger</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">L.Hasura</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-662"></span><span>  </span><span class="annot"><a href="Hasura.Server.Logging.html#LoggingSettings"><span class="hs-identifier hs-type">LoggingSettings</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-663"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-664"></span><span>  </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-665"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Spock.ActionT</span></span><span> </span><span class="annot"><a href="#local-6989586621690827800"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-666"></span><span id="consoleAssetsHandler"><span class="annot"><span class="annottext">consoleAssetsHandler :: forall (m :: * -&gt; *).
(MonadIO m, HttpLog m) =&gt;
Logger Hasura -&gt; LoggingSettings -&gt; Text -&gt; [Char] -&gt; ActionT m ()
</span><a href="Hasura.Server.App.html#consoleAssetsHandler"><span class="hs-identifier hs-var hs-var">consoleAssetsHandler</span></a></span></span><span> </span><span id="local-6989586621690825774"><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621690825774"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621690825773"><span class="annot"><span class="annottext">LoggingSettings
</span><a href="#local-6989586621690825773"><span class="hs-identifier hs-var">loggingSettings</span></a></span></span><span> </span><span id="local-6989586621690825772"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690825772"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span id="local-6989586621690825771"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621690825771"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-667"></span><span>  </span><span id="local-6989586621690825770"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690825770"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx. MonadIO m =&gt; ActionCtxT ctx m Request
</span><span class="hs-identifier hs-var">Spock.request</span></span><span>
</span><span id="line-668"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690825769"><span class="annot"><span class="annottext">reqHeaders :: [Header]
</span><a href="#local-6989586621690825769"><span class="hs-identifier hs-var hs-var">reqHeaders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; [Header]
</span><span class="hs-identifier hs-var">Wai.requestHeaders</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690825770"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-669"></span><span>  </span><span class="hs-comment">-- '..' in paths need not be handed as it is resolved in the url by</span><span>
</span><span id="line-670"></span><span>  </span><span class="hs-comment">-- spock's routing. we get the expanded path.</span><span>
</span><span id="line-671"></span><span>  </span><span id="local-6989586621690825768"><span class="annot"><span class="annottext">Either IOException ByteString
</span><a href="#local-6989586621690825768"><span class="hs-identifier hs-var">eFileContents</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-672"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-673"></span><span>      </span><span class="annot"><span class="annottext">forall e a. Exception e =&gt; IO a -&gt; IO (Either e a)
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">try</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-674"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; IO ByteString
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-var">BL.readFile</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-675"></span><span>          </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/filepath-1.4.2.2/src"><span class="hs-identifier hs-var">joinPath</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690825772"><span class="hs-identifier hs-var">dir</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621690825771"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-676"></span><span>  </span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, HttpLog m) =&gt;
[Header] -&gt; IOException -&gt; ActionT m ()
</span><a href="#local-6989586621690825764"><span class="hs-identifier hs-var">onError</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690825769"><span class="hs-identifier hs-var">reqHeaders</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ActionT m ()
</span><a href="#local-6989586621690825763"><span class="hs-identifier hs-var">onSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">Either IOException ByteString
</span><a href="#local-6989586621690825768"><span class="hs-identifier hs-var">eFileContents</span></a></span><span>
</span><span id="line-677"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-678"></span><span>    </span><span id="local-6989586621690825763"><span class="annot"><span class="annottext">onSuccess :: ByteString -&gt; ActionT m ()
</span><a href="#local-6989586621690825763"><span class="hs-identifier hs-var hs-var">onSuccess</span></a></span></span><span> </span><span id="local-6989586621690825762"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690825762"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-679"></span><span>      </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx.
MonadIO m =&gt;
Header -&gt; ActionCtxT ctx m ()
</span><a href="Hasura.Server.App.html#setHeader"><span class="hs-identifier hs-var">setHeader</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690825761"><span class="hs-identifier hs-var">headers</span></a></span><span>
</span><span id="line-680"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx a.
MonadIO m =&gt;
ByteString -&gt; ActionCtxT ctx m a
</span><span class="hs-identifier hs-var">Spock.lazyBytes</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690825762"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-681"></span><span>    </span><span id="local-6989586621690827791"><span class="annot"><a href="#local-6989586621690825764"><span class="hs-identifier hs-type">onError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827791"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLog"><span class="hs-identifier hs-type">HttpLog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827791"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">HTTP.Header</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">IOException</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Spock.ActionT</span></span><span> </span><span class="annot"><a href="#local-6989586621690827791"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-682"></span><span>    </span><span id="local-6989586621690825764"><span class="annot"><span class="annottext">onError :: forall (m :: * -&gt; *).
(MonadIO m, HttpLog m) =&gt;
[Header] -&gt; IOException -&gt; ActionT m ()
</span><a href="#local-6989586621690825764"><span class="hs-identifier hs-var hs-var">onError</span></a></span></span><span> </span><span id="local-6989586621690825754"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690825754"><span class="hs-identifier hs-var">hdrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, HttpLog m) =&gt;
Logger Hasura
-&gt; LoggingSettings -&gt; [Header] -&gt; QErr -&gt; ActionT m ()
</span><a href="Hasura.Server.App.html#raiseGenericApiError"><span class="hs-identifier hs-var">raiseGenericApiError</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621690825774"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">LoggingSettings
</span><a href="#local-6989586621690825773"><span class="hs-identifier hs-var">loggingSettings</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690825754"><span class="hs-identifier hs-var">hdrs</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; QErr
</span><a href="Hasura.Base.Error.html#err404"><span class="hs-identifier hs-var">err404</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotFound"><span class="hs-identifier hs-var">NotFound</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; Text
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier hs-var">tshow</span></a></span><span>
</span><span id="line-683"></span><span>    </span><span id="local-6989586621690825750"><span class="annot"><span class="annottext">fn :: Text
</span><a href="#local-6989586621690825750"><span class="hs-identifier hs-var hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/filepath-1.4.2.2/src"><span class="hs-identifier hs-var">takeFileName</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621690825771"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-684"></span><span>    </span><span class="hs-comment">-- set gzip header if the filename ends with .gz</span><span>
</span><span id="line-685"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621690825749"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690825749"><span class="hs-identifier hs-var">fileName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690825748"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690825748"><span class="hs-identifier hs-var">encHeader</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Maybe Text
</span><span class="hs-identifier hs-var">T.stripSuffix</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.gz&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690825750"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-686"></span><span>      </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621690825746"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690825746"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690825746"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Header
</span><a href="Hasura.Server.Utils.html#gzipHeader"><span class="hs-identifier hs-var">gzipHeader</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-687"></span><span>      </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690825750"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-688"></span><span>    </span><span id="local-6989586621690825744"><span class="annot"><span class="annottext">mimeType :: ByteString
</span><a href="#local-6989586621690825744"><span class="hs-identifier hs-var hs-var">mimeType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">defaultMimeLookup</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690825749"><span class="hs-identifier hs-var">fileName</span></a></span><span>
</span><span id="line-689"></span><span>    </span><span id="local-6989586621690825761"><span class="annot"><span class="annottext">headers :: [Header]
</span><a href="#local-6989586621690825761"><span class="hs-identifier hs-var hs-var">headers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HeaderName
</span><span class="hs-string">&quot;Content-Type&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690825744"><span class="hs-identifier hs-var">mimeType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690825748"><span class="hs-identifier hs-var">encHeader</span></a></span><span>
</span><span id="line-690"></span><span>
</span><span id="line-691"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827787"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="ConsoleRenderer"><span class="annot"><a href="Hasura.Server.App.html#ConsoleRenderer"><span class="hs-identifier hs-var">ConsoleRenderer</span></a></span></span><span> </span><span id="local-6989586621690827787"><span class="annot"><a href="#local-6989586621690827787"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-692"></span><span>  </span><span id="renderConsole"><span class="annot"><a href="Hasura.Server.App.html#renderConsole"><span class="hs-identifier hs-type">renderConsole</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.Auth.html#AuthMode"><span class="hs-identifier hs-type">AuthMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html#TelemetryStatus"><span class="hs-identifier hs-type">TelemetryStatus</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690827787"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-693"></span><span>
</span><span id="line-694"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621690827784"><span class="annot"><a href="Hasura.Server.App.html#ConsoleRenderer"><span class="hs-identifier hs-type">ConsoleRenderer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827784"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#ConsoleRenderer"><span class="hs-identifier hs-type">ConsoleRenderer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Tracing.html#TraceT"><span class="hs-identifier hs-type">Tracing.TraceT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827784"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-695"></span><span>  </span><span id="local-6989586621690825731"><span class="annot"><span class="annottext">renderConsole :: Text
-&gt; AuthMode
-&gt; TelemetryStatus
-&gt; Maybe Text
-&gt; Maybe Text
-&gt; TraceT m (Either [Char] Text)
</span><a href="#local-6989586621690825731"><span class="hs-identifier hs-var hs-var hs-var hs-var">renderConsole</span></a></span></span><span> </span><span id="local-6989586621690825730"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690825730"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621690825729"><span class="annot"><span class="annottext">AuthMode
</span><a href="#local-6989586621690825729"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621690825728"><span class="annot"><span class="annottext">TelemetryStatus
</span><a href="#local-6989586621690825728"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621690825727"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690825727"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621690825726"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690825726"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ConsoleRenderer m =&gt;
Text
-&gt; AuthMode
-&gt; TelemetryStatus
-&gt; Maybe Text
-&gt; Maybe Text
-&gt; m (Either [Char] Text)
</span><a href="Hasura.Server.App.html#renderConsole"><span class="hs-identifier hs-var">renderConsole</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690825730"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">AuthMode
</span><a href="#local-6989586621690825729"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">TelemetryStatus
</span><a href="#local-6989586621690825728"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690825727"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690825726"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-696"></span><span>
</span><span id="line-697"></span><span class="hs-comment">-- Type class to get any extra [Pair] for the version API</span><span>
</span><span id="line-698"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827783"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="MonadVersionAPIWithExtraData"><span class="annot"><a href="Hasura.Server.App.html#MonadVersionAPIWithExtraData"><span class="hs-identifier hs-var">MonadVersionAPIWithExtraData</span></a></span></span><span> </span><span id="local-6989586621690827783"><span class="annot"><a href="#local-6989586621690827783"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-699"></span><span>  </span><span id="getExtraDataForVersionAPI"><span class="annot"><a href="Hasura.Server.App.html#getExtraDataForVersionAPI"><span class="hs-identifier hs-type">getExtraDataForVersionAPI</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621690827783"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">J.Pair</span></span><span class="hs-special">]</span><span>
</span><span id="line-700"></span><span>
</span><span id="line-701"></span><span class="annot"><a href="Hasura.Server.App.html#renderHtmlTemplate"><span class="hs-identifier hs-type">renderHtmlTemplate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Template</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-702"></span><span id="renderHtmlTemplate"><span class="annot"><span class="annottext">renderHtmlTemplate :: Template -&gt; Value -&gt; Either [Char] Text
</span><a href="Hasura.Server.App.html#renderHtmlTemplate"><span class="hs-identifier hs-var hs-var">renderHtmlTemplate</span></a></span></span><span> </span><span id="local-6989586621690825723"><span class="annot"><span class="annottext">Template
</span><a href="#local-6989586621690825723"><span class="hs-identifier hs-var">template</span></a></span></span><span> </span><span id="local-6989586621690825722"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621690825722"><span class="hs-identifier hs-var">jVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-703"></span><span>  </span><span class="annot"><span class="annottext">forall a. a -&gt; a -&gt; Bool -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">bool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621690825721"><span class="hs-identifier hs-var">errMsg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690825720"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[SubstitutionError]
</span><a href="#local-6989586621690825718"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-704"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-705"></span><span>    </span><span id="local-6989586621690825721"><span class="annot"><span class="annottext">errMsg :: [Char]
</span><a href="#local-6989586621690825721"><span class="hs-identifier hs-var hs-var">errMsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;template rendering failed: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; [Char]
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[SubstitutionError]
</span><a href="#local-6989586621690825718"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-706"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621690825718"><span class="annot"><span class="annottext">[SubstitutionError]
</span><a href="#local-6989586621690825718"><span class="hs-identifier hs-var">errs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690825720"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690825720"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k.
ToMustache k =&gt;
Template -&gt; k -&gt; ([SubstitutionError], Text)
</span><span class="hs-identifier hs-var">M.checkedSubstitute</span></span><span> </span><span class="annot"><span class="annottext">Template
</span><a href="#local-6989586621690825723"><span class="hs-identifier hs-var">template</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621690825722"><span class="hs-identifier hs-var">jVal</span></a></span><span>
</span><span id="line-707"></span><span>
</span><span id="line-708"></span><span class="hs-comment">-- | Default implementation of the 'MonadConfigApiHandler'</span><span>
</span><span id="line-709"></span><span class="annot"><a href="Hasura.Server.App.html#configApiGetHandler"><span class="hs-identifier hs-type">configApiGetHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-710"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621690827773"><span class="annot"><a href="#local-6989586621690827773"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-711"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827773"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadBaseControl</span></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827773"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.Auth.html#UserAuthentication"><span class="hs-identifier hs-type">UserAuthentication</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Tracing.html#TraceT"><span class="hs-identifier hs-type">Tracing.TraceT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827773"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLog"><span class="hs-identifier hs-type">HttpLog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827773"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Tracing.html#HasReporter"><span class="hs-identifier hs-type">Tracing.HasReporter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827773"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.Limits.html#HasResourceLimits"><span class="hs-identifier hs-type">HasResourceLimits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827773"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-712"></span><span>  </span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-713"></span><span>  </span><span class="annot"><a href="Hasura.App.State.html#AppEnv"><span class="hs-identifier hs-type">AppEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-714"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Spock.SpockCtxT</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621690827773"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-715"></span><span id="configApiGetHandler"><span class="annot"><span class="annottext">configApiGetHandler :: forall (m :: * -&gt; *).
(MonadIO m, MonadBaseControl IO m, UserAuthentication (TraceT m),
 HttpLog m, HasReporter m, HasResourceLimits m) =&gt;
AppContext -&gt; AppEnv -&gt; SpockCtxT () m ()
</span><a href="Hasura.Server.App.html#configApiGetHandler"><span class="hs-identifier hs-var hs-var">configApiGetHandler</span></a></span></span><span> </span><span id="local-6989586621690825684"><span class="annot"><span class="annottext">appCtx :: AppContext
</span><a href="#local-6989586621690825684"><span class="hs-identifier hs-var">appCtx</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621690825662"><span id="local-6989586621690825663"><span id="local-6989586621690825664"><span id="local-6989586621690825665"><span id="local-6989586621690825666"><span id="local-6989586621690825667"><span id="local-6989586621690825668"><span id="local-6989586621690825669"><span id="local-6989586621690825670"><span id="local-6989586621690825671"><span id="local-6989586621690825672"><span id="local-6989586621690825673"><span id="local-6989586621690825674"><span id="local-6989586621690825675"><span id="local-6989586621690825676"><span id="local-6989586621690825677"><span id="local-6989586621690825678"><span id="local-6989586621690825679"><span id="local-6989586621690825680"><span id="local-6989586621690825681"><span id="local-6989586621690825682"><span id="local-6989586621690825683"><span class="annot"><span class="annottext">HashSet ExperimentalFeature
HashSet API
Environment
Refined NonNegative Int
Refined NonNegative Milliseconds
Refined Positive Int
StreamQueriesOptions
NamingCase
RemoteSchemaPermissions
InferFunctionPermissions
SQLGenCtx
CorsConfig
MetadataDefaults
SchemaCacheRef
AuthMode
ResponseInternalErrorsConfig
OptionalInterval
TelemetryStatus
AllowListStatus
ConsoleStatus
acSchemaPollInterval :: OptionalInterval
acAsyncActionsFetchInterval :: OptionalInterval
acEventsFetchBatchSize :: Refined NonNegative Int
acEventsFetchInterval :: Refined NonNegative Milliseconds
acEventsHttpPoolSize :: Refined Positive Int
acEnableTelemetry :: TelemetryStatus
acConsoleStatus :: ConsoleStatus
acCorsConfig :: CorsConfig
acStreamQueryOptions :: StreamQueriesOptions
acLiveQueryOptions :: StreamQueriesOptions
acMetadataDefaults :: MetadataDefaults
acDefaultNamingConvention :: NamingCase
acExperimentalFeatures :: HashSet ExperimentalFeature
acFunctionPermsCtx :: InferFunctionPermissions
acRemoteSchemaPermsCtx :: RemoteSchemaPermissions
acEnvironment :: Environment
acResponseInternalErrorsConfig :: ResponseInternalErrorsConfig
acEnableAllowlist :: AllowListStatus
acEnabledAPIs :: HashSet API
acSQLGenCtx :: SQLGenCtx
acAuthMode :: AuthMode
acCacheRef :: SchemaCacheRef
acSchemaPollInterval :: AppContext -&gt; OptionalInterval
acAsyncActionsFetchInterval :: AppContext -&gt; OptionalInterval
acEventsFetchBatchSize :: AppContext -&gt; Refined NonNegative Int
acEventsFetchInterval :: AppContext -&gt; Refined NonNegative Milliseconds
acEventsHttpPoolSize :: AppContext -&gt; Refined Positive Int
acEnableTelemetry :: AppContext -&gt; TelemetryStatus
acConsoleStatus :: AppContext -&gt; ConsoleStatus
acCorsConfig :: AppContext -&gt; CorsConfig
acStreamQueryOptions :: AppContext -&gt; StreamQueriesOptions
acLiveQueryOptions :: AppContext -&gt; StreamQueriesOptions
acMetadataDefaults :: AppContext -&gt; MetadataDefaults
acDefaultNamingConvention :: AppContext -&gt; NamingCase
acExperimentalFeatures :: AppContext -&gt; HashSet ExperimentalFeature
acFunctionPermsCtx :: AppContext -&gt; InferFunctionPermissions
acRemoteSchemaPermsCtx :: AppContext -&gt; RemoteSchemaPermissions
acEnvironment :: AppContext -&gt; Environment
acResponseInternalErrorsConfig :: AppContext -&gt; ResponseInternalErrorsConfig
acEnableAllowlist :: AppContext -&gt; AllowListStatus
acSQLGenCtx :: AppContext -&gt; SQLGenCtx
acAuthMode :: AppContext -&gt; AuthMode
acCacheRef :: AppContext -&gt; SchemaCacheRef
acEnabledAPIs :: AppContext -&gt; HashSet API
</span><a href="#local-6989586621690825662"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621690825661"><span class="annot"><span class="annottext">AppEnv
</span><a href="#local-6989586621690825661"><span class="hs-identifier hs-var">appEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-716"></span><span>  </span><span class="annot"><span class="annottext">forall (xs :: [*]) (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *)
       (ps :: PathState) ctx.
(HasRep xs, RouteM t, Monad m) =&gt;
Path xs ps -&gt; HVectElim xs (ActionCtxT ctx m ()) -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.get</span></span><span> </span><span class="annot"><span class="annottext">Path '[] 'Open
</span><span class="hs-string">&quot;v1alpha1/config&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-717"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadIO m, MonadBaseControl IO m, FromJSON a,
 UserAuthentication (TraceT m), HttpLog m, HasReporter m,
 HasResourceLimits m) =&gt;
AppContext
-&gt; AppEnv
-&gt; (Bool -&gt; QErr -&gt; Value)
-&gt; (QErr -&gt; QErr)
-&gt; APIHandler (TraceT m) a
-&gt; ActionT m ()
</span><a href="Hasura.Server.App.html#mkSpockAction"><span class="hs-identifier hs-var">mkSpockAction</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621690825684"><span class="hs-identifier hs-var">appCtx</span></a></span><span> </span><span class="annot"><span class="annottext">AppEnv
</span><a href="#local-6989586621690825661"><span class="hs-identifier hs-var">appEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; QErr -&gt; Value
</span><a href="Hasura.Base.Error.html#encodeQErr"><span class="hs-identifier hs-var">encodeQErr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-718"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
Handler m (HttpLogGraphQLInfo, APIResp) -&gt; APIHandler m ()
</span><a href="Hasura.Server.App.html#mkGetHandler"><span class="hs-identifier hs-var">mkGetHandler</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-719"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadError QErr m, MonadReader HandlerCtx m) =&gt;
m ()
</span><a href="Hasura.Server.App.html#onlyAdmin"><span class="hs-identifier hs-var">onlyAdmin</span></a></span><span>
</span><span id="line-720"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690825657"><span class="annot"><span class="annottext">res :: ServerConfig
</span><a href="#local-6989586621690825657"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-721"></span><span>              </span><span class="annot"><span class="annottext">InferFunctionPermissions
-&gt; RemoteSchemaPermissions
-&gt; AuthMode
-&gt; AllowListStatus
-&gt; StreamQueriesOptions
-&gt; StreamQueriesOptions
-&gt; Maybe Text
-&gt; HashSet ExperimentalFeature
-&gt; HashSet API
-&gt; NamingCase
-&gt; ServerConfig
</span><a href="Hasura.Server.API.Config.html#runGetConfig"><span class="hs-identifier hs-var">runGetConfig</span></a></span><span>
</span><span id="line-722"></span><span>                </span><span class="annot"><span class="annottext">InferFunctionPermissions
</span><a href="#local-6989586621690825675"><span class="hs-identifier hs-var">acFunctionPermsCtx</span></a></span><span>
</span><span id="line-723"></span><span>                </span><span class="annot"><span class="annottext">RemoteSchemaPermissions
</span><a href="#local-6989586621690825676"><span class="hs-identifier hs-var">acRemoteSchemaPermsCtx</span></a></span><span>
</span><span id="line-724"></span><span>                </span><span class="annot"><span class="annottext">AuthMode
</span><a href="#local-6989586621690825682"><span class="hs-identifier hs-var">acAuthMode</span></a></span><span>
</span><span id="line-725"></span><span>                </span><span class="annot"><span class="annottext">AllowListStatus
</span><a href="#local-6989586621690825679"><span class="hs-identifier hs-var">acEnableAllowlist</span></a></span><span>
</span><span id="line-726"></span><span>                </span><span class="annot"><span class="annottext">StreamQueriesOptions
</span><a href="#local-6989586621690825671"><span class="hs-identifier hs-var">acLiveQueryOptions</span></a></span><span>
</span><span id="line-727"></span><span>                </span><span class="annot"><span class="annottext">StreamQueriesOptions
</span><a href="#local-6989586621690825670"><span class="hs-identifier hs-var">acStreamQueryOptions</span></a></span><span>
</span><span id="line-728"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppEnv -&gt; Maybe Text
</span><a href="Hasura.App.State.html#appEnvConsoleAssetsDir"><span class="hs-identifier hs-var">appEnvConsoleAssetsDir</span></a></span><span> </span><span class="annot"><span class="annottext">AppEnv
</span><a href="#local-6989586621690825661"><span class="hs-identifier hs-var">appEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-729"></span><span>                </span><span class="annot"><span class="annottext">HashSet ExperimentalFeature
</span><a href="#local-6989586621690825674"><span class="hs-identifier hs-var">acExperimentalFeatures</span></a></span><span>
</span><span id="line-730"></span><span>                </span><span class="annot"><span class="annottext">HashSet API
</span><a href="#local-6989586621690825680"><span class="hs-identifier hs-var">acEnabledAPIs</span></a></span><span>
</span><span id="line-731"></span><span>                </span><span class="annot"><span class="annottext">NamingCase
</span><a href="#local-6989586621690825673"><span class="hs-identifier hs-var">acDefaultNamingConvention</span></a></span><span>
</span><span id="line-732"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HttpLogGraphQLInfo
</span><a href="Hasura.Server.Logging.html#emptyHttpLogGraphQLInfo"><span class="hs-identifier hs-var">emptyHttpLogGraphQLInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HttpResponse EncJSON -&gt; APIResp
</span><a href="Hasura.Server.App.html#JSONResp"><span class="hs-identifier hs-var">JSONResp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [Header] -&gt; HttpResponse a
</span><a href="Hasura.HTTP.html#HttpResponse"><span class="hs-identifier hs-var">HttpResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; EncJSON
</span><a href="Hasura.EncJSON.html#encJFromJValue"><span class="hs-identifier hs-var">encJFromJValue</span></a></span><span> </span><span class="annot"><span class="annottext">ServerConfig
</span><a href="#local-6989586621690825657"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-733"></span><span>
</span><span id="line-734"></span><span class="hs-keyword">data</span><span> </span><span id="HasuraApp"><span class="annot"><a href="Hasura.Server.App.html#HasuraApp"><span class="hs-identifier hs-var">HasuraApp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HasuraApp"><span class="annot"><a href="Hasura.Server.App.html#HasuraApp"><span class="hs-identifier hs-var">HasuraApp</span></a></span></span><span>
</span><span id="line-735"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_hapApplication"><span class="annot"><span class="annottext">HasuraApp -&gt; Application
</span><a href="Hasura.Server.App.html#_hapApplication"><span class="hs-identifier hs-var hs-var">_hapApplication</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Wai.Application</span></span><span class="hs-special">,</span><span>
</span><span id="line-736"></span><span>    </span><span id="_hapSchemaRef"><span class="annot"><span class="annottext">HasuraApp -&gt; SchemaCacheRef
</span><a href="Hasura.Server.App.html#_hapSchemaRef"><span class="hs-identifier hs-var hs-var">_hapSchemaRef</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Server.SchemaCacheRef.html#SchemaCacheRef"><span class="hs-identifier hs-type">SchemaCacheRef</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-737"></span><span>    </span><span id="_hapAsyncActionSubscriptionState"><span class="annot"><span class="annottext">HasuraApp -&gt; AsyncActionSubscriptionState
</span><a href="Hasura.Server.App.html#_hapAsyncActionSubscriptionState"><span class="hs-identifier hs-var hs-var">_hapAsyncActionSubscriptionState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.GraphQL.Execute.Subscription.State.html#AsyncActionSubscriptionState"><span class="hs-identifier hs-type">ES.AsyncActionSubscriptionState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-738"></span><span>    </span><span id="_hapShutdownWsServer"><span class="annot"><span class="annottext">HasuraApp -&gt; IO ()
</span><a href="Hasura.Server.App.html#_hapShutdownWsServer"><span class="hs-identifier hs-var hs-var">_hapShutdownWsServer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-739"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-740"></span><span>
</span><span id="line-741"></span><span class="annot"><a href="Hasura.Server.App.html#mkWaiApp"><span class="hs-identifier hs-type">mkWaiApp</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-742"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621690827751"><span class="annot"><a href="#local-6989586621690827751"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-743"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827751"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-744"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadFix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827751"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-745"></span><span>    </span><span class="annot"><a href="Control.Monad.Stateless.html#MonadStateless"><span class="hs-identifier hs-type">MonadStateless</span></a></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827751"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-746"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">LA.Forall</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LA.Pure</span></span><span> </span><span class="annot"><a href="#local-6989586621690827751"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-747"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#ConsoleRenderer"><span class="hs-identifier hs-type">ConsoleRenderer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827751"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-748"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#MonadVersionAPIWithExtraData"><span class="hs-identifier hs-type">MonadVersionAPIWithExtraData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827751"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-749"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLog"><span class="hs-identifier hs-type">HttpLog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827751"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-750"></span><span>    </span><span class="annot"><a href="Hasura.Server.Auth.html#UserAuthentication"><span class="hs-identifier hs-type">UserAuthentication</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Tracing.html#TraceT"><span class="hs-identifier hs-type">Tracing.TraceT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827751"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-751"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#MonadMetadataApiAuthorization"><span class="hs-identifier hs-type">MonadMetadataApiAuthorization</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827751"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-752"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Execute.Common.html#MonadGQLExecutionCheck"><span class="hs-identifier hs-type">E.MonadGQLExecutionCheck</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827751"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-753"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#MonadConfigApiHandler"><span class="hs-identifier hs-type">MonadConfigApiHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827751"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-754"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Logging.html#MonadQueryLog"><span class="hs-identifier hs-type">MonadQueryLog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827751"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-755"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Transport.WebSocket.Server.html#MonadWSLog"><span class="hs-identifier hs-type">WS.MonadWSLog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827751"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-756"></span><span>    </span><span class="annot"><a href="Hasura.Tracing.html#HasReporter"><span class="hs-identifier hs-type">Tracing.HasReporter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827751"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-757"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.html#MonadExecuteQuery"><span class="hs-identifier hs-type">GH.MonadExecuteQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827751"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-758"></span><span>    </span><span class="annot"><a href="Hasura.Server.Limits.html#HasResourceLimits"><span class="hs-identifier hs-type">HasResourceLimits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827751"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-759"></span><span>    </span><span class="annot"><a href="Hasura.Metadata.Class.html#MonadMetadataStorageQueryAPI"><span class="hs-identifier hs-type">MonadMetadataStorageQueryAPI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827751"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-760"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Source.html#MonadResolveSource"><span class="hs-identifier hs-type">MonadResolveSource</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827751"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-761"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Execute.Backend.html#MonadQueryTags"><span class="hs-identifier hs-type">EB.MonadQueryTags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827751"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-762"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.EventTrigger.html#MonadEventLogCleanup"><span class="hs-identifier hs-type">MonadEventLogCleanup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827751"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-763"></span><span>    </span><span class="annot"><a href="Hasura.Services.Network.html#ProvidesNetwork"><span class="hs-identifier hs-type">ProvidesNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827751"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-764"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-765"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Spock.SpockT</span></span><span> </span><span class="annot"><a href="#local-6989586621690827751"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-766"></span><span>  </span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-767"></span><span>  </span><span class="annot"><a href="Hasura.App.State.html#AppEnv"><span class="hs-identifier hs-type">AppEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-768"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">EKG.Store</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EKG.EmptyMetrics</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-769"></span><span>  </span><span class="annot"><a href="#local-6989586621690827751"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.App.html#HasuraApp"><span class="hs-identifier hs-type">HasuraApp</span></a></span><span>
</span><span id="line-770"></span><span id="mkWaiApp"><span class="annot"><span class="annottext">mkWaiApp :: forall (m :: * -&gt; *).
(MonadIO m, MonadFix m, MonadStateless IO m, Forall (Pure m),
 ConsoleRenderer m, MonadVersionAPIWithExtraData m, HttpLog m,
 UserAuthentication (TraceT m), MonadMetadataApiAuthorization m,
 MonadGQLExecutionCheck m, MonadConfigApiHandler m, MonadQueryLog m,
 MonadWSLog m, HasReporter m, MonadExecuteQuery m,
 HasResourceLimits m, MonadMetadataStorageQueryAPI m,
 MonadResolveSource m, MonadQueryTags m, MonadEventLogCleanup m,
 ProvidesNetwork m) =&gt;
(AppContext -&gt; SpockT m ())
-&gt; AppContext -&gt; AppEnv -&gt; Store EmptyMetrics -&gt; m HasuraApp
</span><a href="Hasura.Server.App.html#mkWaiApp"><span class="hs-identifier hs-var hs-var">mkWaiApp</span></a></span></span><span>
</span><span id="line-771"></span><span>  </span><span id="local-6989586621690825578"><span class="annot"><span class="annottext">AppContext -&gt; SpockT m ()
</span><a href="#local-6989586621690825578"><span class="hs-identifier hs-var">setupHook</span></a></span></span><span>
</span><span id="line-772"></span><span>  </span><span id="local-6989586621690825577"><span class="annot"><span class="annottext">appCtx :: AppContext
</span><a href="#local-6989586621690825577"><span class="hs-identifier hs-var">appCtx</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621690825555"><span id="local-6989586621690825556"><span id="local-6989586621690825557"><span id="local-6989586621690825558"><span id="local-6989586621690825559"><span id="local-6989586621690825560"><span id="local-6989586621690825561"><span id="local-6989586621690825562"><span id="local-6989586621690825563"><span id="local-6989586621690825564"><span id="local-6989586621690825565"><span id="local-6989586621690825566"><span id="local-6989586621690825567"><span id="local-6989586621690825568"><span id="local-6989586621690825569"><span id="local-6989586621690825570"><span id="local-6989586621690825571"><span id="local-6989586621690825572"><span id="local-6989586621690825573"><span id="local-6989586621690825574"><span id="local-6989586621690825575"><span id="local-6989586621690825576"><span class="annot"><span class="annottext">HashSet ExperimentalFeature
HashSet API
Environment
Refined NonNegative Int
Refined NonNegative Milliseconds
Refined Positive Int
StreamQueriesOptions
NamingCase
RemoteSchemaPermissions
InferFunctionPermissions
SQLGenCtx
CorsConfig
MetadataDefaults
SchemaCacheRef
AuthMode
ResponseInternalErrorsConfig
OptionalInterval
TelemetryStatus
AllowListStatus
ConsoleStatus
acSchemaPollInterval :: OptionalInterval
acAsyncActionsFetchInterval :: OptionalInterval
acEventsFetchBatchSize :: Refined NonNegative Int
acEventsFetchInterval :: Refined NonNegative Milliseconds
acEventsHttpPoolSize :: Refined Positive Int
acEnableTelemetry :: TelemetryStatus
acConsoleStatus :: ConsoleStatus
acCorsConfig :: CorsConfig
acStreamQueryOptions :: StreamQueriesOptions
acLiveQueryOptions :: StreamQueriesOptions
acMetadataDefaults :: MetadataDefaults
acDefaultNamingConvention :: NamingCase
acExperimentalFeatures :: HashSet ExperimentalFeature
acFunctionPermsCtx :: InferFunctionPermissions
acRemoteSchemaPermsCtx :: RemoteSchemaPermissions
acEnvironment :: Environment
acResponseInternalErrorsConfig :: ResponseInternalErrorsConfig
acEnableAllowlist :: AllowListStatus
acEnabledAPIs :: HashSet API
acSQLGenCtx :: SQLGenCtx
acAuthMode :: AuthMode
acCacheRef :: SchemaCacheRef
acSchemaPollInterval :: AppContext -&gt; OptionalInterval
acAsyncActionsFetchInterval :: AppContext -&gt; OptionalInterval
acEventsFetchBatchSize :: AppContext -&gt; Refined NonNegative Int
acEventsFetchInterval :: AppContext -&gt; Refined NonNegative Milliseconds
acEventsHttpPoolSize :: AppContext -&gt; Refined Positive Int
acEnableTelemetry :: AppContext -&gt; TelemetryStatus
acConsoleStatus :: AppContext -&gt; ConsoleStatus
acCorsConfig :: AppContext -&gt; CorsConfig
acStreamQueryOptions :: AppContext -&gt; StreamQueriesOptions
acLiveQueryOptions :: AppContext -&gt; StreamQueriesOptions
acMetadataDefaults :: AppContext -&gt; MetadataDefaults
acDefaultNamingConvention :: AppContext -&gt; NamingCase
acExperimentalFeatures :: AppContext -&gt; HashSet ExperimentalFeature
acFunctionPermsCtx :: AppContext -&gt; InferFunctionPermissions
acRemoteSchemaPermsCtx :: AppContext -&gt; RemoteSchemaPermissions
acEnvironment :: AppContext -&gt; Environment
acResponseInternalErrorsConfig :: AppContext -&gt; ResponseInternalErrorsConfig
acEnableAllowlist :: AppContext -&gt; AllowListStatus
acSQLGenCtx :: AppContext -&gt; SQLGenCtx
acAuthMode :: AppContext -&gt; AuthMode
acCacheRef :: AppContext -&gt; SchemaCacheRef
acEnabledAPIs :: AppContext -&gt; HashSet API
</span><a href="#local-6989586621690825555"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span>
</span><span id="line-773"></span><span>  </span><span id="local-6989586621690825554"><span class="annot"><span class="annottext">appEnv :: AppEnv
</span><a href="#local-6989586621690825554"><span class="hs-identifier hs-var">appEnv</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Hasura.App.State.html#AppEnv"><span class="hs-identifier hs-type">AppEnv</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621690825527"><span id="local-6989586621690825528"><span id="local-6989586621690825529"><span id="local-6989586621690825530"><span id="local-6989586621690825531"><span id="local-6989586621690825532"><span id="local-6989586621690825533"><span id="local-6989586621690825534"><span id="local-6989586621690825535"><span id="local-6989586621690825536"><span id="local-6989586621690825537"><span id="local-6989586621690825538"><span id="local-6989586621690825539"><span id="local-6989586621690825540"><span id="local-6989586621690825541"><span id="local-6989586621690825542"><span id="local-6989586621690825543"><span id="local-6989586621690825544"><span id="local-6989586621690825545"><span id="local-6989586621690825546"><span id="local-6989586621690825547"><span id="local-6989586621690825548"><span id="local-6989586621690825549"><span id="local-6989586621690825550"><span id="local-6989586621690825551"><span id="local-6989586621690825552"><span id="local-6989586621690825553"><span class="annot"><span class="annottext">Maybe Text
SamplingPolicy
PGPool
ConnParams
TxIsolation
TMVar MetadataResourceVersion
Refined NonNegative Seconds
Manager
ServerMetrics
PrometheusMetrics
ShutdownLatch
EventingMode
ReadOnlyMode
MaintenanceMode ()
InstanceId
LockedEventsCtx
LoggingSettings
HostPreference
ConnectionOptions
WSConnectionInitTimeout
KeepAliveDelay
Port
SubscriptionsState
Loggers
FeatureFlag -&gt; IO Bool
appEnvCheckFeatureFlag :: FeatureFlag -&gt; IO Bool
appEnvGracefulShutdownTimeout :: Refined NonNegative Seconds
appEnvWebSocketConnectionInitTimeout :: WSConnectionInitTimeout
appEnvWebSocketKeepAlive :: KeepAliveDelay
appEnvConnectionOptions :: ConnectionOptions
appEnvConsoleSentryDsn :: Maybe Text
appEnvConsoleAssetsDir :: Maybe Text
appEnvTxIso :: TxIsolation
appEnvConnParams :: ConnParams
appEnvLockedEventsCtx :: LockedEventsCtx
appEnvSubscriptionState :: SubscriptionsState
appEnvTraceSamplingPolicy :: SamplingPolicy
appEnvPrometheusMetrics :: PrometheusMetrics
appEnvMetaVersionRef :: TMVar MetadataResourceVersion
appEnvShutdownLatch :: ShutdownLatch
appEnvServerMetrics :: ServerMetrics
appEnvEnableReadOnlyMode :: ReadOnlyMode
appEnvEventingMode :: EventingMode
appEnvLoggingSettings :: LoggingSettings
appEnvEnableMaintenanceMode :: MaintenanceMode ()
appEnvInstanceId :: InstanceId
appEnvMetadataVersionRef :: TMVar MetadataResourceVersion
appEnvLoggers :: Loggers
appEnvManager :: Manager
appEnvMetadataDbPool :: PGPool
appEnvHost :: HostPreference
appEnvPort :: Port
appEnvCheckFeatureFlag :: AppEnv -&gt; FeatureFlag -&gt; IO Bool
appEnvGracefulShutdownTimeout :: AppEnv -&gt; Refined NonNegative Seconds
appEnvWebSocketConnectionInitTimeout :: AppEnv -&gt; WSConnectionInitTimeout
appEnvWebSocketKeepAlive :: AppEnv -&gt; KeepAliveDelay
appEnvConnectionOptions :: AppEnv -&gt; ConnectionOptions
appEnvConsoleSentryDsn :: AppEnv -&gt; Maybe Text
appEnvConsoleAssetsDir :: AppEnv -&gt; Maybe Text
appEnvTxIso :: AppEnv -&gt; TxIsolation
appEnvConnParams :: AppEnv -&gt; ConnParams
appEnvLockedEventsCtx :: AppEnv -&gt; LockedEventsCtx
appEnvSubscriptionState :: AppEnv -&gt; SubscriptionsState
appEnvTraceSamplingPolicy :: AppEnv -&gt; SamplingPolicy
appEnvPrometheusMetrics :: AppEnv -&gt; PrometheusMetrics
appEnvMetaVersionRef :: AppEnv -&gt; TMVar MetadataResourceVersion
appEnvShutdownLatch :: AppEnv -&gt; ShutdownLatch
appEnvServerMetrics :: AppEnv -&gt; ServerMetrics
appEnvEnableReadOnlyMode :: AppEnv -&gt; ReadOnlyMode
appEnvEventingMode :: AppEnv -&gt; EventingMode
appEnvLoggingSettings :: AppEnv -&gt; LoggingSettings
appEnvEnableMaintenanceMode :: AppEnv -&gt; MaintenanceMode ()
appEnvInstanceId :: AppEnv -&gt; InstanceId
appEnvMetadataVersionRef :: AppEnv -&gt; TMVar MetadataResourceVersion
appEnvLoggers :: AppEnv -&gt; Loggers
appEnvManager :: AppEnv -&gt; Manager
appEnvMetadataDbPool :: AppEnv -&gt; PGPool
appEnvHost :: AppEnv -&gt; HostPreference
appEnvPort :: AppEnv -&gt; Port
</span><a href="#local-6989586621690825527"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span>
</span><span id="line-774"></span><span>  </span><span id="local-6989586621690825526"><span class="annot"><span class="annottext">Store EmptyMetrics
</span><a href="#local-6989586621690825526"><span class="hs-identifier hs-var">ekgStore</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-775"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690825525"><span class="annot"><span class="annottext">getSchemaCache' :: IO (SchemaCache, SchemaCacheVer)
</span><a href="#local-6989586621690825525"><span class="hs-identifier hs-var hs-var">getSchemaCache'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">RebuildableSchemaCache -&gt; SchemaCache
</span><a href="Hasura.RQL.DDL.Schema.Cache.Common.html#lastBuiltSchemaCache"><span class="hs-identifier hs-var">lastBuiltSchemaCache</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCacheRef -&gt; IO (RebuildableSchemaCache, SchemaCacheVer)
</span><a href="Hasura.Server.SchemaCacheRef.html#readSchemaCacheRef"><span class="hs-identifier hs-var">readSchemaCacheRef</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCacheRef
</span><a href="#local-6989586621690825576"><span class="hs-identifier hs-var">acCacheRef</span></a></span><span>
</span><span id="line-776"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690825524"><span class="annot"><span class="annottext">corsPolicy :: CorsPolicy
</span><a href="#local-6989586621690825524"><span class="hs-identifier hs-var hs-var">corsPolicy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CorsConfig -&gt; CorsPolicy
</span><a href="Hasura.Server.Cors.html#mkDefaultCorsPolicy"><span class="hs-identifier hs-var">mkDefaultCorsPolicy</span></a></span><span> </span><span class="annot"><span class="annottext">CorsConfig
</span><a href="#local-6989586621690825562"><span class="hs-identifier hs-var">acCorsConfig</span></a></span><span>
</span><span id="line-777"></span><span>
</span><span id="line-778"></span><span>    </span><span id="local-6989586621690825522"><span class="annot"><span class="annottext">WSServerEnv
</span><a href="#local-6989586621690825522"><span class="hs-identifier hs-var">wsServerEnv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-779"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadIO m =&gt;
Logger Hasura
-&gt; SubscriptionsState
-&gt; StreamQueriesOptions
-&gt; StreamQueriesOptions
-&gt; IO (SchemaCache, SchemaCacheVer)
-&gt; Manager
-&gt; CorsPolicy
-&gt; SQLGenCtx
-&gt; ReadOnlyMode
-&gt; AllowListStatus
-&gt; KeepAliveDelay
-&gt; ServerMetrics
-&gt; PrometheusMetrics
-&gt; SamplingPolicy
-&gt; m WSServerEnv
</span><a href="Hasura.GraphQL.Transport.WSServerApp.html#createWSServerEnv"><span class="hs-identifier hs-var">WS.createWSServerEnv</span></a></span><span>
</span><span id="line-780"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Loggers -&gt; Logger Hasura
</span><a href="Hasura.App.State.html#_lsLogger"><span class="hs-identifier hs-var">_lsLogger</span></a></span><span> </span><span class="annot"><span class="annottext">Loggers
</span><a href="#local-6989586621690825549"><span class="hs-identifier hs-var">appEnvLoggers</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-781"></span><span>        </span><span class="annot"><span class="annottext">SubscriptionsState
</span><a href="#local-6989586621690825537"><span class="hs-identifier hs-var">appEnvSubscriptionState</span></a></span><span>
</span><span id="line-782"></span><span>        </span><span class="annot"><span class="annottext">StreamQueriesOptions
</span><a href="#local-6989586621690825564"><span class="hs-identifier hs-var">acLiveQueryOptions</span></a></span><span>
</span><span id="line-783"></span><span>        </span><span class="annot"><span class="annottext">StreamQueriesOptions
</span><a href="#local-6989586621690825563"><span class="hs-identifier hs-var">acStreamQueryOptions</span></a></span><span>
</span><span id="line-784"></span><span>        </span><span class="annot"><span class="annottext">IO (SchemaCache, SchemaCacheVer)
</span><a href="#local-6989586621690825525"><span class="hs-identifier hs-var">getSchemaCache'</span></a></span><span>
</span><span id="line-785"></span><span>        </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621690825550"><span class="hs-identifier hs-var">appEnvManager</span></a></span><span>
</span><span id="line-786"></span><span>        </span><span class="annot"><span class="annottext">CorsPolicy
</span><a href="#local-6989586621690825524"><span class="hs-identifier hs-var">corsPolicy</span></a></span><span>
</span><span id="line-787"></span><span>        </span><span class="annot"><span class="annottext">SQLGenCtx
</span><a href="#local-6989586621690825574"><span class="hs-identifier hs-var">acSQLGenCtx</span></a></span><span>
</span><span id="line-788"></span><span>        </span><span class="annot"><span class="annottext">ReadOnlyMode
</span><a href="#local-6989586621690825543"><span class="hs-identifier hs-var">appEnvEnableReadOnlyMode</span></a></span><span>
</span><span id="line-789"></span><span>        </span><span class="annot"><span class="annottext">AllowListStatus
</span><a href="#local-6989586621690825572"><span class="hs-identifier hs-var">acEnableAllowlist</span></a></span><span>
</span><span id="line-790"></span><span>        </span><span class="annot"><span class="annottext">KeepAliveDelay
</span><a href="#local-6989586621690825530"><span class="hs-identifier hs-var">appEnvWebSocketKeepAlive</span></a></span><span>
</span><span id="line-791"></span><span>        </span><span class="annot"><span class="annottext">ServerMetrics
</span><a href="#local-6989586621690825542"><span class="hs-identifier hs-var">appEnvServerMetrics</span></a></span><span>
</span><span id="line-792"></span><span>        </span><span class="annot"><span class="annottext">PrometheusMetrics
</span><a href="#local-6989586621690825539"><span class="hs-identifier hs-var">appEnvPrometheusMetrics</span></a></span><span>
</span><span id="line-793"></span><span>        </span><span class="annot"><span class="annottext">SamplingPolicy
</span><a href="#local-6989586621690825538"><span class="hs-identifier hs-var">appEnvTraceSamplingPolicy</span></a></span><span>
</span><span id="line-794"></span><span>
</span><span id="line-795"></span><span>    </span><span id="local-6989586621690825520"><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621690825520"><span class="hs-identifier hs-var">spockApp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (b :: * -&gt; *) (m :: * -&gt; *) c.
MonadStateless b m =&gt;
((forall a. m a -&gt; b a) -&gt; b c) -&gt; m c
</span><a href="Control.Monad.Stateless.html#liftWithStateless"><span class="hs-identifier hs-var">liftWithStateless</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621690825518"><span class="annot"><span class="annottext">forall a. m a -&gt; IO a
</span><a href="#local-6989586621690825518"><span class="hs-identifier hs-var">lowerIO</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-796"></span><span>      </span><span class="annot"><span class="annottext">IO Middleware -&gt; IO Application
</span><span class="hs-identifier hs-var">Spock.spockAsApp</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-797"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadIO m =&gt;
(forall a. m a -&gt; IO a) -&gt; SpockT m () -&gt; IO Middleware
</span><span class="hs-identifier hs-var">Spock.spockT</span></span><span> </span><span class="annot"><span class="annottext">forall a. m a -&gt; IO a
</span><a href="#local-6989586621690825518"><span class="hs-identifier hs-var">lowerIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-798"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadFix m, MonadBaseControl IO m, ConsoleRenderer m,
 MonadVersionAPIWithExtraData m, HttpLog m,
 UserAuthentication (TraceT m), MonadMetadataApiAuthorization m,
 MonadGQLExecutionCheck m, MonadConfigApiHandler m, MonadQueryLog m,
 HasReporter m, MonadExecuteQuery m, MonadMetadataStorageQueryAPI m,
 HasResourceLimits m, MonadResolveSource m, MonadQueryTags m,
 MonadEventLogCleanup m, ProvidesNetwork m) =&gt;
(AppContext -&gt; SpockT m ())
-&gt; AppContext -&gt; AppEnv -&gt; Store EmptyMetrics -&gt; SpockT m ()
</span><a href="Hasura.Server.App.html#httpApp"><span class="hs-identifier hs-var">httpApp</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext -&gt; SpockT m ()
</span><a href="#local-6989586621690825578"><span class="hs-identifier hs-var">setupHook</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621690825577"><span class="hs-identifier hs-var">appCtx</span></a></span><span> </span><span class="annot"><span class="annottext">AppEnv
</span><a href="#local-6989586621690825554"><span class="hs-identifier hs-var">appEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Store EmptyMetrics
</span><a href="#local-6989586621690825526"><span class="hs-identifier hs-var">ekgStore</span></a></span><span>
</span><span id="line-799"></span><span>
</span><span id="line-800"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690825514"><span class="annot"><span class="annottext">wsServerApp :: HasuraServerApp m
</span><a href="#local-6989586621690825514"><span class="hs-identifier hs-var hs-var">wsServerApp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadBaseControl IO m, Forall (Pure m),
 UserAuthentication (TraceT m), MonadGQLExecutionCheck m,
 MonadWSLog m, MonadQueryLog m, HasReporter m, MonadExecuteQuery m,
 MonadMetadataStorage m, MonadQueryTags m, HasResourceLimits m,
 ProvidesNetwork m) =&gt;
Environment
-&gt; HashSet (EngineLogType Hasura)
-&gt; AuthMode
-&gt; WSServerEnv
-&gt; WSConnectionInitTimeout
-&gt; HasuraServerApp m
</span><a href="Hasura.GraphQL.Transport.WSServerApp.html#createWSServerApp"><span class="hs-identifier hs-var">WS.createWSServerApp</span></a></span><span> </span><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621690825570"><span class="hs-identifier hs-var">acEnvironment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LoggingSettings -&gt; HashSet (EngineLogType Hasura)
</span><a href="Hasura.Server.Logging.html#_lsEnabledLogTypes"><span class="hs-identifier hs-var">_lsEnabledLogTypes</span></a></span><span> </span><span class="annot"><span class="annottext">LoggingSettings
</span><a href="#local-6989586621690825545"><span class="hs-identifier hs-var">appEnvLoggingSettings</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AuthMode
</span><a href="#local-6989586621690825575"><span class="hs-identifier hs-var">acAuthMode</span></a></span><span> </span><span class="annot"><span class="annottext">WSServerEnv
</span><a href="#local-6989586621690825522"><span class="hs-identifier hs-var">wsServerEnv</span></a></span><span> </span><span class="annot"><span class="annottext">WSConnectionInitTimeout
</span><a href="#local-6989586621690825529"><span class="hs-identifier hs-var">appEnvWebSocketConnectionInitTimeout</span></a></span><span> </span><span class="hs-comment">-- TODO: Lyndon: Can we pass environment through wsServerEnv?</span><span>
</span><span id="line-801"></span><span>        </span><span id="local-6989586621690825511"><span class="annot"><span class="annottext">stopWSServer :: IO ()
</span><a href="#local-6989586621690825511"><span class="hs-identifier hs-var hs-var">stopWSServer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WSServerEnv -&gt; IO ()
</span><a href="Hasura.GraphQL.Transport.WSServerApp.html#stopWSServerApp"><span class="hs-identifier hs-var">WS.stopWSServerApp</span></a></span><span> </span><span class="annot"><span class="annottext">WSServerEnv
</span><a href="#local-6989586621690825522"><span class="hs-identifier hs-var">wsServerEnv</span></a></span><span>
</span><span id="line-802"></span><span>
</span><span id="line-803"></span><span>    </span><span id="local-6989586621690825509"><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621690825509"><span class="hs-identifier hs-var">waiApp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (b :: * -&gt; *) (m :: * -&gt; *) c.
MonadStateless b m =&gt;
((forall a. m a -&gt; b a) -&gt; b c) -&gt; m c
</span><a href="Control.Monad.Stateless.html#liftWithStateless"><span class="hs-identifier hs-var">liftWithStateless</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621690825508"><span class="annot"><span class="annottext">forall a. m a -&gt; IO a
</span><a href="#local-6989586621690825508"><span class="hs-identifier hs-var">lowerIO</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-804"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ConnectionOptions
-&gt; (IpAddress -&gt; PendingConnection -&gt; IO ()) -&gt; Middleware
</span><a href="Network.Wai.Handler.WebSockets.Custom.html#websocketsOr"><span class="hs-identifier hs-var">WSC.websocketsOr</span></a></span><span> </span><span class="annot"><span class="annottext">ConnectionOptions
</span><a href="#local-6989586621690825531"><span class="hs-identifier hs-var">appEnvConnectionOptions</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621690825506"><span class="annot"><span class="annottext">IpAddress
</span><a href="#local-6989586621690825506"><span class="hs-identifier hs-var">ip</span></a></span></span><span> </span><span id="local-6989586621690825505"><span class="annot"><span class="annottext">PendingConnection
</span><a href="#local-6989586621690825505"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. m a -&gt; IO a
</span><a href="#local-6989586621690825508"><span class="hs-identifier hs-var">lowerIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">HasuraServerApp m
</span><a href="#local-6989586621690825514"><span class="hs-identifier hs-var">wsServerApp</span></a></span><span> </span><span class="annot"><span class="annottext">IpAddress
</span><a href="#local-6989586621690825506"><span class="hs-identifier hs-var">ip</span></a></span><span> </span><span class="annot"><span class="annottext">PendingConnection
</span><a href="#local-6989586621690825505"><span class="hs-identifier hs-var">conn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621690825520"><span class="hs-identifier hs-var">spockApp</span></a></span><span>
</span><span id="line-805"></span><span>
</span><span id="line-806"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Application
-&gt; SchemaCacheRef
-&gt; AsyncActionSubscriptionState
-&gt; IO ()
-&gt; HasuraApp
</span><a href="Hasura.Server.App.html#HasuraApp"><span class="hs-identifier hs-var">HasuraApp</span></a></span><span> </span><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621690825509"><span class="hs-identifier hs-var">waiApp</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCacheRef
</span><a href="#local-6989586621690825576"><span class="hs-identifier hs-var">acCacheRef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SubscriptionsState -&gt; AsyncActionSubscriptionState
</span><a href="Hasura.GraphQL.Execute.Subscription.State.html#_ssAsyncActions"><span class="hs-identifier hs-var">ES._ssAsyncActions</span></a></span><span> </span><span class="annot"><span class="annottext">SubscriptionsState
</span><a href="#local-6989586621690825537"><span class="hs-identifier hs-var">appEnvSubscriptionState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621690825511"><span class="hs-identifier hs-var">stopWSServer</span></a></span><span>
</span><span id="line-807"></span><span>
</span><span id="line-808"></span><span class="annot"><a href="Hasura.Server.App.html#httpApp"><span class="hs-identifier hs-type">httpApp</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-809"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621690827726"><span class="annot"><a href="#local-6989586621690827726"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-810"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827726"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-811"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadFix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827726"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-812"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadBaseControl</span></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827726"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-813"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#ConsoleRenderer"><span class="hs-identifier hs-type">ConsoleRenderer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827726"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-814"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#MonadVersionAPIWithExtraData"><span class="hs-identifier hs-type">MonadVersionAPIWithExtraData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827726"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-815"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLog"><span class="hs-identifier hs-type">HttpLog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827726"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-816"></span><span>    </span><span class="annot"><a href="Hasura.Server.Auth.html#UserAuthentication"><span class="hs-identifier hs-type">UserAuthentication</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Tracing.html#TraceT"><span class="hs-identifier hs-type">Tracing.TraceT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827726"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-817"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#MonadMetadataApiAuthorization"><span class="hs-identifier hs-type">MonadMetadataApiAuthorization</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827726"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-818"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Execute.Common.html#MonadGQLExecutionCheck"><span class="hs-identifier hs-type">E.MonadGQLExecutionCheck</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827726"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-819"></span><span>    </span><span class="annot"><a href="Hasura.Server.App.html#MonadConfigApiHandler"><span class="hs-identifier hs-type">MonadConfigApiHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827726"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-820"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Logging.html#MonadQueryLog"><span class="hs-identifier hs-type">MonadQueryLog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827726"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-821"></span><span>    </span><span class="annot"><a href="Hasura.Tracing.html#HasReporter"><span class="hs-identifier hs-type">Tracing.HasReporter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827726"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-822"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.html#MonadExecuteQuery"><span class="hs-identifier hs-type">GH.MonadExecuteQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827726"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-823"></span><span>    </span><span class="annot"><a href="Hasura.Metadata.Class.html#MonadMetadataStorageQueryAPI"><span class="hs-identifier hs-type">MonadMetadataStorageQueryAPI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827726"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-824"></span><span>    </span><span class="annot"><a href="Hasura.Server.Limits.html#HasResourceLimits"><span class="hs-identifier hs-type">HasResourceLimits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827726"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-825"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Source.html#MonadResolveSource"><span class="hs-identifier hs-type">MonadResolveSource</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827726"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-826"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Execute.Backend.html#MonadQueryTags"><span class="hs-identifier hs-type">EB.MonadQueryTags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827726"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-827"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.EventTrigger.html#MonadEventLogCleanup"><span class="hs-identifier hs-type">MonadEventLogCleanup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827726"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-828"></span><span>    </span><span class="annot"><a href="Hasura.Services.Network.html#ProvidesNetwork"><span class="hs-identifier hs-type">ProvidesNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827726"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-829"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-830"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Spock.SpockT</span></span><span> </span><span class="annot"><a href="#local-6989586621690827726"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-831"></span><span>  </span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-832"></span><span>  </span><span class="annot"><a href="Hasura.App.State.html#AppEnv"><span class="hs-identifier hs-type">AppEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-833"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">EKG.Store</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EKG.EmptyMetrics</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-834"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Spock.SpockT</span></span><span> </span><span class="annot"><a href="#local-6989586621690827726"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-835"></span><span id="httpApp"><span class="annot"><span class="annottext">httpApp :: forall (m :: * -&gt; *).
(MonadIO m, MonadFix m, MonadBaseControl IO m, ConsoleRenderer m,
 MonadVersionAPIWithExtraData m, HttpLog m,
 UserAuthentication (TraceT m), MonadMetadataApiAuthorization m,
 MonadGQLExecutionCheck m, MonadConfigApiHandler m, MonadQueryLog m,
 HasReporter m, MonadExecuteQuery m, MonadMetadataStorageQueryAPI m,
 HasResourceLimits m, MonadResolveSource m, MonadQueryTags m,
 MonadEventLogCleanup m, ProvidesNetwork m) =&gt;
(AppContext -&gt; SpockT m ())
-&gt; AppContext -&gt; AppEnv -&gt; Store EmptyMetrics -&gt; SpockT m ()
</span><a href="Hasura.Server.App.html#httpApp"><span class="hs-identifier hs-var hs-var">httpApp</span></a></span></span><span> </span><span id="local-6989586621690824898"><span class="annot"><span class="annottext">AppContext -&gt; SpockT m ()
</span><a href="#local-6989586621690824898"><span class="hs-identifier hs-var">setupHook</span></a></span></span><span> </span><span id="local-6989586621690824897"><span class="annot"><span class="annottext">appCtx :: AppContext
</span><a href="#local-6989586621690824897"><span class="hs-identifier hs-var">appCtx</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621690824875"><span id="local-6989586621690824876"><span id="local-6989586621690824877"><span id="local-6989586621690824878"><span id="local-6989586621690824879"><span id="local-6989586621690824880"><span id="local-6989586621690824881"><span id="local-6989586621690824882"><span id="local-6989586621690824883"><span id="local-6989586621690824884"><span id="local-6989586621690824885"><span id="local-6989586621690824886"><span id="local-6989586621690824887"><span id="local-6989586621690824888"><span id="local-6989586621690824889"><span id="local-6989586621690824890"><span id="local-6989586621690824891"><span id="local-6989586621690824892"><span id="local-6989586621690824893"><span id="local-6989586621690824894"><span id="local-6989586621690824895"><span id="local-6989586621690824896"><span class="annot"><span class="annottext">HashSet ExperimentalFeature
HashSet API
Environment
Refined NonNegative Int
Refined NonNegative Milliseconds
Refined Positive Int
StreamQueriesOptions
NamingCase
RemoteSchemaPermissions
InferFunctionPermissions
SQLGenCtx
CorsConfig
MetadataDefaults
SchemaCacheRef
AuthMode
ResponseInternalErrorsConfig
OptionalInterval
TelemetryStatus
AllowListStatus
ConsoleStatus
acSchemaPollInterval :: OptionalInterval
acAsyncActionsFetchInterval :: OptionalInterval
acEventsFetchBatchSize :: Refined NonNegative Int
acEventsFetchInterval :: Refined NonNegative Milliseconds
acEventsHttpPoolSize :: Refined Positive Int
acEnableTelemetry :: TelemetryStatus
acConsoleStatus :: ConsoleStatus
acCorsConfig :: CorsConfig
acStreamQueryOptions :: StreamQueriesOptions
acLiveQueryOptions :: StreamQueriesOptions
acMetadataDefaults :: MetadataDefaults
acDefaultNamingConvention :: NamingCase
acExperimentalFeatures :: HashSet ExperimentalFeature
acFunctionPermsCtx :: InferFunctionPermissions
acRemoteSchemaPermsCtx :: RemoteSchemaPermissions
acEnvironment :: Environment
acResponseInternalErrorsConfig :: ResponseInternalErrorsConfig
acEnableAllowlist :: AllowListStatus
acEnabledAPIs :: HashSet API
acSQLGenCtx :: SQLGenCtx
acAuthMode :: AuthMode
acCacheRef :: SchemaCacheRef
acSchemaPollInterval :: AppContext -&gt; OptionalInterval
acAsyncActionsFetchInterval :: AppContext -&gt; OptionalInterval
acEventsFetchBatchSize :: AppContext -&gt; Refined NonNegative Int
acEventsFetchInterval :: AppContext -&gt; Refined NonNegative Milliseconds
acEventsHttpPoolSize :: AppContext -&gt; Refined Positive Int
acEnableTelemetry :: AppContext -&gt; TelemetryStatus
acConsoleStatus :: AppContext -&gt; ConsoleStatus
acCorsConfig :: AppContext -&gt; CorsConfig
acStreamQueryOptions :: AppContext -&gt; StreamQueriesOptions
acLiveQueryOptions :: AppContext -&gt; StreamQueriesOptions
acMetadataDefaults :: AppContext -&gt; MetadataDefaults
acDefaultNamingConvention :: AppContext -&gt; NamingCase
acExperimentalFeatures :: AppContext -&gt; HashSet ExperimentalFeature
acFunctionPermsCtx :: AppContext -&gt; InferFunctionPermissions
acRemoteSchemaPermsCtx :: AppContext -&gt; RemoteSchemaPermissions
acEnvironment :: AppContext -&gt; Environment
acResponseInternalErrorsConfig :: AppContext -&gt; ResponseInternalErrorsConfig
acEnableAllowlist :: AppContext -&gt; AllowListStatus
acSQLGenCtx :: AppContext -&gt; SQLGenCtx
acAuthMode :: AppContext -&gt; AuthMode
acCacheRef :: AppContext -&gt; SchemaCacheRef
acEnabledAPIs :: AppContext -&gt; HashSet API
</span><a href="#local-6989586621690824875"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621690824874"><span class="annot"><span class="annottext">appEnv :: AppEnv
</span><a href="#local-6989586621690824874"><span class="hs-identifier hs-var">appEnv</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Hasura.App.State.html#AppEnv"><span class="hs-identifier hs-type">AppEnv</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621690824847"><span id="local-6989586621690824848"><span id="local-6989586621690824849"><span id="local-6989586621690824850"><span id="local-6989586621690824851"><span id="local-6989586621690824852"><span id="local-6989586621690824853"><span id="local-6989586621690824854"><span id="local-6989586621690824855"><span id="local-6989586621690824856"><span id="local-6989586621690824857"><span id="local-6989586621690824858"><span id="local-6989586621690824859"><span id="local-6989586621690824860"><span id="local-6989586621690824861"><span id="local-6989586621690824862"><span id="local-6989586621690824863"><span id="local-6989586621690824864"><span id="local-6989586621690824865"><span id="local-6989586621690824866"><span id="local-6989586621690824867"><span id="local-6989586621690824868"><span id="local-6989586621690824869"><span id="local-6989586621690824870"><span id="local-6989586621690824871"><span id="local-6989586621690824872"><span id="local-6989586621690824873"><span class="annot"><span class="annottext">Maybe Text
SamplingPolicy
PGPool
ConnParams
TxIsolation
TMVar MetadataResourceVersion
Refined NonNegative Seconds
Manager
ServerMetrics
PrometheusMetrics
ShutdownLatch
EventingMode
ReadOnlyMode
MaintenanceMode ()
InstanceId
LockedEventsCtx
LoggingSettings
HostPreference
ConnectionOptions
WSConnectionInitTimeout
KeepAliveDelay
Port
SubscriptionsState
Loggers
FeatureFlag -&gt; IO Bool
appEnvCheckFeatureFlag :: FeatureFlag -&gt; IO Bool
appEnvGracefulShutdownTimeout :: Refined NonNegative Seconds
appEnvWebSocketConnectionInitTimeout :: WSConnectionInitTimeout
appEnvWebSocketKeepAlive :: KeepAliveDelay
appEnvConnectionOptions :: ConnectionOptions
appEnvConsoleSentryDsn :: Maybe Text
appEnvConsoleAssetsDir :: Maybe Text
appEnvTxIso :: TxIsolation
appEnvConnParams :: ConnParams
appEnvLockedEventsCtx :: LockedEventsCtx
appEnvSubscriptionState :: SubscriptionsState
appEnvTraceSamplingPolicy :: SamplingPolicy
appEnvPrometheusMetrics :: PrometheusMetrics
appEnvMetaVersionRef :: TMVar MetadataResourceVersion
appEnvShutdownLatch :: ShutdownLatch
appEnvServerMetrics :: ServerMetrics
appEnvEnableReadOnlyMode :: ReadOnlyMode
appEnvEventingMode :: EventingMode
appEnvLoggingSettings :: LoggingSettings
appEnvEnableMaintenanceMode :: MaintenanceMode ()
appEnvInstanceId :: InstanceId
appEnvMetadataVersionRef :: TMVar MetadataResourceVersion
appEnvLoggers :: Loggers
appEnvManager :: Manager
appEnvMetadataDbPool :: PGPool
appEnvHost :: HostPreference
appEnvPort :: Port
appEnvCheckFeatureFlag :: AppEnv -&gt; FeatureFlag -&gt; IO Bool
appEnvGracefulShutdownTimeout :: AppEnv -&gt; Refined NonNegative Seconds
appEnvWebSocketConnectionInitTimeout :: AppEnv -&gt; WSConnectionInitTimeout
appEnvWebSocketKeepAlive :: AppEnv -&gt; KeepAliveDelay
appEnvConnectionOptions :: AppEnv -&gt; ConnectionOptions
appEnvConsoleSentryDsn :: AppEnv -&gt; Maybe Text
appEnvConsoleAssetsDir :: AppEnv -&gt; Maybe Text
appEnvTxIso :: AppEnv -&gt; TxIsolation
appEnvConnParams :: AppEnv -&gt; ConnParams
appEnvLockedEventsCtx :: AppEnv -&gt; LockedEventsCtx
appEnvSubscriptionState :: AppEnv -&gt; SubscriptionsState
appEnvTraceSamplingPolicy :: AppEnv -&gt; SamplingPolicy
appEnvPrometheusMetrics :: AppEnv -&gt; PrometheusMetrics
appEnvMetaVersionRef :: AppEnv -&gt; TMVar MetadataResourceVersion
appEnvShutdownLatch :: AppEnv -&gt; ShutdownLatch
appEnvServerMetrics :: AppEnv -&gt; ServerMetrics
appEnvEnableReadOnlyMode :: AppEnv -&gt; ReadOnlyMode
appEnvEventingMode :: AppEnv -&gt; EventingMode
appEnvLoggingSettings :: AppEnv -&gt; LoggingSettings
appEnvEnableMaintenanceMode :: AppEnv -&gt; MaintenanceMode ()
appEnvInstanceId :: AppEnv -&gt; InstanceId
appEnvMetadataVersionRef :: AppEnv -&gt; TMVar MetadataResourceVersion
appEnvLoggers :: AppEnv -&gt; Loggers
appEnvManager :: AppEnv -&gt; Manager
appEnvMetadataDbPool :: AppEnv -&gt; PGPool
appEnvHost :: AppEnv -&gt; HostPreference
appEnvPort :: AppEnv -&gt; Port
</span><a href="#local-6989586621690824847"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621690824846"><span class="annot"><span class="annottext">Store EmptyMetrics
</span><a href="#local-6989586621690824846"><span class="hs-identifier hs-var">ekgStore</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-836"></span><span>  </span><span class="hs-comment">-- Additional spock action to run</span><span>
</span><span id="line-837"></span><span>  </span><span class="annot"><span class="annottext">AppContext -&gt; SpockT m ()
</span><a href="#local-6989586621690824898"><span class="hs-identifier hs-var">setupHook</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621690824897"><span class="hs-identifier hs-var">appCtx</span></a></span><span>
</span><span id="line-838"></span><span>
</span><span id="line-839"></span><span>  </span><span class="hs-comment">-- cors middleware</span><span>
</span><span id="line-840"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CorsConfig -&gt; Bool
</span><a href="Hasura.Server.Cors.html#isCorsDisabled"><span class="hs-identifier hs-var">isCorsDisabled</span></a></span><span> </span><span class="annot"><span class="annottext">CorsConfig
</span><a href="#local-6989586621690824882"><span class="hs-identifier hs-var">acCorsConfig</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-841"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) ctx.
(RouteM t, Monad m) =&gt;
Middleware -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.middleware</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-842"></span><span>      </span><span class="annot"><span class="annottext">CorsPolicy -&gt; Middleware
</span><a href="Hasura.Server.Middleware.html#corsMiddleware"><span class="hs-identifier hs-var">corsMiddleware</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CorsConfig -&gt; CorsPolicy
</span><a href="Hasura.Server.Cors.html#mkDefaultCorsPolicy"><span class="hs-identifier hs-var">mkDefaultCorsPolicy</span></a></span><span> </span><span class="annot"><span class="annottext">CorsConfig
</span><a href="#local-6989586621690824882"><span class="hs-identifier hs-var">acCorsConfig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-843"></span><span>
</span><span id="line-844"></span><span>  </span><span class="hs-comment">-- API Console and Root Dir</span><span>
</span><span id="line-845"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConsoleStatus -&gt; Bool
</span><a href="Hasura.Server.Init.Config.html#isConsoleEnabled"><span class="hs-identifier hs-var">isConsoleEnabled</span></a></span><span> </span><span class="annot"><span class="annottext">ConsoleStatus
</span><a href="#local-6989586621690824881"><span class="hs-identifier hs-var">acConsoleStatus</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690824840"><span class="hs-identifier hs-var">enableMetadata</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SpockT m ()
</span><a href="#local-6989586621690824839"><span class="hs-identifier hs-var">serveApiConsole</span></a></span><span>
</span><span id="line-846"></span><span>
</span><span id="line-847"></span><span>  </span><span class="hs-comment">-- Local console assets for server and CLI consoles</span><span>
</span><span id="line-848"></span><span>  </span><span class="annot"><span class="annottext">SpockT m ()
</span><a href="#local-6989586621690824838"><span class="hs-identifier hs-var">serveApiConsoleAssets</span></a></span><span>
</span><span id="line-849"></span><span>
</span><span id="line-850"></span><span>  </span><span class="hs-comment">-- Health check endpoint with logs</span><span>
</span><span id="line-851"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690824837"><span class="annot"><span class="annottext">healthzAction :: ActionCtxT () m ()
</span><a href="#local-6989586621690824837"><span class="hs-identifier hs-var hs-var">healthzAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-852"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690824835"><span class="annot"><span class="annottext">errorMsg :: Text
</span><a href="#local-6989586621690824835"><span class="hs-identifier hs-var hs-var">errorMsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;ERROR&quot;</span></span><span>
</span><span id="line-853"></span><span>        </span><span id="local-6989586621690824834"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690824834"><span class="hs-identifier hs-var">isStrict</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall p (m :: * -&gt; *) ctx.
(FromHttpApiData p, MonadIO m) =&gt;
Text -&gt; ActionCtxT ctx m (Maybe p)
</span><span class="hs-identifier hs-var">Spock.param</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;strict&quot;</span></span><span>
</span><span id="line-854"></span><span>        </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadMetadataStorage m =&gt; m (Either QErr ())
</span><a href="Hasura.Metadata.Class.html#checkMetadataStorageHealth"><span class="hs-identifier hs-var">checkMetadataStorageHealth</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-855"></span><span>          </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621690824830"><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621690824830"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-856"></span><span>            </span><span class="hs-comment">-- error running the health check</span><span>
</span><span id="line-857"></span><span>            </span><span class="annot"><span class="annottext">QErr -&gt; ActionCtxT () m ()
</span><a href="#local-6989586621690824829"><span class="hs-identifier hs-var">logError</span></a></span><span> </span><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621690824830"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-858"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx.
MonadIO m =&gt;
Status -&gt; ActionCtxT ctx m ()
</span><span class="hs-identifier hs-var">Spock.setStatus</span></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">HTTP.status500</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx a. MonadIO m =&gt; Text -&gt; ActionCtxT ctx m a
</span><span class="hs-identifier hs-var">Spock.text</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690824835"><span class="hs-identifier hs-var">errorMsg</span></a></span><span>
</span><span id="line-859"></span><span>          </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-860"></span><span>            </span><span class="hs-comment">-- metadata storage is healthy</span><span>
</span><span id="line-861"></span><span>            </span><span id="local-6989586621690824826"><span class="annot"><span class="annottext">SchemaCache
</span><a href="#local-6989586621690824826"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCacheRef -&gt; IO SchemaCache
</span><a href="Hasura.Server.SchemaCacheRef.html#getSchemaCache"><span class="hs-identifier hs-var">getSchemaCache</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCacheRef
</span><a href="#local-6989586621690824896"><span class="hs-identifier hs-var">acCacheRef</span></a></span><span>
</span><span id="line-862"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690824825"><span class="annot"><span class="annottext">isInconsistent :: Bool
</span><a href="#local-6989586621690824825"><span class="hs-identifier hs-var hs-var">isInconsistent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCache -&gt; [InconsistentMetadata]
</span><a href="Hasura.RQL.Types.SchemaCache.html#scInconsistentObjs"><span class="hs-identifier hs-var">scInconsistentObjs</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCache
</span><a href="#local-6989586621690824826"><span class="hs-identifier hs-var">sc</span></a></span><span>
</span><span id="line-863"></span><span>                </span><span id="local-6989586621690824821"><span class="annot"><span class="annottext">inconsistenciesMessage :: Text
</span><a href="#local-6989586621690824821"><span class="hs-identifier hs-var hs-var">inconsistenciesMessage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;inconsistent objects in schema&quot;</span></span><span>
</span><span id="line-864"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621690824820"><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621690824820"><span class="hs-identifier hs-var">status</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690824819"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690824819"><span class="hs-identifier hs-var">responseText</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-865"></span><span>              </span><span class="hs-keyword">if</span><span>
</span><span id="line-866"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690824825"><span class="hs-identifier hs-var">isInconsistent</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690824834"><span class="hs-identifier hs-var">isStrict</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-867"></span><span>                      </span><span class="hs-comment">-- Inconsistencies exist and strict mode enabled. Report inconsistencies as ERROR with status 500.</span><span>
</span><span id="line-868"></span><span>                      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690824818"><span class="annot"><span class="annottext">message :: Text
</span><a href="#local-6989586621690824818"><span class="hs-identifier hs-var hs-var">message</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;ERROR: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690824821"><span class="hs-identifier hs-var">inconsistenciesMessage</span></a></span><span>
</span><span id="line-869"></span><span>                      </span><span class="annot"><span class="annottext">QErr -&gt; ActionCtxT () m ()
</span><a href="#local-6989586621690824829"><span class="hs-identifier hs-var">logError</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; QErr
</span><a href="Hasura.Base.Error.html#err500"><span class="hs-identifier hs-var">err500</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#InvalidConfiguration"><span class="hs-identifier hs-var">InvalidConfiguration</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690824818"><span class="hs-identifier hs-var">message</span></a></span><span>
</span><span id="line-870"></span><span>                      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">HTTP.status500</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690824818"><span class="hs-identifier hs-var">message</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-871"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690824825"><span class="hs-identifier hs-var">isInconsistent</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690824834"><span class="hs-identifier hs-var">isStrict</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-872"></span><span>                      </span><span class="hs-comment">-- Inconsistencies exist and strict mode disabled. Warn inconsistencies with status 200.</span><span>
</span><span id="line-873"></span><span>                      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690824815"><span class="annot"><span class="annottext">message :: Text
</span><a href="#local-6989586621690824815"><span class="hs-identifier hs-var hs-var">message</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;WARN: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690824821"><span class="hs-identifier hs-var">inconsistenciesMessage</span></a></span><span>
</span><span id="line-874"></span><span>                      </span><span class="annot"><span class="annottext">Text -&gt; ActionCtxT () m ()
</span><a href="#local-6989586621690824814"><span class="hs-identifier hs-var">logSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">LT.fromStrict</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690824815"><span class="hs-identifier hs-var">message</span></a></span><span>
</span><span id="line-875"></span><span>                      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">HTTP.status200</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690824815"><span class="hs-identifier hs-var">message</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-876"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-877"></span><span>                      </span><span class="hs-comment">-- No inconsistencies in schema cache, report OK</span><span>
</span><span id="line-878"></span><span>                      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690824810"><span class="annot"><span class="annottext">message :: Text
</span><a href="#local-6989586621690824810"><span class="hs-identifier hs-var hs-var">message</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;OK&quot;</span></span><span>
</span><span id="line-879"></span><span>                      </span><span class="annot"><span class="annottext">Text -&gt; ActionCtxT () m ()
</span><a href="#local-6989586621690824814"><span class="hs-identifier hs-var">logSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">LT.fromStrict</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690824810"><span class="hs-identifier hs-var">message</span></a></span><span>
</span><span id="line-880"></span><span>                      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">HTTP.status200</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690824810"><span class="hs-identifier hs-var">message</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-881"></span><span>
</span><span id="line-882"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx.
MonadIO m =&gt;
Status -&gt; ActionCtxT ctx m ()
</span><span class="hs-identifier hs-var">Spock.setStatus</span></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621690824820"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx a. MonadIO m =&gt; Text -&gt; ActionCtxT ctx m a
</span><span class="hs-identifier hs-var">Spock.text</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690824819"><span class="hs-identifier hs-var">responseText</span></a></span><span>
</span><span id="line-883"></span><span>
</span><span id="line-884"></span><span>  </span><span class="annot"><span class="annottext">forall (xs :: [*]) (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *)
       (ps :: PathState) ctx.
(HasRep xs, RouteM t, Monad m) =&gt;
Path xs ps -&gt; HVectElim xs (ActionCtxT ctx m ()) -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.get</span></span><span> </span><span class="annot"><span class="annottext">Path '[] 'Open
</span><span class="hs-string">&quot;healthz&quot;</span></span><span> </span><span class="annot"><span class="annottext">ActionCtxT () m ()
</span><a href="#local-6989586621690824837"><span class="hs-identifier hs-var">healthzAction</span></a></span><span>
</span><span id="line-885"></span><span>
</span><span id="line-886"></span><span>  </span><span class="hs-comment">-- This is an alternative to `healthz` (See issue #6958)</span><span>
</span><span id="line-887"></span><span>  </span><span class="annot"><span class="annottext">forall (xs :: [*]) (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *)
       (ps :: PathState) ctx.
(HasRep xs, RouteM t, Monad m) =&gt;
Path xs ps -&gt; HVectElim xs (ActionCtxT ctx m ()) -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.get</span></span><span> </span><span class="annot"><span class="annottext">Path '[] 'Open
</span><span class="hs-string">&quot;hasura/healthz&quot;</span></span><span> </span><span class="annot"><span class="annottext">ActionCtxT () m ()
</span><a href="#local-6989586621690824837"><span class="hs-identifier hs-var">healthzAction</span></a></span><span>
</span><span id="line-888"></span><span>
</span><span id="line-889"></span><span>  </span><span class="annot"><span class="annottext">forall (xs :: [*]) (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *)
       (ps :: PathState) ctx.
(HasRep xs, RouteM t, Monad m) =&gt;
Path xs ps -&gt; HVectElim xs (ActionCtxT ctx m ()) -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.get</span></span><span> </span><span class="annot"><span class="annottext">Path '[] 'Open
</span><span class="hs-string">&quot;v1/version&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-890"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; ActionCtxT () m ()
</span><a href="#local-6989586621690824814"><span class="hs-identifier hs-var">logSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;version: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (ToText a, FromText b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">convertText</span></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="Hasura.Server.Version.html#currentVersion"><span class="hs-identifier hs-var">currentVersion</span></a></span><span>
</span><span id="line-891"></span><span>    </span><span id="local-6989586621690824808"><span class="annot"><span class="annottext">[Pair]
</span><a href="#local-6989586621690824808"><span class="hs-identifier hs-var">extraData</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadVersionAPIWithExtraData m =&gt; m [Pair]
</span><a href="Hasura.Server.App.html#getExtraDataForVersionAPI"><span class="hs-identifier hs-var">getExtraDataForVersionAPI</span></a></span><span>
</span><span id="line-892"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx.
MonadIO m =&gt;
Header -&gt; ActionCtxT ctx m ()
</span><a href="Hasura.Server.App.html#setHeader"><span class="hs-identifier hs-var">setHeader</span></a></span><span> </span><span class="annot"><span class="annottext">Header
</span><a href="Hasura.Server.Utils.html#jsonHeader"><span class="hs-identifier hs-var">jsonHeader</span></a></span><span>
</span><span id="line-893"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx a.
MonadIO m =&gt;
ByteString -&gt; ActionCtxT ctx m a
</span><span class="hs-identifier hs-var">Spock.lazyBytes</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encode</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">object</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;version&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="Hasura.Server.Version.html#currentVersion"><span class="hs-identifier hs-var">currentVersion</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Pair]
</span><a href="#local-6989586621690824808"><span class="hs-identifier hs-var">extraData</span></a></span><span>
</span><span id="line-894"></span><span>
</span><span id="line-895"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621690824805"><span class="hs-identifier hs-type">customEndpointHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-896"></span><span>        </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621690827666"><span class="annot"><a href="#local-6989586621690827666"><span class="hs-identifier hs-type">n</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-897"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827666"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-898"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">MonadBaseControl</span></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827666"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-899"></span><span>          </span><span class="annot"><a href="Hasura.GraphQL.Execute.Common.html#MonadGQLExecutionCheck"><span class="hs-identifier hs-type">E.MonadGQLExecutionCheck</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827666"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-900"></span><span>          </span><span class="annot"><a href="Hasura.GraphQL.Logging.html#MonadQueryLog"><span class="hs-identifier hs-type">MonadQueryLog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827666"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-901"></span><span>          </span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.html#MonadExecuteQuery"><span class="hs-identifier hs-type">GH.MonadExecuteQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827666"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-902"></span><span>          </span><span class="annot"><a href="Hasura.Metadata.Class.html#MonadMetadataStorage"><span class="hs-identifier hs-type">MonadMetadataStorage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827666"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-903"></span><span>          </span><span class="annot"><a href="Hasura.GraphQL.Execute.Backend.html#MonadQueryTags"><span class="hs-identifier hs-type">EB.MonadQueryTags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827666"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-904"></span><span>          </span><span class="annot"><a href="Hasura.Server.Limits.html#HasResourceLimits"><span class="hs-identifier hs-type">HasResourceLimits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827666"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-905"></span><span>          </span><span class="annot"><a href="Hasura.Services.Network.html#ProvidesNetwork"><span class="hs-identifier hs-type">ProvidesNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827666"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-906"></span><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-907"></span><span>        </span><span class="annot"><a href="Hasura.Server.Rest.html#RestRequest"><span class="hs-identifier hs-type">RestRequest</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Spock.SpockMethod</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-908"></span><span>        </span><span class="annot"><a href="Hasura.Server.App.html#Handler"><span class="hs-identifier hs-type">Handler</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Tracing.html#TraceT"><span class="hs-identifier hs-type">Tracing.TraceT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827666"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogGraphQLInfo"><span class="hs-identifier hs-type">HttpLogGraphQLInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.App.html#APIResp"><span class="hs-identifier hs-type">APIResp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-909"></span><span>      </span><span id="local-6989586621690824805"><span class="annot"><span class="annottext">customEndpointHandler :: forall (n :: * -&gt; *).
(MonadIO n, MonadBaseControl IO n, MonadGQLExecutionCheck n,
 MonadQueryLog n, MonadExecuteQuery n, MonadMetadataStorage n,
 MonadQueryTags n, HasResourceLimits n, ProvidesNetwork n) =&gt;
RestRequest SpockMethod
-&gt; Handler (TraceT n) (HttpLogGraphQLInfo, APIResp)
</span><a href="#local-6989586621690824805"><span class="hs-identifier hs-var hs-var">customEndpointHandler</span></a></span></span><span> </span><span id="local-6989586621690824734"><span class="annot"><span class="annottext">RestRequest SpockMethod
</span><a href="#local-6989586621690824734"><span class="hs-identifier hs-var">restReq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-910"></span><span>        </span><span id="local-6989586621690824733"><span class="annot"><span class="annottext">EndpointTrie GQLQueryWithText
</span><a href="#local-6989586621690824733"><span class="hs-identifier hs-var">endpoints</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCache -&gt; EndpointTrie GQLQueryWithText
</span><a href="Hasura.RQL.Types.SchemaCache.html#scEndpoints"><span class="hs-identifier hs-var">scEndpoints</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCacheRef -&gt; IO SchemaCache
</span><a href="Hasura.Server.SchemaCacheRef.html#getSchemaCache"><span class="hs-identifier hs-var">getSchemaCache</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCacheRef
</span><a href="#local-6989586621690824896"><span class="hs-identifier hs-var">acCacheRef</span></a></span><span>
</span><span id="line-911"></span><span>        </span><span id="local-6989586621690824731"><span class="annot"><span class="annottext">ExecutionCtx
</span><a href="#local-6989586621690824731"><span class="hs-identifier hs-var">execCtx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadReader HandlerCtx m) =&gt;
m ExecutionCtx
</span><a href="Hasura.Server.App.html#mkExecutionContext"><span class="hs-identifier hs-var">mkExecutionContext</span></a></span><span>
</span><span id="line-912"></span><span>        </span><span id="local-6989586621690824730"><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621690824730"><span class="hs-identifier hs-var">requestId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; RequestId
</span><a href="Hasura.Server.App.html#hcRequestId"><span class="hs-identifier hs-var">hcRequestId</span></a></span><span>
</span><span id="line-913"></span><span>        </span><span id="local-6989586621690824729"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690824729"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; UserInfo
</span><a href="Hasura.Server.App.html#hcUser"><span class="hs-identifier hs-var">hcUser</span></a></span><span>
</span><span id="line-914"></span><span>        </span><span id="local-6989586621690824728"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690824728"><span class="hs-identifier hs-var">reqHeaders</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; [Header]
</span><a href="Hasura.Server.App.html#hcReqHeaders"><span class="hs-identifier hs-var">hcReqHeaders</span></a></span><span>
</span><span id="line-915"></span><span>        </span><span id="local-6989586621690824727"><span class="annot"><span class="annottext">IpAddress
</span><a href="#local-6989586621690824727"><span class="hs-identifier hs-var">ipAddress</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerCtx -&gt; IpAddress
</span><a href="Hasura.Server.App.html#hcSourceIpAddress"><span class="hs-identifier hs-var">hcSourceIpAddress</span></a></span><span>
</span><span id="line-916"></span><span>
</span><span id="line-917"></span><span>        </span><span id="local-6989586621690824726"><span class="annot"><span class="annottext">RestRequest EndpointMethod
</span><a href="#local-6989586621690824726"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-918"></span><span>          </span><span class="annot"><span class="annottext">RestRequest SpockMethod
</span><a href="#local-6989586621690824734"><span class="hs-identifier hs-var">restReq</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-919"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Spock.MethodStandard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Spock.HttpMethod</span></span><span> </span><span id="local-6989586621690824721"><span class="annot"><span class="annottext">StdMethod
</span><a href="#local-6989586621690824721"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StdMethod
</span><a href="#local-6989586621690824721"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-920"></span><span>              </span><span class="annot"><span class="annottext">StdMethod
</span><span class="hs-identifier hs-var">Spock.GET</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointMethod
</span><a href="Hasura.RQL.Types.Endpoint.html#GET"><span class="hs-identifier hs-var">EP.GET</span></a></span><span>
</span><span id="line-921"></span><span>              </span><span class="annot"><span class="annottext">StdMethod
</span><span class="hs-identifier hs-var">Spock.POST</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointMethod
</span><a href="Hasura.RQL.Types.Endpoint.html#POST"><span class="hs-identifier hs-var">EP.POST</span></a></span><span>
</span><span id="line-922"></span><span>              </span><span class="annot"><span class="annottext">StdMethod
</span><span class="hs-identifier hs-var">Spock.PUT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointMethod
</span><a href="Hasura.RQL.Types.Endpoint.html#PUT"><span class="hs-identifier hs-var">EP.PUT</span></a></span><span>
</span><span id="line-923"></span><span>              </span><span class="annot"><span class="annottext">StdMethod
</span><span class="hs-identifier hs-var">Spock.DELETE</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointMethod
</span><a href="Hasura.RQL.Types.Endpoint.html#DELETE"><span class="hs-identifier hs-var">EP.DELETE</span></a></span><span>
</span><span id="line-924"></span><span>              </span><span class="annot"><span class="annottext">StdMethod
</span><span class="hs-identifier hs-var">Spock.PATCH</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointMethod
</span><a href="Hasura.RQL.Types.Endpoint.html#PATCH"><span class="hs-identifier hs-var">EP.PATCH</span></a></span><span>
</span><span id="line-925"></span><span>              </span><span id="local-6989586621690824710"><span class="annot"><span class="annottext">StdMethod
</span><a href="#local-6989586621690824710"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#BadRequest"><span class="hs-identifier hs-var">BadRequest</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Method &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; Text
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier hs-var">tshow</span></a></span><span> </span><span class="annot"><span class="annottext">StdMethod
</span><a href="#local-6989586621690824710"><span class="hs-identifier hs-var">other</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; not supported.&quot;</span></span><span>
</span><span id="line-926"></span><span>            </span><span class="annot"><span class="annottext">SpockMethod
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#BadRequest"><span class="hs-identifier hs-var">BadRequest</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Nonstandard method not allowed for REST endpoints&quot;</span></span><span>
</span><span id="line-927"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">HttpResponse EncJSON -&gt; APIResp
</span><a href="Hasura.Server.App.html#JSONResp"><span class="hs-identifier hs-var">JSONResp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m, MonadTrace m, MonadBaseControl IO m,
 MonadGQLExecutionCheck m, MonadQueryLog m, MonadExecuteQuery m,
 MonadMetadataStorage m, MonadQueryTags m, HasResourceLimits m,
 ProvidesNetwork m) =&gt;
Environment
-&gt; ExecutionCtx
-&gt; RequestId
-&gt; UserInfo
-&gt; [Header]
-&gt; IpAddress
-&gt; RestRequest EndpointMethod
-&gt; EndpointTrie GQLQueryWithText
-&gt; m (HttpLogGraphQLInfo, HttpResponse EncJSON)
</span><a href="Hasura.Server.Rest.html#runCustomEndpoint"><span class="hs-identifier hs-var">runCustomEndpoint</span></a></span><span> </span><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621690824890"><span class="hs-identifier hs-var">acEnvironment</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutionCtx
</span><a href="#local-6989586621690824731"><span class="hs-identifier hs-var">execCtx</span></a></span><span> </span><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621690824730"><span class="hs-identifier hs-var">requestId</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621690824729"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690824728"><span class="hs-identifier hs-var">reqHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">IpAddress
</span><a href="#local-6989586621690824727"><span class="hs-identifier hs-var">ipAddress</span></a></span><span> </span><span class="annot"><span class="annottext">RestRequest EndpointMethod
</span><a href="#local-6989586621690824726"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointTrie GQLQueryWithText
</span><a href="#local-6989586621690824733"><span class="hs-identifier hs-var">endpoints</span></a></span><span>
</span><span id="line-928"></span><span>
</span><span id="line-929"></span><span>  </span><span class="hs-comment">-- See Issue #291 for discussion around restified feature</span><span>
</span><span id="line-930"></span><span>  </span><span class="annot"><span class="annottext">forall (xs :: [*]) (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *)
       (ps :: PathState) ctx.
(HasRep xs, RouteM t, Monad m) =&gt;
Path xs ps -&gt; HVectElim xs (ActionCtxT ctx m ()) -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.hookRouteAll</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path '[] 'Open
</span><span class="hs-string">&quot;api&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (as :: [*]) (bs :: [*]) (ps :: PathState).
Path as 'Open -&gt; Path bs ps -&gt; Path (Append as bs) ps
</span><span class="hs-operator hs-var">&lt;//&gt;</span></span><span> </span><span class="annot"><span class="annottext">Path '[] 'Open
</span><span class="hs-string">&quot;rest&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (as :: [*]) (bs :: [*]) (ps :: PathState).
Path as 'Open -&gt; Path bs ps -&gt; Path (Append as bs) ps
</span><span class="hs-operator hs-var">&lt;//&gt;</span></span><span> </span><span class="annot"><span class="annottext">Path '[Text] 'Closed
</span><span class="hs-identifier hs-var">Spock.wildcard</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621690824705"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690824705"><span class="hs-identifier hs-var">wildcard</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-931"></span><span>    </span><span id="local-6989586621690824704"><span class="annot"><span class="annottext">TracingMetadata
</span><a href="#local-6989586621690824704"><span class="hs-identifier hs-var">queryParams</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx.
MonadIO m =&gt;
ActionCtxT ctx m TracingMetadata
</span><span class="hs-identifier hs-var">Spock.params</span></span><span>
</span><span id="line-932"></span><span>    </span><span id="local-6989586621690824702"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690824702"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx. MonadIO m =&gt; ActionCtxT ctx m ByteString
</span><span class="hs-identifier hs-var">Spock.body</span></span><span>
</span><span id="line-933"></span><span>    </span><span id="local-6989586621690824700"><span class="annot"><span class="annottext">SpockMethod
</span><a href="#local-6989586621690824700"><span class="hs-identifier hs-var">method</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx. MonadIO m =&gt; ActionCtxT ctx m SpockMethod
</span><span class="hs-identifier hs-var">Spock.reqMethod</span></span><span>
</span><span id="line-934"></span><span>
</span><span id="line-935"></span><span>    </span><span class="hs-comment">-- This is where we decode the json encoded body args. They</span><span>
</span><span id="line-936"></span><span>    </span><span class="hs-comment">-- are treated as if they came from query arguments, but allow</span><span>
</span><span id="line-937"></span><span>    </span><span class="hs-comment">-- us to pass non-scalar values.</span><span>
</span><span id="line-938"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690824698"><span class="annot"><span class="annottext">bodyParams :: [(Text, Value)]
</span><a href="#local-6989586621690824698"><span class="hs-identifier hs-var hs-var">bodyParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; ByteString -&gt; Maybe a
</span><span class="hs-identifier hs-var">J.decodeStrict</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690824702"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-939"></span><span>          </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">J.Object</span></span><span> </span><span id="local-6989586621690824695"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621690824695"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Text
</span><span class="hs-identifier hs-var">K.toText</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall v. KeyMap v -&gt; [(Key, v)]
</span><span class="hs-identifier hs-var">KM.toList</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621690824695"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-940"></span><span>          </span><span class="annot"><span class="annottext">Maybe Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-941"></span><span>        </span><span id="local-6989586621690824692"><span class="annot"><span class="annottext">allParams :: [(Text, Either Text Value)]
</span><a href="#local-6989586621690824692"><span class="hs-identifier hs-var hs-var">allParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TracingMetadata
</span><a href="#local-6989586621690824704"><span class="hs-identifier hs-var">queryParams</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Value)]
</span><a href="#local-6989586621690824698"><span class="hs-identifier hs-var">bodyParams</span></a></span><span>
</span><span id="line-942"></span><span>
</span><span id="line-943"></span><span>    </span><span class="annot"><span class="annottext">forall a (n :: * -&gt; *).
(FromJSON a, MonadIO n, MonadBaseControl IO n,
 UserAuthentication (TraceT n), HttpLog n, HasReporter n,
 HasResourceLimits n) =&gt;
(Bool -&gt; QErr -&gt; Value)
-&gt; (QErr -&gt; QErr) -&gt; APIHandler (TraceT n) a -&gt; ActionT n ()
</span><a href="#local-6989586621690824690"><span class="hs-identifier hs-var">spockAction</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; QErr -&gt; Value
</span><a href="Hasura.Base.Error.html#encodeQErr"><span class="hs-identifier hs-var">encodeQErr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-944"></span><span>      </span><span class="hs-comment">-- TODO: Are we actually able to use mkGetHandler in this situation? POST handler seems to do some work that we might want to avoid.</span><span>
</span><span id="line-945"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
Handler m (HttpLogGraphQLInfo, APIResp) -&gt; APIHandler m ()
</span><a href="Hasura.Server.App.html#mkGetHandler"><span class="hs-identifier hs-var">mkGetHandler</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (n :: * -&gt; *).
(MonadIO n, MonadBaseControl IO n, MonadGQLExecutionCheck n,
 MonadQueryLog n, MonadExecuteQuery n, MonadMetadataStorage n,
 MonadQueryTags n, HasResourceLimits n, ProvidesNetwork n) =&gt;
RestRequest SpockMethod
-&gt; Handler (TraceT n) (HttpLogGraphQLInfo, APIResp)
</span><a href="#local-6989586621690824805"><span class="hs-identifier hs-var">customEndpointHandler</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall method.
Text -&gt; method -&gt; [(Text, Either Text Value)] -&gt; RestRequest method
</span><a href="Hasura.Server.Rest.html#RestRequest"><span class="hs-identifier hs-var">RestRequest</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690824705"><span class="hs-identifier hs-var">wildcard</span></a></span><span> </span><span class="annot"><span class="annottext">SpockMethod
</span><a href="#local-6989586621690824700"><span class="hs-identifier hs-var">method</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Either Text Value)]
</span><a href="#local-6989586621690824692"><span class="hs-identifier hs-var">allParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-946"></span><span>
</span><span id="line-947"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690824840"><span class="hs-identifier hs-var">enableMetadata</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-948"></span><span>    </span><span class="annot"><span class="annottext">forall (xs :: [*]) (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *)
       (ps :: PathState) ctx.
(HasRep xs, RouteM t, Monad m) =&gt;
Path xs ps -&gt; HVectElim xs (ActionCtxT ctx m ()) -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.post</span></span><span> </span><span class="annot"><span class="annottext">Path '[] 'Open
</span><span class="hs-string">&quot;v1/graphql/explain&quot;</span></span><span> </span><span class="annot"><span class="annottext">ActionCtxT () m ()
</span><a href="#local-6989586621690824687"><span class="hs-identifier hs-var">gqlExplainAction</span></a></span><span>
</span><span id="line-949"></span><span>
</span><span id="line-950"></span><span>    </span><span class="annot"><span class="annottext">forall (xs :: [*]) (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *)
       (ps :: PathState) ctx.
(HasRep xs, RouteM t, Monad m) =&gt;
Path xs ps -&gt; HVectElim xs (ActionCtxT ctx m ()) -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.post</span></span><span> </span><span class="annot"><span class="annottext">Path '[] 'Open
</span><span class="hs-string">&quot;v1alpha1/graphql/explain&quot;</span></span><span> </span><span class="annot"><span class="annottext">ActionCtxT () m ()
</span><a href="#local-6989586621690824687"><span class="hs-identifier hs-var">gqlExplainAction</span></a></span><span>
</span><span id="line-951"></span><span>
</span><span id="line-952"></span><span>    </span><span class="annot"><span class="annottext">forall (xs :: [*]) (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *)
       (ps :: PathState) ctx.
(HasRep xs, RouteM t, Monad m) =&gt;
Path xs ps -&gt; HVectElim xs (ActionCtxT ctx m ()) -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.post</span></span><span> </span><span class="annot"><span class="annottext">Path '[] 'Open
</span><span class="hs-string">&quot;v1/query&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-953"></span><span>      </span><span class="annot"><span class="annottext">forall a (n :: * -&gt; *).
(FromJSON a, MonadIO n, MonadBaseControl IO n,
 UserAuthentication (TraceT n), HttpLog n, HasReporter n,
 HasResourceLimits n) =&gt;
(Bool -&gt; QErr -&gt; Value)
-&gt; (QErr -&gt; QErr) -&gt; APIHandler (TraceT n) a -&gt; ActionT n ()
</span><a href="#local-6989586621690824690"><span class="hs-identifier hs-var">spockAction</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; QErr -&gt; Value
</span><a href="Hasura.Base.Error.html#encodeQErr"><span class="hs-identifier hs-var">encodeQErr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-954"></span><span>        </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(a -&gt; Handler m (HttpLogGraphQLInfo, APIResp)) -&gt; APIHandler m a
</span><a href="Hasura.Server.App.html#mkPostHandler"><span class="hs-identifier hs-var">mkPostHandler</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HttpLogGraphQLInfo
</span><a href="Hasura.Server.Logging.html#emptyHttpLogGraphQLInfo"><span class="hs-identifier hs-var">emptyHttpLogGraphQLInfo</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
Functor m =&gt;
(a -&gt; Handler m (HttpResponse EncJSON)) -&gt; a -&gt; Handler m APIResp
</span><a href="Hasura.Server.App.html#mkAPIRespHandler"><span class="hs-identifier hs-var">mkAPIRespHandler</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m, MonadBaseControl IO m,
 MonadMetadataApiAuthorization m, MonadTrace m,
 MonadReader HandlerCtx m, MonadMetadataStorageQueryAPI m,
 MonadResolveSource m, MonadQueryTags m, MonadEventLogCleanup m,
 ProvidesNetwork m) =&gt;
RQLQuery -&gt; m (HttpResponse EncJSON)
</span><a href="Hasura.Server.App.html#v1QueryHandler"><span class="hs-identifier hs-var">v1QueryHandler</span></a></span><span>
</span><span id="line-955"></span><span>
</span><span id="line-956"></span><span>    </span><span class="annot"><span class="annottext">forall (xs :: [*]) (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *)
       (ps :: PathState) ctx.
(HasRep xs, RouteM t, Monad m) =&gt;
Path xs ps -&gt; HVectElim xs (ActionCtxT ctx m ()) -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.post</span></span><span> </span><span class="annot"><span class="annottext">Path '[] 'Open
</span><span class="hs-string">&quot;v1/metadata&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-957"></span><span>      </span><span class="annot"><span class="annottext">forall a (n :: * -&gt; *).
(FromJSON a, MonadIO n, MonadBaseControl IO n,
 UserAuthentication (TraceT n), HttpLog n, HasReporter n,
 HasResourceLimits n) =&gt;
(Bool -&gt; QErr -&gt; Value)
-&gt; (QErr -&gt; QErr) -&gt; APIHandler (TraceT n) a -&gt; ActionT n ()
</span><a href="#local-6989586621690824690"><span class="hs-identifier hs-var">spockAction</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; QErr -&gt; Value
</span><a href="Hasura.Base.Error.html#encodeQErr"><span class="hs-identifier hs-var">encodeQErr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-958"></span><span>        </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(a -&gt; Handler m (HttpLogGraphQLInfo, APIResp)) -&gt; APIHandler m a
</span><a href="Hasura.Server.App.html#mkPostHandler"><span class="hs-identifier hs-var">mkPostHandler</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-959"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HttpLogGraphQLInfo
</span><a href="Hasura.Server.Logging.html#emptyHttpLogGraphQLInfo"><span class="hs-identifier hs-var">emptyHttpLogGraphQLInfo</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
Functor m =&gt;
(a -&gt; Handler m (HttpResponse EncJSON)) -&gt; a -&gt; Handler m APIResp
</span><a href="Hasura.Server.App.html#mkAPIRespHandler"><span class="hs-identifier hs-var">mkAPIRespHandler</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m, MonadBaseControl IO m,
 MonadReader HandlerCtx m, MonadTrace m,
 MonadMetadataStorageQueryAPI m, MonadResolveSource m,
 MonadMetadataApiAuthorization m, MonadEventLogCleanup m,
 ProvidesNetwork m) =&gt;
RQLMetadata -&gt; m (HttpResponse EncJSON)
</span><a href="Hasura.Server.App.html#v1MetadataHandler"><span class="hs-identifier hs-var">v1MetadataHandler</span></a></span><span>
</span><span id="line-960"></span><span>
</span><span id="line-961"></span><span>    </span><span class="annot"><span class="annottext">forall (xs :: [*]) (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *)
       (ps :: PathState) ctx.
(HasRep xs, RouteM t, Monad m) =&gt;
Path xs ps -&gt; HVectElim xs (ActionCtxT ctx m ()) -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.post</span></span><span> </span><span class="annot"><span class="annottext">Path '[] 'Open
</span><span class="hs-string">&quot;v2/query&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-962"></span><span>      </span><span class="annot"><span class="annottext">forall a (n :: * -&gt; *).
(FromJSON a, MonadIO n, MonadBaseControl IO n,
 UserAuthentication (TraceT n), HttpLog n, HasReporter n,
 HasResourceLimits n) =&gt;
(Bool -&gt; QErr -&gt; Value)
-&gt; (QErr -&gt; QErr) -&gt; APIHandler (TraceT n) a -&gt; ActionT n ()
</span><a href="#local-6989586621690824690"><span class="hs-identifier hs-var">spockAction</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; QErr -&gt; Value
</span><a href="Hasura.Base.Error.html#encodeQErr"><span class="hs-identifier hs-var">encodeQErr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-963"></span><span>        </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(a -&gt; Handler m (HttpLogGraphQLInfo, APIResp)) -&gt; APIHandler m a
</span><a href="Hasura.Server.App.html#mkPostHandler"><span class="hs-identifier hs-var">mkPostHandler</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-964"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HttpLogGraphQLInfo
</span><a href="Hasura.Server.Logging.html#emptyHttpLogGraphQLInfo"><span class="hs-identifier hs-var">emptyHttpLogGraphQLInfo</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
Functor m =&gt;
(a -&gt; Handler m (HttpResponse EncJSON)) -&gt; a -&gt; Handler m APIResp
</span><a href="Hasura.Server.App.html#mkAPIRespHandler"><span class="hs-identifier hs-var">mkAPIRespHandler</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m, MonadBaseControl IO m,
 MonadMetadataApiAuthorization m, MonadTrace m,
 MonadReader HandlerCtx m, MonadMetadataStorage m,
 MonadResolveSource m, MonadQueryTags m, ProvidesNetwork m) =&gt;
RQLQuery -&gt; m (HttpResponse EncJSON)
</span><a href="Hasura.Server.App.html#v2QueryHandler"><span class="hs-identifier hs-var">v2QueryHandler</span></a></span><span>
</span><span id="line-965"></span><span>
</span><span id="line-966"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690824686"><span class="hs-identifier hs-var">enablePGDump</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-967"></span><span>    </span><span class="annot"><span class="annottext">forall (xs :: [*]) (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *)
       (ps :: PathState) ctx.
(HasRep xs, RouteM t, Monad m) =&gt;
Path xs ps -&gt; HVectElim xs (ActionCtxT ctx m ()) -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.post</span></span><span> </span><span class="annot"><span class="annottext">Path '[] 'Open
</span><span class="hs-string">&quot;v1alpha1/pg_dump&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-968"></span><span>      </span><span class="annot"><span class="annottext">forall a (n :: * -&gt; *).
(FromJSON a, MonadIO n, MonadBaseControl IO n,
 UserAuthentication (TraceT n), HttpLog n, HasReporter n,
 HasResourceLimits n) =&gt;
(Bool -&gt; QErr -&gt; Value)
-&gt; (QErr -&gt; QErr) -&gt; APIHandler (TraceT n) a -&gt; ActionT n ()
</span><a href="#local-6989586621690824690"><span class="hs-identifier hs-var">spockAction</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; QErr -&gt; Value
</span><a href="Hasura.Base.Error.html#encodeQErr"><span class="hs-identifier hs-var">encodeQErr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-969"></span><span>        </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(a -&gt; Handler m (HttpLogGraphQLInfo, APIResp)) -&gt; APIHandler m a
</span><a href="Hasura.Server.App.html#mkPostHandler"><span class="hs-identifier hs-var">mkPostHandler</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-970"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HttpLogGraphQLInfo
</span><a href="Hasura.Server.Logging.html#emptyHttpLogGraphQLInfo"><span class="hs-identifier hs-var">emptyHttpLogGraphQLInfo</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m, MonadReader HandlerCtx m) =&gt;
PGDumpReqBody -&gt; m APIResp
</span><a href="Hasura.Server.App.html#v1Alpha1PGDumpHandler"><span class="hs-identifier hs-var">v1Alpha1PGDumpHandler</span></a></span><span>
</span><span id="line-971"></span><span>
</span><span id="line-972"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690824685"><span class="hs-identifier hs-var">enableConfig</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadConfigApiHandler m =&gt;
AppContext -&gt; AppEnv -&gt; SpockCtxT () m ()
</span><a href="Hasura.Server.App.html#runConfigApiHandler"><span class="hs-identifier hs-var">runConfigApiHandler</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621690824897"><span class="hs-identifier hs-var">appCtx</span></a></span><span> </span><span class="annot"><span class="annottext">AppEnv
</span><a href="#local-6989586621690824874"><span class="hs-identifier hs-var">appEnv</span></a></span><span>
</span><span id="line-973"></span><span>
</span><span id="line-974"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690824684"><span class="hs-identifier hs-var">enableGraphQL</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-975"></span><span>    </span><span class="annot"><span class="annottext">forall (xs :: [*]) (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *)
       (ps :: PathState) ctx.
(HasRep xs, RouteM t, Monad m) =&gt;
Path xs ps -&gt; HVectElim xs (ActionCtxT ctx m ()) -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.post</span></span><span> </span><span class="annot"><span class="annottext">Path '[] 'Open
</span><span class="hs-string">&quot;v1alpha1/graphql&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-976"></span><span>      </span><span class="annot"><span class="annottext">forall a (n :: * -&gt; *).
(FromJSON a, MonadIO n, MonadBaseControl IO n,
 UserAuthentication (TraceT n), HttpLog n, HasReporter n,
 HasResourceLimits n) =&gt;
(Bool -&gt; QErr -&gt; Value)
-&gt; (QErr -&gt; QErr) -&gt; APIHandler (TraceT n) a -&gt; ActionT n ()
</span><a href="#local-6989586621690824690"><span class="hs-identifier hs-var">spockAction</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; QErr -&gt; Value
</span><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#encodeGQErr"><span class="hs-identifier hs-var">GH.encodeGQErr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-977"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(ReqsText -&gt; Handler m (HttpLogGraphQLInfo, APIResp))
-&gt; APIHandler m ReqsText
</span><a href="Hasura.Server.App.html#mkGQLRequestHandler"><span class="hs-identifier hs-var">mkGQLRequestHandler</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-978"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b.
Functor m =&gt;
(a -&gt; Handler m (b, HttpResponse EncJSON))
-&gt; a -&gt; Handler m (b, APIResp)
</span><a href="Hasura.Server.App.html#mkGQLAPIRespHandler"><span class="hs-identifier hs-var">mkGQLAPIRespHandler</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-979"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadBaseControl IO m, MonadGQLExecutionCheck m,
 MonadQueryLog m, MonadTrace m, MonadExecuteQuery m,
 MonadError QErr m, MonadReader HandlerCtx m,
 MonadMetadataStorage m, MonadQueryTags m, HasResourceLimits m,
 ProvidesNetwork m) =&gt;
GraphQLQueryType
-&gt; ReqsText -&gt; m (HttpLogGraphQLInfo, HttpResponse EncJSON)
</span><a href="Hasura.Server.App.html#v1Alpha1GQHandler"><span class="hs-identifier hs-var">v1Alpha1GQHandler</span></a></span><span> </span><span class="annot"><span class="annottext">GraphQLQueryType
</span><a href="Hasura.GraphQL.Execute.Types.html#QueryHasura"><span class="hs-identifier hs-var">E.QueryHasura</span></a></span><span>
</span><span id="line-980"></span><span>
</span><span id="line-981"></span><span>    </span><span class="annot"><span class="annottext">forall (xs :: [*]) (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *)
       (ps :: PathState) ctx.
(HasRep xs, RouteM t, Monad m) =&gt;
Path xs ps -&gt; HVectElim xs (ActionCtxT ctx m ()) -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.post</span></span><span> </span><span class="annot"><span class="annottext">Path '[] 'Open
</span><span class="hs-string">&quot;v1/graphql&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-982"></span><span>      </span><span class="annot"><span class="annottext">forall a (n :: * -&gt; *).
(FromJSON a, MonadIO n, MonadBaseControl IO n,
 UserAuthentication (TraceT n), HttpLog n, HasReporter n,
 HasResourceLimits n) =&gt;
(Bool -&gt; QErr -&gt; Value)
-&gt; (QErr -&gt; QErr) -&gt; APIHandler (TraceT n) a -&gt; ActionT n ()
</span><a href="#local-6989586621690824690"><span class="hs-identifier hs-var">spockAction</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; QErr -&gt; Value
</span><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#encodeGQErr"><span class="hs-identifier hs-var">GH.encodeGQErr</span></a></span><span> </span><span class="annot"><span class="annottext">QErr -&gt; QErr
</span><a href="#local-6989586621690824682"><span class="hs-identifier hs-var">allMod200</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-983"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(ReqsText -&gt; Handler m (HttpLogGraphQLInfo, APIResp))
-&gt; APIHandler m ReqsText
</span><a href="Hasura.Server.App.html#mkGQLRequestHandler"><span class="hs-identifier hs-var">mkGQLRequestHandler</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-984"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b.
Functor m =&gt;
(a -&gt; Handler m (b, HttpResponse EncJSON))
-&gt; a -&gt; Handler m (b, APIResp)
</span><a href="Hasura.Server.App.html#mkGQLAPIRespHandler"><span class="hs-identifier hs-var">mkGQLAPIRespHandler</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-985"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadBaseControl IO m, MonadGQLExecutionCheck m,
 MonadQueryLog m, MonadTrace m, MonadExecuteQuery m,
 MonadError QErr m, MonadReader HandlerCtx m,
 MonadMetadataStorage m, MonadQueryTags m, HasResourceLimits m,
 ProvidesNetwork m) =&gt;
ReqsText -&gt; m (HttpLogGraphQLInfo, HttpResponse EncJSON)
</span><a href="Hasura.Server.App.html#v1GQHandler"><span class="hs-identifier hs-var">v1GQHandler</span></a></span><span>
</span><span id="line-986"></span><span>
</span><span id="line-987"></span><span>    </span><span class="annot"><span class="annottext">forall (xs :: [*]) (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *)
       (ps :: PathState) ctx.
(HasRep xs, RouteM t, Monad m) =&gt;
Path xs ps -&gt; HVectElim xs (ActionCtxT ctx m ()) -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.post</span></span><span> </span><span class="annot"><span class="annottext">Path '[] 'Open
</span><span class="hs-string">&quot;v1beta1/relay&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-988"></span><span>      </span><span class="annot"><span class="annottext">forall a (n :: * -&gt; *).
(FromJSON a, MonadIO n, MonadBaseControl IO n,
 UserAuthentication (TraceT n), HttpLog n, HasReporter n,
 HasResourceLimits n) =&gt;
(Bool -&gt; QErr -&gt; Value)
-&gt; (QErr -&gt; QErr) -&gt; APIHandler (TraceT n) a -&gt; ActionT n ()
</span><a href="#local-6989586621690824690"><span class="hs-identifier hs-var">spockAction</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; QErr -&gt; Value
</span><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#encodeGQErr"><span class="hs-identifier hs-var">GH.encodeGQErr</span></a></span><span> </span><span class="annot"><span class="annottext">QErr -&gt; QErr
</span><a href="#local-6989586621690824682"><span class="hs-identifier hs-var">allMod200</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-989"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(ReqsText -&gt; Handler m (HttpLogGraphQLInfo, APIResp))
-&gt; APIHandler m ReqsText
</span><a href="Hasura.Server.App.html#mkGQLRequestHandler"><span class="hs-identifier hs-var">mkGQLRequestHandler</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-990"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b.
Functor m =&gt;
(a -&gt; Handler m (b, HttpResponse EncJSON))
-&gt; a -&gt; Handler m (b, APIResp)
</span><a href="Hasura.Server.App.html#mkGQLAPIRespHandler"><span class="hs-identifier hs-var">mkGQLAPIRespHandler</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-991"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadBaseControl IO m, MonadGQLExecutionCheck m,
 MonadQueryLog m, MonadTrace m, MonadExecuteQuery m,
 MonadError QErr m, MonadReader HandlerCtx m,
 MonadMetadataStorage m, MonadQueryTags m, HasResourceLimits m,
 ProvidesNetwork m) =&gt;
ReqsText -&gt; m (HttpLogGraphQLInfo, HttpResponse EncJSON)
</span><a href="Hasura.Server.App.html#v1GQRelayHandler"><span class="hs-identifier hs-var">v1GQRelayHandler</span></a></span><span>
</span><span id="line-992"></span><span>
</span><span id="line-993"></span><span>  </span><span class="hs-comment">-- This exposes some simple RTS stats when we run with `+RTS -T`. We want</span><span>
</span><span id="line-994"></span><span>  </span><span class="hs-comment">-- this to be available even when developer APIs are not compiled in, to</span><span>
</span><span id="line-995"></span><span>  </span><span class="hs-comment">-- support benchmarking.</span><span>
</span><span id="line-996"></span><span>  </span><span class="hs-comment">-- See: https://hackage.haskell.org/package/base/docs/GHC-Stats.html</span><span>
</span><span id="line-997"></span><span>  </span><span id="local-6989586621690824681"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690824681"><span class="hs-identifier hs-var">exposeRtsStats</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">IO Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">RTS.getRTSStatsEnabled</span></a></span><span>
</span><span id="line-998"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690824681"><span class="hs-identifier hs-var">exposeRtsStats</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-999"></span><span>    </span><span class="annot"><span class="annottext">forall (xs :: [*]) (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *)
       (ps :: PathState) ctx.
(HasRep xs, RouteM t, Monad m) =&gt;
Path xs ps -&gt; HVectElim xs (ActionCtxT ctx m ()) -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.get</span></span><span> </span><span class="annot"><span class="annottext">Path '[] 'Open
</span><span class="hs-string">&quot;dev/rts_stats&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1000"></span><span>      </span><span class="hs-comment">-- This ensures the live_bytes and other counters from GCDetails are fresh:</span><span>
</span><span id="line-1001"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">performMajorGC</span></a></span><span>
</span><span id="line-1002"></span><span>      </span><span id="local-6989586621690824679"><span class="annot"><span class="annottext">RTSStats
</span><a href="#local-6989586621690824679"><span class="hs-identifier hs-var">stats</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">IO RTSStats
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">RTS.getRTSStats</span></a></span><span>
</span><span id="line-1003"></span><span>      </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *) ctx b.
(ToJSON a, MonadIO m) =&gt;
a -&gt; ActionCtxT ctx m b
</span><span class="hs-identifier hs-var">Spock.json</span></span><span> </span><span class="annot"><span class="annottext">RTSStats
</span><a href="#local-6989586621690824679"><span class="hs-identifier hs-var">stats</span></a></span><span>
</span><span id="line-1004"></span><span>
</span><span id="line-1005"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppContext -&gt; Bool
</span><a href="Hasura.Server.App.html#isDeveloperAPIEnabled"><span class="hs-identifier hs-var">isDeveloperAPIEnabled</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621690824897"><span class="hs-identifier hs-var">appCtx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1006"></span><span>    </span><span class="annot"><span class="annottext">forall (xs :: [*]) (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *)
       (ps :: PathState) ctx.
(HasRep xs, RouteM t, Monad m) =&gt;
Path xs ps -&gt; HVectElim xs (ActionCtxT ctx m ()) -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.get</span></span><span> </span><span class="annot"><span class="annottext">Path '[] 'Open
</span><span class="hs-string">&quot;dev/ekg&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1007"></span><span>      </span><span class="annot"><span class="annottext">forall a (n :: * -&gt; *).
(FromJSON a, MonadIO n, MonadBaseControl IO n,
 UserAuthentication (TraceT n), HttpLog n, HasReporter n,
 HasResourceLimits n) =&gt;
(Bool -&gt; QErr -&gt; Value)
-&gt; (QErr -&gt; QErr) -&gt; APIHandler (TraceT n) a -&gt; ActionT n ()
</span><a href="#local-6989586621690824690"><span class="hs-identifier hs-var">spockAction</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; QErr -&gt; Value
</span><a href="Hasura.Base.Error.html#encodeQErr"><span class="hs-identifier hs-var">encodeQErr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1008"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
Handler m (HttpLogGraphQLInfo, APIResp) -&gt; APIHandler m ()
</span><a href="Hasura.Server.App.html#mkGetHandler"><span class="hs-identifier hs-var">mkGetHandler</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1009"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadError QErr m, MonadReader HandlerCtx m) =&gt;
m ()
</span><a href="Hasura.Server.App.html#onlyAdmin"><span class="hs-identifier hs-var">onlyAdmin</span></a></span><span>
</span><span id="line-1010"></span><span>          </span><span id="local-6989586621690824676"><span class="annot"><span class="annottext">Sample
</span><a href="#local-6989586621690824676"><span class="hs-identifier hs-var">respJ</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (metrics :: Symbol -&gt; MetricType -&gt; * -&gt; *).
Store metrics -&gt; IO Sample
</span><span class="hs-identifier hs-var">EKG.sampleAll</span></span><span> </span><span class="annot"><span class="annottext">Store EmptyMetrics
</span><a href="#local-6989586621690824846"><span class="hs-identifier hs-var">ekgStore</span></a></span><span>
</span><span id="line-1011"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HttpLogGraphQLInfo
</span><a href="Hasura.Server.Logging.html#emptyHttpLogGraphQLInfo"><span class="hs-identifier hs-var">emptyHttpLogGraphQLInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HttpResponse EncJSON -&gt; APIResp
</span><a href="Hasura.Server.App.html#JSONResp"><span class="hs-identifier hs-var">JSONResp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [Header] -&gt; HttpResponse a
</span><a href="Hasura.HTTP.html#HttpResponse"><span class="hs-identifier hs-var">HttpResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; EncJSON
</span><a href="Hasura.EncJSON.html#encJFromJValue"><span class="hs-identifier hs-var">encJFromJValue</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Sample -&gt; Value
</span><span class="hs-identifier hs-var">EKG.sampleToJson</span></span><span> </span><span class="annot"><span class="annottext">Sample
</span><a href="#local-6989586621690824676"><span class="hs-identifier hs-var">respJ</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1012"></span><span>    </span><span class="hs-comment">-- This deprecated endpoint used to show the query plan cache pre-PDV.</span><span>
</span><span id="line-1013"></span><span>    </span><span class="hs-comment">-- Eventually this endpoint can be removed.</span><span>
</span><span id="line-1014"></span><span>    </span><span class="annot"><span class="annottext">forall (xs :: [*]) (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *)
       (ps :: PathState) ctx.
(HasRep xs, RouteM t, Monad m) =&gt;
Path xs ps -&gt; HVectElim xs (ActionCtxT ctx m ()) -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.get</span></span><span> </span><span class="annot"><span class="annottext">Path '[] 'Open
</span><span class="hs-string">&quot;dev/plan_cache&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1015"></span><span>      </span><span class="annot"><span class="annottext">forall a (n :: * -&gt; *).
(FromJSON a, MonadIO n, MonadBaseControl IO n,
 UserAuthentication (TraceT n), HttpLog n, HasReporter n,
 HasResourceLimits n) =&gt;
(Bool -&gt; QErr -&gt; Value)
-&gt; (QErr -&gt; QErr) -&gt; APIHandler (TraceT n) a -&gt; ActionT n ()
</span><a href="#local-6989586621690824690"><span class="hs-identifier hs-var">spockAction</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; QErr -&gt; Value
</span><a href="Hasura.Base.Error.html#encodeQErr"><span class="hs-identifier hs-var">encodeQErr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1016"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
Handler m (HttpLogGraphQLInfo, APIResp) -&gt; APIHandler m ()
</span><a href="Hasura.Server.App.html#mkGetHandler"><span class="hs-identifier hs-var">mkGetHandler</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1017"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadError QErr m, MonadReader HandlerCtx m) =&gt;
m ()
</span><a href="Hasura.Server.App.html#onlyAdmin"><span class="hs-identifier hs-var">onlyAdmin</span></a></span><span>
</span><span id="line-1018"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HttpLogGraphQLInfo
</span><a href="Hasura.Server.Logging.html#emptyHttpLogGraphQLInfo"><span class="hs-identifier hs-var">emptyHttpLogGraphQLInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HttpResponse EncJSON -&gt; APIResp
</span><a href="Hasura.Server.App.html#JSONResp"><span class="hs-identifier hs-var">JSONResp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [Header] -&gt; HttpResponse a
</span><a href="Hasura.HTTP.html#HttpResponse"><span class="hs-identifier hs-var">HttpResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; EncJSON
</span><a href="Hasura.EncJSON.html#encJFromJValue"><span class="hs-identifier hs-var">encJFromJValue</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier hs-var">J.Null</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1019"></span><span>    </span><span class="annot"><span class="annottext">forall (xs :: [*]) (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *)
       (ps :: PathState) ctx.
(HasRep xs, RouteM t, Monad m) =&gt;
Path xs ps -&gt; HVectElim xs (ActionCtxT ctx m ()) -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.get</span></span><span> </span><span class="annot"><span class="annottext">Path '[] 'Open
</span><span class="hs-string">&quot;dev/subscriptions&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1020"></span><span>      </span><span class="annot"><span class="annottext">forall a (n :: * -&gt; *).
(FromJSON a, MonadIO n, MonadBaseControl IO n,
 UserAuthentication (TraceT n), HttpLog n, HasReporter n,
 HasResourceLimits n) =&gt;
(Bool -&gt; QErr -&gt; Value)
-&gt; (QErr -&gt; QErr) -&gt; APIHandler (TraceT n) a -&gt; ActionT n ()
</span><a href="#local-6989586621690824690"><span class="hs-identifier hs-var">spockAction</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; QErr -&gt; Value
</span><a href="Hasura.Base.Error.html#encodeQErr"><span class="hs-identifier hs-var">encodeQErr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1021"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
Handler m (HttpLogGraphQLInfo, APIResp) -&gt; APIHandler m ()
</span><a href="Hasura.Server.App.html#mkGetHandler"><span class="hs-identifier hs-var">mkGetHandler</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1022"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadError QErr m, MonadReader HandlerCtx m) =&gt;
m ()
</span><a href="Hasura.Server.App.html#onlyAdmin"><span class="hs-identifier hs-var">onlyAdmin</span></a></span><span>
</span><span id="line-1023"></span><span>          </span><span id="local-6989586621690824672"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621690824672"><span class="hs-identifier hs-var">respJ</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; StreamQueriesOptions
-&gt; StreamQueriesOptions
-&gt; SubscriptionsState
-&gt; IO Value
</span><a href="Hasura.GraphQL.Execute.Subscription.State.html#dumpSubscriptionsState"><span class="hs-identifier hs-var">ES.dumpSubscriptionsState</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">StreamQueriesOptions
</span><a href="#local-6989586621690824884"><span class="hs-identifier hs-var">acLiveQueryOptions</span></a></span><span> </span><span class="annot"><span class="annottext">StreamQueriesOptions
</span><a href="#local-6989586621690824883"><span class="hs-identifier hs-var">acStreamQueryOptions</span></a></span><span> </span><span class="annot"><span class="annottext">SubscriptionsState
</span><a href="#local-6989586621690824857"><span class="hs-identifier hs-var">appEnvSubscriptionState</span></a></span><span>
</span><span id="line-1024"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HttpLogGraphQLInfo
</span><a href="Hasura.Server.Logging.html#emptyHttpLogGraphQLInfo"><span class="hs-identifier hs-var">emptyHttpLogGraphQLInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HttpResponse EncJSON -&gt; APIResp
</span><a href="Hasura.Server.App.html#JSONResp"><span class="hs-identifier hs-var">JSONResp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [Header] -&gt; HttpResponse a
</span><a href="Hasura.HTTP.html#HttpResponse"><span class="hs-identifier hs-var">HttpResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; EncJSON
</span><a href="Hasura.EncJSON.html#encJFromJValue"><span class="hs-identifier hs-var">encJFromJValue</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621690824672"><span class="hs-identifier hs-var">respJ</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1025"></span><span>    </span><span class="annot"><span class="annottext">forall (xs :: [*]) (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *)
       (ps :: PathState) ctx.
(HasRep xs, RouteM t, Monad m) =&gt;
Path xs ps -&gt; HVectElim xs (ActionCtxT ctx m ()) -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.get</span></span><span> </span><span class="annot"><span class="annottext">Path '[] 'Open
</span><span class="hs-string">&quot;dev/subscriptions/extended&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1026"></span><span>      </span><span class="annot"><span class="annottext">forall a (n :: * -&gt; *).
(FromJSON a, MonadIO n, MonadBaseControl IO n,
 UserAuthentication (TraceT n), HttpLog n, HasReporter n,
 HasResourceLimits n) =&gt;
(Bool -&gt; QErr -&gt; Value)
-&gt; (QErr -&gt; QErr) -&gt; APIHandler (TraceT n) a -&gt; ActionT n ()
</span><a href="#local-6989586621690824690"><span class="hs-identifier hs-var">spockAction</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; QErr -&gt; Value
</span><a href="Hasura.Base.Error.html#encodeQErr"><span class="hs-identifier hs-var">encodeQErr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1027"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
Handler m (HttpLogGraphQLInfo, APIResp) -&gt; APIHandler m ()
</span><a href="Hasura.Server.App.html#mkGetHandler"><span class="hs-identifier hs-var">mkGetHandler</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1028"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadError QErr m, MonadReader HandlerCtx m) =&gt;
m ()
</span><a href="Hasura.Server.App.html#onlyAdmin"><span class="hs-identifier hs-var">onlyAdmin</span></a></span><span>
</span><span id="line-1029"></span><span>          </span><span id="local-6989586621690824670"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621690824670"><span class="hs-identifier hs-var">respJ</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; StreamQueriesOptions
-&gt; StreamQueriesOptions
-&gt; SubscriptionsState
-&gt; IO Value
</span><a href="Hasura.GraphQL.Execute.Subscription.State.html#dumpSubscriptionsState"><span class="hs-identifier hs-var">ES.dumpSubscriptionsState</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">StreamQueriesOptions
</span><a href="#local-6989586621690824884"><span class="hs-identifier hs-var">acLiveQueryOptions</span></a></span><span> </span><span class="annot"><span class="annottext">StreamQueriesOptions
</span><a href="#local-6989586621690824883"><span class="hs-identifier hs-var">acStreamQueryOptions</span></a></span><span> </span><span class="annot"><span class="annottext">SubscriptionsState
</span><a href="#local-6989586621690824857"><span class="hs-identifier hs-var">appEnvSubscriptionState</span></a></span><span>
</span><span id="line-1030"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HttpLogGraphQLInfo
</span><a href="Hasura.Server.Logging.html#emptyHttpLogGraphQLInfo"><span class="hs-identifier hs-var">emptyHttpLogGraphQLInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HttpResponse EncJSON -&gt; APIResp
</span><a href="Hasura.Server.App.html#JSONResp"><span class="hs-identifier hs-var">JSONResp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [Header] -&gt; HttpResponse a
</span><a href="Hasura.HTTP.html#HttpResponse"><span class="hs-identifier hs-var">HttpResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; EncJSON
</span><a href="Hasura.EncJSON.html#encJFromJValue"><span class="hs-identifier hs-var">encJFromJValue</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621690824670"><span class="hs-identifier hs-var">respJ</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1031"></span><span>    </span><span class="annot"><span class="annottext">forall (xs :: [*]) (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *)
       (ps :: PathState) ctx.
(HasRep xs, RouteM t, Monad m) =&gt;
Path xs ps -&gt; HVectElim xs (ActionCtxT ctx m ()) -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.get</span></span><span> </span><span class="annot"><span class="annottext">Path '[] 'Open
</span><span class="hs-string">&quot;dev/dataconnector/schema&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1032"></span><span>      </span><span class="annot"><span class="annottext">forall a (n :: * -&gt; *).
(FromJSON a, MonadIO n, MonadBaseControl IO n,
 UserAuthentication (TraceT n), HttpLog n, HasReporter n,
 HasResourceLimits n) =&gt;
(Bool -&gt; QErr -&gt; Value)
-&gt; (QErr -&gt; QErr) -&gt; APIHandler (TraceT n) a -&gt; ActionT n ()
</span><a href="#local-6989586621690824690"><span class="hs-identifier hs-var">spockAction</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; QErr -&gt; Value
</span><a href="Hasura.Base.Error.html#encodeQErr"><span class="hs-identifier hs-var">encodeQErr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1033"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
Handler m (HttpLogGraphQLInfo, APIResp) -&gt; APIHandler m ()
</span><a href="Hasura.Server.App.html#mkGetHandler"><span class="hs-identifier hs-var">mkGetHandler</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1034"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadError QErr m, MonadReader HandlerCtx m) =&gt;
m ()
</span><a href="Hasura.Server.App.html#onlyAdmin"><span class="hs-identifier hs-var">onlyAdmin</span></a></span><span>
</span><span id="line-1035"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HttpLogGraphQLInfo
</span><a href="Hasura.Server.Logging.html#emptyHttpLogGraphQLInfo"><span class="hs-identifier hs-var">emptyHttpLogGraphQLInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HttpResponse EncJSON -&gt; APIResp
</span><a href="Hasura.Server.App.html#JSONResp"><span class="hs-identifier hs-var">JSONResp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [Header] -&gt; HttpResponse a
</span><a href="Hasura.HTTP.html#HttpResponse"><span class="hs-identifier hs-var">HttpResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; EncJSON
</span><a href="Hasura.EncJSON.html#encJFromJValue"><span class="hs-identifier hs-var">encJFromJValue</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.5/dc-api-1.0.0/opt/doc/html/dc-api/src"><span class="hs-identifier hs-var">openApiSchema</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1036"></span><span>  </span><span class="annot"><span class="annottext">forall (xs :: [*]) (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *)
       (ps :: PathState) ctx.
(HasRep xs, RouteM t, Monad m) =&gt;
Path xs ps -&gt; HVectElim xs (ActionCtxT ctx m ()) -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.get</span></span><span> </span><span class="annot"><span class="annottext">Path '[] 'Open
</span><span class="hs-string">&quot;api/swagger/json&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1037"></span><span>    </span><span class="annot"><span class="annottext">forall a (n :: * -&gt; *).
(FromJSON a, MonadIO n, MonadBaseControl IO n,
 UserAuthentication (TraceT n), HttpLog n, HasReporter n,
 HasResourceLimits n) =&gt;
(Bool -&gt; QErr -&gt; Value)
-&gt; (QErr -&gt; QErr) -&gt; APIHandler (TraceT n) a -&gt; ActionT n ()
</span><a href="#local-6989586621690824690"><span class="hs-identifier hs-var">spockAction</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; QErr -&gt; Value
</span><a href="Hasura.Base.Error.html#encodeQErr"><span class="hs-identifier hs-var">encodeQErr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1038"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
Handler m (HttpLogGraphQLInfo, APIResp) -&gt; APIHandler m ()
</span><a href="Hasura.Server.App.html#mkGetHandler"><span class="hs-identifier hs-var">mkGetHandler</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1039"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadError QErr m, MonadReader HandlerCtx m) =&gt;
m ()
</span><a href="Hasura.Server.App.html#onlyAdmin"><span class="hs-identifier hs-var">onlyAdmin</span></a></span><span>
</span><span id="line-1040"></span><span>        </span><span id="local-6989586621690824669"><span class="annot"><span class="annottext">SchemaCache
</span><a href="#local-6989586621690824669"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCacheRef -&gt; IO SchemaCache
</span><a href="Hasura.Server.SchemaCacheRef.html#getSchemaCache"><span class="hs-identifier hs-var">getSchemaCache</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCacheRef
</span><a href="#local-6989586621690824896"><span class="hs-identifier hs-var">acCacheRef</span></a></span><span>
</span><span id="line-1041"></span><span>        </span><span id="local-6989586621690824668"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621690824668"><span class="hs-identifier hs-var">json</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadError QErr m, MonadFix m) =&gt;
SchemaCache -&gt; m OpenApi
</span><a href="Hasura.Server.OpenAPI.html#buildOpenAPI"><span class="hs-identifier hs-var">buildOpenAPI</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCache
</span><a href="#local-6989586621690824669"><span class="hs-identifier hs-var">sc</span></a></span><span>
</span><span id="line-1042"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HttpLogGraphQLInfo
</span><a href="Hasura.Server.Logging.html#emptyHttpLogGraphQLInfo"><span class="hs-identifier hs-var">emptyHttpLogGraphQLInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HttpResponse EncJSON -&gt; APIResp
</span><a href="Hasura.Server.App.html#JSONResp"><span class="hs-identifier hs-var">JSONResp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [Header] -&gt; HttpResponse a
</span><a href="Hasura.HTTP.html#HttpResponse"><span class="hs-identifier hs-var">HttpResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; EncJSON
</span><a href="Hasura.EncJSON.html#encJFromJValue"><span class="hs-identifier hs-var">encJFromJValue</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621690824668"><span class="hs-identifier hs-var">json</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1043"></span><span>
</span><span id="line-1044"></span><span>  </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">StdMethod
</span><span class="hs-identifier hs-var">Spock.GET</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StdMethod
</span><span class="hs-identifier hs-var">Spock.POST</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621690824666"><span class="annot"><span class="annottext">StdMethod
</span><a href="#local-6989586621690824666"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) ctx.
(RouteM t, Monad m) =&gt;
StdMethod -&gt; ([Text] -&gt; ActionCtxT ctx m ()) -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.hookAny</span></span><span> </span><span class="annot"><span class="annottext">StdMethod
</span><a href="#local-6989586621690824666"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1045"></span><span>    </span><span id="local-6989586621690824664"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690824664"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx. MonadIO m =&gt; ActionCtxT ctx m Request
</span><span class="hs-identifier hs-var">Spock.request</span></span><span>
</span><span id="line-1046"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690824663"><span class="annot"><span class="annottext">headers :: [Header]
</span><a href="#local-6989586621690824663"><span class="hs-identifier hs-var hs-var">headers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; [Header]
</span><span class="hs-identifier hs-var">Wai.requestHeaders</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690824664"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-1047"></span><span>        </span><span id="local-6989586621690824661"><span class="annot"><span class="annottext">qErr :: QErr
</span><a href="#local-6989586621690824661"><span class="hs-identifier hs-var hs-var">qErr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; QErr
</span><a href="Hasura.Base.Error.html#err404"><span class="hs-identifier hs-var">err404</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotFound"><span class="hs-identifier hs-var">NotFound</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;resource does not exist&quot;</span></span><span>
</span><span id="line-1048"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, HttpLog m) =&gt;
Logger Hasura
-&gt; LoggingSettings -&gt; [Header] -&gt; QErr -&gt; ActionT m ()
</span><a href="Hasura.Server.App.html#raiseGenericApiError"><span class="hs-identifier hs-var">raiseGenericApiError</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621690824660"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">LoggingSettings
</span><a href="#local-6989586621690824865"><span class="hs-identifier hs-var">appEnvLoggingSettings</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690824663"><span class="hs-identifier hs-var">headers</span></a></span><span> </span><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621690824661"><span class="hs-identifier hs-var">qErr</span></a></span><span>
</span><span id="line-1049"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1050"></span><span>    </span><span id="local-6989586621690824660"><span class="annot"><span class="annottext">logger :: Logger Hasura
</span><a href="#local-6989586621690824660"><span class="hs-identifier hs-var hs-var">logger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Loggers -&gt; Logger Hasura
</span><a href="Hasura.App.State.html#_lsLogger"><span class="hs-identifier hs-var">_lsLogger</span></a></span><span> </span><span class="annot"><span class="annottext">Loggers
</span><a href="#local-6989586621690824869"><span class="hs-identifier hs-var">appEnvLoggers</span></a></span><span>
</span><span id="line-1051"></span><span>
</span><span id="line-1052"></span><span>    </span><span id="local-6989586621690824814"><span class="annot"><span class="annottext">logSuccess :: Text -&gt; ActionCtxT () m ()
</span><a href="#local-6989586621690824814"><span class="hs-identifier hs-var hs-var">logSuccess</span></a></span></span><span> </span><span id="local-6989586621690824659"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690824659"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1053"></span><span>      </span><span id="local-6989586621690824658"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690824658"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx. MonadIO m =&gt; ActionCtxT ctx m Request
</span><span class="hs-identifier hs-var">Spock.request</span></span><span>
</span><span id="line-1054"></span><span>      </span><span id="local-6989586621690824657"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690824657"><span class="hs-identifier hs-var">reqBody</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; IO ByteString
</span><span class="hs-identifier hs-var">Wai.strictRequestBody</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690824658"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-1055"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690824656"><span class="annot"><span class="annottext">headers :: [Header]
</span><a href="#local-6989586621690824656"><span class="hs-identifier hs-var hs-var">headers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; [Header]
</span><span class="hs-identifier hs-var">Wai.requestHeaders</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690824658"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-1056"></span><span>          </span><span id="local-6989586621690824655"><span class="annot"><span class="annottext">blMsg :: ByteString
</span><a href="#local-6989586621690824655"><span class="hs-identifier hs-var hs-var">blMsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">TL.encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690824659"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-1057"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621690824653"><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621690824653"><span class="hs-identifier hs-var">reqId</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690824652"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690824652"><span class="hs-identifier hs-var">_newHeaders</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadIO m =&gt;
[Header] -&gt; m (RequestId, [Header])
</span><a href="Hasura.Server.Types.html#getRequestId"><span class="hs-identifier hs-var">getRequestId</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690824656"><span class="hs-identifier hs-var">headers</span></a></span><span>
</span><span id="line-1058"></span><span>      </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1059"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
HttpLog m =&gt;
Logger Hasura
-&gt; LoggingSettings
-&gt; Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; ByteString
-&gt; ByteString
-&gt; Maybe (DiffTime, DiffTime)
-&gt; EncodingType
-&gt; [Header]
-&gt; HttpLogMetadata m
-&gt; m ()
</span><a href="Hasura.Server.Logging.html#logHttpSuccess"><span class="hs-identifier hs-var">logHttpSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621690824660"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">LoggingSettings
</span><a href="#local-6989586621690824865"><span class="hs-identifier hs-var">appEnvLoggingSettings</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621690824653"><span class="hs-identifier hs-var">reqId</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690824658"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690824657"><span class="hs-identifier hs-var">reqBody</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690824655"><span class="hs-identifier hs-var">blMsg</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690824655"><span class="hs-identifier hs-var">blMsg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690824656"><span class="hs-identifier hs-var">headers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). HttpLog m =&gt; HttpLogMetadata m
</span><a href="Hasura.Server.Logging.html#emptyHttpLogMetadata"><span class="hs-identifier hs-var">emptyHttpLogMetadata</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621690827726"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1060"></span><span>
</span><span id="line-1061"></span><span>    </span><span id="local-6989586621690824829"><span class="annot"><span class="annottext">logError :: QErr -&gt; ActionCtxT () m ()
</span><a href="#local-6989586621690824829"><span class="hs-identifier hs-var hs-var">logError</span></a></span></span><span> </span><span id="local-6989586621690824650"><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621690824650"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1062"></span><span>      </span><span id="local-6989586621690824649"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690824649"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx. MonadIO m =&gt; ActionCtxT ctx m Request
</span><span class="hs-identifier hs-var">Spock.request</span></span><span>
</span><span id="line-1063"></span><span>      </span><span id="local-6989586621690824648"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690824648"><span class="hs-identifier hs-var">reqBody</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; IO ByteString
</span><span class="hs-identifier hs-var">Wai.strictRequestBody</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690824649"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-1064"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690824647"><span class="annot"><span class="annottext">headers :: [Header]
</span><a href="#local-6989586621690824647"><span class="hs-identifier hs-var hs-var">headers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; [Header]
</span><span class="hs-identifier hs-var">Wai.requestHeaders</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690824649"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-1065"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621690824646"><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621690824646"><span class="hs-identifier hs-var">reqId</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690824645"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690824645"><span class="hs-identifier hs-var">_newHeaders</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadIO m =&gt;
[Header] -&gt; m (RequestId, [Header])
</span><a href="Hasura.Server.Types.html#getRequestId"><span class="hs-identifier hs-var">getRequestId</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690824647"><span class="hs-identifier hs-var">headers</span></a></span><span>
</span><span id="line-1066"></span><span>      </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1067"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
HttpLog m =&gt;
Logger Hasura
-&gt; LoggingSettings
-&gt; Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; QErr
-&gt; [Header]
-&gt; HttpLogMetadata m
-&gt; m ()
</span><a href="Hasura.Server.Logging.html#logHttpError"><span class="hs-identifier hs-var">logHttpError</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621690824660"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">LoggingSettings
</span><a href="#local-6989586621690824865"><span class="hs-identifier hs-var">appEnvLoggingSettings</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621690824646"><span class="hs-identifier hs-var">reqId</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690824649"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690824648"><span class="hs-identifier hs-var">reqBody</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621690824650"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690824647"><span class="hs-identifier hs-var">headers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). HttpLog m =&gt; HttpLogMetadata m
</span><a href="Hasura.Server.Logging.html#emptyHttpLogMetadata"><span class="hs-identifier hs-var">emptyHttpLogMetadata</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621690827726"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1068"></span><span>
</span><span id="line-1069"></span><span>    </span><span class="annot"><a href="#local-6989586621690824690"><span class="hs-identifier hs-type">spockAction</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1070"></span><span>      </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621690827631"><span class="annot"><a href="#local-6989586621690827631"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621690827630"><span class="annot"><a href="#local-6989586621690827630"><span class="hs-identifier hs-type">n</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-1071"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621690827631"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1072"></span><span>        </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827630"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1073"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">MonadBaseControl</span></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827630"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1074"></span><span>        </span><span class="annot"><a href="Hasura.Server.Auth.html#UserAuthentication"><span class="hs-identifier hs-type">UserAuthentication</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Tracing.html#TraceT"><span class="hs-identifier hs-type">Tracing.TraceT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827630"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1075"></span><span>        </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLog"><span class="hs-identifier hs-type">HttpLog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827630"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1076"></span><span>        </span><span class="annot"><a href="Hasura.Tracing.html#HasReporter"><span class="hs-identifier hs-type">Tracing.HasReporter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827630"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1077"></span><span>        </span><span class="annot"><a href="Hasura.Server.Limits.html#HasResourceLimits"><span class="hs-identifier hs-type">HasResourceLimits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827630"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-1078"></span><span>      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1079"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1080"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1081"></span><span>      </span><span class="annot"><a href="Hasura.Server.App.html#APIHandler"><span class="hs-identifier hs-type">APIHandler</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Tracing.html#TraceT"><span class="hs-identifier hs-type">Tracing.TraceT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827630"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621690827631"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1082"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Spock.ActionT</span></span><span> </span><span class="annot"><a href="#local-6989586621690827630"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1083"></span><span>    </span><span id="local-6989586621690824690"><span class="annot"><span class="annottext">spockAction :: forall a (n :: * -&gt; *).
(FromJSON a, MonadIO n, MonadBaseControl IO n,
 UserAuthentication (TraceT n), HttpLog n, HasReporter n,
 HasResourceLimits n) =&gt;
(Bool -&gt; QErr -&gt; Value)
-&gt; (QErr -&gt; QErr) -&gt; APIHandler (TraceT n) a -&gt; ActionT n ()
</span><a href="#local-6989586621690824690"><span class="hs-identifier hs-var hs-var">spockAction</span></a></span></span><span> </span><span id="local-6989586621690824630"><span class="annot"><span class="annottext">Bool -&gt; QErr -&gt; Value
</span><a href="#local-6989586621690824630"><span class="hs-identifier hs-var">qErrEncoder</span></a></span></span><span> </span><span id="local-6989586621690824629"><span class="annot"><span class="annottext">QErr -&gt; QErr
</span><a href="#local-6989586621690824629"><span class="hs-identifier hs-var">qErrModifier</span></a></span></span><span> </span><span id="local-6989586621690824628"><span class="annot"><span class="annottext">APIHandler (TraceT n) a
</span><a href="#local-6989586621690824628"><span class="hs-identifier hs-var">apiHandler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadIO m, MonadBaseControl IO m, FromJSON a,
 UserAuthentication (TraceT m), HttpLog m, HasReporter m,
 HasResourceLimits m) =&gt;
AppContext
-&gt; AppEnv
-&gt; (Bool -&gt; QErr -&gt; Value)
-&gt; (QErr -&gt; QErr)
-&gt; APIHandler (TraceT m) a
-&gt; ActionT m ()
</span><a href="Hasura.Server.App.html#mkSpockAction"><span class="hs-identifier hs-var">mkSpockAction</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621690824897"><span class="hs-identifier hs-var">appCtx</span></a></span><span> </span><span class="annot"><span class="annottext">AppEnv
</span><a href="#local-6989586621690824874"><span class="hs-identifier hs-var">appEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; QErr -&gt; Value
</span><a href="#local-6989586621690824630"><span class="hs-identifier hs-var">qErrEncoder</span></a></span><span> </span><span class="annot"><span class="annottext">QErr -&gt; QErr
</span><a href="#local-6989586621690824629"><span class="hs-identifier hs-var">qErrModifier</span></a></span><span> </span><span class="annot"><span class="annottext">APIHandler (TraceT n) a
</span><a href="#local-6989586621690824628"><span class="hs-identifier hs-var">apiHandler</span></a></span><span>
</span><span id="line-1084"></span><span>
</span><span id="line-1085"></span><span>    </span><span class="hs-comment">-- all graphql errors should be of type 200</span><span>
</span><span id="line-1086"></span><span>    </span><span id="local-6989586621690824682"><span class="annot"><span class="annottext">allMod200 :: QErr -&gt; QErr
</span><a href="#local-6989586621690824682"><span class="hs-identifier hs-var hs-var">allMod200</span></a></span></span><span> </span><span id="local-6989586621690824627"><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621690824627"><span class="hs-identifier hs-var">qe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621690824627"><span class="hs-identifier hs-var">qe</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">qeStatus :: Status
</span><a href="Hasura.Base.Error.html#qeStatus"><span class="hs-identifier hs-var">qeStatus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">HTTP.status200</span></span><span class="hs-special">}</span><span>
</span><span id="line-1087"></span><span>    </span><span id="local-6989586621690824687"><span class="annot"><span class="annottext">gqlExplainAction :: ActionCtxT () m ()
</span><a href="#local-6989586621690824687"><span class="hs-identifier hs-var hs-var">gqlExplainAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1088"></span><span>      </span><span class="annot"><span class="annottext">forall a (n :: * -&gt; *).
(FromJSON a, MonadIO n, MonadBaseControl IO n,
 UserAuthentication (TraceT n), HttpLog n, HasReporter n,
 HasResourceLimits n) =&gt;
(Bool -&gt; QErr -&gt; Value)
-&gt; (QErr -&gt; QErr) -&gt; APIHandler (TraceT n) a -&gt; ActionT n ()
</span><a href="#local-6989586621690824690"><span class="hs-identifier hs-var">spockAction</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; QErr -&gt; Value
</span><a href="Hasura.Base.Error.html#encodeQErr"><span class="hs-identifier hs-var">encodeQErr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1089"></span><span>        </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(a -&gt; Handler m (HttpLogGraphQLInfo, APIResp)) -&gt; APIHandler m a
</span><a href="Hasura.Server.App.html#mkPostHandler"><span class="hs-identifier hs-var">mkPostHandler</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1090"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HttpLogGraphQLInfo
</span><a href="Hasura.Server.Logging.html#emptyHttpLogGraphQLInfo"><span class="hs-identifier hs-var">emptyHttpLogGraphQLInfo</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
Functor m =&gt;
(a -&gt; Handler m (HttpResponse EncJSON)) -&gt; a -&gt; Handler m APIResp
</span><a href="Hasura.Server.App.html#mkAPIRespHandler"><span class="hs-identifier hs-var">mkAPIRespHandler</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadBaseControl IO m, MonadError QErr m,
 MonadReader HandlerCtx m, MonadMetadataStorage m, MonadQueryTags m,
 MonadTrace m) =&gt;
GQLExplain -&gt; m (HttpResponse EncJSON)
</span><a href="Hasura.Server.App.html#gqlExplainHandler"><span class="hs-identifier hs-var">gqlExplainHandler</span></a></span><span>
</span><span id="line-1091"></span><span>    </span><span id="local-6989586621690824684"><span class="annot"><span class="annottext">enableGraphQL :: Bool
</span><a href="#local-6989586621690824684"><span class="hs-identifier hs-var hs-var">enableGraphQL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AppContext -&gt; Bool
</span><a href="Hasura.Server.App.html#isGraphQLEnabled"><span class="hs-identifier hs-var">isGraphQLEnabled</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621690824897"><span class="hs-identifier hs-var">appCtx</span></a></span><span>
</span><span id="line-1092"></span><span>    </span><span id="local-6989586621690824840"><span class="annot"><span class="annottext">enableMetadata :: Bool
</span><a href="#local-6989586621690824840"><span class="hs-identifier hs-var hs-var">enableMetadata</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AppContext -&gt; Bool
</span><a href="Hasura.Server.App.html#isMetadataEnabled"><span class="hs-identifier hs-var">isMetadataEnabled</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621690824897"><span class="hs-identifier hs-var">appCtx</span></a></span><span>
</span><span id="line-1093"></span><span>    </span><span id="local-6989586621690824686"><span class="annot"><span class="annottext">enablePGDump :: Bool
</span><a href="#local-6989586621690824686"><span class="hs-identifier hs-var hs-var">enablePGDump</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AppContext -&gt; Bool
</span><a href="Hasura.Server.App.html#isPGDumpEnabled"><span class="hs-identifier hs-var">isPGDumpEnabled</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621690824897"><span class="hs-identifier hs-var">appCtx</span></a></span><span>
</span><span id="line-1094"></span><span>    </span><span id="local-6989586621690824685"><span class="annot"><span class="annottext">enableConfig :: Bool
</span><a href="#local-6989586621690824685"><span class="hs-identifier hs-var hs-var">enableConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AppContext -&gt; Bool
</span><a href="Hasura.Server.App.html#isConfigEnabled"><span class="hs-identifier hs-var">isConfigEnabled</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621690824897"><span class="hs-identifier hs-var">appCtx</span></a></span><span>
</span><span id="line-1095"></span><span>
</span><span id="line-1096"></span><span>    </span><span id="local-6989586621690824839"><span class="annot"><span class="annottext">serveApiConsole :: SpockT m ()
</span><a href="#local-6989586621690824839"><span class="hs-identifier hs-var hs-var">serveApiConsole</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1097"></span><span>      </span><span class="hs-comment">-- redirect / to /console</span><span>
</span><span id="line-1098"></span><span>      </span><span class="annot"><span class="annottext">forall (xs :: [*]) (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *)
       (ps :: PathState) ctx.
(HasRep xs, RouteM t, Monad m) =&gt;
Path xs ps -&gt; HVectElim xs (ActionCtxT ctx m ()) -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.get</span></span><span> </span><span class="annot"><span class="annottext">Path '[] 'Open
</span><span class="hs-identifier hs-var">Spock.root</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx a. MonadIO m =&gt; Text -&gt; ActionCtxT ctx m a
</span><span class="hs-identifier hs-var">Spock.redirect</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;console&quot;</span></span><span>
</span><span id="line-1099"></span><span>
</span><span id="line-1100"></span><span>      </span><span class="hs-comment">-- serve console html</span><span>
</span><span id="line-1101"></span><span>      </span><span class="annot"><span class="annottext">forall (xs :: [*]) (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *)
       (ps :: PathState) ctx.
(HasRep xs, RouteM t, Monad m) =&gt;
Path xs ps -&gt; HVectElim xs (ActionCtxT ctx m ()) -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.get</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path '[] 'Open
</span><span class="hs-string">&quot;console&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (as :: [*]) (bs :: [*]) (ps :: PathState).
Path as 'Open -&gt; Path bs ps -&gt; Path (Append as bs) ps
</span><span class="hs-operator hs-var">&lt;//&gt;</span></span><span> </span><span class="annot"><span class="annottext">Path '[Text] 'Closed
</span><span class="hs-identifier hs-var">Spock.wildcard</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621690824595"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690824595"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1102"></span><span>        </span><span id="local-6989586621690824594"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690824594"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx. MonadIO m =&gt; ActionCtxT ctx m Request
</span><span class="hs-identifier hs-var">Spock.request</span></span><span>
</span><span id="line-1103"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690824593"><span class="annot"><span class="annottext">headers :: [Header]
</span><a href="#local-6989586621690824593"><span class="hs-identifier hs-var hs-var">headers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; [Header]
</span><span class="hs-identifier hs-var">Wai.requestHeaders</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690824594"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-1104"></span><span>        </span><span id="local-6989586621690824592"><span class="annot"><span class="annottext">Either [Char] Text
</span><a href="#local-6989586621690824592"><span class="hs-identifier hs-var">consoleHtml</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ConsoleRenderer m =&gt;
Text
-&gt; AuthMode
-&gt; TelemetryStatus
-&gt; Maybe Text
-&gt; Maybe Text
-&gt; m (Either [Char] Text)
</span><a href="Hasura.Server.App.html#renderConsole"><span class="hs-identifier hs-var">renderConsole</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690824595"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">AuthMode
</span><a href="#local-6989586621690824895"><span class="hs-identifier hs-var">acAuthMode</span></a></span><span> </span><span class="annot"><span class="annottext">TelemetryStatus
</span><a href="#local-6989586621690824880"><span class="hs-identifier hs-var">acEnableTelemetry</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690824853"><span class="hs-identifier hs-var">appEnvConsoleAssetsDir</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690824852"><span class="hs-identifier hs-var">appEnvConsoleSentryDsn</span></a></span><span>
</span><span id="line-1105"></span><span>        </span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, HttpLog m) =&gt;
Logger Hasura
-&gt; LoggingSettings -&gt; [Header] -&gt; QErr -&gt; ActionT m ()
</span><a href="Hasura.Server.App.html#raiseGenericApiError"><span class="hs-identifier hs-var">raiseGenericApiError</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621690824660"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">LoggingSettings
</span><a href="#local-6989586621690824865"><span class="hs-identifier hs-var">appEnvLoggingSettings</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690824593"><span class="hs-identifier hs-var">headers</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; QErr
</span><a href="Hasura.Base.Error.html#internalError"><span class="hs-identifier hs-var">internalError</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx a. MonadIO m =&gt; Text -&gt; ActionCtxT ctx m a
</span><span class="hs-identifier hs-var">Spock.html</span></span><span> </span><span class="annot"><span class="annottext">Either [Char] Text
</span><a href="#local-6989586621690824592"><span class="hs-identifier hs-var">consoleHtml</span></a></span><span>
</span><span id="line-1106"></span><span>
</span><span id="line-1107"></span><span>    </span><span id="local-6989586621690824838"><span class="annot"><span class="annottext">serveApiConsoleAssets :: SpockT m ()
</span><a href="#local-6989586621690824838"><span class="hs-identifier hs-var hs-var">serveApiConsoleAssets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1108"></span><span>      </span><span class="hs-comment">-- serve static files if consoleAssetsDir is set</span><span>
</span><span id="line-1109"></span><span>      </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">for_</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621690824853"><span class="hs-identifier hs-var">appEnvConsoleAssetsDir</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621690824588"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690824588"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1110"></span><span>        </span><span class="annot"><span class="annottext">forall (xs :: [*]) (t :: * -&gt; (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *)
       (ps :: PathState) ctx.
(HasRep xs, RouteM t, Monad m) =&gt;
Path xs ps -&gt; HVectElim xs (ActionCtxT ctx m ()) -&gt; t ctx m ()
</span><span class="hs-identifier hs-var">Spock.get</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path '[] 'Open
</span><span class="hs-string">&quot;console/assets&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (as :: [*]) (bs :: [*]) (ps :: PathState).
Path as 'Open -&gt; Path bs ps -&gt; Path (Append as bs) ps
</span><span class="hs-operator hs-var">&lt;//&gt;</span></span><span> </span><span class="annot"><span class="annottext">Path '[Text] 'Closed
</span><span class="hs-identifier hs-var">Spock.wildcard</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621690824587"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690824587"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1111"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, HttpLog m) =&gt;
Logger Hasura -&gt; LoggingSettings -&gt; Text -&gt; [Char] -&gt; ActionT m ()
</span><a href="Hasura.Server.App.html#consoleAssetsHandler"><span class="hs-identifier hs-var">consoleAssetsHandler</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621690824660"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">LoggingSettings
</span><a href="#local-6989586621690824865"><span class="hs-identifier hs-var">appEnvLoggingSettings</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690824588"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690824587"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1112"></span><span>
</span><span id="line-1113"></span><span class="annot"><a href="Hasura.Server.App.html#raiseGenericApiError"><span class="hs-identifier hs-type">raiseGenericApiError</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1114"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621690827789"><span class="annot"><a href="#local-6989586621690827789"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-1115"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827789"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLog"><span class="hs-identifier hs-type">HttpLog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690827789"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1116"></span><span>  </span><span class="annot"><a href="Hasura.Logging.html#Logger"><span class="hs-identifier hs-type">L.Logger</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">L.Hasura</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1117"></span><span>  </span><span class="annot"><a href="Hasura.Server.Logging.html#LoggingSettings"><span class="hs-identifier hs-type">LoggingSettings</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1118"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">HTTP.Header</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1119"></span><span>  </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1120"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Spock.ActionT</span></span><span> </span><span class="annot"><a href="#local-6989586621690827789"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1121"></span><span id="raiseGenericApiError"><span class="annot"><span class="annottext">raiseGenericApiError :: forall (m :: * -&gt; *).
(MonadIO m, HttpLog m) =&gt;
Logger Hasura
-&gt; LoggingSettings -&gt; [Header] -&gt; QErr -&gt; ActionT m ()
</span><a href="Hasura.Server.App.html#raiseGenericApiError"><span class="hs-identifier hs-var hs-var">raiseGenericApiError</span></a></span></span><span> </span><span id="local-6989586621690824565"><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621690824565"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621690824564"><span class="annot"><span class="annottext">LoggingSettings
</span><a href="#local-6989586621690824564"><span class="hs-identifier hs-var">loggingSetting</span></a></span></span><span> </span><span id="local-6989586621690824563"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690824563"><span class="hs-identifier hs-var">headers</span></a></span></span><span> </span><span id="local-6989586621690824562"><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621690824562"><span class="hs-identifier hs-var">qErr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1122"></span><span>  </span><span id="local-6989586621690824561"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690824561"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx. MonadIO m =&gt; ActionCtxT ctx m Request
</span><span class="hs-identifier hs-var">Spock.request</span></span><span>
</span><span id="line-1123"></span><span>  </span><span id="local-6989586621690824560"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690824560"><span class="hs-identifier hs-var">reqBody</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; IO ByteString
</span><span class="hs-identifier hs-var">Wai.strictRequestBody</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690824561"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-1124"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621690824559"><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621690824559"><span class="hs-identifier hs-var">reqId</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690824558"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690824558"><span class="hs-identifier hs-var">_newHeaders</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadIO m =&gt;
[Header] -&gt; m (RequestId, [Header])
</span><a href="Hasura.Server.Types.html#getRequestId"><span class="hs-identifier hs-var">getRequestId</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; [Header]
</span><span class="hs-identifier hs-var">Wai.requestHeaders</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690824561"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-1125"></span><span>  </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
HttpLog m =&gt;
Logger Hasura
-&gt; LoggingSettings
-&gt; Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; QErr
-&gt; [Header]
-&gt; HttpLogMetadata m
-&gt; m ()
</span><a href="Hasura.Server.Logging.html#logHttpError"><span class="hs-identifier hs-var">logHttpError</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621690824565"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">LoggingSettings
</span><a href="#local-6989586621690824564"><span class="hs-identifier hs-var">loggingSetting</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621690824559"><span class="hs-identifier hs-var">reqId</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621690824561"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621690824560"><span class="hs-identifier hs-var">reqBody</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621690824562"><span class="hs-identifier hs-var">qErr</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621690824563"><span class="hs-identifier hs-var">headers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). HttpLog m =&gt; HttpLogMetadata m
</span><a href="Hasura.Server.Logging.html#emptyHttpLogMetadata"><span class="hs-identifier hs-var">emptyHttpLogMetadata</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621690827789"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1126"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx.
MonadIO m =&gt;
Header -&gt; ActionCtxT ctx m ()
</span><a href="Hasura.Server.App.html#setHeader"><span class="hs-identifier hs-var">setHeader</span></a></span><span> </span><span class="annot"><span class="annottext">Header
</span><a href="Hasura.Server.Utils.html#jsonHeader"><span class="hs-identifier hs-var">jsonHeader</span></a></span><span>
</span><span id="line-1127"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx.
MonadIO m =&gt;
Status -&gt; ActionCtxT ctx m ()
</span><span class="hs-identifier hs-var">Spock.setStatus</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">QErr -&gt; Status
</span><a href="Hasura.Base.Error.html#qeStatus"><span class="hs-identifier hs-var">qeStatus</span></a></span><span> </span><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621690824562"><span class="hs-identifier hs-var">qErr</span></a></span><span>
</span><span id="line-1128"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) ctx a.
MonadIO m =&gt;
ByteString -&gt; ActionCtxT ctx m a
</span><span class="hs-identifier hs-var">Spock.lazyBytes</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.5/share/doc/ghc-9.2.5/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encode</span></span><span> </span><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621690824562"><span class="hs-identifier hs-var">qErr</span></a></span><span>
</span><span id="line-1129"></span></pre></body></html>